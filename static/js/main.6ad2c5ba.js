/*! For license information please see main.6ad2c5ba.js.LICENSE.txt */
!function(){var e={7290:function(e,t,n){"use strict";e=n.nmd(e);var r=n(861).default,a=n(3344).default,i=n(7424).default,u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(t){return"\x1b[".concat(38+e,";5;").concat(t,"m")}},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(t,n,r){return"\x1b[".concat(38+e,";2;").concat(t,";").concat(n,";").concat(r,"m")}};Object.defineProperty(e,"exports",{enumerable:!0,get:function(){var e=new Map,t={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};t.color.gray=t.color.blackBright,t.bgColor.bgGray=t.bgColor.bgBlackBright,t.color.grey=t.color.blackBright,t.bgColor.bgGrey=t.bgColor.bgBlackBright;for(var n=0,s=Object.entries(t);n<s.length;n++){for(var c=i(s[n],2),l=c[0],d=c[1],f=0,p=Object.entries(d);f<p.length;f++){var h=i(p[f],2),v=h[0],m=h[1];t[v]={open:"\x1b[".concat(m[0],"m"),close:"\x1b[".concat(m[1],"m")},d[v]=t[v],e.set(m[0],m[1])}Object.defineProperty(t,l,{value:d,enumerable:!1})}return Object.defineProperty(t,"codes",{value:e,enumerable:!1}),t.color.close="\x1b[39m",t.bgColor.close="\x1b[49m",t.color.ansi256=u(),t.color.ansi16m=o(),t.bgColor.ansi256=u(10),t.bgColor.ansi16m=o(10),Object.defineProperties(t,{rgbToAnsi256:{value:function(e,t,n){return e===t&&t===n?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(n/255*5)},enumerable:!1},hexToRgb:{value:function(e){var t=a(/([a-f\d]{6}|[a-f\d]{3})/i,{colorString:1}).exec(e.toString(16));if(!t)return[0,0,0];var n=t.groups.colorString;3===n.length&&(n=n.split("").map((function(e){return e+e})).join(""));var r=Number.parseInt(n,16);return[r>>16&255,r>>8&255,255&r]},enumerable:!1},hexToAnsi256:{value:function(e){return t.rgbToAnsi256.apply(t,r(t.hexToRgb(e)))},enumerable:!1}}),t}})},2009:function(e,t){"use strict";t.byteLength=function(e){var t=o(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,i=o(e),u=i[0],s=i[1],c=new a(function(e,t,n){return 3*(t+n)/4-n}(0,u,s)),l=0,d=s>0?u-4:u;for(n=0;n<d;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;2===s&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,c[l++]=255&t);1===s&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t);return c},t.fromByteArray=function(e){for(var t,r=e.length,a=r%3,i=[],u=16383,o=0,c=r-a;o<c;o+=u)i.push(s(e,o,o+u>c?c:o+u));1===a?(t=e[r-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===a&&(t=(e[r-2]<<8)+e[r-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return i.join("")};for(var n=[],r=[],a="undefined"!==typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0;u<64;++u)n[u]=i[u],r[i.charCodeAt(u)]=u;function o(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function s(e,t,r){for(var a,i,u=[],o=t;o<r;o+=3)a=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),u.push(n[(i=a)>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return u.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},8856:function(e,t,n){"use strict";var r=n(2122).default,a=/(?:[A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1C90-\u1CBA\u1CBD-\u1CBF\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2F\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AE\uA7B0-\uA7B4\uA7B6\uA7B8\uA7BA\uA7BC\uA7BE\uA7C0\uA7C2\uA7C4-\uA7C7\uA7C9\uA7D0\uA7D6\uA7D8\uA7F5\uFF21-\uFF3A]|\uD801[\uDC00-\uDC27\uDCB0-\uDCD3\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95]|\uD803[\uDC80-\uDCB2]|\uD806[\uDCA0-\uDCBF]|\uD81B[\uDE40-\uDE5F]|\uD835[\uDC00-\uDC19\uDC34-\uDC4D\uDC68-\uDC81\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB5\uDCD0-\uDCE9\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD38\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD6C-\uDD85\uDDA0-\uDDB9\uDDD4-\uDDED\uDE08-\uDE21\uDE3C-\uDE55\uDE70-\uDE89\uDEA8-\uDEC0\uDEE2-\uDEFA\uDF1C-\uDF34\uDF56-\uDF6E\uDF90-\uDFA8\uDFCA]|\uD83A[\uDD00-\uDD21])/,i=/(?:[a-z\xB5\xDF-\xF6\xF8-\xFF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0529\u052B\u052D\u052F\u0560-\u0588\u10D0-\u10FA\u10FD-\u10FF\u13F8-\u13FD\u1C80-\u1C88\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6\u1FC7\u1FD0-\u1FD3\u1FD6\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6\u1FF7\u210A\u210E\u210F\u2113\u212F\u2134\u2139\u213C\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5F\u2C61\u2C65\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA699\uA69B\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793-\uA795\uA797\uA799\uA79B\uA79D\uA79F\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7AF\uA7B5\uA7B7\uA7B9\uA7BB\uA7BD\uA7BF\uA7C1\uA7C3\uA7C8\uA7CA\uA7D1\uA7D3\uA7D5\uA7D7\uA7D9\uA7F6\uA7FA\uAB30-\uAB5A\uAB60-\uAB68\uAB70-\uABBF\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A]|\uD801[\uDC28-\uDC4F\uDCD8-\uDCFB\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC]|\uD803[\uDCC0-\uDCF2]|\uD806[\uDCC0-\uDCDF]|\uD81B[\uDE60-\uDE7F]|\uD835[\uDC1A-\uDC33\uDC4E-\uDC54\uDC56-\uDC67\uDC82-\uDC9B\uDCB6-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDCEA-\uDD03\uDD1E-\uDD37\uDD52-\uDD6B\uDD86-\uDD9F\uDDBA-\uDDD3\uDDEE-\uDE07\uDE22-\uDE3B\uDE56-\uDE6F\uDE8A-\uDEA5\uDEC2-\uDEDA\uDEDC-\uDEE1\uDEFC-\uDF14\uDF16-\uDF1B\uDF36-\uDF4E\uDF50-\uDF55\uDF70-\uDF88\uDF8A-\uDF8F\uDFAA-\uDFC2\uDFC4-\uDFC9\uDFCB]|\uD837[\uDF00-\uDF09\uDF0B-\uDF1E\uDF25-\uDF2A]|\uD83A[\uDD22-\uDD43])/,u=/^(?:[A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1C90-\u1CBA\u1CBD-\u1CBF\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2F\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AE\uA7B0-\uA7B4\uA7B6\uA7B8\uA7BA\uA7BC\uA7BE\uA7C0\uA7C2\uA7C4-\uA7C7\uA7C9\uA7D0\uA7D6\uA7D8\uA7F5\uFF21-\uFF3A]|\uD801[\uDC00-\uDC27\uDCB0-\uDCD3\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95]|\uD803[\uDC80-\uDCB2]|\uD806[\uDCA0-\uDCBF]|\uD81B[\uDE40-\uDE5F]|\uD835[\uDC00-\uDC19\uDC34-\uDC4D\uDC68-\uDC81\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB5\uDCD0-\uDCE9\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD38\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD6C-\uDD85\uDDA0-\uDDB9\uDDD4-\uDDED\uDE08-\uDE21\uDE3C-\uDE55\uDE70-\uDE89\uDEA8-\uDEC0\uDEE2-\uDEFA\uDF1C-\uDF34\uDF56-\uDF6E\uDF90-\uDFA8\uDFCA]|\uD83A[\uDD00-\uDD21])(?!(?:[A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1C90-\u1CBA\u1CBD-\u1CBF\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2F\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AE\uA7B0-\uA7B4\uA7B6\uA7B8\uA7BA\uA7BC\uA7BE\uA7C0\uA7C2\uA7C4-\uA7C7\uA7C9\uA7D0\uA7D6\uA7D8\uA7F5\uFF21-\uFF3A]|\uD801[\uDC00-\uDC27\uDCB0-\uDCD3\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95]|\uD803[\uDC80-\uDCB2]|\uD806[\uDCA0-\uDCBF]|\uD81B[\uDE40-\uDE5F]|\uD835[\uDC00-\uDC19\uDC34-\uDC4D\uDC68-\uDC81\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB5\uDCD0-\uDCE9\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD38\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD6C-\uDD85\uDDA0-\uDDB9\uDDD4-\uDDED\uDE08-\uDE21\uDE3C-\uDE55\uDE70-\uDE89\uDEA8-\uDEC0\uDEE2-\uDEFA\uDF1C-\uDF34\uDF56-\uDF6E\uDF90-\uDFA8\uDFCA]|\uD83A[\uDD00-\uDD21]))/g,o=/((?:[0-9A-Z_a-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0345\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05B0-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05EF-\u05F2\u0610-\u061A\u0620-\u0657\u0659-\u0669\u066E-\u06D3\u06D5-\u06DC\u06E1-\u06E8\u06ED-\u06FC\u06FF\u0710-\u073F\u074D-\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0817\u081A-\u082C\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u08D4-\u08DF\u08E3-\u08E9\u08F0-\u093B\u093D-\u094C\u094E-\u0950\u0955-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD-\u09C4\u09C7\u09C8\u09CB\u09CC\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3E-\u0A42\u0A47\u0A48\u0A4B\u0A4C\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD-\u0AC5\u0AC7-\u0AC9\u0ACB\u0ACC\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFC\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D-\u0B44\u0B47\u0B48\u0B4B\u0B4C\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71-\u0B77\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCC\u0BD0\u0BD7\u0BE6-\u0BF2\u0C00-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4C\u0C55\u0C56\u0C58-\u0C5A\u0C5D\u0C60-\u0C63\u0C66-\u0C6F\u0C78-\u0C7E\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCC\u0CD5\u0CD6\u0CDD\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1-\u0CF3\u0D00-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4C\u0D4E\u0D54-\u0D63\u0D66-\u0D78\u0D7A-\u0D7F\u0D81-\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E46\u0E4D\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F71-\u0F83\u0F88-\u0F97\u0F99-\u0FBC\u1000-\u1036\u1038\u103B-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1713\u171F-\u1733\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17B3\u17B6-\u17C8\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u1938\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A61-\u1A74\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1ABF\u1AC0\u1ACC-\u1ACE\u1B00-\u1B33\u1B35-\u1B43\u1B45-\u1B4C\u1B50-\u1B59\u1B80-\u1BA9\u1BAC-\u1BE5\u1BE7-\u1BF1\u1C00-\u1C36\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1DE7-\u1DF4\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2189\u2150-\u2182\u2460-\u249B\u24B6-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA674-\uA67B\uA67F-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA805\uA807-\uA827\uA830-\uA835\uA840-\uA873\uA880-\uA8C3\uA8C5\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD-\uA92A\uA930-\uA952\uA960-\uA97C\uA980-\uA9B2\uA9B4-\uA9BF\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAABE\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF5\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABEA\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD27\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEAB\uDEAC\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC00-\uDC45\uDC52-\uDC6F\uDC71-\uDC75\uDC80-\uDCB8\uDCC2\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD32\uDD36-\uDD3F\uDD44-\uDD47\uDD50-\uDD72\uDD76\uDD80-\uDDBF\uDDC1-\uDDC4\uDDCE-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE34\uDE37\uDE3E-\uDE41\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEE8\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D-\uDF44\uDF47\uDF48\uDF4B\uDF4C\uDF50\uDF57\uDF5D-\uDF63]|\uD805[\uDC00-\uDC41\uDC43-\uDC45\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCC1\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDBE\uDDD8-\uDDDD\uDE00-\uDE3E\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB5\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF1D-\uDF2A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC38\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD35\uDD37\uDD38\uDD3B\uDD3C\uDD3F-\uDD42\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD7\uDDDA-\uDDDF\uDDE1\uDDE3\uDDE4\uDE00-\uDE32\uDE35-\uDE3E\uDE50-\uDE97\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC3E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD41\uDD43\uDD46\uDD47\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD8E\uDD90\uDD91\uDD93-\uDD96\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF6\uDF00-\uDF10\uDF12-\uDF3A\uDF3E-\uDF40\uDF50-\uDF59\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF4F-\uDF87\uDF8F-\uDF9F\uDFE0\uDFE1\uDFE3\uDFF0\uDFF1]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9E]|\uD834[\uDEC0-\uDED3\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDC30-\uDC6D\uDC8F\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDCD0-\uDCEB\uDCF0-\uDCF9\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD47\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C\uDD30-\uDD49\uDD50-\uDD69\uDD70-\uDD89]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])|$)/,s=/[_.\- ]+/,c=new RegExp("^"+s.source),l=new RegExp(s.source+o.source,"gu"),d=new RegExp("\\d+"+o.source,"gu"),f=function(e,t){if("string"!==typeof e&&!Array.isArray(e))throw new TypeError("Expected the input to be `string | string[]`");if(t=r({pascalCase:!1,preserveConsecutiveUppercase:!1},t),0===(e=Array.isArray(e)?e.map((function(e){return e.trim()})).filter((function(e){return e.length})).join("-"):e.trim()).length)return"";var n=!1===t.locale?function(e){return e.toLowerCase()}:function(e){return e.toLocaleLowerCase(t.locale)},o=!1===t.locale?function(e){return e.toUpperCase()}:function(e){return e.toLocaleUpperCase(t.locale)};return 1===e.length?t.pascalCase?o(e):n(e):(e!==n(e)&&(e=function(e,t,n){for(var r=!1,u=!1,o=!1,s=0;s<e.length;s++){var c=e[s];r&&a.test(c)?(e=e.slice(0,s)+"-"+e.slice(s),r=!1,o=u,u=!0,s++):u&&o&&i.test(c)?(e=e.slice(0,s-1)+"-"+e.slice(s-1),o=u,u=!1,r=!0):(r=t(c)===c&&n(c)!==c,o=u,u=n(c)===c&&t(c)!==c)}return e}(e,n,o)),e=e.replace(c,""),e=t.preserveConsecutiveUppercase?function(e,t){return u.lastIndex=0,e.replace(u,(function(e){return t(e)}))}(e,n):n(e),t.pascalCase&&(e=o(e.charAt(0))+e.slice(1)),function(e,t){return l.lastIndex=0,d.lastIndex=0,e.replace(l,(function(e,n){return t(n)})).replace(d,(function(e){return t(e)}))}(e,o))};e.exports=f,e.exports.default=f},5578:function(e){"use strict";e.exports=function(e,t){if("string"!==typeof e)throw new TypeError("Expected a string");return t="undefined"===typeof t?"_":t,e.replace(/([a-z\d])([A-Z])/g,"$1"+t+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+t+"$2").toLowerCase()}},7143:function(e){"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,u){if("function"!==typeof r)throw new TypeError("The listener must be a function");var o=new a(r,i||e,u),s=n?n+t:t;return e._events[s]?e._events[s].fn?e._events[s]=[e._events[s],o]:e._events[s].push(o):(e._events[s]=o,e._eventsCount++),e}function u(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function o(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),o.prototype.eventNames=function(){var e,r,a=[];if(0===this._eventsCount)return a;for(r in e=this._events)t.call(e,r)&&a.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},o.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var a=0,i=r.length,u=new Array(i);a<i;a++)u[a]=r[a].fn;return u},o.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},o.prototype.emit=function(e,t,r,a,i,u){var o=n?n+e:e;if(!this._events[o])return!1;var s,c,l=this._events[o],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,a),!0;case 5:return l.fn.call(l.context,t,r,a,i),!0;case 6:return l.fn.call(l.context,t,r,a,i,u),!0}for(c=1,s=new Array(d-1);c<d;c++)s[c-1]=arguments[c];l.fn.apply(l.context,s)}else{var f,p=l.length;for(c=0;c<p;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),d){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,r);break;case 4:l[c].fn.call(l[c].context,t,r,a);break;default:if(!s)for(f=1,s=new Array(d-1);f<d;f++)s[f-1]=arguments[f];l[c].fn.apply(l[c].context,s)}}return!0},o.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},o.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},o.prototype.removeListener=function(e,t,r,a){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return u(this,i),this;var o=this._events[i];if(o.fn)o.fn!==t||a&&!o.once||r&&o.context!==r||u(this,i);else{for(var s=0,c=[],l=o.length;s<l;s++)(o[s].fn!==t||a&&!o[s].once||r&&o[s].context!==r)&&c.push(o[s]);c.length?this._events[i]=1===c.length?c[0]:c:u(this,i)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&u(this,t)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o},9674:function(e){"use strict";e.exports=function(e,t){return t=t||function(){},e.then((function(e){return new Promise((function(e){e(t())})).then((function(){return e}))}),(function(e){return new Promise((function(e){e(t())})).then((function(){throw e}))}))}},2906:function(e,t,n){"use strict";var r=n(7061).default,a=n(7156).default,i=n(6690).default,u=n(9728).default,o=n(1655).default,s=n(6389).default;Object.defineProperty(t,"__esModule",{value:!0});var c=n(7143),l=n(3807),d=n(5152),f=function(){},p=new l.TimeoutError,h=function(e){o(n,e);var t=s(n);function n(e){var r,a,u,o,s;if(i(this,n),(r=t.call(this))._intervalCount=0,r._intervalEnd=0,r._pendingCount=0,r._resolveEmpty=f,r._resolveIdle=f,!("number"===typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:d.default},e)).intervalCap&&e.intervalCap>=1))throw new TypeError("Expected `intervalCap` to be a number from 1 and up, got `".concat(null!==(u=null===(a=e.intervalCap)||void 0===a?void 0:a.toString())&&void 0!==u?u:"","` (").concat(typeof e.intervalCap,")"));if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError("Expected `interval` to be a finite number >= 0, got `".concat(null!==(s=null===(o=e.interval)||void 0===o?void 0:o.toString())&&void 0!==s?s:"","` (").concat(typeof e.interval,")"));return r._carryoverConcurrencyCount=e.carryoverConcurrencyCount,r._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,r._intervalCap=e.intervalCap,r._interval=e.interval,r._queue=new e.queueClass,r._queueClass=e.queueClass,r.concurrency=e.concurrency,r._timeout=e.timeout,r._throwOnTimeout=!0===e.throwOnTimeout,r._isPaused=!1===e.autoStart,r}return u(n,[{key:"_doesIntervalAllowAnother",get:function(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}},{key:"_doesConcurrentAllowAnother",get:function(){return this._pendingCount<this._concurrency}},{key:"_next",value:function(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}},{key:"_resolvePromises",value:function(){this._resolveEmpty(),this._resolveEmpty=f,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=f,this.emit("idle"))}},{key:"_onResumeInterval",value:function(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}},{key:"_isIntervalPaused",value:function(){var e=this,t=Date.now();if(void 0===this._intervalId){var n=this._intervalEnd-t;if(!(n<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout((function(){e._onResumeInterval()}),n)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}},{key:"_tryToStartAnother",value:function(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){var e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){var t=this._queue.dequeue();return!!t&&(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0)}}return!1}},{key:"_initializeIntervalIfNeeded",value:function(){var e=this;this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval((function(){e._onInterval()}),this._interval),this._intervalEnd=Date.now()+this._interval)}},{key:"_onInterval",value:function(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}},{key:"_processQueue",value:function(){for(;this._tryToStartAnother(););}},{key:"concurrency",get:function(){return this._concurrency},set:function(e){if(!("number"===typeof e&&e>=1))throw new TypeError("Expected `concurrency` to be a number from 1 and up, got `".concat(e,"` (").concat(typeof e,")"));this._concurrency=e,this._processQueue()}},{key:"add",value:function(){var e=a(r().mark((function e(t){var n,i=this,u=arguments;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:{},e.abrupt("return",new Promise((function(e,u){var o=function(){var o=a(r().mark((function a(){var o;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i._pendingCount++,i._intervalCount++,r.prev=2,o=void 0===i._timeout&&void 0===n.timeout?t():l.default(Promise.resolve(t()),void 0===n.timeout?i._timeout:n.timeout,(function(){(void 0===n.throwOnTimeout?i._throwOnTimeout:n.throwOnTimeout)&&u(p)})),r.t0=e,r.next=7,o;case 7:r.t1=r.sent,(0,r.t0)(r.t1),r.next=14;break;case 11:r.prev=11,r.t2=r.catch(2),u(r.t2);case 14:i._next();case 15:case"end":return r.stop()}}),a,null,[[2,11]])})));return function(){return o.apply(this,arguments)}}();i._queue.enqueue(o,n),i._tryToStartAnother(),i.emit("add")})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"addAll",value:function(){var e=a(r().mark((function e(t,n){var i=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(t.map(function(){var e=a(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.add(t,n));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"start",value:function(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}},{key:"pause",value:function(){this._isPaused=!0}},{key:"clear",value:function(){this._queue=new this._queueClass}},{key:"onEmpty",value:function(){var e=a(r().mark((function e(){var t=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this._queue.size){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",new Promise((function(e){var n=t._resolveEmpty;t._resolveEmpty=function(){n(),e()}})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onIdle",value:function(){var e=a(r().mark((function e(){var t=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this._pendingCount||0!==this._queue.size){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",new Promise((function(e){var n=t._resolveIdle;t._resolveIdle=function(){n(),e()}})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"size",get:function(){return this._queue.size}},{key:"sizeBy",value:function(e){return this._queue.filter(e).length}},{key:"pending",get:function(){return this._pendingCount}},{key:"isPaused",get:function(){return this._isPaused}},{key:"timeout",get:function(){return this._timeout},set:function(e){this._timeout=e}}]),n}(c);t.default=h},7009:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){for(var r=0,a=e.length;a>0;){var i=a/2|0,u=r+i;n(e[u],t)<=0?(r=++u,a-=i+1):a=i}return r}},5152:function(e,t,n){"use strict";var r=n(6690).default,a=n(9728).default;Object.defineProperty(t,"__esModule",{value:!0});var i=n(7009),u=function(){function e(){r(this,e),this._queue=[]}return a(e,[{key:"enqueue",value:function(e,t){var n={priority:(t=Object.assign({priority:0},t)).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)this._queue.push(n);else{var r=i.default(this._queue,n,(function(e,t){return t.priority-e.priority}));this._queue.splice(r,0,n)}}},{key:"dequeue",value:function(){var e=this._queue.shift();return null===e||void 0===e?void 0:e.run}},{key:"filter",value:function(e){return this._queue.filter((function(t){return t.priority===e.priority})).map((function(e){return e.run}))}},{key:"size",get:function(){return this._queue.length}}]),e}();t.default=u},1545:function(e,t,n){"use strict";var r=n(7061).default,a=n(7156).default,i=n(2122).default,u=n(9728).default,o=n(6690).default,s=n(1655).default,c=n(6389).default,l=n(3496).default,d=n(9158),f=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"],p=function(e){s(n,e);var t=c(n);function n(e){var r;(o(this,n),r=t.call(this),e instanceof Error)?(r.originalError=e,e=e.message):(r.originalError=new Error(e),r.originalError.stack=r.stack);return r.name="AbortError",r.message=e,r}return u(n)}(l(Error)),h=function(e,t,n){var r=n.retries-(t-1);return e.attemptNumber=t,e.retriesLeft=r,e},v=function(e,t){return new Promise((function(n,u){t=i({onFailedAttempt:function(){},retries:10},t);var o=d.operation(t);o.attempt(function(){var i=a(r().mark((function a(i){return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.t0=n,r.next=4,e(i);case 4:r.t1=r.sent,(0,r.t0)(r.t1),r.next=34;break;case 8:if(r.prev=8,r.t2=r.catch(0),r.t2 instanceof Error){r.next=13;break}return u(new TypeError('Non-error was thrown: "'.concat(r.t2,'". You should only throw errors.'))),r.abrupt("return");case 13:if(!(r.t2 instanceof p)){r.next=18;break}o.stop(),u(r.t2.originalError),r.next=34;break;case 18:if(!(r.t2 instanceof TypeError)||(a=r.t2.message,f.includes(a))){r.next=23;break}o.stop(),u(r.t2),r.next=34;break;case 23:return h(r.t2,i,t),r.prev=24,r.next=27,t.onFailedAttempt(r.t2);case 27:r.next=33;break;case 29:return r.prev=29,r.t3=r.catch(24),u(r.t3),r.abrupt("return");case 33:o.retry(r.t2)||u(o.mainError());case 34:case"end":return r.stop()}var a}),a,null,[[0,8],[24,29]])})));return function(e){return i.apply(this,arguments)}}())}))};e.exports=v,e.exports.default=v,e.exports.AbortError=p},3807:function(e,t,n){"use strict";var r=n(9728).default,a=n(6690).default,i=n(1655).default,u=n(6389).default,o=n(3496).default,s=n(9674),c=function(e){i(n,e);var t=u(n);function n(e){var r;return a(this,n),(r=t.call(this,e)).name="TimeoutError",r}return r(n)}(o(Error)),l=function(e,t,n){return new Promise((function(r,a){if("number"!==typeof t||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(t!==1/0){var i=setTimeout((function(){if("function"!==typeof n){var i="string"===typeof n?n:"Promise timed out after ".concat(t," milliseconds"),u=n instanceof Error?n:new c(i);"function"===typeof e.cancel&&e.cancel(),a(u)}else try{r(n())}catch(o){a(o)}}),t);s(e.then(r,a),(function(){clearTimeout(i)}))}else r(e)}))};e.exports=l,e.exports.default=l,e.exports.TimeoutError=c},4463:function(e,t,n){"use strict";var r=n(2791),a=n(5296);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u=new Set,o={};function s(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)u.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},h={};function v(e,t,n,r,a,i,u){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=u}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function g(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=m.hasOwnProperty(t)?m[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!d.call(h,e)||!d.call(p,e)&&(f.test(e)?h[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,g);m[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,g);m[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,g);m[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var _=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),w=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),D=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),T=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var j=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var I=Symbol.iterator;function N(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=I&&e[I]||e["@@iterator"])?e:null}var R,B=Object.assign;function L(e){if(void 0===R)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);R=t&&t[1]||""}return"\n"+R+e}var M=!1;function U(e,t){if(!e||M)return"";M=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),u=a.length-1,o=i.length-1;1<=u&&0<=o&&a[u]!==i[o];)o--;for(;1<=u&&0<=o;u--,o--)if(a[u]!==i[o]){if(1!==u||1!==o)do{if(u--,0>--o||a[u]!==i[o]){var s="\n"+a[u].replace(" at new "," at ");return e.displayName&&s.includes("<anonymous>")&&(s=s.replace("<anonymous>",e.displayName)),s}}while(1<=u&&0<=o);break}}}finally{M=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?L(e):""}function z(e){switch(e.tag){case 5:return L(e.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function H(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case x:return"Fragment";case w:return"Portal";case A:return"Profiler";case E:return"StrictMode";case O:return"Suspense";case F:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case D:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case S:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:H(e.type)||"Memo";case T:t=e._payload,e=e._init;try{return H(e(t))}catch(n){}}return null}function Z(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function V(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=q(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function $(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function J(e,t){var n=t.checked;return B({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function K(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){Q(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Y(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&$(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return B({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function ie(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ue(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function se(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,le,de=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function fe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(pe).forEach((function(e){he.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ye=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ge(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _e=null;function ke(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,xe=null,Ee=null;function Ae(e){if(e=ba(e)){if("function"!==typeof we)throw Error(i(280));var t=e.stateNode;t&&(t=ka(t),we(e.stateNode,e.type,t))}}function Ce(e){xe?Ee?Ee.push(e):Ee=[e]:xe=e}function De(){if(xe){var e=xe,t=Ee;if(Ee=xe=null,Ae(e),t)for(e=0;e<t.length;e++)Ae(t[e])}}function Se(e,t){return e(t)}function Oe(){}var Fe=!1;function Pe(e,t,n){if(Fe)return e(t,n);Fe=!0;try{return Se(e,t,n)}finally{Fe=!1,(null!==xe||null!==Ee)&&(Oe(),De())}}function Te(e,t){var n=e.stateNode;if(null===n)return null;var r=ka(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var je=!1;if(l)try{var Ie={};Object.defineProperty(Ie,"passive",{get:function(){je=!0}}),window.addEventListener("test",Ie,Ie),window.removeEventListener("test",Ie,Ie)}catch(le){je=!1}function Ne(e,t,n,r,a,i,u,o,s){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var Re=!1,Be=null,Le=!1,Me=null,Ue={onError:function(e){Re=!0,Be=e}};function ze(e,t,n,r,a,i,u,o,s){Re=!1,Be=null,Ne.apply(Ue,arguments)}function He(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ze(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(He(e)!==e)throw Error(i(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=He(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var u=a.alternate;if(null===u){if(null!==(r=a.return)){n=r;continue}break}if(a.child===u.child){for(u=a.child;u;){if(u===n)return We(a),e;if(u===r)return We(a),t;u=u.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=u;else{for(var o=!1,s=a.child;s;){if(s===n){o=!0,n=a,r=u;break}if(s===r){o=!0,r=a,n=u;break}s=s.sibling}if(!o){for(s=u.child;s;){if(s===n){o=!0,n=u,r=a;break}if(s===r){o=!0,r=u,n=a;break}s=s.sibling}if(!o)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var Ve=a.unstable_scheduleCallback,$e=a.unstable_cancelCallback,Je=a.unstable_shouldYield,Ke=a.unstable_requestPaint,Qe=a.unstable_now,Xe=a.unstable_getCurrentPriorityLevel,Ye=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var ut=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/st|0)|0},ot=Math.log,st=Math.LN2;var ct=64,lt=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ft(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,u=268435455&n;if(0!==u){var o=u&~a;0!==o?r=dt(o):0!==(i&=u)&&(r=dt(i))}else 0!==(u=n&~a)?r=dt(u):0!==i&&(r=dt(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-ut(t)),r|=e[n],t&=~a;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ut(t)]=n}function gt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ut(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function _t(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var kt,wt,xt,Et,At,Ct=!1,Dt=[],St=null,Ot=null,Ft=null,Pt=new Map,Tt=new Map,jt=[],It="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Nt(e,t){switch(e){case"focusin":case"focusout":St=null;break;case"dragenter":case"dragleave":Ot=null;break;case"mouseover":case"mouseout":Ft=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tt.delete(t.pointerId)}}function Rt(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&wt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Bt(e){var t=ga(e.target);if(null!==t){var n=He(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ze(n)))return e.blockedOn=t,void At(e.priority,(function(){xt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Lt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&wt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);_e=r,n.target.dispatchEvent(r),_e=null,t.shift()}return!0}function Mt(e,t,n){Lt(e)&&n.delete(t)}function Ut(){Ct=!1,null!==St&&Lt(St)&&(St=null),null!==Ot&&Lt(Ot)&&(Ot=null),null!==Ft&&Lt(Ft)&&(Ft=null),Pt.forEach(Mt),Tt.forEach(Mt)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ut)))}function Ht(e){function t(t){return zt(t,e)}if(0<Dt.length){zt(Dt[0],e);for(var n=1;n<Dt.length;n++){var r=Dt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==St&&zt(St,e),null!==Ot&&zt(Ot,e),null!==Ft&&zt(Ft,e),Pt.forEach(t),Tt.forEach(t),n=0;n<jt.length;n++)(r=jt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<jt.length&&null===(n=jt[0]).blockedOn;)Bt(n),null===n.blockedOn&&jt.shift()}var Zt=_.ReactCurrentBatchConfig,Wt=!0;function qt(e,t,n,r){var a=bt,i=Zt.transition;Zt.transition=null;try{bt=1,Vt(e,t,n,r)}finally{bt=a,Zt.transition=i}}function Gt(e,t,n,r){var a=bt,i=Zt.transition;Zt.transition=null;try{bt=4,Vt(e,t,n,r)}finally{bt=a,Zt.transition=i}}function Vt(e,t,n,r){if(Wt){var a=Jt(e,t,n,r);if(null===a)Wr(e,t,r,$t,n),Nt(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return St=Rt(St,e,t,n,r,a),!0;case"dragenter":return Ot=Rt(Ot,e,t,n,r,a),!0;case"mouseover":return Ft=Rt(Ft,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Pt.set(i,Rt(Pt.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Tt.set(i,Rt(Tt.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Nt(e,r),4&t&&-1<It.indexOf(e)){for(;null!==a;){var i=ba(a);if(null!==i&&kt(i),null===(i=Jt(e,t,n,r))&&Wr(e,t,r,$t,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var $t=null;function Jt(e,t,n,r){if($t=null,null!==(e=ga(e=ke(r))))if(null===(t=He(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ze(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return $t=e,null}function Kt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ye:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Qt=null,Xt=null,Yt=null;function en(){if(Yt)return Yt;var e,t,n=Xt,r=n.length,a="value"in Qt?Qt.value:Qt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var u=r-e;for(t=1;t<=u&&n[r-t]===a[i-t];t++);return Yt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var u in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(u)&&(t=e[u],this[u]=t?t(a):a[u]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return B(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var un,on,sn,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=an(cn),dn=B({},cn,{view:0,detail:0}),fn=an(dn),pn=B({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:An,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sn&&(sn&&"mousemove"===e.type?(un=e.screenX-sn.screenX,on=e.screenY-sn.screenY):on=un=0,sn=e),un)},movementY:function(e){return"movementY"in e?e.movementY:on}}),hn=an(pn),vn=an(B({},pn,{dataTransfer:0})),mn=an(B({},dn,{relatedTarget:0})),yn=an(B({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),gn=B({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(gn),_n=an(B({},cn,{data:0})),kn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=xn[e])&&!!t[e]}function An(){return En}var Cn=B({},dn,{key:function(e){if(e.key){var t=kn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:An,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Dn=an(Cn),Sn=an(B({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),On=an(B({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:An})),Fn=an(B({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pn=B({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Tn=an(Pn),jn=[9,13,27,32],In=l&&"CompositionEvent"in window,Nn=null;l&&"documentMode"in document&&(Nn=document.documentMode);var Rn=l&&"TextEvent"in window&&!Nn,Bn=l&&(!In||Nn&&8<Nn&&11>=Nn),Ln=String.fromCharCode(32),Mn=!1;function Un(e,t){switch(e){case"keyup":return-1!==jn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Hn=!1;var Zn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Zn[e.type]:"textarea"===t}function qn(e,t,n,r){Ce(r),0<(t=Gr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,Vn=null;function $n(e){Lr(e,0)}function Jn(e){if(V(_a(e)))return e}function Kn(e,t){if("change"===e)return t}var Qn=!1;if(l){var Xn;if(l){var Yn="oninput"in document;if(!Yn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Yn="function"===typeof er.oninput}Xn=Yn}else Xn=!1;Qn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Gn&&(Gn.detachEvent("onpropertychange",nr),Vn=Gn=null)}function nr(e){if("value"===e.propertyName&&Jn(Vn)){var t=[];qn(t,Vn,e,ke(e)),Pe($n,t)}}function rr(e,t,n){"focusin"===e?(tr(),Vn=n,(Gn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn(Vn)}function ir(e,t){if("click"===e)return Jn(t)}function ur(e,t){if("input"===e||"change"===e)return Jn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function sr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!d.call(t,a)||!or(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fr(){for(var e=window,t=$();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=$((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function hr(e){var t=fr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=lr(n,i);var u=lr(n,r);a&&u&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==u.node||e.focusOffset!==u.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(u.node,u.offset)):(t.setEnd(u.node,u.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=l&&"documentMode"in document&&11>=document.documentMode,mr=null,yr=null,gr=null,br=!1;function _r(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==mr||mr!==$(r)||("selectionStart"in(r=mr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},gr&&sr(gr,r)||(gr=r,0<(r=Gr(yr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function kr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wr={animationend:kr("Animation","AnimationEnd"),animationiteration:kr("Animation","AnimationIteration"),animationstart:kr("Animation","AnimationStart"),transitionend:kr("Transition","TransitionEnd")},xr={},Er={};function Ar(e){if(xr[e])return xr[e];if(!wr[e])return e;var t,n=wr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Er)return xr[e]=n[t];return e}l&&(Er=document.createElement("div").style,"AnimationEvent"in window||(delete wr.animationend.animation,delete wr.animationiteration.animation,delete wr.animationstart.animation),"TransitionEvent"in window||delete wr.transitionend.transition);var Cr=Ar("animationend"),Dr=Ar("animationiteration"),Sr=Ar("animationstart"),Or=Ar("transitionend"),Fr=new Map,Pr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Tr(e,t){Fr.set(e,t),s(t,[e])}for(var jr=0;jr<Pr.length;jr++){var Ir=Pr[jr];Tr(Ir.toLowerCase(),"on"+(Ir[0].toUpperCase()+Ir.slice(1)))}Tr(Cr,"onAnimationEnd"),Tr(Dr,"onAnimationIteration"),Tr(Sr,"onAnimationStart"),Tr("dblclick","onDoubleClick"),Tr("focusin","onFocus"),Tr("focusout","onBlur"),Tr(Or,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Rr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nr));function Br(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,u,o,s,c){if(ze.apply(this,arguments),Re){if(!Re)throw Error(i(198));var l=Be;Re=!1,Be=null,Le||(Le=!0,Me=l)}}(r,t,void 0,e),e.currentTarget=null}function Lr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var u=r.length-1;0<=u;u--){var o=r[u],s=o.instance,c=o.currentTarget;if(o=o.listener,s!==i&&a.isPropagationStopped())break e;Br(a,o,c),i=s}else for(u=0;u<r.length;u++){if(s=(o=r[u]).instance,c=o.currentTarget,o=o.listener,s!==i&&a.isPropagationStopped())break e;Br(a,o,c),i=s}}}if(Le)throw e=Me,Le=!1,Me=null,e}function Mr(e,t){var n=t[va];void 0===n&&(n=t[va]=new Set);var r=e+"__bubble";n.has(r)||(Zr(t,e,2,!1),n.add(r))}function Ur(e,t,n){var r=0;t&&(r|=4),Zr(n,e,r,t)}var zr="_reactListening"+Math.random().toString(36).slice(2);function Hr(e){if(!e[zr]){e[zr]=!0,u.forEach((function(t){"selectionchange"!==t&&(Rr.has(t)||Ur(t,!1,e),Ur(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zr]||(t[zr]=!0,Ur("selectionchange",!1,t))}}function Zr(e,t,n,r){switch(Kt(t)){case 1:var a=qt;break;case 4:a=Gt;break;default:a=Vt}n=a.bind(null,t,n,e),a=void 0,!je||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var u=r.tag;if(3===u||4===u){var o=r.stateNode.containerInfo;if(o===a||8===o.nodeType&&o.parentNode===a)break;if(4===u)for(u=r.return;null!==u;){var s=u.tag;if((3===s||4===s)&&((s=u.stateNode.containerInfo)===a||8===s.nodeType&&s.parentNode===a))return;u=u.return}for(;null!==o;){if(null===(u=ga(o)))return;if(5===(s=u.tag)||6===s){r=i=u;continue e}o=o.parentNode}}r=r.return}Pe((function(){var r=i,a=ke(n),u=[];e:{var o=Fr.get(e);if(void 0!==o){var s=ln,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":s=Dn;break;case"focusin":c="focus",s=mn;break;case"focusout":c="blur",s=mn;break;case"beforeblur":case"afterblur":s=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":s=hn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":s=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":s=On;break;case Cr:case Dr:case Sr:s=yn;break;case Or:s=Fn;break;case"scroll":s=fn;break;case"wheel":s=Tn;break;case"copy":case"cut":case"paste":s=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":s=Sn}var l=0!==(4&t),d=!l&&"scroll"===e,f=l?null!==o?o+"Capture":null:o;l=[];for(var p,h=r;null!==h;){var v=(p=h).stateNode;if(5===p.tag&&null!==v&&(p=v,null!==f&&(null!=(v=Te(h,f))&&l.push(qr(h,v,p)))),d)break;h=h.return}0<l.length&&(o=new s(o,c,null,n,a),u.push({event:o,listeners:l}))}}if(0===(7&t)){if(s="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===_e||!(c=n.relatedTarget||n.fromElement)||!ga(c)&&!c[ha])&&(s||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,s?(s=r,null!==(c=(c=n.relatedTarget||n.toElement)?ga(c):null)&&(c!==(d=He(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(s=null,c=r),s!==c)){if(l=hn,v="onMouseLeave",f="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(l=Sn,v="onPointerLeave",f="onPointerEnter",h="pointer"),d=null==s?o:_a(s),p=null==c?o:_a(c),(o=new l(v,h+"leave",s,n,a)).target=d,o.relatedTarget=p,v=null,ga(a)===r&&((l=new l(f,h+"enter",c,n,a)).target=p,l.relatedTarget=d,v=l),d=v,s&&c)e:{for(f=c,h=0,p=l=s;p;p=Vr(p))h++;for(p=0,v=f;v;v=Vr(v))p++;for(;0<h-p;)l=Vr(l),h--;for(;0<p-h;)f=Vr(f),p--;for(;h--;){if(l===f||null!==f&&l===f.alternate)break e;l=Vr(l),f=Vr(f)}l=null}else l=null;null!==s&&$r(u,o,s,l,!1),null!==c&&null!==d&&$r(u,d,c,l,!0)}if("select"===(s=(o=r?_a(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===s&&"file"===o.type)var m=Kn;else if(Wn(o))if(Qn)m=ur;else{m=ar;var y=rr}else(s=o.nodeName)&&"input"===s.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(m=ir);switch(m&&(m=m(e,r))?qn(u,m,n,a):(y&&y(e,o,r),"focusout"===e&&(y=o._wrapperState)&&y.controlled&&"number"===o.type&&ee(o,"number",o.value)),y=r?_a(r):window,e){case"focusin":(Wn(y)||"true"===y.contentEditable)&&(mr=y,yr=r,gr=null);break;case"focusout":gr=yr=mr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,_r(u,n,a);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":_r(u,n,a)}var g;if(In)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Hn?Un(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Bn&&"ko"!==n.locale&&(Hn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Hn&&(g=en()):(Xt="value"in(Qt=a)?Qt.value:Qt.textContent,Hn=!0)),0<(y=Gr(r,b)).length&&(b=new _n(b,e,null,n,a),u.push({event:b,listeners:y}),g?b.data=g:null!==(g=zn(n))&&(b.data=g))),(g=Rn?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Mn=!0,Ln);case"textInput":return(e=t.data)===Ln&&Mn?null:e;default:return null}}(e,n):function(e,t){if(Hn)return"compositionend"===e||!In&&Un(e,t)?(e=en(),Yt=Xt=Qt=null,Hn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Gr(r,"onBeforeInput")).length&&(a=new _n("onBeforeInput","beforeinput",null,n,a),u.push({event:a,listeners:r}),a.data=g))}Lr(u,t)}))}function qr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Te(e,n))&&r.unshift(qr(e,i,a)),null!=(i=Te(e,t))&&r.push(qr(e,i,a))),e=e.return}return r}function Vr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function $r(e,t,n,r,a){for(var i=t._reactName,u=[];null!==n&&n!==r;){var o=n,s=o.alternate,c=o.stateNode;if(null!==s&&s===r)break;5===o.tag&&null!==c&&(o=c,a?null!=(s=Te(n,i))&&u.unshift(qr(n,s,o)):a||null!=(s=Te(n,i))&&u.push(qr(n,s,o))),n=n.return}0!==u.length&&e.push({event:t,listeners:u})}var Jr=/\r\n?/g,Kr=/\u0000|\uFFFD/g;function Qr(e){return("string"===typeof e?e:""+e).replace(Jr,"\n").replace(Kr,"")}function Xr(e,t,n){if(t=Qr(t),Qr(e)!==t&&n)throw Error(i(425))}function Yr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,ua="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(oa)}:ra;function oa(e){setTimeout((function(){throw e}))}function sa(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Ht(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Ht(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function la(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var da=Math.random().toString(36).slice(2),fa="__reactFiber$"+da,pa="__reactProps$"+da,ha="__reactContainer$"+da,va="__reactEvents$"+da,ma="__reactListeners$"+da,ya="__reactHandles$"+da;function ga(e){var t=e[fa];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ha]||n[fa]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=la(e);null!==e;){if(n=e[fa])return n;e=la(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[fa]||e[ha])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function _a(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function ka(e){return e[pa]||null}var wa=[],xa=-1;function Ea(e){return{current:e}}function Aa(e){0>xa||(e.current=wa[xa],wa[xa]=null,xa--)}function Ca(e,t){xa++,wa[xa]=e.current,e.current=t}var Da={},Sa=Ea(Da),Oa=Ea(!1),Fa=Da;function Pa(e,t){var n=e.type.contextTypes;if(!n)return Da;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ta(e){return null!==(e=e.childContextTypes)&&void 0!==e}function ja(){Aa(Oa),Aa(Sa)}function Ia(e,t,n){if(Sa.current!==Da)throw Error(i(168));Ca(Sa,t),Ca(Oa,n)}function Na(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,Z(e)||"Unknown",a));return B({},n,r)}function Ra(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Da,Fa=Sa.current,Ca(Sa,e),Ca(Oa,Oa.current),!0}function Ba(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Na(e,t,Fa),r.__reactInternalMemoizedMergedChildContext=e,Aa(Oa),Aa(Sa),Ca(Sa,e)):Aa(Oa),Ca(Oa,n)}var La=null,Ma=!1,Ua=!1;function za(e){null===La?La=[e]:La.push(e)}function Ha(){if(!Ua&&null!==La){Ua=!0;var e=0,t=bt;try{var n=La;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}La=null,Ma=!1}catch(a){throw null!==La&&(La=La.slice(e+1)),Ve(Ye,Ha),a}finally{bt=t,Ua=!1}}return null}var Za=[],Wa=0,qa=null,Ga=0,Va=[],$a=0,Ja=null,Ka=1,Qa="";function Xa(e,t){Za[Wa++]=Ga,Za[Wa++]=qa,qa=e,Ga=t}function Ya(e,t,n){Va[$a++]=Ka,Va[$a++]=Qa,Va[$a++]=Ja,Ja=e;var r=Ka;e=Qa;var a=32-ut(r)-1;r&=~(1<<a),n+=1;var i=32-ut(t)+a;if(30<i){var u=a-a%5;i=(r&(1<<u)-1).toString(32),r>>=u,a-=u,Ka=1<<32-ut(t)+a|n<<a|r,Qa=i+e}else Ka=1<<i|n<<a|r,Qa=e}function ei(e){null!==e.return&&(Xa(e,1),Ya(e,1,0))}function ti(e){for(;e===qa;)qa=Za[--Wa],Za[Wa]=null,Ga=Za[--Wa],Za[Wa]=null;for(;e===Ja;)Ja=Va[--$a],Va[$a]=null,Qa=Va[--$a],Va[$a]=null,Ka=Va[--$a],Va[$a]=null}var ni=null,ri=null,ai=!1,ii=null;function ui(e,t){var n=Tc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oi(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ja?{id:Ka,overflow:Qa}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Tc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ni=e,ri=null,!0);default:return!1}}function si(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ci(e){if(ai){var t=ri;if(t){var n=t;if(!oi(e,t)){if(si(e))throw Error(i(418));t=ca(n.nextSibling);var r=ni;t&&oi(e,t)?ui(r,n):(e.flags=-4097&e.flags|2,ai=!1,ni=e)}}else{if(si(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ni=e}}}function li(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function di(e){if(e!==ni)return!1;if(!ai)return li(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ri)){if(si(e))throw fi(),Error(i(418));for(;t;)ui(e,t),t=ca(t.nextSibling)}if(li(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=ni?ca(e.stateNode.nextSibling):null;return!0}function fi(){for(var e=ri;e;)e=ca(e.nextSibling)}function pi(){ri=ni=null,ai=!1}function hi(e){null===ii?ii=[e]:ii.push(e)}var vi=_.ReactCurrentBatchConfig;function mi(e,t){if(e&&e.defaultProps){for(var n in t=B({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var yi=Ea(null),gi=null,bi=null,_i=null;function ki(){_i=bi=gi=null}function wi(e){var t=yi.current;Aa(yi),e._currentValue=t}function xi(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ei(e,t){gi=e,_i=bi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(_o=!0),e.firstContext=null)}function Ai(e){var t=e._currentValue;if(_i!==e)if(e={context:e,memoizedValue:t,next:null},null===bi){if(null===gi)throw Error(i(308));bi=e,gi.dependencies={lanes:0,firstContext:e}}else bi=bi.next=e;return t}var Ci=null;function Di(e){null===Ci?Ci=[e]:Ci.push(e)}function Si(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Di(t)):(n.next=a.next,a.next=n),t.interleaved=n,Oi(e,r)}function Oi(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Fi=!1;function Pi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ti(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ji(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ii(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Os)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Oi(e,n)}return null===(a=r.interleaved)?(t.next=t,Di(r)):(t.next=a.next,a.next=t),r.interleaved=t,Oi(e,n)}function Ni(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}function Ri(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var u={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=u:i=i.next=u,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Bi(e,t,n,r){var a=e.updateQueue;Fi=!1;var i=a.firstBaseUpdate,u=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var s=o,c=s.next;s.next=null,null===u?i=c:u.next=c,u=s;var l=e.alternate;null!==l&&((o=(l=l.updateQueue).lastBaseUpdate)!==u&&(null===o?l.firstBaseUpdate=c:o.next=c,l.lastBaseUpdate=s))}if(null!==i){var d=a.baseState;for(u=0,l=c=s=null,o=i;;){var f=o.lane,p=o.eventTime;if((r&f)===f){null!==l&&(l=l.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var h=e,v=o;switch(f=t,p=n,v.tag){case 1:if("function"===typeof(h=v.payload)){d=h.call(p,d,f);break e}d=h;break e;case 3:h.flags=-65537&h.flags|128;case 0:if(null===(f="function"===typeof(h=v.payload)?h.call(p,d,f):h)||void 0===f)break e;d=B({},d,f);break e;case 2:Fi=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(f=a.effects)?a.effects=[o]:f.push(o))}else p={eventTime:p,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===l?(c=l=p,s=d):l=l.next=p,u|=f;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(f=o).next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}if(null===l&&(s=d),a.baseState=s,a.firstBaseUpdate=c,a.lastBaseUpdate=l,null!==(t=a.shared.interleaved)){a=t;do{u|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Bs|=u,e.lanes=u,e.memoizedState=d}}function Li(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var Mi=(new r.Component).refs;function Ui(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:B({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var zi={isMounted:function(e){return!!(e=e._reactInternals)&&He(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),a=nc(e),i=ji(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Ii(e,i,a))&&(rc(t,e,a,r),Ni(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),a=nc(e),i=ji(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Ii(e,i,a))&&(rc(t,e,a,r),Ni(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),a=ji(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Ii(e,a,r))&&(rc(t,e,r,n),Ni(t,e,r))}};function Hi(e,t,n,r,a,i,u){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,u):!t.prototype||!t.prototype.isPureReactComponent||(!sr(n,r)||!sr(a,i))}function Zi(e,t,n){var r=!1,a=Da,i=t.contextType;return"object"===typeof i&&null!==i?i=Ai(i):(a=Ta(t)?Fa:Sa.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Pa(e,a):Da),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=zi,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function Wi(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&zi.enqueueReplaceState(t,t.state,null)}function qi(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=Mi,Pi(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Ai(i):(i=Ta(t)?Fa:Sa.current,a.context=Pa(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(Ui(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&zi.enqueueReplaceState(a,a.state,null),Bi(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function Gi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,u=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===u?t.ref:(t=function(e){var t=a.refs;t===Mi&&(t=a.refs={}),null===e?delete t[u]:t[u]=e},t._stringRef=u,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function Vi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function $i(e){return(0,e._init)(e._payload)}function Ji(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Ic(e,t)).index=0,e.sibling=null,e}function u(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function s(e,t,n,r){return null===t||6!==t.tag?((t=Lc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===x?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===T&&$i(i)===t.type)?((r=a(t,n.props)).ref=Gi(e,t,n),r.return=e,r):((r=Nc(n.type,n.key,n.props,null,e.mode,r)).ref=Gi(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Mc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=Rc(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function f(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case k:return(n=Nc(t.type,t.key,t.props,null,e.mode,n)).ref=Gi(e,null,t),n.return=e,n;case w:return(t=Mc(t,e.mode,n)).return=e,t;case T:return f(e,(0,t._init)(t._payload),n)}if(te(t)||N(t))return(t=Rc(t,e.mode,n,null)).return=e,t;Vi(e,t)}return null}function p(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:s(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case k:return n.key===a?c(e,t,n,r):null;case w:return n.key===a?l(e,t,n,r):null;case T:return p(e,t,(a=n._init)(n._payload),r)}if(te(n)||N(n))return null!==a?null:d(e,t,n,r,null);Vi(e,n)}return null}function h(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return s(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case k:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case w:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a);case T:return h(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||N(r))return d(t,e=e.get(n)||null,r,a,null);Vi(t,r)}return null}function v(a,i,o,s){for(var c=null,l=null,d=i,v=i=0,m=null;null!==d&&v<o.length;v++){d.index>v?(m=d,d=null):m=d.sibling;var y=p(a,d,o[v],s);if(null===y){null===d&&(d=m);break}e&&d&&null===y.alternate&&t(a,d),i=u(y,i,v),null===l?c=y:l.sibling=y,l=y,d=m}if(v===o.length)return n(a,d),ai&&Xa(a,v),c;if(null===d){for(;v<o.length;v++)null!==(d=f(a,o[v],s))&&(i=u(d,i,v),null===l?c=d:l.sibling=d,l=d);return ai&&Xa(a,v),c}for(d=r(a,d);v<o.length;v++)null!==(m=h(d,a,v,o[v],s))&&(e&&null!==m.alternate&&d.delete(null===m.key?v:m.key),i=u(m,i,v),null===l?c=m:l.sibling=m,l=m);return e&&d.forEach((function(e){return t(a,e)})),ai&&Xa(a,v),c}function m(a,o,s,c){var l=N(s);if("function"!==typeof l)throw Error(i(150));if(null==(s=l.call(s)))throw Error(i(151));for(var d=l=null,v=o,m=o=0,y=null,g=s.next();null!==v&&!g.done;m++,g=s.next()){v.index>m?(y=v,v=null):y=v.sibling;var b=p(a,v,g.value,c);if(null===b){null===v&&(v=y);break}e&&v&&null===b.alternate&&t(a,v),o=u(b,o,m),null===d?l=b:d.sibling=b,d=b,v=y}if(g.done)return n(a,v),ai&&Xa(a,m),l;if(null===v){for(;!g.done;m++,g=s.next())null!==(g=f(a,g.value,c))&&(o=u(g,o,m),null===d?l=g:d.sibling=g,d=g);return ai&&Xa(a,m),l}for(v=r(a,v);!g.done;m++,g=s.next())null!==(g=h(v,a,m,g.value,c))&&(e&&null!==g.alternate&&v.delete(null===g.key?m:g.key),o=u(g,o,m),null===d?l=g:d.sibling=g,d=g);return e&&v.forEach((function(e){return t(a,e)})),ai&&Xa(a,m),l}return function e(r,i,u,s){if("object"===typeof u&&null!==u&&u.type===x&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case k:e:{for(var c=u.key,l=i;null!==l;){if(l.key===c){if((c=u.type)===x){if(7===l.tag){n(r,l.sibling),(i=a(l,u.props.children)).return=r,r=i;break e}}else if(l.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===T&&$i(c)===l.type){n(r,l.sibling),(i=a(l,u.props)).ref=Gi(r,l,u),i.return=r,r=i;break e}n(r,l);break}t(r,l),l=l.sibling}u.type===x?((i=Rc(u.props.children,r.mode,s,u.key)).return=r,r=i):((s=Nc(u.type,u.key,u.props,null,r.mode,s)).ref=Gi(r,i,u),s.return=r,r=s)}return o(r);case w:e:{for(l=u.key;null!==i;){if(i.key===l){if(4===i.tag&&i.stateNode.containerInfo===u.containerInfo&&i.stateNode.implementation===u.implementation){n(r,i.sibling),(i=a(i,u.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Mc(u,r.mode,s)).return=r,r=i}return o(r);case T:return e(r,i,(l=u._init)(u._payload),s)}if(te(u))return v(r,i,u,s);if(N(u))return m(r,i,u,s);Vi(r,u)}return"string"===typeof u&&""!==u||"number"===typeof u?(u=""+u,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,u)).return=r,r=i):(n(r,i),(i=Lc(u,r.mode,s)).return=r,r=i),o(r)):n(r,i)}}var Ki=Ji(!0),Qi=Ji(!1),Xi={},Yi=Ea(Xi),eu=Ea(Xi),tu=Ea(Xi);function nu(e){if(e===Xi)throw Error(i(174));return e}function ru(e,t){switch(Ca(tu,t),Ca(eu,e),Ca(Yi,Xi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:se(null,"");break;default:t=se(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Aa(Yi),Ca(Yi,t)}function au(){Aa(Yi),Aa(eu),Aa(tu)}function iu(e){nu(tu.current);var t=nu(Yi.current),n=se(t,e.type);t!==n&&(Ca(eu,e),Ca(Yi,n))}function uu(e){eu.current===e&&(Aa(Yi),Aa(eu))}var ou=Ea(0);function su(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var cu=[];function lu(){for(var e=0;e<cu.length;e++)cu[e]._workInProgressVersionPrimary=null;cu.length=0}var du=_.ReactCurrentDispatcher,fu=_.ReactCurrentBatchConfig,pu=0,hu=null,vu=null,mu=null,yu=!1,gu=!1,bu=0,_u=0;function ku(){throw Error(i(321))}function wu(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function xu(e,t,n,r,a,u){if(pu=u,hu=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,du.current=null===e||null===e.memoizedState?uo:oo,e=n(r,a),gu){u=0;do{if(gu=!1,bu=0,25<=u)throw Error(i(301));u+=1,mu=vu=null,t.updateQueue=null,du.current=so,e=n(r,a)}while(gu)}if(du.current=io,t=null!==vu&&null!==vu.next,pu=0,mu=vu=hu=null,yu=!1,t)throw Error(i(300));return e}function Eu(){var e=0!==bu;return bu=0,e}function Au(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===mu?hu.memoizedState=mu=e:mu=mu.next=e,mu}function Cu(){if(null===vu){var e=hu.alternate;e=null!==e?e.memoizedState:null}else e=vu.next;var t=null===mu?hu.memoizedState:mu.next;if(null!==t)mu=t,vu=e;else{if(null===e)throw Error(i(310));e={memoizedState:(vu=e).memoizedState,baseState:vu.baseState,baseQueue:vu.baseQueue,queue:vu.queue,next:null},null===mu?hu.memoizedState=mu=e:mu=mu.next=e}return mu}function Du(e,t){return"function"===typeof t?t(e):t}function Su(e){var t=Cu(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=vu,a=r.baseQueue,u=n.pending;if(null!==u){if(null!==a){var o=a.next;a.next=u.next,u.next=o}r.baseQueue=a=u,n.pending=null}if(null!==a){u=a.next,r=r.baseState;var s=o=null,c=null,l=u;do{var d=l.lane;if((pu&d)===d)null!==c&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var f={lane:d,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===c?(s=c=f,o=r):c=c.next=f,hu.lanes|=d,Bs|=d}l=l.next}while(null!==l&&l!==u);null===c?o=r:c.next=s,or(r,t.memoizedState)||(_o=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{u=a.lane,hu.lanes|=u,Bs|=u,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ou(e){var t=Cu(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,u=t.memoizedState;if(null!==a){n.pending=null;var o=a=a.next;do{u=e(u,o.action),o=o.next}while(o!==a);or(u,t.memoizedState)||(_o=!0),t.memoizedState=u,null===t.baseQueue&&(t.baseState=u),n.lastRenderedState=u}return[u,r]}function Fu(){}function Pu(e,t){var n=hu,r=Cu(),a=t(),u=!or(r.memoizedState,a);if(u&&(r.memoizedState=a,_o=!0),r=r.queue,Zu(Iu.bind(null,n,r,e),[e]),r.getSnapshot!==t||u||null!==mu&&1&mu.memoizedState.tag){if(n.flags|=2048,Lu(9,ju.bind(null,n,r,a,t),void 0,null),null===Fs)throw Error(i(349));0!==(30&pu)||Tu(n,t,a)}return a}function Tu(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=hu.updateQueue)?(t={lastEffect:null,stores:null},hu.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function ju(e,t,n,r){t.value=n,t.getSnapshot=r,Nu(t)&&Ru(e)}function Iu(e,t,n){return n((function(){Nu(t)&&Ru(e)}))}function Nu(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function Ru(e){var t=Oi(e,1);null!==t&&rc(t,e,1,-1)}function Bu(e){var t=Au();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Du,lastRenderedState:e},t.queue=e,e=e.dispatch=to.bind(null,hu,e),[t.memoizedState,e]}function Lu(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=hu.updateQueue)?(t={lastEffect:null,stores:null},hu.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Mu(){return Cu().memoizedState}function Uu(e,t,n,r){var a=Au();hu.flags|=e,a.memoizedState=Lu(1|t,n,void 0,void 0===r?null:r)}function zu(e,t,n,r){var a=Cu();r=void 0===r?null:r;var i=void 0;if(null!==vu){var u=vu.memoizedState;if(i=u.destroy,null!==r&&wu(r,u.deps))return void(a.memoizedState=Lu(t,n,i,r))}hu.flags|=e,a.memoizedState=Lu(1|t,n,i,r)}function Hu(e,t){return Uu(8390656,8,e,t)}function Zu(e,t){return zu(2048,8,e,t)}function Wu(e,t){return zu(4,2,e,t)}function qu(e,t){return zu(4,4,e,t)}function Gu(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Vu(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,zu(4,4,Gu.bind(null,t,e),n)}function $u(){}function Ju(e,t){var n=Cu();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&wu(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ku(e,t){var n=Cu();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&wu(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Qu(e,t,n){return 0===(21&pu)?(e.baseState&&(e.baseState=!1,_o=!0),e.memoizedState=n):(or(n,t)||(n=vt(),hu.lanes|=n,Bs|=n,e.baseState=!0),t)}function Xu(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=fu.transition;fu.transition={};try{e(!1),t()}finally{bt=n,fu.transition=r}}function Yu(){return Cu().memoizedState}function eo(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},no(e))ro(t,n);else if(null!==(n=Si(e,t,n,r))){rc(n,e,r,tc()),ao(n,t,r)}}function to(e,t,n){var r=nc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(no(e))ro(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var u=t.lastRenderedState,o=i(u,n);if(a.hasEagerState=!0,a.eagerState=o,or(o,u)){var s=t.interleaved;return null===s?(a.next=a,Di(t)):(a.next=s.next,s.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Si(e,t,a,r))&&(rc(n,e,r,a=tc()),ao(n,t,r))}}function no(e){var t=e.alternate;return e===hu||null!==t&&t===hu}function ro(e,t){gu=yu=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ao(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}var io={readContext:Ai,useCallback:ku,useContext:ku,useEffect:ku,useImperativeHandle:ku,useInsertionEffect:ku,useLayoutEffect:ku,useMemo:ku,useReducer:ku,useRef:ku,useState:ku,useDebugValue:ku,useDeferredValue:ku,useTransition:ku,useMutableSource:ku,useSyncExternalStore:ku,useId:ku,unstable_isNewReconciler:!1},uo={readContext:Ai,useCallback:function(e,t){return Au().memoizedState=[e,void 0===t?null:t],e},useContext:Ai,useEffect:Hu,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Uu(4194308,4,Gu.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Uu(4194308,4,e,t)},useInsertionEffect:function(e,t){return Uu(4,2,e,t)},useMemo:function(e,t){var n=Au();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Au();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=eo.bind(null,hu,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Au().memoizedState=e},useState:Bu,useDebugValue:$u,useDeferredValue:function(e){return Au().memoizedState=e},useTransition:function(){var e=Bu(!1),t=e[0];return e=Xu.bind(null,e[1]),Au().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=hu,a=Au();if(ai){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Fs)throw Error(i(349));0!==(30&pu)||Tu(r,t,n)}a.memoizedState=n;var u={value:n,getSnapshot:t};return a.queue=u,Hu(Iu.bind(null,r,u,e),[e]),r.flags|=2048,Lu(9,ju.bind(null,r,u,n,t),void 0,null),n},useId:function(){var e=Au(),t=Fs.identifierPrefix;if(ai){var n=Qa;t=":"+t+"R"+(n=(Ka&~(1<<32-ut(Ka)-1)).toString(32)+n),0<(n=bu++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=_u++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},oo={readContext:Ai,useCallback:Ju,useContext:Ai,useEffect:Zu,useImperativeHandle:Vu,useInsertionEffect:Wu,useLayoutEffect:qu,useMemo:Ku,useReducer:Su,useRef:Mu,useState:function(){return Su(Du)},useDebugValue:$u,useDeferredValue:function(e){return Qu(Cu(),vu.memoizedState,e)},useTransition:function(){return[Su(Du)[0],Cu().memoizedState]},useMutableSource:Fu,useSyncExternalStore:Pu,useId:Yu,unstable_isNewReconciler:!1},so={readContext:Ai,useCallback:Ju,useContext:Ai,useEffect:Zu,useImperativeHandle:Vu,useInsertionEffect:Wu,useLayoutEffect:qu,useMemo:Ku,useReducer:Ou,useRef:Mu,useState:function(){return Ou(Du)},useDebugValue:$u,useDeferredValue:function(e){var t=Cu();return null===vu?t.memoizedState=e:Qu(t,vu.memoizedState,e)},useTransition:function(){return[Ou(Du)[0],Cu().memoizedState]},useMutableSource:Fu,useSyncExternalStore:Pu,useId:Yu,unstable_isNewReconciler:!1};function co(e,t){try{var n="",r=t;do{n+=z(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function lo(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function fo(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var po="function"===typeof WeakMap?WeakMap:Map;function ho(e,t,n){(n=ji(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){qs||(qs=!0,Gs=r),fo(0,t)},n}function vo(e,t,n){(n=ji(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){fo(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){fo(0,t),"function"!==typeof r&&(null===Vs?Vs=new Set([this]):Vs.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function mo(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new po;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Cc.bind(null,e,t,n),t.then(e,e))}function yo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function go(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=ji(-1,1)).tag=2,Ii(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var bo=_.ReactCurrentOwner,_o=!1;function ko(e,t,n,r){t.child=null===e?Qi(t,null,n,r):Ki(t,e.child,n,r)}function wo(e,t,n,r,a){n=n.render;var i=t.ref;return Ei(t,a),r=xu(e,t,n,r,i,a),n=Eu(),null===e||_o?(ai&&n&&ei(t),t.flags|=1,ko(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,qo(e,t,a))}function xo(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||jc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Nc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Eo(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var u=i.memoizedProps;if((n=null!==(n=n.compare)?n:sr)(u,r)&&e.ref===t.ref)return qo(e,t,a)}return t.flags|=1,(e=Ic(i,r)).ref=t.ref,e.return=t,t.child=e}function Eo(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(sr(i,r)&&e.ref===t.ref){if(_o=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,qo(e,t,a);0!==(131072&e.flags)&&(_o=!0)}}return Do(e,t,n,r,a)}function Ao(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ca(Is,js),js|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ca(Is,js),js|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Ca(Is,js),js|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ca(Is,js),js|=r;return ko(e,t,a,n),t.child}function Co(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Do(e,t,n,r,a){var i=Ta(n)?Fa:Sa.current;return i=Pa(t,i),Ei(t,a),n=xu(e,t,n,r,i,a),r=Eu(),null===e||_o?(ai&&r&&ei(t),t.flags|=1,ko(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,qo(e,t,a))}function So(e,t,n,r,a){if(Ta(n)){var i=!0;Ra(t)}else i=!1;if(Ei(t,a),null===t.stateNode)Wo(e,t),Zi(t,n,r),qi(t,n,r,a),r=!0;else if(null===e){var u=t.stateNode,o=t.memoizedProps;u.props=o;var s=u.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ai(c):c=Pa(t,c=Ta(n)?Fa:Sa.current);var l=n.getDerivedStateFromProps,d="function"===typeof l||"function"===typeof u.getSnapshotBeforeUpdate;d||"function"!==typeof u.UNSAFE_componentWillReceiveProps&&"function"!==typeof u.componentWillReceiveProps||(o!==r||s!==c)&&Wi(t,u,r,c),Fi=!1;var f=t.memoizedState;u.state=f,Bi(t,r,u,a),s=t.memoizedState,o!==r||f!==s||Oa.current||Fi?("function"===typeof l&&(Ui(t,n,l,r),s=t.memoizedState),(o=Fi||Hi(t,n,o,r,f,s,c))?(d||"function"!==typeof u.UNSAFE_componentWillMount&&"function"!==typeof u.componentWillMount||("function"===typeof u.componentWillMount&&u.componentWillMount(),"function"===typeof u.UNSAFE_componentWillMount&&u.UNSAFE_componentWillMount()),"function"===typeof u.componentDidMount&&(t.flags|=4194308)):("function"===typeof u.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=s),u.props=r,u.state=s,u.context=c,r=o):("function"===typeof u.componentDidMount&&(t.flags|=4194308),r=!1)}else{u=t.stateNode,Ti(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:mi(t.type,o),u.props=c,d=t.pendingProps,f=u.context,"object"===typeof(s=n.contextType)&&null!==s?s=Ai(s):s=Pa(t,s=Ta(n)?Fa:Sa.current);var p=n.getDerivedStateFromProps;(l="function"===typeof p||"function"===typeof u.getSnapshotBeforeUpdate)||"function"!==typeof u.UNSAFE_componentWillReceiveProps&&"function"!==typeof u.componentWillReceiveProps||(o!==d||f!==s)&&Wi(t,u,r,s),Fi=!1,f=t.memoizedState,u.state=f,Bi(t,r,u,a);var h=t.memoizedState;o!==d||f!==h||Oa.current||Fi?("function"===typeof p&&(Ui(t,n,p,r),h=t.memoizedState),(c=Fi||Hi(t,n,c,r,f,h,s)||!1)?(l||"function"!==typeof u.UNSAFE_componentWillUpdate&&"function"!==typeof u.componentWillUpdate||("function"===typeof u.componentWillUpdate&&u.componentWillUpdate(r,h,s),"function"===typeof u.UNSAFE_componentWillUpdate&&u.UNSAFE_componentWillUpdate(r,h,s)),"function"===typeof u.componentDidUpdate&&(t.flags|=4),"function"===typeof u.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof u.componentDidUpdate||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof u.getSnapshotBeforeUpdate||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=h),u.props=r,u.state=h,u.context=s,r=c):("function"!==typeof u.componentDidUpdate||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof u.getSnapshotBeforeUpdate||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return Oo(e,t,n,r,i,a)}function Oo(e,t,n,r,a,i){Co(e,t);var u=0!==(128&t.flags);if(!r&&!u)return a&&Ba(t,n,!1),qo(e,t,i);r=t.stateNode,bo.current=t;var o=u&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&u?(t.child=Ki(t,e.child,null,i),t.child=Ki(t,null,o,i)):ko(e,t,o,i),t.memoizedState=r.state,a&&Ba(t,n,!0),t.child}function Fo(e){var t=e.stateNode;t.pendingContext?Ia(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ia(0,t.context,!1),ru(e,t.containerInfo)}function Po(e,t,n,r,a){return pi(),hi(a),t.flags|=256,ko(e,t,n,r),t.child}var To,jo,Io,No,Ro={dehydrated:null,treeContext:null,retryLane:0};function Bo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Lo(e,t,n){var r,a=t.pendingProps,u=ou.current,o=!1,s=0!==(128&t.flags);if((r=s)||(r=(null===e||null!==e.memoizedState)&&0!==(2&u)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(u|=1),Ca(ou,1&u),null===e)return ci(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(s=a.children,e=a.fallback,o?(a=t.mode,o=t.child,s={mode:"hidden",children:s},0===(1&a)&&null!==o?(o.childLanes=0,o.pendingProps=s):o=Bc(s,a,0,null),e=Rc(e,a,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Bo(n),t.memoizedState=Ro,e):Mo(t,s));if(null!==(u=e.memoizedState)&&null!==(r=u.dehydrated))return function(e,t,n,r,a,u,o){if(n)return 256&t.flags?(t.flags&=-257,Uo(e,t,o,r=lo(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(u=r.fallback,a=t.mode,r=Bc({mode:"visible",children:r.children},a,0,null),(u=Rc(u,a,o,null)).flags|=2,r.return=t,u.return=t,r.sibling=u,t.child=r,0!==(1&t.mode)&&Ki(t,e.child,null,o),t.child.memoizedState=Bo(o),t.memoizedState=Ro,u);if(0===(1&t.mode))return Uo(e,t,o,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var s=r.dgst;return r=s,Uo(e,t,o,r=lo(u=Error(i(419)),r,void 0))}if(s=0!==(o&e.childLanes),_o||s){if(null!==(r=Fs)){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|o))?0:a)&&a!==u.retryLane&&(u.retryLane=a,Oi(e,a),rc(r,e,a,-1))}return mc(),Uo(e,t,o,r=lo(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Sc.bind(null,e),a._reactRetry=t,null):(e=u.treeContext,ri=ca(a.nextSibling),ni=t,ai=!0,ii=null,null!==e&&(Va[$a++]=Ka,Va[$a++]=Qa,Va[$a++]=Ja,Ka=e.id,Qa=e.overflow,Ja=t),t=Mo(t,r.children),t.flags|=4096,t)}(e,t,s,a,r,u,n);if(o){o=a.fallback,s=t.mode,r=(u=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&s)&&t.child!==u?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Ic(u,c)).subtreeFlags=14680064&u.subtreeFlags,null!==r?o=Ic(r,o):(o=Rc(o,s,n,null)).flags|=2,o.return=t,a.return=t,a.sibling=o,t.child=a,a=o,o=t.child,s=null===(s=e.child.memoizedState)?Bo(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=e.childLanes&~n,t.memoizedState=Ro,a}return e=(o=e.child).sibling,a=Ic(o,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Mo(e,t){return(t=Bc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Uo(e,t,n,r){return null!==r&&hi(r),Ki(t,e.child,null,n),(e=Mo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),xi(e.return,t,n)}function Ho(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Zo(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(ko(e,t,r.children,n),0!==(2&(r=ou.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zo(e,n,t);else if(19===e.tag)zo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ca(ou,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===su(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Ho(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===su(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Ho(t,!0,n,null,i);break;case"together":Ho(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Bs|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Ic(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ic(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Go(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Vo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function $o(e,t,n){var r=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vo(t),null;case 1:case 17:return Ta(t.type)&&ja(),Vo(t),null;case 3:return r=t.stateNode,au(),Aa(Oa),Aa(Sa),lu(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(di(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(oc(ii),ii=null))),jo(e,t),Vo(t),null;case 5:uu(t);var a=nu(tu.current);if(n=t.type,null!==e&&null!=t.stateNode)Io(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Vo(t),null}if(e=nu(Yi.current),di(t)){r=t.stateNode,n=t.type;var u=t.memoizedProps;switch(r[fa]=t,r[pa]=u,e=0!==(1&t.mode),n){case"dialog":Mr("cancel",r),Mr("close",r);break;case"iframe":case"object":case"embed":Mr("load",r);break;case"video":case"audio":for(a=0;a<Nr.length;a++)Mr(Nr[a],r);break;case"source":Mr("error",r);break;case"img":case"image":case"link":Mr("error",r),Mr("load",r);break;case"details":Mr("toggle",r);break;case"input":K(r,u),Mr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!u.multiple},Mr("invalid",r);break;case"textarea":ae(r,u),Mr("invalid",r)}for(var s in ge(n,u),a=null,u)if(u.hasOwnProperty(s)){var c=u[s];"children"===s?"string"===typeof c?r.textContent!==c&&(!0!==u.suppressHydrationWarning&&Xr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==u.suppressHydrationWarning&&Xr(r.textContent,c,e),a=["children",""+c]):o.hasOwnProperty(s)&&null!=c&&"onScroll"===s&&Mr("scroll",r)}switch(n){case"input":G(r),Y(r,u,!0);break;case"textarea":G(r),ue(r);break;case"select":case"option":break;default:"function"===typeof u.onClick&&(r.onclick=Yr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{s=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=s.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),"select"===n&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[fa]=t,e[pa]=r,To(e,t,!1,!1),t.stateNode=e;e:{switch(s=be(n,r),n){case"dialog":Mr("cancel",e),Mr("close",e),a=r;break;case"iframe":case"object":case"embed":Mr("load",e),a=r;break;case"video":case"audio":for(a=0;a<Nr.length;a++)Mr(Nr[a],e);a=r;break;case"source":Mr("error",e),a=r;break;case"img":case"image":case"link":Mr("error",e),Mr("load",e),a=r;break;case"details":Mr("toggle",e),a=r;break;case"input":K(e,r),a=J(e,r),Mr("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=B({},r,{value:void 0}),Mr("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Mr("invalid",e)}for(u in ge(n,a),c=a)if(c.hasOwnProperty(u)){var l=c[u];"style"===u?me(e,l):"dangerouslySetInnerHTML"===u?null!=(l=l?l.__html:void 0)&&de(e,l):"children"===u?"string"===typeof l?("textarea"!==n||""!==l)&&fe(e,l):"number"===typeof l&&fe(e,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?null!=l&&"onScroll"===u&&Mr("scroll",e):null!=l&&b(e,u,l,s))}switch(n){case"input":G(e),Y(e,r,!1);break;case"textarea":G(e),ue(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(u=r.value)?ne(e,!!r.multiple,u,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Yr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Vo(t),null;case 6:if(e&&null!=t.stateNode)No(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=nu(tu.current),nu(Yi.current),di(t)){if(r=t.stateNode,n=t.memoizedProps,r[fa]=t,(u=r.nodeValue!==n)&&null!==(e=ni))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}u&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[fa]=t,t.stateNode=r}return Vo(t),null;case 13:if(Aa(ou),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))fi(),pi(),t.flags|=98560,u=!1;else if(u=di(t),null!==r&&null!==r.dehydrated){if(null===e){if(!u)throw Error(i(318));if(!(u=null!==(u=t.memoizedState)?u.dehydrated:null))throw Error(i(317));u[fa]=t}else pi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Vo(t),u=!1}else null!==ii&&(oc(ii),ii=null),u=!0;if(!u)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ou.current)?0===Ns&&(Ns=3):mc())),null!==t.updateQueue&&(t.flags|=4),Vo(t),null);case 4:return au(),jo(e,t),null===e&&Hr(t.stateNode.containerInfo),Vo(t),null;case 10:return wi(t.type._context),Vo(t),null;case 19:if(Aa(ou),null===(u=t.memoizedState))return Vo(t),null;if(r=0!==(128&t.flags),null===(s=u.rendering))if(r)Go(u,!1);else{if(0!==Ns||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=su(e))){for(t.flags|=128,Go(u,!1),null!==(r=s.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(u=n).flags&=14680066,null===(s=u.alternate)?(u.childLanes=0,u.lanes=e,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,u.type=s.type,e=s.dependencies,u.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ca(ou,1&ou.current|2),t.child}e=e.sibling}null!==u.tail&&Qe()>Zs&&(t.flags|=128,r=!0,Go(u,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=su(s))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Go(u,!0),null===u.tail&&"hidden"===u.tailMode&&!s.alternate&&!ai)return Vo(t),null}else 2*Qe()-u.renderingStartTime>Zs&&1073741824!==n&&(t.flags|=128,r=!0,Go(u,!1),t.lanes=4194304);u.isBackwards?(s.sibling=t.child,t.child=s):(null!==(n=u.last)?n.sibling=s:t.child=s,u.last=s)}return null!==u.tail?(t=u.tail,u.rendering=t,u.tail=t.sibling,u.renderingStartTime=Qe(),t.sibling=null,n=ou.current,Ca(ou,r?1&n|2:1&n),t):(Vo(t),null);case 22:case 23:return fc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&js)&&(Vo(t),6&t.subtreeFlags&&(t.flags|=8192)):Vo(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Jo(e,t){switch(ti(t),t.tag){case 1:return Ta(t.type)&&ja(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return au(),Aa(Oa),Aa(Sa),lu(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return uu(t),null;case 13:if(Aa(ou),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));pi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Aa(ou),null;case 4:return au(),null;case 10:return wi(t.type._context),null;case 22:case 23:return fc(),null;default:return null}}To=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},jo=function(){},Io=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,nu(Yi.current);var i,u=null;switch(n){case"input":a=J(e,a),r=J(e,r),u=[];break;case"select":a=B({},a,{value:void 0}),r=B({},r,{value:void 0}),u=[];break;case"textarea":a=re(e,a),r=re(e,r),u=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Yr)}for(l in ge(n,r),n=null,a)if(!r.hasOwnProperty(l)&&a.hasOwnProperty(l)&&null!=a[l])if("style"===l){var s=a[l];for(i in s)s.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(o.hasOwnProperty(l)?u||(u=[]):(u=u||[]).push(l,null));for(l in r){var c=r[l];if(s=null!=a?a[l]:void 0,r.hasOwnProperty(l)&&c!==s&&(null!=c||null!=s))if("style"===l)if(s){for(i in s)!s.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&s[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(u||(u=[]),u.push(l,n)),n=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,s=s?s.__html:void 0,null!=c&&s!==c&&(u=u||[]).push(l,c)):"children"===l?"string"!==typeof c&&"number"!==typeof c||(u=u||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(o.hasOwnProperty(l)?(null!=c&&"onScroll"===l&&Mr("scroll",e),u||s===c||(u=[])):(u=u||[]).push(l,c))}n&&(u=u||[]).push("style",n);var l=u;(t.updateQueue=l)&&(t.flags|=4)}},No=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ko=!1,Qo=!1,Xo="function"===typeof WeakSet?WeakSet:Set,Yo=null;function es(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Ac(e,t,r)}else n.current=null}function ts(e,t,n){try{n()}catch(r){Ac(e,t,r)}}var ns=!1;function rs(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&ts(t,n,i)}a=a.next}while(a!==r)}}function as(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function is(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function us(e){var t=e.alternate;null!==t&&(e.alternate=null,us(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fa],delete t[pa],delete t[va],delete t[ma],delete t[ya])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function os(e){return 5===e.tag||3===e.tag||4===e.tag}function ss(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||os(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cs(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Yr));else if(4!==r&&null!==(e=e.child))for(cs(e,t,n),e=e.sibling;null!==e;)cs(e,t,n),e=e.sibling}function ls(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ls(e,t,n),e=e.sibling;null!==e;)ls(e,t,n),e=e.sibling}var ds=null,fs=!1;function ps(e,t,n){for(n=n.child;null!==n;)hs(e,t,n),n=n.sibling}function hs(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(o){}switch(n.tag){case 5:Qo||es(n,t);case 6:var r=ds,a=fs;ds=null,ps(e,t,n),fs=a,null!==(ds=r)&&(fs?(e=ds,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ds.removeChild(n.stateNode));break;case 18:null!==ds&&(fs?(e=ds,n=n.stateNode,8===e.nodeType?sa(e.parentNode,n):1===e.nodeType&&sa(e,n),Ht(e)):sa(ds,n.stateNode));break;case 4:r=ds,a=fs,ds=n.stateNode.containerInfo,fs=!0,ps(e,t,n),ds=r,fs=a;break;case 0:case 11:case 14:case 15:if(!Qo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,u=i.destroy;i=i.tag,void 0!==u&&(0!==(2&i)||0!==(4&i))&&ts(n,t,u),a=a.next}while(a!==r)}ps(e,t,n);break;case 1:if(!Qo&&(es(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Ac(n,t,o)}ps(e,t,n);break;case 21:ps(e,t,n);break;case 22:1&n.mode?(Qo=(r=Qo)||null!==n.memoizedState,ps(e,t,n),Qo=r):ps(e,t,n);break;default:ps(e,t,n)}}function vs(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xo),t.forEach((function(t){var r=Oc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ms(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var u=e,o=t,s=o;e:for(;null!==s;){switch(s.tag){case 5:ds=s.stateNode,fs=!1;break e;case 3:case 4:ds=s.stateNode.containerInfo,fs=!0;break e}s=s.return}if(null===ds)throw Error(i(160));hs(u,o,a),ds=null,fs=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(l){Ac(a,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ys(t,e),t=t.sibling}function ys(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ms(t,e),gs(e),4&r){try{rs(3,e,e.return),as(3,e)}catch(m){Ac(e,e.return,m)}try{rs(5,e,e.return)}catch(m){Ac(e,e.return,m)}}break;case 1:ms(t,e),gs(e),512&r&&null!==n&&es(n,n.return);break;case 5:if(ms(t,e),gs(e),512&r&&null!==n&&es(n,n.return),32&e.flags){var a=e.stateNode;try{fe(a,"")}catch(m){Ac(e,e.return,m)}}if(4&r&&null!=(a=e.stateNode)){var u=e.memoizedProps,o=null!==n?n.memoizedProps:u,s=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===s&&"radio"===u.type&&null!=u.name&&Q(a,u),be(s,o);var l=be(s,u);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];"style"===d?me(a,f):"dangerouslySetInnerHTML"===d?de(a,f):"children"===d?fe(a,f):b(a,d,f,l)}switch(s){case"input":X(a,u);break;case"textarea":ie(a,u);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!u.multiple;var h=u.value;null!=h?ne(a,!!u.multiple,h,!1):p!==!!u.multiple&&(null!=u.defaultValue?ne(a,!!u.multiple,u.defaultValue,!0):ne(a,!!u.multiple,u.multiple?[]:"",!1))}a[pa]=u}catch(m){Ac(e,e.return,m)}}break;case 6:if(ms(t,e),gs(e),4&r){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,u=e.memoizedProps;try{a.nodeValue=u}catch(m){Ac(e,e.return,m)}}break;case 3:if(ms(t,e),gs(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ht(t.containerInfo)}catch(m){Ac(e,e.return,m)}break;case 4:default:ms(t,e),gs(e);break;case 13:ms(t,e),gs(e),8192&(a=e.child).flags&&(u=null!==a.memoizedState,a.stateNode.isHidden=u,!u||null!==a.alternate&&null!==a.alternate.memoizedState||(Hs=Qe())),4&r&&vs(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Qo=(l=Qo)||d,ms(t,e),Qo=l):ms(t,e),gs(e),8192&r){if(l=null!==e.memoizedState,(e.stateNode.isHidden=l)&&!d&&0!==(1&e.mode))for(Yo=e,d=e.child;null!==d;){for(f=Yo=d;null!==Yo;){switch(h=(p=Yo).child,p.tag){case 0:case 11:case 14:case 15:rs(4,p,p.return);break;case 1:es(p,p.return);var v=p.stateNode;if("function"===typeof v.componentWillUnmount){r=p,n=p.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(m){Ac(r,n,m)}}break;case 5:es(p,p.return);break;case 22:if(null!==p.memoizedState){ws(f);continue}}null!==h?(h.return=p,Yo=h):ws(f)}d=d.sibling}e:for(d=null,f=e;;){if(5===f.tag){if(null===d){d=f;try{a=f.stateNode,l?"function"===typeof(u=a.style).setProperty?u.setProperty("display","none","important"):u.display="none":(s=f.stateNode,o=void 0!==(c=f.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,s.style.display=ve("display",o))}catch(m){Ac(e,e.return,m)}}}else if(6===f.tag){if(null===d)try{f.stateNode.nodeValue=l?"":f.memoizedProps}catch(m){Ac(e,e.return,m)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===e)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;null===f.sibling;){if(null===f.return||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:ms(t,e),gs(e),4&r&&vs(e);case 21:}}function gs(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(os(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(fe(a,""),r.flags&=-33),ls(e,ss(e),a);break;case 3:case 4:var u=r.stateNode.containerInfo;cs(e,ss(e),u);break;default:throw Error(i(161))}}catch(o){Ac(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bs(e,t,n){Yo=e,_s(e,t,n)}function _s(e,t,n){for(var r=0!==(1&e.mode);null!==Yo;){var a=Yo,i=a.child;if(22===a.tag&&r){var u=null!==a.memoizedState||Ko;if(!u){var o=a.alternate,s=null!==o&&null!==o.memoizedState||Qo;o=Ko;var c=Qo;if(Ko=u,(Qo=s)&&!c)for(Yo=a;null!==Yo;)s=(u=Yo).child,22===u.tag&&null!==u.memoizedState?xs(a):null!==s?(s.return=u,Yo=s):xs(a);for(;null!==i;)Yo=i,_s(i,t,n),i=i.sibling;Yo=a,Ko=o,Qo=c}ks(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Yo=i):ks(e)}}function ks(e){for(;null!==Yo;){var t=Yo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Qo||as(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Qo)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:mi(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var u=t.updateQueue;null!==u&&Li(t,u,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Li(t,o,n)}break;case 5:var s=t.stateNode;if(null===n&&4&t.flags){n=s;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var d=l.memoizedState;if(null!==d){var f=d.dehydrated;null!==f&&Ht(f)}}}break;default:throw Error(i(163))}Qo||512&t.flags&&is(t)}catch(p){Ac(t,t.return,p)}}if(t===e){Yo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Yo=n;break}Yo=t.return}}function ws(e){for(;null!==Yo;){var t=Yo;if(t===e){Yo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Yo=n;break}Yo=t.return}}function xs(e){for(;null!==Yo;){var t=Yo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{as(4,t)}catch(s){Ac(t,n,s)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(s){Ac(t,a,s)}}var i=t.return;try{is(t)}catch(s){Ac(t,i,s)}break;case 5:var u=t.return;try{is(t)}catch(s){Ac(t,u,s)}}}catch(s){Ac(t,t.return,s)}if(t===e){Yo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Yo=o;break}Yo=t.return}}var Es,As=Math.ceil,Cs=_.ReactCurrentDispatcher,Ds=_.ReactCurrentOwner,Ss=_.ReactCurrentBatchConfig,Os=0,Fs=null,Ps=null,Ts=0,js=0,Is=Ea(0),Ns=0,Rs=null,Bs=0,Ls=0,Ms=0,Us=null,zs=null,Hs=0,Zs=1/0,Ws=null,qs=!1,Gs=null,Vs=null,$s=!1,Js=null,Ks=0,Qs=0,Xs=null,Ys=-1,ec=0;function tc(){return 0!==(6&Os)?Qe():-1!==Ys?Ys:Ys=Qe()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Os)&&0!==Ts?Ts&-Ts:null!==vi.transition?(0===ec&&(ec=vt()),ec):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Kt(e.type)}function rc(e,t,n,r){if(50<Qs)throw Qs=0,Xs=null,Error(i(185));yt(e,n,r),0!==(2&Os)&&e===Fs||(e===Fs&&(0===(2&Os)&&(Ls|=n),4===Ns&&sc(e,Ts)),ac(e,r),1===n&&0===Os&&0===(1&t.mode)&&(Zs=Qe()+500,Ma&&Ha()))}function ac(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var u=31-ut(i),o=1<<u,s=a[u];-1===s?0!==(o&n)&&0===(o&r)||(a[u]=pt(o,t)):s<=t&&(e.expiredLanes|=o),i&=~o}}(e,t);var r=ft(e,e===Fs?Ts:0);if(0===r)null!==n&&$e(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&$e(n),1===t)0===e.tag?function(e){Ma=!0,za(e)}(cc.bind(null,e)):za(cc.bind(null,e)),ua((function(){0===(6&Os)&&Ha()})),n=null;else{switch(_t(r)){case 1:n=Ye;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Fc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if(Ys=-1,ec=0,0!==(6&Os))throw Error(i(327));var n=e.callbackNode;if(xc()&&e.callbackNode!==n)return null;var r=ft(e,e===Fs?Ts:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=yc(e,r);else{t=r;var a=Os;Os|=2;var u=vc();for(Fs===e&&Ts===t||(Ws=null,Zs=Qe()+500,pc(e,t));;)try{bc();break}catch(s){hc(e,s)}ki(),Cs.current=u,Os=a,null!==Ps?t=0:(Fs=null,Ts=0,t=Ns)}if(0!==t){if(2===t&&(0!==(a=ht(e))&&(r=a,t=uc(e,a))),1===t)throw n=Rs,pc(e,0),sc(e,r),ac(e,Qe()),n;if(6===t)sc(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!or(i(),a))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=yc(e,r))&&(0!==(u=ht(e))&&(r=u,t=uc(e,u))),1===t))throw n=Rs,pc(e,0),sc(e,r),ac(e,Qe()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:wc(e,zs,Ws);break;case 3:if(sc(e,r),(130023424&r)===r&&10<(t=Hs+500-Qe())){if(0!==ft(e,0))break;if(((a=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(wc.bind(null,e,zs,Ws),t);break}wc(e,zs,Ws);break;case 4:if(sc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var o=31-ut(r);u=1<<o,(o=t[o])>a&&(a=o),r&=~u}if(r=a,10<(r=(120>(r=Qe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*As(r/1960))-r)){e.timeoutHandle=ra(wc.bind(null,e,zs,Ws),r);break}wc(e,zs,Ws);break;default:throw Error(i(329))}}}return ac(e,Qe()),e.callbackNode===n?ic.bind(null,e):null}function uc(e,t){var n=Us;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=yc(e,t))&&(t=zs,zs=n,null!==t&&oc(t)),e}function oc(e){null===zs?zs=e:zs.push.apply(zs,e)}function sc(e,t){for(t&=~Ms,t&=~Ls,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ut(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(0!==(6&Os))throw Error(i(327));xc();var t=ft(e,0);if(0===(1&t))return ac(e,Qe()),null;var n=yc(e,t);if(0!==e.tag&&2===n){var r=ht(e);0!==r&&(t=r,n=uc(e,r))}if(1===n)throw n=Rs,pc(e,0),sc(e,t),ac(e,Qe()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,zs,Ws),ac(e,Qe()),null}function lc(e,t){var n=Os;Os|=1;try{return e(t)}finally{0===(Os=n)&&(Zs=Qe()+500,Ma&&Ha())}}function dc(e){null!==Js&&0===Js.tag&&0===(6&Os)&&xc();var t=Os;Os|=1;var n=Ss.transition,r=bt;try{if(Ss.transition=null,bt=1,e)return e()}finally{bt=r,Ss.transition=n,0===(6&(Os=t))&&Ha()}}function fc(){js=Is.current,Aa(Is)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Ps)for(n=Ps.return;null!==n;){var r=n;switch(ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&ja();break;case 3:au(),Aa(Oa),Aa(Sa),lu();break;case 5:uu(r);break;case 4:au();break;case 13:case 19:Aa(ou);break;case 10:wi(r.type._context);break;case 22:case 23:fc()}n=n.return}if(Fs=e,Ps=e=Ic(e.current,null),Ts=js=t,Ns=0,Rs=null,Ms=Ls=Bs=0,zs=Us=null,null!==Ci){for(t=0;t<Ci.length;t++)if(null!==(r=(n=Ci[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var u=i.next;i.next=a,r.next=u}n.pending=r}Ci=null}return e}function hc(e,t){for(;;){var n=Ps;try{if(ki(),du.current=io,yu){for(var r=hu.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}yu=!1}if(pu=0,mu=vu=hu=null,gu=!1,bu=0,Ds.current=null,null===n||null===n.return){Ns=1,Rs=t,Ps=null;break}e:{var u=e,o=n.return,s=n,c=t;if(t=Ts,s.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c,d=s,f=d.tag;if(0===(1&d.mode)&&(0===f||11===f||15===f)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=yo(o);if(null!==h){h.flags&=-257,go(h,o,s,0,t),1&h.mode&&mo(u,l,t),c=l;var v=(t=h).updateQueue;if(null===v){var m=new Set;m.add(c),t.updateQueue=m}else v.add(c);break e}if(0===(1&t)){mo(u,l,t),mc();break e}c=Error(i(426))}else if(ai&&1&s.mode){var y=yo(o);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),go(y,o,s,0,t),hi(co(c,s));break e}}u=c=co(c,s),4!==Ns&&(Ns=2),null===Us?Us=[u]:Us.push(u),u=o;do{switch(u.tag){case 3:u.flags|=65536,t&=-t,u.lanes|=t,Ri(u,ho(0,c,t));break e;case 1:s=c;var g=u.type,b=u.stateNode;if(0===(128&u.flags)&&("function"===typeof g.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Vs||!Vs.has(b)))){u.flags|=65536,t&=-t,u.lanes|=t,Ri(u,vo(u,s,t));break e}}u=u.return}while(null!==u)}kc(n)}catch(_){t=_,Ps===n&&null!==n&&(Ps=n=n.return);continue}break}}function vc(){var e=Cs.current;return Cs.current=io,null===e?io:e}function mc(){0!==Ns&&3!==Ns&&2!==Ns||(Ns=4),null===Fs||0===(268435455&Bs)&&0===(268435455&Ls)||sc(Fs,Ts)}function yc(e,t){var n=Os;Os|=2;var r=vc();for(Fs===e&&Ts===t||(Ws=null,pc(e,t));;)try{gc();break}catch(a){hc(e,a)}if(ki(),Os=n,Cs.current=r,null!==Ps)throw Error(i(261));return Fs=null,Ts=0,Ns}function gc(){for(;null!==Ps;)_c(Ps)}function bc(){for(;null!==Ps&&!Je();)_c(Ps)}function _c(e){var t=Es(e.alternate,e,js);e.memoizedProps=e.pendingProps,null===t?kc(e):Ps=t,Ds.current=null}function kc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=$o(n,t,js)))return void(Ps=n)}else{if(null!==(n=Jo(n,t)))return n.flags&=32767,void(Ps=n);if(null===e)return Ns=6,void(Ps=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ps=t);Ps=t=e}while(null!==t);0===Ns&&(Ns=5)}function wc(e,t,n){var r=bt,a=Ss.transition;try{Ss.transition=null,bt=1,function(e,t,n,r){do{xc()}while(null!==Js);if(0!==(6&Os))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var u=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-ut(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,u),e===Fs&&(Ps=Fs=null,Ts=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||$s||($s=!0,Fc(tt,(function(){return xc(),null}))),u=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||u){u=Ss.transition,Ss.transition=null;var o=bt;bt=1;var s=Os;Os|=4,Ds.current=null,function(e,t){if(ea=Wt,pr(e=fr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,u=r.focusNode;r=r.focusOffset;try{n.nodeType,u.nodeType}catch(k){n=null;break e}var o=0,s=-1,c=-1,l=0,d=0,f=e,p=null;t:for(;;){for(var h;f!==n||0!==a&&3!==f.nodeType||(s=o+a),f!==u||0!==r&&3!==f.nodeType||(c=o+r),3===f.nodeType&&(o+=f.nodeValue.length),null!==(h=f.firstChild);)p=f,f=h;for(;;){if(f===e)break t;if(p===n&&++l===a&&(s=o),p===u&&++d===r&&(c=o),null!==(h=f.nextSibling))break;p=(f=p).parentNode}f=h}n=-1===s||-1===c?null:{start:s,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Wt=!1,Yo=t;null!==Yo;)if(e=(t=Yo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Yo=e;else for(;null!==Yo;){t=Yo;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var m=v.memoizedProps,y=v.memoizedState,g=t.stateNode,b=g.getSnapshotBeforeUpdate(t.elementType===t.type?m:mi(t.type,m),y);g.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var _=t.stateNode.containerInfo;1===_.nodeType?_.textContent="":9===_.nodeType&&_.documentElement&&_.removeChild(_.documentElement);break;default:throw Error(i(163))}}catch(k){Ac(t,t.return,k)}if(null!==(e=t.sibling)){e.return=t.return,Yo=e;break}Yo=t.return}v=ns,ns=!1}(e,n),ys(n,e),hr(ta),Wt=!!ea,ta=ea=null,e.current=n,bs(n,e,a),Ke(),Os=s,bt=o,Ss.transition=u}else e.current=n;if($s&&($s=!1,Js=e,Ks=a),u=e.pendingLanes,0===u&&(Vs=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ac(e,Qe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(qs)throw qs=!1,e=Gs,Gs=null,e;0!==(1&Ks)&&0!==e.tag&&xc(),u=e.pendingLanes,0!==(1&u)?e===Xs?Qs++:(Qs=0,Xs=e):Qs=0,Ha()}(e,t,n,r)}finally{Ss.transition=a,bt=r}return null}function xc(){if(null!==Js){var e=_t(Ks),t=Ss.transition,n=bt;try{if(Ss.transition=null,bt=16>e?16:e,null===Js)var r=!1;else{if(e=Js,Js=null,Ks=0,0!==(6&Os))throw Error(i(331));var a=Os;for(Os|=4,Yo=e.current;null!==Yo;){var u=Yo,o=u.child;if(0!==(16&Yo.flags)){var s=u.deletions;if(null!==s){for(var c=0;c<s.length;c++){var l=s[c];for(Yo=l;null!==Yo;){var d=Yo;switch(d.tag){case 0:case 11:case 15:rs(8,d,u)}var f=d.child;if(null!==f)f.return=d,Yo=f;else for(;null!==Yo;){var p=(d=Yo).sibling,h=d.return;if(us(d),d===l){Yo=null;break}if(null!==p){p.return=h,Yo=p;break}Yo=h}}}var v=u.alternate;if(null!==v){var m=v.child;if(null!==m){v.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(null!==m)}}Yo=u}}if(0!==(2064&u.subtreeFlags)&&null!==o)o.return=u,Yo=o;else e:for(;null!==Yo;){if(0!==(2048&(u=Yo).flags))switch(u.tag){case 0:case 11:case 15:rs(9,u,u.return)}var g=u.sibling;if(null!==g){g.return=u.return,Yo=g;break e}Yo=u.return}}var b=e.current;for(Yo=b;null!==Yo;){var _=(o=Yo).child;if(0!==(2064&o.subtreeFlags)&&null!==_)_.return=o,Yo=_;else e:for(o=b;null!==Yo;){if(0!==(2048&(s=Yo).flags))try{switch(s.tag){case 0:case 11:case 15:as(9,s)}}catch(w){Ac(s,s.return,w)}if(s===o){Yo=null;break e}var k=s.sibling;if(null!==k){k.return=s.return,Yo=k;break e}Yo=s.return}}if(Os=a,Ha(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(w){}r=!0}return r}finally{bt=n,Ss.transition=t}}return!1}function Ec(e,t,n){e=Ii(e,t=ho(0,t=co(n,t),1),1),t=tc(),null!==e&&(yt(e,1,t),ac(e,t))}function Ac(e,t,n){if(3===e.tag)Ec(e,e,n);else for(;null!==t;){if(3===t.tag){Ec(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Vs||!Vs.has(r))){t=Ii(t,e=vo(t,e=co(n,e),1),1),e=tc(),null!==t&&(yt(t,1,e),ac(t,e));break}}t=t.return}}function Cc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Fs===e&&(Ts&n)===n&&(4===Ns||3===Ns&&(130023424&Ts)===Ts&&500>Qe()-Hs?pc(e,0):Ms|=n),ac(e,t)}function Dc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=tc();null!==(e=Oi(e,t))&&(yt(e,t,n),ac(e,n))}function Sc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Dc(e,n)}function Oc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Dc(e,n)}function Fc(e,t){return Ve(e,t)}function Pc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tc(e,t,n,r){return new Pc(e,t,n,r)}function jc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ic(e,t){var n=e.alternate;return null===n?((n=Tc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Nc(e,t,n,r,a,u){var o=2;if(r=e,"function"===typeof e)jc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case x:return Rc(n.children,a,u,t);case E:o=8,a|=8;break;case A:return(e=Tc(12,n,t,2|a)).elementType=A,e.lanes=u,e;case O:return(e=Tc(13,n,t,a)).elementType=O,e.lanes=u,e;case F:return(e=Tc(19,n,t,a)).elementType=F,e.lanes=u,e;case j:return Bc(n,a,u,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:o=10;break e;case D:o=9;break e;case S:o=11;break e;case P:o=14;break e;case T:o=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Tc(o,n,t,a)).elementType=e,t.type=r,t.lanes=u,t}function Rc(e,t,n,r){return(e=Tc(7,e,r,t)).lanes=n,e}function Bc(e,t,n,r){return(e=Tc(22,e,r,t)).elementType=j,e.lanes=n,e.stateNode={isHidden:!1},e}function Lc(e,t,n){return(e=Tc(6,e,null,t)).lanes=n,e}function Mc(e,t,n){return(t=Tc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,r,a,i,u,o,s){return e=new Uc(e,t,n,o,s),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Tc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pi(i),e}function Hc(e){if(!e)return Da;e:{if(He(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ta(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Ta(n))return Na(e,n,t)}return t}function Zc(e,t,n,r,a,i,u,o,s){return(e=zc(n,r,!0,e,0,i,0,o,s)).context=Hc(null),n=e.current,(i=ji(r=tc(),a=nc(n))).callback=void 0!==t&&null!==t?t:null,Ii(n,i,a),e.current.lanes=a,yt(e,a,r),ac(e,r),e}function Wc(e,t,n,r){var a=t.current,i=tc(),u=nc(a);return n=Hc(n),null===t.context?t.context=n:t.pendingContext=n,(t=ji(i,u)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Ii(a,t,u))&&(rc(e,a,u,i),Ni(e,a,u)),u}function qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Vc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}Es=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Oa.current)_o=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return _o=!1,function(e,t,n){switch(t.tag){case 3:Fo(t),pi();break;case 5:iu(t);break;case 1:Ta(t.type)&&Ra(t);break;case 4:ru(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Ca(yi,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ca(ou,1&ou.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Lo(e,t,n):(Ca(ou,1&ou.current),null!==(e=qo(e,t,n))?e.sibling:null);Ca(ou,1&ou.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Zo(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ca(ou,ou.current),r)break;return null;case 22:case 23:return t.lanes=0,Ao(e,t,n)}return qo(e,t,n)}(e,t,n);_o=0!==(131072&e.flags)}else _o=!1,ai&&0!==(1048576&t.flags)&&Ya(t,Ga,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Wo(e,t),e=t.pendingProps;var a=Pa(t,Sa.current);Ei(t,n),a=xu(null,t,r,e,a,n);var u=Eu();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ta(r)?(u=!0,Ra(t)):u=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Pi(t),a.updater=zi,t.stateNode=a,a._reactInternals=t,qi(t,r,e,n),t=Oo(null,t,r,!0,u,n)):(t.tag=0,ai&&u&&ei(t),ko(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Wo(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return jc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===S)return 11;if(e===P)return 14}return 2}(r),e=mi(r,e),a){case 0:t=Do(null,t,r,e,n);break e;case 1:t=So(null,t,r,e,n);break e;case 11:t=wo(null,t,r,e,n);break e;case 14:t=xo(null,t,r,mi(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Do(e,t,r,a=t.elementType===r?a:mi(r,a),n);case 1:return r=t.type,a=t.pendingProps,So(e,t,r,a=t.elementType===r?a:mi(r,a),n);case 3:e:{if(Fo(t),null===e)throw Error(i(387));r=t.pendingProps,a=(u=t.memoizedState).element,Ti(e,t),Bi(t,r,null,n);var o=t.memoizedState;if(r=o.element,u.isDehydrated){if(u={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=u,t.memoizedState=u,256&t.flags){t=Po(e,t,r,n,a=co(Error(i(423)),t));break e}if(r!==a){t=Po(e,t,r,n,a=co(Error(i(424)),t));break e}for(ri=ca(t.stateNode.containerInfo.firstChild),ni=t,ai=!0,ii=null,n=Qi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pi(),r===a){t=qo(e,t,n);break e}ko(e,t,r,n)}t=t.child}return t;case 5:return iu(t),null===e&&ci(t),r=t.type,a=t.pendingProps,u=null!==e?e.memoizedProps:null,o=a.children,na(r,a)?o=null:null!==u&&na(r,u)&&(t.flags|=32),Co(e,t),ko(e,t,o,n),t.child;case 6:return null===e&&ci(t),null;case 13:return Lo(e,t,n);case 4:return ru(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ki(t,null,r,n):ko(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,wo(e,t,r,a=t.elementType===r?a:mi(r,a),n);case 7:return ko(e,t,t.pendingProps,n),t.child;case 8:case 12:return ko(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,u=t.memoizedProps,o=a.value,Ca(yi,r._currentValue),r._currentValue=o,null!==u)if(or(u.value,o)){if(u.children===a.children&&!Oa.current){t=qo(e,t,n);break e}}else for(null!==(u=t.child)&&(u.return=t);null!==u;){var s=u.dependencies;if(null!==s){o=u.child;for(var c=s.firstContext;null!==c;){if(c.context===r){if(1===u.tag){(c=ji(-1,n&-n)).tag=2;var l=u.updateQueue;if(null!==l){var d=(l=l.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),l.pending=c}}u.lanes|=n,null!==(c=u.alternate)&&(c.lanes|=n),xi(u.return,n,t),s.lanes|=n;break}c=c.next}}else if(10===u.tag)o=u.type===t.type?null:u.child;else if(18===u.tag){if(null===(o=u.return))throw Error(i(341));o.lanes|=n,null!==(s=o.alternate)&&(s.lanes|=n),xi(o,n,t),o=u.sibling}else o=u.child;if(null!==o)o.return=u;else for(o=u;null!==o;){if(o===t){o=null;break}if(null!==(u=o.sibling)){u.return=o.return,o=u;break}o=o.return}u=o}ko(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Ei(t,n),r=r(a=Ai(a)),t.flags|=1,ko(e,t,r,n),t.child;case 14:return a=mi(r=t.type,t.pendingProps),xo(e,t,r,a=mi(r.type,a),n);case 15:return Eo(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:mi(r,a),Wo(e,t),t.tag=1,Ta(r)?(e=!0,Ra(t)):e=!1,Ei(t,n),Zi(t,r,a),qi(t,r,a,n),Oo(null,t,r,!0,e,n);case 19:return Zo(e,t,n);case 22:return Ao(e,t,n)}throw Error(i(156,t.tag))};var $c="function"===typeof reportError?reportError:function(e){console.error(e)};function Jc(e){this._internalRoot=e}function Kc(e){this._internalRoot=e}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Yc(){}function el(e,t,n,r,a){var i=n._reactRootContainer;if(i){var u=i;if("function"===typeof a){var o=a;a=function(){var e=qc(u);o.call(e)}}Wc(t,u,e,a)}else u=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=qc(u);i.call(e)}}var u=Zc(t,r,e,0,null,!1,0,"",Yc);return e._reactRootContainer=u,e[ha]=u.current,Hr(8===e.nodeType?e.parentNode:e),dc(),u}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var o=r;r=function(){var e=qc(s);o.call(e)}}var s=zc(e,0,!1,null,0,!1,0,"",Yc);return e._reactRootContainer=s,e[ha]=s.current,Hr(8===e.nodeType?e.parentNode:e),dc((function(){Wc(t,s,n,r)})),s}(n,t,e,a,r);return qc(u)}Kc.prototype.render=Jc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Wc(e,t,null,null)},Kc.prototype.unmount=Jc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc((function(){Wc(null,e,null,null)})),t[ha]=null}},Kc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<jt.length&&0!==t&&t<jt[n].priority;n++);jt.splice(n,0,e),0===n&&Bt(e)}},kt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(gt(t,1|n),ac(t,Qe()),0===(6&Os)&&(Zs=Qe()+500,Ha()))}break;case 13:dc((function(){var t=Oi(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}})),Vc(e,1)}},wt=function(e){if(13===e.tag){var t=Oi(e,134217728);if(null!==t)rc(t,e,134217728,tc());Vc(e,134217728)}},xt=function(e){if(13===e.tag){var t=nc(e),n=Oi(e,t);if(null!==n)rc(n,e,t,tc());Vc(e,t)}},Et=function(){return bt},At=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},we=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=ka(r);if(!a)throw Error(i(90));V(r),X(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Se=lc,Oe=dc;var tl={usingClientEntryPoint:!1,Events:[ba,_a,ka,Ce,De,lc]},nl={findFiberByHostInstance:ga,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rl={bundleType:nl.bundleType,version:nl.version,rendererPackageName:nl.rendererPackageName,rendererConfig:nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:nl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!al.isDisabled&&al.supportsFiber)try{at=al.inject(rl),it=al}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qc(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Qc(e))throw Error(i(299));var n=!1,r="",a=$c;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,r,a),e[ha]=t.current,Hr(8===e.nodeType?e.parentNode:e),new Jc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!Xc(t))throw Error(i(200));return el(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Qc(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,u="",o=$c;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(u=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Zc(t,null,e,1,null!=n?n:null,a,0,u,o),e[ha]=t.current,Hr(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Kc(t)},t.render=function(e,t,n){if(!Xc(t))throw Error(i(200));return el(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(i(40));return!!e._reactRootContainer&&(dc((function(){el(null,null,e,!1,(function(){e._reactRootContainer=null,e[ha]=null}))})),!0)},t.unstable_batchedUpdates=lc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return el(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},1250:function(e,t,n){"use strict";var r=n(4164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4463)},6374:function(e,t,n){"use strict";var r=n(2791),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),u=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)u.call(t,r)&&!s.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:l,props:i,_owner:o.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},9117:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),s=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,m={};function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||h}function g(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||h}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},g.prototype=y.prototype;var _=b.prototype=new g;_.constructor=b,v(_,y.prototype),_.isPureReactComponent=!0;var k=Array.isArray,w=Object.prototype.hasOwnProperty,x={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function A(e,t,r){var a,i={},u=null,o=null;if(null!=t)for(a in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(u=""+t.key),t)w.call(t,a)&&!E.hasOwnProperty(a)&&(i[a]=t[a]);var s=arguments.length-2;if(1===s)i.children=r;else if(1<s){for(var c=Array(s),l=0;l<s;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(a in s=e.defaultProps)void 0===i[a]&&(i[a]=s[a]);return{$$typeof:n,type:e,key:u,ref:o,props:i,_owner:x.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var D=/\/+/g;function S(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function O(e,t,a,i,u){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var s=!1;if(null===e)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case n:case r:s=!0}}if(s)return u=u(s=e),e=""===i?"."+S(s,0):i,k(u)?(a="",null!=e&&(a=e.replace(D,"$&/")+"/"),O(u,t,a,"",(function(e){return e}))):null!=u&&(C(u)&&(u=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(u,a+(!u.key||s&&s.key===u.key?"":(""+u.key).replace(D,"$&/")+"/")+e)),t.push(u)),1;if(s=0,i=""===i?".":i+":",k(e))for(var c=0;c<e.length;c++){var l=i+S(o=e[c],c);s+=O(o,t,a,l,u)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(o=e.next()).done;)s+=O(o=o.value,t,a,l=i+S(o,c++),u);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function F(e,t,n){if(null==e)return e;var r=[],a=0;return O(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function P(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var T={current:null},j={transition:null},I={ReactCurrentDispatcher:T,ReactCurrentBatchConfig:j,ReactCurrentOwner:x};t.Children={map:F,forEach:function(e,t,n){F(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return F(e,(function(){t++})),t},toArray:function(e){return F(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=a,t.Profiler=u,t.PureComponent=b,t.StrictMode=i,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=v({},e.props),i=e.key,u=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(u=t.ref,o=x.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(c in t)w.call(t,c)&&!E.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==s?s[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){s=Array(c);for(var l=0;l<c;l++)s[l]=arguments[l+2];a.children=s}return{$$typeof:n,type:e.type,key:i,ref:u,props:a,_owner:o}},t.createContext=function(e){return(e={$$typeof:s,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=A,t.createFactory=function(e){var t=A.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=j.transition;j.transition={};try{e()}finally{j.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return T.current.useCallback(e,t)},t.useContext=function(e){return T.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return T.current.useDeferredValue(e)},t.useEffect=function(e,t){return T.current.useEffect(e,t)},t.useId=function(){return T.current.useId()},t.useImperativeHandle=function(e,t,n){return T.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return T.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return T.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return T.current.useMemo(e,t)},t.useReducer=function(e,t,n){return T.current.useReducer(e,t,n)},t.useRef=function(e){return T.current.useRef(e)},t.useState=function(e){return T.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return T.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return T.current.useTransition()},t.version="18.2.0"},2791:function(e,t,n){"use strict";e.exports=n(9117)},184:function(e,t,n){"use strict";e.exports=n(6374)},9158:function(e,t,n){e.exports=n(5509)},5509:function(e,t,n){var r=n(1500);t.operation=function(e){var n=t.timeouts(e);return new r(n,{forever:e&&(e.forever||e.retries===1/0),unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},t.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var n in e)t[n]=e[n];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var r=[],a=0;a<t.retries;a++)r.push(this.createTimeout(a,t));return e&&e.forever&&!r.length&&r.push(this.createTimeout(a,t)),r.sort((function(e,t){return e-t})),r},t.createTimeout=function(e,t){var n=t.randomize?Math.random()+1:1,r=Math.round(n*Math.max(t.minTimeout,1)*Math.pow(t.factor,e));return r=Math.min(r,t.maxTimeout)},t.wrap=function(e,n,r){if(n instanceof Array&&(r=n,n=null),!r)for(var a in r=[],e)"function"===typeof e[a]&&r.push(a);for(var i=0;i<r.length;i++){var u=r[i],o=e[u];e[u]=function(r){var a=t.operation(n),i=Array.prototype.slice.call(arguments,1),u=i.pop();i.push((function(e){a.retry(e)||(e&&(arguments[0]=a.mainError()),u.apply(this,arguments))})),a.attempt((function(){r.apply(e,i)}))}.bind(e,o),e[u].options=n}}},1500:function(e){function t(e,t){"boolean"===typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}e.exports=t,t.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},t.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},t.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var n=this._timeouts.shift();if(void 0===n){if(!this._cachedTimeouts)return!1;this._errors.splice(0,this._errors.length-1),n=this._cachedTimeouts.slice(-1)}var r=this;return this._timer=setTimeout((function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout((function(){r._operationTimeoutCb(r._attempts)}),r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)}),n),this._options.unref&&this._timer.unref(),!0},t.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){n._operationTimeoutCb()}),n._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},t.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},t.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},t.prototype.start=t.prototype.try,t.prototype.errors=function(){return this._errors},t.prototype.attempts=function(){return this._attempts},t.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,n=0,r=0;r<this._errors.length;r++){var a=this._errors[r],i=a.message,u=(e[i]||0)+1;e[i]=u,u>=n&&(t=a,n=u)}return t}},6813:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,u=a>>>1;r<u;){var o=2*(r+1)-1,s=e[o],c=o+1,l=e[c];if(0>i(s,n))c<a&&0>i(l,s)?(e[r]=l,e[c]=n,r=c):(e[r]=s,e[o]=n,r=o);else{if(!(c<a&&0>i(l,n)))break e;e[r]=l,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var u=performance;t.unstable_now=function(){return u.now()}}else{var o=Date,s=o.now();t.unstable_now=function(){return o.now()-s}}var c=[],l=[],d=1,f=null,p=3,h=!1,v=!1,m=!1,y="function"===typeof setTimeout?setTimeout:null,g="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function _(e){for(var t=r(l);null!==t;){if(null===t.callback)a(l);else{if(!(t.startTime<=e))break;a(l),t.sortIndex=t.expirationTime,n(c,t)}t=r(l)}}function k(e){if(m=!1,_(e),!v)if(null!==r(c))v=!0,j(w);else{var t=r(l);null!==t&&I(k,t.startTime-e)}}function w(e,n){v=!1,m&&(m=!1,g(C),C=-1),h=!0;var i=p;try{for(_(n),f=r(c);null!==f&&(!(f.expirationTime>n)||e&&!O());){var u=f.callback;if("function"===typeof u){f.callback=null,p=f.priorityLevel;var o=u(f.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?f.callback=o:f===r(c)&&a(c),_(n)}else a(c);f=r(c)}if(null!==f)var s=!0;else{var d=r(l);null!==d&&I(k,d.startTime-n),s=!1}return s}finally{f=null,p=i,h=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var x,E=!1,A=null,C=-1,D=5,S=-1;function O(){return!(t.unstable_now()-S<D)}function F(){if(null!==A){var e=t.unstable_now();S=e;var n=!0;try{n=A(!0,e)}finally{n?x():(E=!1,A=null)}}else E=!1}if("function"===typeof b)x=function(){b(F)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,T=P.port2;P.port1.onmessage=F,x=function(){T.postMessage(null)}}else x=function(){y(F,0)};function j(e){A=e,E||(E=!0,x())}function I(e,n){C=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||h||(v=!0,j(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,a,i){var u=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?u+i:u:i=u,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:a,priorityLevel:e,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>u?(e.sortIndex=i,n(l,e),null===r(c)&&e===r(l)&&(m?(g(C),C=-1):m=!0,I(k,i-u))):(e.sortIndex=o,n(c,e),v||h||(v=!0,j(w))),e},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},5296:function(e,t,n){"use strict";e.exports=n(6813)},8981:function(e,t,n){var r=n(6690).default,a=n(9728).default,i=Symbol("SemVer ANY"),u=function(){"use strict";function e(t,n){if(r(this,e),n=o(n),t instanceof e){if(t.loose===!!n.loose)return t;t=t.value}t=t.trim().split(/\s+/).join(" "),f("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.semver===i?this.value="":this.value=this.operator+this.semver.version,f("comp",this)}return a(e,[{key:"parse",value:function(e){var t=this.options.loose?c[l.COMPARATORLOOSE]:c[l.COMPARATOR],n=e.match(t);if(!n)throw new TypeError("Invalid comparator: ".concat(e));this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new p(n[2],this.options.loose):this.semver=i}},{key:"toString",value:function(){return this.value}},{key:"test",value:function(e){if(f("Comparator.test",e,this.options.loose),this.semver===i||e===i)return!0;if("string"===typeof e)try{e=new p(e,this.options)}catch(t){return!1}return d(e,this.operator,this.semver,this.options)}},{key:"intersects",value:function(t,n){if(!(t instanceof e))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new h(t.value,n).test(this.value):""===t.operator?""===t.value||new h(this.value,n).test(t.semver):(!(n=o(n)).includePrerelease||"<0.0.0-0"!==this.value&&"<0.0.0-0"!==t.value)&&(!(!n.includePrerelease&&(this.value.startsWith("<0.0.0")||t.value.startsWith("<0.0.0")))&&(!(!this.operator.startsWith(">")||!t.operator.startsWith(">"))||(!(!this.operator.startsWith("<")||!t.operator.startsWith("<"))||(!(this.semver.version!==t.semver.version||!this.operator.includes("=")||!t.operator.includes("="))||(!!(d(this.semver,"<",t.semver,n)&&this.operator.startsWith(">")&&t.operator.startsWith("<"))||!!(d(this.semver,">",t.semver,n)&&this.operator.startsWith("<")&&t.operator.startsWith(">")))))))}}],[{key:"ANY",get:function(){return i}}]),e}();e.exports=u;var o=n(8270),s=n(5446),c=s.safeRe,l=s.t,d=n(2907),f=n(9304),p=n(3298),h=n(487)},487:function(e,t,n){var r=n(861).default,a=n(4704).default,i=n(6690).default,u=n(9728).default,o=/\s+/g,s=function(){"use strict";function e(t,n){var r=this;if(i(this,e),n=l(n),t instanceof e)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new e(t.raw,n);if(t instanceof d)return this.raw=t.value,this.set=[[t]],this.formatted=void 0,this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t.trim().replace(o," "),this.set=this.raw.split("||").map((function(e){return r.parseRange(e.trim())})).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(this.raw));if(this.set.length>1){var u=this.set[0];if(this.set=this.set.filter((function(e){return!x(e[0])})),0===this.set.length)this.set=[u];else if(this.set.length>1){var s,c=a(this.set);try{for(c.s();!(s=c.n()).done;){var f=s.value;if(1===f.length&&E(f[0])){this.set=[f];break}}}catch(p){c.e(p)}finally{c.f()}}}this.formatted=void 0}return u(e,[{key:"range",get:function(){if(void 0===this.formatted){this.formatted="";for(var e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");for(var t=this.set[e],n=0;n<t.length;n++)n>0&&(this.formatted+=" "),this.formatted+=t[n].toString().trim()}}return this.formatted}},{key:"format",value:function(){return this.range}},{key:"toString",value:function(){return this.range}},{key:"parseRange",value:function(e){var t=this,n=((this.options.includePrerelease&&k)|(this.options.loose&&w))+":"+e,i=c.get(n);if(i)return i;var u=this.options.loose,o=u?v[m.HYPHENRANGELOOSE]:v[m.HYPHENRANGE];e=e.replace(o,R(this.options.includePrerelease)),f("hyphen replace",e),e=e.replace(v[m.COMPARATORTRIM],y),f("comparator trim",e),e=e.replace(v[m.TILDETRIM],g),f("tilde trim",e),e=e.replace(v[m.CARETTRIM],b),f("caret trim",e);var s=e.split(" ").map((function(e){return C(e,t.options)})).join(" ").split(/\s+/).map((function(e){return N(e,t.options)}));u&&(s=s.filter((function(e){return f("loose invalid filter",e,t.options),!!e.match(v[m.COMPARATORLOOSE])}))),f("range list",s);var l,p=new Map,h=s.map((function(e){return new d(e,t.options)})),_=a(h);try{for(_.s();!(l=_.n()).done;){var E=l.value;if(x(E))return[E];p.set(E.value,E)}}catch(D){_.e(D)}finally{_.f()}p.size>1&&p.has("")&&p.delete("");var A=r(p.values());return c.set(n,A),A}},{key:"intersects",value:function(t,n){if(!(t instanceof e))throw new TypeError("a Range is required");return this.set.some((function(e){return A(e,n)&&t.set.some((function(t){return A(t,n)&&e.every((function(e){return t.every((function(t){return e.intersects(t,n)}))}))}))}))}},{key:"test",value:function(e){if(!e)return!1;if("string"===typeof e)try{e=new p(e,this.options)}catch(n){return!1}for(var t=0;t<this.set.length;t++)if(B(this.set[t],e,this.options))return!0;return!1}}]),e}();e.exports=s;var c=new(n(8159)),l=n(8270),d=n(8981),f=n(9304),p=n(3298),h=n(5446),v=h.safeRe,m=h.t,y=h.comparatorTrimReplace,g=h.tildeTrimReplace,b=h.caretTrimReplace,_=n(9836),k=_.FLAG_INCLUDE_PRERELEASE,w=_.FLAG_LOOSE,x=function(e){return"<0.0.0-0"===e.value},E=function(e){return""===e.value},A=function(e,t){for(var n=!0,r=e.slice(),a=r.pop();n&&r.length;)n=r.every((function(e){return a.intersects(e,t)})),a=r.pop();return n},C=function(e,t){return f("comp",e,t),e=F(e,t),f("caret",e),e=S(e,t),f("tildes",e),e=T(e,t),f("xrange",e),e=I(e,t),f("stars",e),e},D=function(e){return!e||"x"===e.toLowerCase()||"*"===e},S=function(e,t){return e.trim().split(/\s+/).map((function(e){return O(e,t)})).join(" ")},O=function(e,t){var n=t.loose?v[m.TILDELOOSE]:v[m.TILDE];return e.replace(n,(function(t,n,r,a,i){var u;return f("tilde",e,t,n,r,a,i),D(n)?u="":D(r)?u=">=".concat(n,".0.0 <").concat(+n+1,".0.0-0"):D(a)?u=">=".concat(n,".").concat(r,".0 <").concat(n,".").concat(+r+1,".0-0"):i?(f("replaceTilde pr",i),u=">=".concat(n,".").concat(r,".").concat(a,"-").concat(i," <").concat(n,".").concat(+r+1,".0-0")):u=">=".concat(n,".").concat(r,".").concat(a," <").concat(n,".").concat(+r+1,".0-0"),f("tilde return",u),u}))},F=function(e,t){return e.trim().split(/\s+/).map((function(e){return P(e,t)})).join(" ")},P=function(e,t){f("caret",e,t);var n=t.loose?v[m.CARETLOOSE]:v[m.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,(function(t,n,a,i,u){var o;return f("caret",e,t,n,a,i,u),D(n)?o="":D(a)?o=">=".concat(n,".0.0").concat(r," <").concat(+n+1,".0.0-0"):D(i)?o="0"===n?">=".concat(n,".").concat(a,".0").concat(r," <").concat(n,".").concat(+a+1,".0-0"):">=".concat(n,".").concat(a,".0").concat(r," <").concat(+n+1,".0.0-0"):u?(f("replaceCaret pr",u),o="0"===n?"0"===a?">=".concat(n,".").concat(a,".").concat(i,"-").concat(u," <").concat(n,".").concat(a,".").concat(+i+1,"-0"):">=".concat(n,".").concat(a,".").concat(i,"-").concat(u," <").concat(n,".").concat(+a+1,".0-0"):">=".concat(n,".").concat(a,".").concat(i,"-").concat(u," <").concat(+n+1,".0.0-0")):(f("no pr"),o="0"===n?"0"===a?">=".concat(n,".").concat(a,".").concat(i).concat(r," <").concat(n,".").concat(a,".").concat(+i+1,"-0"):">=".concat(n,".").concat(a,".").concat(i).concat(r," <").concat(n,".").concat(+a+1,".0-0"):">=".concat(n,".").concat(a,".").concat(i," <").concat(+n+1,".0.0-0")),f("caret return",o),o}))},T=function(e,t){return f("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return j(e,t)})).join(" ")},j=function(e,t){e=e.trim();var n=t.loose?v[m.XRANGELOOSE]:v[m.XRANGE];return e.replace(n,(function(n,r,a,i,u,o){f("xRange",e,n,r,a,i,u,o);var s=D(a),c=s||D(i),l=c||D(u),d=l;return"="===r&&d&&(r=""),o=t.includePrerelease?"-0":"",s?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&d?(c&&(i=0),u=0,">"===r?(r=">=",c?(a=+a+1,i=0,u=0):(i=+i+1,u=0)):"<="===r&&(r="<",c?a=+a+1:i=+i+1),"<"===r&&(o="-0"),n="".concat(r+a,".").concat(i,".").concat(u).concat(o)):c?n=">=".concat(a,".0.0").concat(o," <").concat(+a+1,".0.0-0"):l&&(n=">=".concat(a,".").concat(i,".0").concat(o," <").concat(a,".").concat(+i+1,".0-0")),f("xRange return",n),n}))},I=function(e,t){return f("replaceStars",e,t),e.trim().replace(v[m.STAR],"")},N=function(e,t){return f("replaceGTE0",e,t),e.trim().replace(v[t.includePrerelease?m.GTE0PRE:m.GTE0],"")},R=function(e){return function(t,n,r,a,i,u,o,s,c,l,d,f){return n=D(r)?"":D(a)?">=".concat(r,".0.0").concat(e?"-0":""):D(i)?">=".concat(r,".").concat(a,".0").concat(e?"-0":""):u?">=".concat(n):">=".concat(n).concat(e?"-0":""),s=D(c)?"":D(l)?"<".concat(+c+1,".0.0-0"):D(d)?"<".concat(c,".").concat(+l+1,".0-0"):f?"<=".concat(c,".").concat(l,".").concat(d,"-").concat(f):e?"<".concat(c,".").concat(l,".").concat(+d+1,"-0"):"<=".concat(s),"".concat(n," ").concat(s).trim()}},B=function(e,t,n){for(var r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(var a=0;a<e.length;a++)if(f(e[a].semver),e[a].semver!==d.ANY&&e[a].semver.prerelease.length>0){var i=e[a].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}},3298:function(e,t,n){var r=n(6690).default,a=n(9728).default,i=n(9304),u=n(9836),o=u.MAX_LENGTH,s=u.MAX_SAFE_INTEGER,c=n(5446),l=c.safeRe,d=c.safeSrc,f=c.t,p=n(8270),h=n(3228).compareIdentifiers,v=function(){"use strict";function e(t,n){if(r(this,e),n=p(n),t instanceof e){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if("string"!==typeof t)throw new TypeError('Invalid version. Must be a string. Got type "'.concat(typeof t,'".'));if(t.length>o)throw new TypeError("version is longer than ".concat(o," characters"));i("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;var a=t.trim().match(n.loose?l[f.LOOSE]:l[f.FULL]);if(!a)throw new TypeError("Invalid Version: ".concat(t));if(this.raw=t,this.major=+a[1],this.minor=+a[2],this.patch=+a[3],this.major>s||this.major<0)throw new TypeError("Invalid major version");if(this.minor>s||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>s||this.patch<0)throw new TypeError("Invalid patch version");a[4]?this.prerelease=a[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<s)return t}return e})):this.prerelease=[],this.build=a[5]?a[5].split("."):[],this.format()}return a(e,[{key:"format",value:function(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}},{key:"toString",value:function(){return this.version}},{key:"compare",value:function(t){if(i("SemVer.compare",this.version,this.options,t),!(t instanceof e)){if("string"===typeof t&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}},{key:"compareMain",value:function(t){return t instanceof e||(t=new e(t,this.options)),h(this.major,t.major)||h(this.minor,t.minor)||h(this.patch,t.patch)}},{key:"comparePre",value:function(t){if(t instanceof e||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var n=0;do{var r=this.prerelease[n],a=t.prerelease[n];if(i("prerelease compare",n,r,a),void 0===r&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===r)return-1;if(r!==a)return h(r,a)}while(++n)}},{key:"compareBuild",value:function(t){t instanceof e||(t=new e(t,this.options));var n=0;do{var r=this.build[n],a=t.build[n];if(i("build compare",n,r,a),void 0===r&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===r)return-1;if(r!==a)return h(r,a)}while(++n)}},{key:"inc",value:function(e,t,n){if(e.startsWith("pre")){if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(t){var r=new RegExp("^".concat(this.options.loose?d[f.PRERELEASELOOSE]:d[f.PRERELEASE],"$")),a="-".concat(t).match(r);if(!a||a[1]!==t)throw new Error("invalid identifier: ".concat(t))}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"release":if(0===this.prerelease.length)throw new Error("version ".concat(this.raw," is not a prerelease"));this.prerelease.length=0;break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":var i=Number(n)?1:0;if(0===this.prerelease.length)this.prerelease=[i];else{for(var u=this.prerelease.length;--u>=0;)"number"===typeof this.prerelease[u]&&(this.prerelease[u]++,u=-2);if(-1===u){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(t){var o=[t,i];!1===n&&(o=[t]),0===h(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=o):this.prerelease=o}break;default:throw new Error("invalid increment argument: ".concat(e))}return this.raw=this.format(),this.build.length&&(this.raw+="+".concat(this.build.join("."))),this}}]),e}();e.exports=v},5365:function(e,t,n){var r=n(7985);e.exports=function(e,t){var n=r(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null}},2907:function(e,t,n){var r=n(5378),a=n(9078),i=n(4544),u=n(6310),o=n(4562),s=n(7532);e.exports=function(e,t,n,c){switch(t){case"===":return"object"===typeof e&&(e=e.version),"object"===typeof n&&(n=n.version),e===n;case"!==":return"object"===typeof e&&(e=e.version),"object"===typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return r(e,n,c);case"!=":return a(e,n,c);case">":return i(e,n,c);case">=":return u(e,n,c);case"<":return o(e,n,c);case"<=":return s(e,n,c);default:throw new TypeError("Invalid operator: ".concat(t))}}},5071:function(e,t,n){var r=n(3298),a=n(7985),i=n(5446),u=i.safeRe,o=i.t;e.exports=function(e,t){if(e instanceof r)return e;if("number"===typeof e&&(e=String(e)),"string"!==typeof e)return null;var n=null;if((t=t||{}).rtl){for(var i,s=t.includePrerelease?u[o.COERCERTLFULL]:u[o.COERCERTL];(i=s.exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&i.index+i[0].length===n.index+n[0].length||(n=i),s.lastIndex=i.index+i[1].length+i[2].length;s.lastIndex=-1}else n=e.match(t.includePrerelease?u[o.COERCEFULL]:u[o.COERCE]);if(null===n)return null;var c=n[2],l=n[3]||"0",d=n[4]||"0",f=t.includePrerelease&&n[5]?"-".concat(n[5]):"",p=t.includePrerelease&&n[6]?"+".concat(n[6]):"";return a("".concat(c,".").concat(l,".").concat(d).concat(f).concat(p),t)}},136:function(e,t,n){var r=n(3298);e.exports=function(e,t,n){var a=new r(e,n),i=new r(t,n);return a.compare(i)||a.compareBuild(i)}},832:function(e,t,n){var r=n(2384);e.exports=function(e,t){return r(e,t,!0)}},2384:function(e,t,n){var r=n(3298);e.exports=function(e,t,n){return new r(e,n).compare(new r(t,n))}},639:function(e,t,n){var r=n(7985);e.exports=function(e,t){var n=r(e,null,!0),a=r(t,null,!0),i=n.compare(a);if(0===i)return null;var u=i>0,o=u?n:a,s=u?a:n,c=!!o.prerelease.length;if(!!s.prerelease.length&&!c){if(!s.patch&&!s.minor)return"major";if(0===s.compareMain(o))return s.minor&&!s.patch?"minor":"patch"}var l=c?"pre":"";return n.major!==a.major?l+"major":n.minor!==a.minor?l+"minor":n.patch!==a.patch?l+"patch":"prerelease"}},5378:function(e,t,n){var r=n(2384);e.exports=function(e,t,n){return 0===r(e,t,n)}},4544:function(e,t,n){var r=n(2384);e.exports=function(e,t,n){return r(e,t,n)>0}},6310:function(e,t,n){var r=n(2384);e.exports=function(e,t,n){return r(e,t,n)>=0}},6778:function(e,t,n){var r=n(3298);e.exports=function(e,t,n,a,i){"string"===typeof n&&(i=a,a=n,n=void 0);try{return new r(e instanceof r?e.version:e,n).inc(t,a,i).version}catch(u){return null}}},4562:function(e,t,n){var r=n(2384);e.exports=function(e,t,n){return r(e,t,n)<0}},7532:function(e,t,n){var r=n(2384);e.exports=function(e,t,n){return r(e,t,n)<=0}},2750:function(e,t,n){var r=n(3298);e.exports=function(e,t){return new r(e,t).major}},4184:function(e,t,n){var r=n(3298);e.exports=function(e,t){return new r(e,t).minor}},9078:function(e,t,n){var r=n(2384);e.exports=function(e,t,n){return 0!==r(e,t,n)}},7985:function(e,t,n){var r=n(3298);e.exports=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e instanceof r)return e;try{return new r(e,t)}catch(a){if(!n)return null;throw a}}},5093:function(e,t,n){var r=n(3298);e.exports=function(e,t){return new r(e,t).patch}},9361:function(e,t,n){var r=n(7985);e.exports=function(e,t){var n=r(e,t);return n&&n.prerelease.length?n.prerelease:null}},8111:function(e,t,n){var r=n(2384);e.exports=function(e,t,n){return r(t,e,n)}},6658:function(e,t,n){var r=n(136);e.exports=function(e,t){return e.sort((function(e,n){return r(n,e,t)}))}},2529:function(e,t,n){var r=n(487);e.exports=function(e,t,n){try{t=new r(t,n)}catch(a){return!1}return t.test(e)}},3462:function(e,t,n){var r=n(136);e.exports=function(e,t){return e.sort((function(e,n){return r(e,n,t)}))}},6793:function(e,t,n){var r=n(7985);e.exports=function(e,t){var n=r(e,t);return n?n.version:null}},724:function(e,t,n){var r=n(5446),a=n(9836),i=n(3298),u=n(3228),o=n(7985),s=n(6793),c=n(5365),l=n(6778),d=n(639),f=n(2750),p=n(4184),h=n(5093),v=n(9361),m=n(2384),y=n(8111),g=n(832),b=n(136),_=n(3462),k=n(6658),w=n(4544),x=n(4562),E=n(5378),A=n(9078),C=n(6310),D=n(7532),S=n(2907),O=n(5071),F=n(8981),P=n(487),T=n(2529),j=n(7545),I=n(4774),N=n(6088),R=n(1219),B=n(1383),L=n(2643),M=n(7281),U=n(5675),z=n(8772),H=n(4934),Z=n(6669);e.exports={parse:o,valid:s,clean:c,inc:l,diff:d,major:f,minor:p,patch:h,prerelease:v,compare:m,rcompare:y,compareLoose:g,compareBuild:b,sort:_,rsort:k,gt:w,lt:x,eq:E,neq:A,gte:C,lte:D,cmp:S,coerce:O,Comparator:F,Range:P,satisfies:T,toComparators:j,maxSatisfying:I,minSatisfying:N,minVersion:R,validRange:B,outside:L,gtr:M,ltr:U,intersects:z,simplifyRange:H,subset:Z,SemVer:i,re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:a.SEMVER_SPEC_VERSION,RELEASE_TYPES:a.RELEASE_TYPES,compareIdentifiers:u.compareIdentifiers,rcompareIdentifiers:u.rcompareIdentifiers}},9836:function(e){var t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},9304:function(e){var t="object"===typeof process&&{NODE_ENV:"production",PUBLIC_URL:"/detective-infinity",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NODE_DEBUG&&/\bsemver\b/i.test({NODE_ENV:"production",PUBLIC_URL:"/detective-infinity",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NODE_DEBUG)?function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=console).error.apply(e,["SEMVER"].concat(n))}:function(){};e.exports=t},3228:function(e){var t=/^[0-9]+$/,n=function(e,n){var r=t.test(e),a=t.test(n);return r&&a&&(e=+e,n=+n),e===n?0:r&&!a?-1:a&&!r?1:e<n?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:function(e,t){return n(t,e)}}},8159:function(e,t,n){var r=n(6690).default,a=n(9728).default,i=function(){"use strict";function e(){r(this,e),this.max=1e3,this.map=new Map}return a(e,[{key:"get",value:function(e){var t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}},{key:"delete",value:function(e){return this.map.delete(e)}},{key:"set",value:function(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){var n=this.map.keys().next().value;this.delete(n)}this.map.set(e,t)}return this}}]),e}();e.exports=i},8270:function(e){var t=Object.freeze({loose:!0}),n=Object.freeze({});e.exports=function(e){return e?"object"!==typeof e?t:e:n}},5446:function(e,t,n){var r=n(7424).default,a=n(9836),i=a.MAX_SAFE_COMPONENT_LENGTH,u=a.MAX_SAFE_BUILD_LENGTH,o=a.MAX_LENGTH,s=n(9304),c=(t=e.exports={}).re=[],l=t.safeRe=[],d=t.src=[],f=t.safeSrc=[],p=t.t={},h=0,v="[a-zA-Z0-9-]",m=[["\\s",1],["\\d",o],[v,u]],y=function(e,t,n){var a=function(e){for(var t=0,n=m;t<n.length;t++){var a=r(n[t],2),i=a[0],u=a[1];e=e.split("".concat(i,"*")).join("".concat(i,"{0,").concat(u,"}")).split("".concat(i,"+")).join("".concat(i,"{1,").concat(u,"}"))}return e}(t),i=h++;s(e,i,t),p[e]=i,d[i]=t,f[i]=a,c[i]=new RegExp(t,n?"g":void 0),l[i]=new RegExp(a,n?"g":void 0)};y("NUMERICIDENTIFIER","0|[1-9]\\d*"),y("NUMERICIDENTIFIERLOOSE","\\d+"),y("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-]".concat(v,"*")),y("MAINVERSION","(".concat(d[p.NUMERICIDENTIFIER],")\\.")+"(".concat(d[p.NUMERICIDENTIFIER],")\\.")+"(".concat(d[p.NUMERICIDENTIFIER],")")),y("MAINVERSIONLOOSE","(".concat(d[p.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(d[p.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(d[p.NUMERICIDENTIFIERLOOSE],")")),y("PRERELEASEIDENTIFIER","(?:".concat(d[p.NUMERICIDENTIFIER],"|").concat(d[p.NONNUMERICIDENTIFIER],")")),y("PRERELEASEIDENTIFIERLOOSE","(?:".concat(d[p.NUMERICIDENTIFIERLOOSE],"|").concat(d[p.NONNUMERICIDENTIFIER],")")),y("PRERELEASE","(?:-(".concat(d[p.PRERELEASEIDENTIFIER],"(?:\\.").concat(d[p.PRERELEASEIDENTIFIER],")*))")),y("PRERELEASELOOSE","(?:-?(".concat(d[p.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(d[p.PRERELEASEIDENTIFIERLOOSE],")*))")),y("BUILDIDENTIFIER","".concat(v,"+")),y("BUILD","(?:\\+(".concat(d[p.BUILDIDENTIFIER],"(?:\\.").concat(d[p.BUILDIDENTIFIER],")*))")),y("FULLPLAIN","v?".concat(d[p.MAINVERSION]).concat(d[p.PRERELEASE],"?").concat(d[p.BUILD],"?")),y("FULL","^".concat(d[p.FULLPLAIN],"$")),y("LOOSEPLAIN","[v=\\s]*".concat(d[p.MAINVERSIONLOOSE]).concat(d[p.PRERELEASELOOSE],"?").concat(d[p.BUILD],"?")),y("LOOSE","^".concat(d[p.LOOSEPLAIN],"$")),y("GTLT","((?:<|>)?=?)"),y("XRANGEIDENTIFIERLOOSE","".concat(d[p.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),y("XRANGEIDENTIFIER","".concat(d[p.NUMERICIDENTIFIER],"|x|X|\\*")),y("XRANGEPLAIN","[v=\\s]*(".concat(d[p.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(d[p.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(d[p.XRANGEIDENTIFIER],")")+"(?:".concat(d[p.PRERELEASE],")?").concat(d[p.BUILD],"?")+")?)?"),y("XRANGEPLAINLOOSE","[v=\\s]*(".concat(d[p.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(d[p.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(d[p.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(d[p.PRERELEASELOOSE],")?").concat(d[p.BUILD],"?")+")?)?"),y("XRANGE","^".concat(d[p.GTLT],"\\s*").concat(d[p.XRANGEPLAIN],"$")),y("XRANGELOOSE","^".concat(d[p.GTLT],"\\s*").concat(d[p.XRANGEPLAINLOOSE],"$")),y("COERCEPLAIN","".concat("(^|[^\\d])(\\d{1,").concat(i,"})")+"(?:\\.(\\d{1,".concat(i,"}))?")+"(?:\\.(\\d{1,".concat(i,"}))?")),y("COERCE","".concat(d[p.COERCEPLAIN],"(?:$|[^\\d])")),y("COERCEFULL",d[p.COERCEPLAIN]+"(?:".concat(d[p.PRERELEASE],")?")+"(?:".concat(d[p.BUILD],")?")+"(?:$|[^\\d])"),y("COERCERTL",d[p.COERCE],!0),y("COERCERTLFULL",d[p.COERCEFULL],!0),y("LONETILDE","(?:~>?)"),y("TILDETRIM","(\\s*)".concat(d[p.LONETILDE],"\\s+"),!0),t.tildeTrimReplace="$1~",y("TILDE","^".concat(d[p.LONETILDE]).concat(d[p.XRANGEPLAIN],"$")),y("TILDELOOSE","^".concat(d[p.LONETILDE]).concat(d[p.XRANGEPLAINLOOSE],"$")),y("LONECARET","(?:\\^)"),y("CARETTRIM","(\\s*)".concat(d[p.LONECARET],"\\s+"),!0),t.caretTrimReplace="$1^",y("CARET","^".concat(d[p.LONECARET]).concat(d[p.XRANGEPLAIN],"$")),y("CARETLOOSE","^".concat(d[p.LONECARET]).concat(d[p.XRANGEPLAINLOOSE],"$")),y("COMPARATORLOOSE","^".concat(d[p.GTLT],"\\s*(").concat(d[p.LOOSEPLAIN],")$|^$")),y("COMPARATOR","^".concat(d[p.GTLT],"\\s*(").concat(d[p.FULLPLAIN],")$|^$")),y("COMPARATORTRIM","(\\s*)".concat(d[p.GTLT],"\\s*(").concat(d[p.LOOSEPLAIN],"|").concat(d[p.XRANGEPLAIN],")"),!0),t.comparatorTrimReplace="$1$2$3",y("HYPHENRANGE","^\\s*(".concat(d[p.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(d[p.XRANGEPLAIN],")")+"\\s*$"),y("HYPHENRANGELOOSE","^\\s*(".concat(d[p.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(d[p.XRANGEPLAINLOOSE],")")+"\\s*$"),y("STAR","(<|>)?=?\\s*\\*"),y("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),y("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},7281:function(e,t,n){var r=n(2643);e.exports=function(e,t,n){return r(e,t,">",n)}},8772:function(e,t,n){var r=n(487);e.exports=function(e,t,n){return e=new r(e,n),t=new r(t,n),e.intersects(t,n)}},5675:function(e,t,n){var r=n(2643);e.exports=function(e,t,n){return r(e,t,"<",n)}},4774:function(e,t,n){var r=n(3298),a=n(487);e.exports=function(e,t,n){var i=null,u=null,o=null;try{o=new a(t,n)}catch(s){return null}return e.forEach((function(e){o.test(e)&&(i&&-1!==u.compare(e)||(u=new r(i=e,n)))})),i}},6088:function(e,t,n){var r=n(3298),a=n(487);e.exports=function(e,t,n){var i=null,u=null,o=null;try{o=new a(t,n)}catch(s){return null}return e.forEach((function(e){o.test(e)&&(i&&1!==u.compare(e)||(u=new r(i=e,n)))})),i}},1219:function(e,t,n){var r=n(3298),a=n(487),i=n(4544);e.exports=function(e,t){e=new a(e,t);var n=new r("0.0.0");if(e.test(n))return n;if(n=new r("0.0.0-0"),e.test(n))return n;n=null;for(var u=function(){var t=e.set[o],a=null;t.forEach((function(e){var t=new r(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":a&&!i(t,a)||(a=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: ".concat(e.operator))}})),!a||n&&!i(n,a)||(n=a)},o=0;o<e.set.length;++o)u();return n&&e.test(n)?n:null}},2643:function(e,t,n){var r=n(3298),a=n(8981),i=a.ANY,u=n(487),o=n(2529),s=n(4544),c=n(4562),l=n(7532),d=n(6310);e.exports=function(e,t,n,f){var p,h,v,m,y;switch(e=new r(e,f),t=new u(t,f),n){case">":p=s,h=l,v=c,m=">",y=">=";break;case"<":p=c,h=d,v=s,m="<",y="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(o(e,t,f))return!1;for(var g=function(){var n=t.set[b],r=null,u=null;return n.forEach((function(e){e.semver===i&&(e=new a(">=0.0.0")),r=r||e,u=u||e,p(e.semver,r.semver,f)?r=e:v(e.semver,u.semver,f)&&(u=e)})),r.operator===m||r.operator===y?{v:!1}:u.operator&&u.operator!==m||!h(e,u.semver)?u.operator===y&&v(e,u.semver)?{v:!1}:void 0:{v:!1}},b=0;b<t.set.length;++b){var _=g();if("object"===typeof _)return _.v}return!0}},4934:function(e,t,n){var r=n(7424).default,a=n(4704).default,i=n(2529),u=n(2384);e.exports=function(e,t,n){var o,s=[],c=null,l=null,d=e.sort((function(e,t){return u(e,t,n)})),f=a(d);try{for(f.s();!(o=f.n()).done;){var p=o.value;i(p,t,n)?(l=p,c||(c=p)):(l&&s.push([c,l]),l=null,c=null)}}catch(w){f.e(w)}finally{f.f()}c&&s.push([c,null]);for(var h=[],v=0,m=s;v<m.length;v++){var y=r(m[v],2),g=y[0],b=y[1];g===b?h.push(g):b||g!==d[0]?b?g===d[0]?h.push("<=".concat(b)):h.push("".concat(g," - ").concat(b)):h.push(">=".concat(g)):h.push("*")}var _=h.join(" || "),k="string"===typeof t.raw?t.raw:String(t);return _.length<k.length?_:t}},6669:function(e,t,n){var r=n(4704).default,a=n(487),i=n(8981),u=i.ANY,o=n(2529),s=n(2384),c=[new i(">=0.0.0-0")],l=[new i(">=0.0.0")],d=function(e,t,n){if(e===t)return!0;if(1===e.length&&e[0].semver===u){if(1===t.length&&t[0].semver===u)return!0;e=n.includePrerelease?c:l}if(1===t.length&&t[0].semver===u){if(n.includePrerelease)return!0;t=l}var a,i,d,h,v=new Set,m=r(e);try{for(m.s();!(d=m.n()).done;){var y=d.value;">"===y.operator||">="===y.operator?a=f(a,y,n):"<"===y.operator||"<="===y.operator?i=p(i,y,n):v.add(y.semver)}}catch(j){m.e(j)}finally{m.f()}if(v.size>1)return null;if(a&&i){if((h=s(a.semver,i.semver,n))>0)return null;if(0===h&&(">="!==a.operator||"<="!==i.operator))return null}var g,b,_,k,w,x=r(v);try{for(x.s();!(g=x.n()).done;){var E=g.value;if(a&&!o(E,String(a),n))return null;if(i&&!o(E,String(i),n))return null;var A,C=r(t);try{for(C.s();!(A=C.n()).done;){var D=A.value;if(!o(E,String(D),n))return!1}}catch(j){C.e(j)}finally{C.f()}return!0}}catch(j){x.e(j)}finally{x.f()}var S=!(!i||n.includePrerelease||!i.semver.prerelease.length)&&i.semver,O=!(!a||n.includePrerelease||!a.semver.prerelease.length)&&a.semver;S&&1===S.prerelease.length&&"<"===i.operator&&0===S.prerelease[0]&&(S=!1);var F,P=r(t);try{for(P.s();!(F=P.n()).done;){var T=F.value;if(w=w||">"===T.operator||">="===T.operator,k=k||"<"===T.operator||"<="===T.operator,a)if(O&&T.semver.prerelease&&T.semver.prerelease.length&&T.semver.major===O.major&&T.semver.minor===O.minor&&T.semver.patch===O.patch&&(O=!1),">"===T.operator||">="===T.operator){if((b=f(a,T,n))===T&&b!==a)return!1}else if(">="===a.operator&&!o(a.semver,String(T),n))return!1;if(i)if(S&&T.semver.prerelease&&T.semver.prerelease.length&&T.semver.major===S.major&&T.semver.minor===S.minor&&T.semver.patch===S.patch&&(S=!1),"<"===T.operator||"<="===T.operator){if((_=p(i,T,n))===T&&_!==i)return!1}else if("<="===i.operator&&!o(i.semver,String(T),n))return!1;if(!T.operator&&(i||a)&&0!==h)return!1}}catch(j){P.e(j)}finally{P.f()}return!(a&&k&&!i&&0!==h)&&(!(i&&w&&!a&&0!==h)&&(!O&&!S))},f=function(e,t,n){if(!e)return t;var r=s(e.semver,t.semver,n);return r>0?e:r<0||">"===t.operator&&">="===e.operator?t:e},p=function(e,t,n){if(!e)return t;var r=s(e.semver,t.semver,n);return r<0?e:r>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e===t)return!0;e=new a(e,n),t=new a(t,n);var i,u=!1,o=r(e.set);try{e:for(o.s();!(i=o.n()).done;){var s,c=i.value,l=r(t.set);try{for(l.s();!(s=l.n()).done;){var f=s.value,p=d(c,f,n);if(u=u||null!==p,p)continue e}}catch(h){l.e(h)}finally{l.f()}if(u)return!1}}catch(h){o.e(h)}finally{o.f()}return!0}},7545:function(e,t,n){var r=n(487);e.exports=function(e,t){return new r(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))}},1383:function(e,t,n){var r=n(487);e.exports=function(e,t){try{return new r(e,t).range||"*"}catch(n){return null}}},3897:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},5372:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},3405:function(e,t,n){var r=n(3897);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},6115:function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},7156:function(e){function t(e,t,n,r,a,i,u){try{var o=e[i](u),s=o.value}catch(c){return void n(c)}o.done?t(s):Promise.resolve(s).then(r,a)}e.exports=function(e){return function(){var n=this,r=arguments;return new Promise((function(a,i){var u=e.apply(n,r);function o(e){t(u,a,i,o,s,"next",e)}function s(e){t(u,a,i,o,s,"throw",e)}o(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},6690:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},3515:function(e,t,n){var r=n(6015),a=n(9617);function i(t,n,u){return a()?(e.exports=i=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=i=function(e,t,n){var a=[null];a.push.apply(a,t);var i=new(Function.bind.apply(e,a));return n&&r(i,n.prototype),i},e.exports.__esModule=!0,e.exports.default=e.exports),i.apply(null,arguments)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},9728:function(e,t,n){var r=n(4062);function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,r(a.key),a)}}e.exports=function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},4704:function(e,t,n){var r=n(6116);e.exports=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,u=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw u}}}},e.exports.__esModule=!0,e.exports.default=e.exports},6389:function(e,t,n){var r=n(3808),a=n(9617),i=n(4993);e.exports=function(e){var t=a();return function(){var n,a=r(e);if(t){var u=r(this).constructor;n=Reflect.construct(a,arguments,u)}else n=a.apply(this,arguments);return i(this,n)}},e.exports.__esModule=!0,e.exports.default=e.exports},8416:function(e,t,n){var r=n(4062);e.exports=function(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},3808:function(e){function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},1655:function(e,t,n){var r=n(6015);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},6035:function(e){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},e.exports.__esModule=!0,e.exports.default=e.exports},9617:function(e){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},9498:function(e){e.exports=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},8872:function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,u,o=[],s=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(o.push(r.value),o.length!==t);s=!0);}catch(l){c=!0,a=l}finally{try{if(!s&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(c)throw a}}return o}},e.exports.__esModule=!0,e.exports.default=e.exports},2218:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},2281:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},2122:function(e,t,n){var r=n(8416);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e},e.exports.__esModule=!0,e.exports.default=e.exports},4993:function(e,t,n){var r=n(8698).default,a=n(6115);e.exports=function(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)},e.exports.__esModule=!0,e.exports.default=e.exports},7061:function(e,t,n){var r=n(8698).default;function a(){"use strict";e.exports=a=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,i=n.hasOwnProperty,u=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(P){d=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),o=new S(r||[]);return u(i,"_invoke",{value:E(e,n,o)}),i}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(P){return{type:"throw",arg:P}}}t.wrap=f;var h={};function v(){}function m(){}function y(){}var g={};d(g,s,(function(){return this}));var b=Object.getPrototypeOf,_=b&&b(b(O([])));_&&_!==n&&i.call(_,s)&&(g=_);var k=y.prototype=v.prototype=Object.create(g);function w(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function n(a,u,o,s){var c=p(e[a],e,u);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==r(d)&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(d).then((function(e){l.value=e,o(l)}),(function(e){return n("throw",e,o,s)}))}s(c.arg)}var a;u(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,a){n(e,r,t,a)}))}return a=a?a.then(i,i):i()}})}function E(e,t,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return F()}for(n.method=a,n.arg=i;;){var u=n.delegate;if(u){var o=A(u,n);if(o){if(o===h)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=p(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===h)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}function A(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,A(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var a=p(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,h;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function O(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:F}}function F(){return{value:void 0,done:!0}}return m.prototype=y,u(k,"constructor",{value:y,configurable:!0}),u(y,"constructor",{value:m,configurable:!0}),m.displayName=d(y,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,d(e,l,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},w(x.prototype),d(x.prototype,c,(function(){return this})),t.AsyncIterator=x,t.async=function(e,n,r,a,i){void 0===i&&(i=Promise);var u=new x(f(e,n,r,a),i);return t.isGeneratorFunction(n)?u:u.next().then((function(e){return e.done?e.value:u.next()}))},w(k),d(k,l,"Generator"),d(k,s,(function(){return this})),d(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=O,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(D),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return u.type="throw",u.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var o=i.call(a,"catchLoc"),s=i.call(a,"finallyLoc");if(o&&s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(o){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var u=a?a.completion:{};return u.type=e,u.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(u)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),D(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;D(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:O(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},6015:function(e){function t(n,r){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},7424:function(e,t,n){var r=n(5372),a=n(8872),i=n(6116),u=n(2218);e.exports=function(e,t){return r(e)||a(e,t)||i(e,t)||u()},e.exports.__esModule=!0,e.exports.default=e.exports},861:function(e,t,n){var r=n(3405),a=n(9498),i=n(6116),u=n(2281);e.exports=function(e){return r(e)||a(e)||i(e)||u()},e.exports.__esModule=!0,e.exports.default=e.exports},5036:function(e,t,n){var r=n(8698).default;e.exports=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},4062:function(e,t,n){var r=n(8698).default,a=n(5036);e.exports=function(e){var t=a(e,"string");return"symbol"===r(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},8698:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},6116:function(e,t,n){var r=n(3897);e.exports=function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},3496:function(e,t,n){var r=n(3808),a=n(6015),i=n(6035),u=n(3515);function o(t){var n="function"===typeof Map?new Map:void 0;return e.exports=o=function(e){if(null===e||!i(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return u(e,arguments,r(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),a(t,e)},e.exports.__esModule=!0,e.exports.default=e.exports,o(t)}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},3344:function(e,t,n){var r=n(8698).default,a=n(6015),i=n(1655);function u(){e.exports=u=function(e,t){return new o(e,void 0,t)},e.exports.__esModule=!0,e.exports.default=e.exports;var t=RegExp.prototype,n=new WeakMap;function o(e,t,r){var i=new RegExp(e,t);return n.set(i,r||n.get(e)),a(i,o.prototype)}function s(e,t){var r=n.get(t);return Object.keys(r).reduce((function(t,n){var a=r[n];if("number"==typeof a)t[n]=e[a];else{for(var i=0;void 0===e[a[i]]&&i+1<a.length;)i++;t[n]=e[a[i]]}return t}),Object.create(null))}return i(o,RegExp),o.prototype.exec=function(e){var n=t.exec.call(this,e);if(n){n.groups=s(n,this);var r=n.indices;r&&(r.groups=s(r,this))}return n},o.prototype[Symbol.replace]=function(e,a){if("string"==typeof a){var i=n.get(this);return t[Symbol.replace].call(this,e,a.replace(/\$<([^>]+)>/g,(function(e,t){var n=i[t];return"$"+(Array.isArray(n)?n.join("$"):n)})))}if("function"==typeof a){var u=this;return t[Symbol.replace].call(this,e,(function(){var e=arguments;return"object"!=r(e[e.length-1])&&(e=[].slice.call(e)).push(s(e,u)),a.apply(this,e)}))}return t[Symbol.replace].call(this,e,a)},u.apply(this,arguments)}e.exports=u,e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r](i,i.exports,n),i.loaded=!0,i.exports}n.m=e,n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,r){return n.f[r](e,t),t}),[]))},n.u=function(e){return"static/js/"+e+".8e4701c1.chunk.js"},n.miniCssF=function(e){},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="ai-detective:";n.l=function(r,a,i,u){if(e[r])e[r].push(a);else{var o,s;if(void 0!==i)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var d=c[l];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+i){o=d;break}}o||(s=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+i),o.src=r),e[r]=[a];var f=function(t,n){o.onerror=o.onload=null,clearTimeout(p);var a=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach((function(e){return e(n)})),t)return t(n)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=f.bind(null,o.onerror),o.onload=f.bind(null,o.onload),s&&document.head.appendChild(o)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},n.p="/detective-infinity/",function(){var e={179:0};n.f.j=function(t,r){var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var i=new Promise((function(n,r){a=e[t]=[n,r]}));r.push(a[2]=i);var u=n.p+n.u(t),o=new Error;n.l(u,(function(r){if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=r&&("load"===r.type?"missing":r.type),u=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+u+")",o.name="ChunkLoadError",o.type=i,o.request=u,a[1](o)}}),"chunk-"+t,t)}};var t=function(t,r){var a,i,u=r[0],o=r[1],s=r[2],c=0;if(u.some((function(t){return 0!==e[t]}))){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(s)s(n)}for(t&&t(r);c<u.length;c++)i=u[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunkai_detective=self.webpackChunkai_detective||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}(),function(){"use strict";var e={};n.r(e),n.d(e,{JsonPatchError:function(){return pl},_areEquals:function(){return xl},applyOperation:function(){return gl},applyPatch:function(){return bl},applyReducer:function(){return _l},deepClone:function(){return hl},getValueByPointer:function(){return yl},validate:function(){return wl},validator:function(){return kl}});var t=n(2791),r=n(1250),a="init",i="loading",u="playing",o="finish",s={PROLOGUE:"prologue",WATSON:"watson",SUSPECTS:"suspects",GUESSING:"guessing"},c="watson",l="suspect",d="guessing";function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(){p=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",o=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(F){s=function(e,t,n){return e[t]=n}}function c(e,t,n,a){var i=t&&t.prototype instanceof h?t:h,u=Object.create(i.prototype),o=new D(a||[]);return r(u,"_invoke",{value:x(e,n,o)}),u}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(F){return{type:"throw",arg:F}}}e.wrap=c;var d={};function h(){}function v(){}function m(){}var y={};s(y,i,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(S([])));b&&b!==t&&n.call(b,i)&&(y=b);var _=m.prototype=h.prototype=Object.create(y);function k(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(r,i,u,o){var s=l(e[r],e,i);if("throw"!==s.type){var c=s.arg,d=c.value;return d&&"object"==f(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){a("next",e,u,o)}),(function(e){a("throw",e,u,o)})):t.resolve(d).then((function(e){c.value=e,u(c)}),(function(e){return a("throw",e,u,o)}))}o(s.arg)}var i;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){a(e,n,t,r)}))}return i=i?i.then(r,r):r()}})}function x(e,t,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return O()}for(n.method=a,n.arg=i;;){var u=n.delegate;if(u){var o=E(u,n);if(o){if(o===d)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=l(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var a=l(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,d;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function S(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:O}}function O(){return{value:void 0,done:!0}}return v.prototype=m,r(_,"constructor",{value:m,configurable:!0}),r(m,"constructor",{value:v,configurable:!0}),v.displayName=s(m,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,s(e,o,"GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},k(w.prototype),s(w.prototype,u,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var u=new w(c(t,n,r,a),i);return e.isGeneratorFunction(n)?u:u.next().then((function(e){return e.done?e.value:u.next()}))},k(_),s(_,o,"Generator"),s(_,i,(function(){return this})),s(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=S,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return u.type="throw",u.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],u=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var o=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(o&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var u=i?i.completion:{};return u.type=e,u.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(u)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;C(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function m(e,t){if(e){if("string"===typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function y(e){return function(e){if(Array.isArray(e))return h(e)}(e)||v(e)||m(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t,n,r,a,i,u){try{var o=e[i](u),s=o.value}catch(c){return void n(c)}o.done?t(s):Promise.resolve(s).then(r,a)}function b(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function u(e){g(i,r,a,u,o,"next",e)}function o(e){g(i,r,a,u,o,"throw",e)}u(void 0)}))}}function _(e){if(Array.isArray(e))return e}function k(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function w(e,t){return _(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,u,o=[],s=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(o.push(r.value),o.length!==t);s=!0);}catch(l){c=!0,a=l}finally{try{if(!s&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(c)throw a}}return o}}(e,t)||m(e,t)||k()}var x=function(e){var t,n=new Set,r=function(e,r){var a="function"===typeof e?e(t):e;if(!Object.is(a,t)){var i=t;t=(null!=r?r:"object"!==typeof a||null===a)?a:Object.assign({},t,a),n.forEach((function(e){return e(t,i)}))}},a=function(){return t},i={setState:r,getState:a,getInitialState:function(){return u},subscribe:function(e){return n.add(e),function(){return n.delete(e)}}},u=t=e(r,a,i);return i},E=function(e){return e};var A,C,D=function(e){var n=function(e){return e?x(e):x}(e),r=function(e){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:E,r=t.useSyncExternalStore(e.subscribe,(function(){return n(e.getState())}),(function(){return n(e.getInitialState())}));return t.useDebugValue(r),r}(n,e)};return Object.assign(r,n),r},S=function(e){return e?D(e):D},O=S((function(e){return{scenario:null,updateScenario:function(t){return e({scenario:t})}}}));function F(e){var t=function(e,t){if("object"!==f(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===f(t)?t:String(t)}function P(e,t,n){return(t=F(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,F(r.key),r)}}function I(e,t,n){return t&&j(e.prototype,t),n&&j(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e,t){return R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},R(e,t)}function B(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&R(e,t)}function L(e){return L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},L(e)}function M(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function U(e,t){if(t&&("object"===f(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return N(e)}function z(e){var t=M();return function(){var n,r=L(e);if(t){var a=L(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return U(this,n)}}function H(e,t,n){return H=M()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&R(a,n.prototype),a},H.apply(null,arguments)}function Z(e){var t="function"===typeof Map?new Map:void 0;return Z=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return H(e,arguments,L(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),R(r,e)},Z(e)}function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=m(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){o=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(o)throw i}}}}!function(e){e.assertEqual=function(e){return e},e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=function(e){var t,n={},r=G(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n[a]=a}}catch(i){r.e(i)}finally{r.f()}return n},e.getValidEnumValues=function(t){var n,r=e.objectKeys(t).filter((function(e){return"number"!==typeof t[t[e]]})),a={},i=G(r);try{for(i.s();!(n=i.n()).done;){var u=n.value;a[u]=t[u]}}catch(o){i.e(o)}finally{i.f()}return e.objectValues(a)},e.objectValues=function(t){return e.objectKeys(t).map((function(e){return t[e]}))},e.objectKeys="function"===typeof Object.keys?function(e){return Object.keys(e)}:function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},e.find=function(e,t){var n,r=G(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(t(a))return a}}catch(i){r.e(i)}finally{r.f()}},e.isInteger="function"===typeof Number.isInteger?function(e){return Number.isInteger(e)}:function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e},e.joinValues=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" | ";return e.map((function(e){return"string"===typeof e?"'".concat(e,"'"):e})).join(t)},e.jsonStringifyReplacer=function(e,t){return"bigint"===typeof t?t.toString():t}}(A||(A={})),function(e){e.mergeShapes=function(e,t){return q(q({},e),t)}}(C||(C={}));var V=A.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),$=function(e){switch(typeof e){case"undefined":return V.undefined;case"string":return V.string;case"number":return isNaN(e)?V.nan:V.number;case"boolean":return V.boolean;case"function":return V.function;case"bigint":return V.bigint;case"symbol":return V.symbol;case"object":return Array.isArray(e)?V.array:null===e?V.null:e.then&&"function"===typeof e.then&&e.catch&&"function"===typeof e.catch?V.promise:"undefined"!==typeof Map&&e instanceof Map?V.map:"undefined"!==typeof Set&&e instanceof Set?V.set:"undefined"!==typeof Date&&e instanceof Date?V.date:V.object;default:return V.unknown}},J=A.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),K=function(e){B(n,e);var t=z(n);function n(e){var r;T(this,n),(r=t.call(this)).issues=[],r.addIssue=function(e){r.issues=[].concat(y(r.issues),[e])},r.addIssues=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];r.issues=[].concat(y(r.issues),y(e))};var a=(this instanceof n?this.constructor:void 0).prototype;return Object.setPrototypeOf?Object.setPrototypeOf(N(r),a):r.__proto__=a,r.name="ZodError",r.issues=e,r}return I(n,[{key:"errors",get:function(){return this.issues}},{key:"format",value:function(e){var t=e||function(e){return e.message},n={_errors:[]};return function e(r){var a,i=G(r.issues);try{for(i.s();!(a=i.n()).done;){var u=a.value;if("invalid_union"===u.code)u.unionErrors.map(e);else if("invalid_return_type"===u.code)e(u.returnTypeError);else if("invalid_arguments"===u.code)e(u.argumentsError);else if(0===u.path.length)n._errors.push(t(u));else for(var o=n,s=0;s<u.path.length;){var c=u.path[s];s===u.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(t(u))):o[c]=o[c]||{_errors:[]},o=o[c],s++}}}catch(l){i.e(l)}finally{i.f()}}(this),n}},{key:"toString",value:function(){return this.message}},{key:"message",get:function(){return JSON.stringify(this.issues,A.jsonStringifyReplacer,2)}},{key:"isEmpty",get:function(){return 0===this.issues.length}},{key:"flatten",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e.message},n={},r=[],a=G(this.issues);try{for(a.s();!(e=a.n()).done;){var i=e.value;i.path.length>0?(n[i.path[0]]=n[i.path[0]]||[],n[i.path[0]].push(t(i))):r.push(t(i))}}catch(u){a.e(u)}finally{a.f()}return{formErrors:r,fieldErrors:n}}},{key:"formErrors",get:function(){return this.flatten()}}],[{key:"assert",value:function(e){if(!(e instanceof n))throw new Error("Not a ZodError: ".concat(e))}}]),n}(Z(Error));K.create=function(e){return new K(e)};var Q=function(e,t){var n;switch(e.code){case J.invalid_type:n=e.received===V.undefined?"Required":"Expected ".concat(e.expected,", received ").concat(e.received);break;case J.invalid_literal:n="Invalid literal value, expected ".concat(JSON.stringify(e.expected,A.jsonStringifyReplacer));break;case J.unrecognized_keys:n="Unrecognized key(s) in object: ".concat(A.joinValues(e.keys,", "));break;case J.invalid_union:n="Invalid input";break;case J.invalid_union_discriminator:n="Invalid discriminator value. Expected ".concat(A.joinValues(e.options));break;case J.invalid_enum_value:n="Invalid enum value. Expected ".concat(A.joinValues(e.options),", received '").concat(e.received,"'");break;case J.invalid_arguments:n="Invalid function arguments";break;case J.invalid_return_type:n="Invalid function return type";break;case J.invalid_date:n="Invalid date";break;case J.invalid_string:"object"===typeof e.validation?"includes"in e.validation?(n='Invalid input: must include "'.concat(e.validation.includes,'"'),"number"===typeof e.validation.position&&(n="".concat(n," at one or more positions greater than or equal to ").concat(e.validation.position))):"startsWith"in e.validation?n='Invalid input: must start with "'.concat(e.validation.startsWith,'"'):"endsWith"in e.validation?n='Invalid input: must end with "'.concat(e.validation.endsWith,'"'):A.assertNever(e.validation):n="regex"!==e.validation?"Invalid ".concat(e.validation):"Invalid";break;case J.too_small:n="array"===e.type?"Array must contain ".concat(e.exact?"exactly":e.inclusive?"at least":"more than"," ").concat(e.minimum," element(s)"):"string"===e.type?"String must contain ".concat(e.exact?"exactly":e.inclusive?"at least":"over"," ").concat(e.minimum," character(s)"):"number"===e.type?"Number must be ".concat(e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than ").concat(e.minimum):"date"===e.type?"Date must be ".concat(e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than ").concat(new Date(Number(e.minimum))):"Invalid input";break;case J.too_big:n="array"===e.type?"Array must contain ".concat(e.exact?"exactly":e.inclusive?"at most":"less than"," ").concat(e.maximum," element(s)"):"string"===e.type?"String must contain ".concat(e.exact?"exactly":e.inclusive?"at most":"under"," ").concat(e.maximum," character(s)"):"number"===e.type?"Number must be ".concat(e.exact?"exactly":e.inclusive?"less than or equal to":"less than"," ").concat(e.maximum):"bigint"===e.type?"BigInt must be ".concat(e.exact?"exactly":e.inclusive?"less than or equal to":"less than"," ").concat(e.maximum):"date"===e.type?"Date must be ".concat(e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"," ").concat(new Date(Number(e.maximum))):"Invalid input";break;case J.custom:n="Invalid input";break;case J.invalid_intersection_types:n="Intersection results could not be merged";break;case J.not_multiple_of:n="Number must be a multiple of ".concat(e.multipleOf);break;case J.not_finite:n="Number must be finite";break;default:n=t.defaultError,A.assertNever(e)}return{message:n}},X=Q;function Y(){return X}var ee=function(e){var t=e.data,n=e.path,r=e.errorMaps,a=e.issueData,i=[].concat(y(n),y(a.path||[])),u=q(q({},a),{},{path:i});if(void 0!==a.message)return q(q({},a),{},{path:i,message:a.message});var o,s="",c=G(r.filter((function(e){return!!e})).slice().reverse());try{for(c.s();!(o=c.n()).done;){s=(0,o.value)(u,{data:t,defaultError:s}).message}}catch(l){c.e(l)}finally{c.f()}return q(q({},a),{},{path:i,message:s})};function te(e,t){var n=Y(),r=ee({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===Q?void 0:Q].filter((function(e){return!!e}))});e.common.issues.push(r)}var ne,re,ae,ie=function(){function e(){T(this,e),this.value="valid"}return I(e,[{key:"dirty",value:function(){"valid"===this.value&&(this.value="dirty")}},{key:"abort",value:function(){"aborted"!==this.value&&(this.value="aborted")}}],[{key:"mergeArray",value:function(e,t){var n,r=[],a=G(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;if("aborted"===i.status)return ue;"dirty"===i.status&&e.dirty(),r.push(i.value)}}catch(u){a.e(u)}finally{a.f()}return{status:e.value,value:r}}},{key:"mergeObjectAsync",value:function(){var t=b(p().mark((function t(n,r){var a,i,u,o,s,c;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=[],i=G(r),t.prev=2,i.s();case 4:if((u=i.n()).done){t.next=15;break}return o=u.value,t.next=8,o.key;case 8:return s=t.sent,t.next=11,o.value;case 11:c=t.sent,a.push({key:s,value:c});case 13:t.next=4;break;case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(2),i.e(t.t0);case 20:return t.prev=20,i.f(),t.finish(20);case 23:return t.abrupt("return",e.mergeObjectSync(n,a));case 24:case"end":return t.stop()}}),t,null,[[2,17,20,23]])})));return function(e,n){return t.apply(this,arguments)}}()},{key:"mergeObjectSync",value:function(e,t){var n,r={},a=G(t);try{for(a.s();!(n=a.n()).done;){var i=n.value,u=i.key,o=i.value;if("aborted"===u.status)return ue;if("aborted"===o.status)return ue;"dirty"===u.status&&e.dirty(),"dirty"===o.status&&e.dirty(),"__proto__"===u.value||"undefined"===typeof o.value&&!i.alwaysSet||(r[u.value]=o.value)}}catch(s){a.e(s)}finally{a.f()}return{status:e.value,value:r}}}]),e}(),ue=Object.freeze({status:"aborted"}),oe=function(e){return{status:"dirty",value:e}},se=function(e){return{status:"valid",value:e}},ce=function(e){return"aborted"===e.status},le=function(e){return"dirty"===e.status},de=function(e){return"valid"===e.status},fe=function(e){return"undefined"!==typeof Promise&&e instanceof Promise};function pe(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function he(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n}"function"===typeof SuppressedError&&SuppressedError,function(e){e.errToObj=function(e){return"string"===typeof e?{message:e}:e||{}},e.toString=function(e){return"string"===typeof e?e:null===e||void 0===e?void 0:e.message}}(ne||(ne={}));var ve=function(){function e(t,n,r,a){T(this,e),this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=a}return I(e,[{key:"path",get:function(){var e,t;this._cachedPath.length||(this._key instanceof Array?(e=this._cachedPath).push.apply(e,y(this._path).concat(y(this._key))):(t=this._cachedPath).push.apply(t,y(this._path).concat([this._key])));return this._cachedPath}}]),e}(),me=function(e,t){if(de(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;var t=new K(e.common.issues);return this._error=t,this._error}}};function ye(e){if(!e)return{};var t=e.errorMap,n=e.invalid_type_error,r=e.required_error,a=e.description;if(t&&(n||r))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:a};return{errorMap:function(t,a){var i,u,o=e.message;return"invalid_enum_value"===t.code?{message:null!==o&&void 0!==o?o:a.defaultError}:"undefined"===typeof a.data?{message:null!==(i=null!==o&&void 0!==o?o:r)&&void 0!==i?i:a.defaultError}:"invalid_type"!==t.code?{message:a.defaultError}:{message:null!==(u=null!==o&&void 0!==o?o:n)&&void 0!==u?u:a.defaultError}},description:a}}var ge,be=function(){function e(t){var n=this;T(this,e),this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:function(e){return n["~validate"](e)}}}return I(e,[{key:"description",get:function(){return this._def.description}},{key:"_getType",value:function(e){return $(e.data)}},{key:"_getOrReturnCtx",value:function(e,t){return t||{common:e.parent.common,data:e.data,parsedType:$(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}},{key:"_processInputParams",value:function(e){return{status:new ie,ctx:{common:e.parent.common,data:e.data,parsedType:$(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}},{key:"_parseSync",value:function(e){var t=this._parse(e);if(fe(t))throw new Error("Synchronous parse encountered promise.");return t}},{key:"_parseAsync",value:function(e){var t=this._parse(e);return Promise.resolve(t)}},{key:"parse",value:function(e,t){var n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}},{key:"safeParse",value:function(e,t){var n,r={common:{issues:[],async:null!==(n=null===t||void 0===t?void 0:t.async)&&void 0!==n&&n,contextualErrorMap:null===t||void 0===t?void 0:t.errorMap},path:(null===t||void 0===t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:$(e)},a=this._parseSync({data:e,path:r.path,parent:r});return me(r,a)}},{key:"~validate",value:function(e){var t,n,r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:$(e)};if(!this["~standard"].async)try{var a=this._parseSync({data:e,path:[],parent:r});return de(a)?{value:a.value}:{issues:r.common.issues}}catch(i){(null===(n=null===(t=null===i||void 0===i?void 0:i.message)||void 0===t?void 0:t.toLowerCase())||void 0===n?void 0:n.includes("encountered"))&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then((function(e){return de(e)?{value:e.value}:{issues:r.common.issues}}))}},{key:"parseAsync",value:function(){var e=b(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.safeParseAsync(t,n);case 2:if(!(r=e.sent).success){e.next=5;break}return e.abrupt("return",r.data);case 5:throw r.error;case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"safeParseAsync",value:function(){var e=b(p().mark((function e(t,n){var r,a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={common:{issues:[],contextualErrorMap:null===n||void 0===n?void 0:n.errorMap,async:!0},path:(null===n||void 0===n?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:$(t)},a=this._parse({data:t,path:r.path,parent:r}),e.next=4,fe(a)?a:Promise.resolve(a);case 4:return i=e.sent,e.abrupt("return",me(r,i));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"refine",value:function(e,t){return this._refinement((function(n,r){var a=e(n),i=function(){return r.addIssue(q({code:J.custom},function(e){return"string"===typeof t||"undefined"===typeof t?{message:t}:"function"===typeof t?t(e):t}(n)))};return"undefined"!==typeof Promise&&a instanceof Promise?a.then((function(e){return!!e||(i(),!1)})):!!a||(i(),!1)}))}},{key:"refinement",value:function(e,t){return this._refinement((function(n,r){return!!e(n)||(r.addIssue("function"===typeof t?t(n,r):t),!1)}))}},{key:"_refinement",value:function(e){return new gt({schema:this,typeName:Ft.ZodEffects,effect:{type:"refinement",refinement:e}})}},{key:"superRefine",value:function(e){return this._refinement(e)}},{key:"optional",value:function(){return bt.create(this,this._def)}},{key:"nullable",value:function(){return _t.create(this,this._def)}},{key:"nullish",value:function(){return this.nullable().optional()}},{key:"array",value:function(){return Ye.create(this)}},{key:"promise",value:function(){return yt.create(this,this._def)}},{key:"or",value:function(e){return nt.create([this,e],this._def)}},{key:"and",value:function(e){return ut.create(this,e,this._def)}},{key:"transform",value:function(e){return new gt(q(q({},ye(this._def)),{},{schema:this,typeName:Ft.ZodEffects,effect:{type:"transform",transform:e}}))}},{key:"default",value:function(e){var t="function"===typeof e?e:function(){return e};return new kt(q(q({},ye(this._def)),{},{innerType:this,defaultValue:t,typeName:Ft.ZodDefault}))}},{key:"brand",value:function(){return new At(q({typeName:Ft.ZodBranded,type:this},ye(this._def)))}},{key:"catch",value:function(e){var t="function"===typeof e?e:function(){return e};return new wt(q(q({},ye(this._def)),{},{innerType:this,catchValue:t,typeName:Ft.ZodCatch}))}},{key:"describe",value:function(e){return new(0,this.constructor)(q(q({},this._def),{},{description:e}))}},{key:"pipe",value:function(e){return Ct.create(this,e)}},{key:"readonly",value:function(){return Dt.create(this)}},{key:"isOptional",value:function(){return this.safeParse(void 0).success}},{key:"isNullable",value:function(){return this.safeParse(null).success}}]),e}(),_e=/^c[^\s-]{8,}$/i,ke=/^[0-9a-z]+$/,we=/^[0-9A-HJKMNP-TV-Z]{26}$/i,xe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Ee=/^[a-z0-9_-]{21}$/i,Ae=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Ce=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,De=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Se=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Oe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Fe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Pe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Te=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,je=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Ie="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Ne=new RegExp("^".concat(Ie,"$"));function Re(e){var t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t="".concat(t,"\\.\\d{").concat(e.precision,"}"):null==e.precision&&(t="".concat(t,"(\\.\\d+)?")),t}function Be(e){var t="".concat(Ie,"T").concat(Re(e)),n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t="".concat(t,"(").concat(n.join("|"),")"),new RegExp("^".concat(t,"$"))}function Le(e,t){if(!Ae.test(e))return!1;try{var n=w(e.split("."),1)[0],r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),a=JSON.parse(atob(r));return"object"===typeof a&&null!==a&&(!(!a.typ||!a.alg)&&(!t||a.alg===t))}catch(Mo){return!1}}function Me(e,t){return!("v4"!==t&&t||!Oe.test(e))||!("v6"!==t&&t||!Pe.test(e))}var Ue=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==V.string){var t=this._getOrReturnCtx(e);return te(t,{code:J.invalid_type,expected:V.string,received:t.parsedType}),ue}var n,r,a,i=new ie,u=void 0,o=G(this._def.checks);try{for(o.s();!(n=o.n()).done;){var s=n.value;if("min"===s.kind)e.data.length<s.value&&(te(u=this._getOrReturnCtx(e,u),{code:J.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),i.dirty());else if("max"===s.kind)e.data.length>s.value&&(te(u=this._getOrReturnCtx(e,u),{code:J.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),i.dirty());else if("length"===s.kind){var c=e.data.length>s.value,l=e.data.length<s.value;(c||l)&&(u=this._getOrReturnCtx(e,u),c?te(u,{code:J.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):l&&te(u,{code:J.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),i.dirty())}else if("email"===s.kind)De.test(e.data)||(te(u=this._getOrReturnCtx(e,u),{validation:"email",code:J.invalid_string,message:s.message}),i.dirty());else if("emoji"===s.kind)ge||(ge=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),ge.test(e.data)||(te(u=this._getOrReturnCtx(e,u),{validation:"emoji",code:J.invalid_string,message:s.message}),i.dirty());else if("uuid"===s.kind)xe.test(e.data)||(te(u=this._getOrReturnCtx(e,u),{validation:"uuid",code:J.invalid_string,message:s.message}),i.dirty());else if("nanoid"===s.kind)Ee.test(e.data)||(te(u=this._getOrReturnCtx(e,u),{validation:"nanoid",code:J.invalid_string,message:s.message}),i.dirty());else if("cuid"===s.kind)_e.test(e.data)||(te(u=this._getOrReturnCtx(e,u),{validation:"cuid",code:J.invalid_string,message:s.message}),i.dirty());else if("cuid2"===s.kind)ke.test(e.data)||(te(u=this._getOrReturnCtx(e,u),{validation:"cuid2",code:J.invalid_string,message:s.message}),i.dirty());else if("ulid"===s.kind)we.test(e.data)||(te(u=this._getOrReturnCtx(e,u),{validation:"ulid",code:J.invalid_string,message:s.message}),i.dirty());else if("url"===s.kind)try{new URL(e.data)}catch(Mo){te(u=this._getOrReturnCtx(e,u),{validation:"url",code:J.invalid_string,message:s.message}),i.dirty()}else if("regex"===s.kind){s.regex.lastIndex=0,s.regex.test(e.data)||(te(u=this._getOrReturnCtx(e,u),{validation:"regex",code:J.invalid_string,message:s.message}),i.dirty())}else if("trim"===s.kind)e.data=e.data.trim();else if("includes"===s.kind)e.data.includes(s.value,s.position)||(te(u=this._getOrReturnCtx(e,u),{code:J.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),i.dirty());else if("toLowerCase"===s.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===s.kind)e.data=e.data.toUpperCase();else if("startsWith"===s.kind)e.data.startsWith(s.value)||(te(u=this._getOrReturnCtx(e,u),{code:J.invalid_string,validation:{startsWith:s.value},message:s.message}),i.dirty());else if("endsWith"===s.kind)e.data.endsWith(s.value)||(te(u=this._getOrReturnCtx(e,u),{code:J.invalid_string,validation:{endsWith:s.value},message:s.message}),i.dirty());else if("datetime"===s.kind){Be(s).test(e.data)||(te(u=this._getOrReturnCtx(e,u),{code:J.invalid_string,validation:"datetime",message:s.message}),i.dirty())}else if("date"===s.kind){Ne.test(e.data)||(te(u=this._getOrReturnCtx(e,u),{code:J.invalid_string,validation:"date",message:s.message}),i.dirty())}else if("time"===s.kind){new RegExp("^".concat(Re(s),"$")).test(e.data)||(te(u=this._getOrReturnCtx(e,u),{code:J.invalid_string,validation:"time",message:s.message}),i.dirty())}else"duration"===s.kind?Ce.test(e.data)||(te(u=this._getOrReturnCtx(e,u),{validation:"duration",code:J.invalid_string,message:s.message}),i.dirty()):"ip"===s.kind?(r=e.data,("v4"!==(a=s.version)&&a||!Se.test(r))&&("v6"!==a&&a||!Fe.test(r))&&(te(u=this._getOrReturnCtx(e,u),{validation:"ip",code:J.invalid_string,message:s.message}),i.dirty())):"jwt"===s.kind?Le(e.data,s.alg)||(te(u=this._getOrReturnCtx(e,u),{validation:"jwt",code:J.invalid_string,message:s.message}),i.dirty()):"cidr"===s.kind?Me(e.data,s.version)||(te(u=this._getOrReturnCtx(e,u),{validation:"cidr",code:J.invalid_string,message:s.message}),i.dirty()):"base64"===s.kind?Te.test(e.data)||(te(u=this._getOrReturnCtx(e,u),{validation:"base64",code:J.invalid_string,message:s.message}),i.dirty()):"base64url"===s.kind?je.test(e.data)||(te(u=this._getOrReturnCtx(e,u),{validation:"base64url",code:J.invalid_string,message:s.message}),i.dirty()):A.assertNever(s)}}catch(d){o.e(d)}finally{o.f()}return{status:i.value,value:e.data}}},{key:"_regex",value:function(e,t,n){return this.refinement((function(t){return e.test(t)}),q({validation:t,code:J.invalid_string},ne.errToObj(n)))}},{key:"_addCheck",value:function(e){return new n(q(q({},this._def),{},{checks:[].concat(y(this._def.checks),[e])}))}},{key:"email",value:function(e){return this._addCheck(q({kind:"email"},ne.errToObj(e)))}},{key:"url",value:function(e){return this._addCheck(q({kind:"url"},ne.errToObj(e)))}},{key:"emoji",value:function(e){return this._addCheck(q({kind:"emoji"},ne.errToObj(e)))}},{key:"uuid",value:function(e){return this._addCheck(q({kind:"uuid"},ne.errToObj(e)))}},{key:"nanoid",value:function(e){return this._addCheck(q({kind:"nanoid"},ne.errToObj(e)))}},{key:"cuid",value:function(e){return this._addCheck(q({kind:"cuid"},ne.errToObj(e)))}},{key:"cuid2",value:function(e){return this._addCheck(q({kind:"cuid2"},ne.errToObj(e)))}},{key:"ulid",value:function(e){return this._addCheck(q({kind:"ulid"},ne.errToObj(e)))}},{key:"base64",value:function(e){return this._addCheck(q({kind:"base64"},ne.errToObj(e)))}},{key:"base64url",value:function(e){return this._addCheck(q({kind:"base64url"},ne.errToObj(e)))}},{key:"jwt",value:function(e){return this._addCheck(q({kind:"jwt"},ne.errToObj(e)))}},{key:"ip",value:function(e){return this._addCheck(q({kind:"ip"},ne.errToObj(e)))}},{key:"cidr",value:function(e){return this._addCheck(q({kind:"cidr"},ne.errToObj(e)))}},{key:"datetime",value:function(e){var t,n;return"string"===typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck(q({kind:"datetime",precision:"undefined"===typeof(null===e||void 0===e?void 0:e.precision)?null:null===e||void 0===e?void 0:e.precision,offset:null!==(t=null===e||void 0===e?void 0:e.offset)&&void 0!==t&&t,local:null!==(n=null===e||void 0===e?void 0:e.local)&&void 0!==n&&n},ne.errToObj(null===e||void 0===e?void 0:e.message)))}},{key:"date",value:function(e){return this._addCheck({kind:"date",message:e})}},{key:"time",value:function(e){return"string"===typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck(q({kind:"time",precision:"undefined"===typeof(null===e||void 0===e?void 0:e.precision)?null:null===e||void 0===e?void 0:e.precision},ne.errToObj(null===e||void 0===e?void 0:e.message)))}},{key:"duration",value:function(e){return this._addCheck(q({kind:"duration"},ne.errToObj(e)))}},{key:"regex",value:function(e,t){return this._addCheck(q({kind:"regex",regex:e},ne.errToObj(t)))}},{key:"includes",value:function(e,t){return this._addCheck(q({kind:"includes",value:e,position:null===t||void 0===t?void 0:t.position},ne.errToObj(null===t||void 0===t?void 0:t.message)))}},{key:"startsWith",value:function(e,t){return this._addCheck(q({kind:"startsWith",value:e},ne.errToObj(t)))}},{key:"endsWith",value:function(e,t){return this._addCheck(q({kind:"endsWith",value:e},ne.errToObj(t)))}},{key:"min",value:function(e,t){return this._addCheck(q({kind:"min",value:e},ne.errToObj(t)))}},{key:"max",value:function(e,t){return this._addCheck(q({kind:"max",value:e},ne.errToObj(t)))}},{key:"length",value:function(e,t){return this._addCheck(q({kind:"length",value:e},ne.errToObj(t)))}},{key:"nonempty",value:function(e){return this.min(1,ne.errToObj(e))}},{key:"trim",value:function(){return new n(q(q({},this._def),{},{checks:[].concat(y(this._def.checks),[{kind:"trim"}])}))}},{key:"toLowerCase",value:function(){return new n(q(q({},this._def),{},{checks:[].concat(y(this._def.checks),[{kind:"toLowerCase"}])}))}},{key:"toUpperCase",value:function(){return new n(q(q({},this._def),{},{checks:[].concat(y(this._def.checks),[{kind:"toUpperCase"}])}))}},{key:"isDatetime",get:function(){return!!this._def.checks.find((function(e){return"datetime"===e.kind}))}},{key:"isDate",get:function(){return!!this._def.checks.find((function(e){return"date"===e.kind}))}},{key:"isTime",get:function(){return!!this._def.checks.find((function(e){return"time"===e.kind}))}},{key:"isDuration",get:function(){return!!this._def.checks.find((function(e){return"duration"===e.kind}))}},{key:"isEmail",get:function(){return!!this._def.checks.find((function(e){return"email"===e.kind}))}},{key:"isURL",get:function(){return!!this._def.checks.find((function(e){return"url"===e.kind}))}},{key:"isEmoji",get:function(){return!!this._def.checks.find((function(e){return"emoji"===e.kind}))}},{key:"isUUID",get:function(){return!!this._def.checks.find((function(e){return"uuid"===e.kind}))}},{key:"isNANOID",get:function(){return!!this._def.checks.find((function(e){return"nanoid"===e.kind}))}},{key:"isCUID",get:function(){return!!this._def.checks.find((function(e){return"cuid"===e.kind}))}},{key:"isCUID2",get:function(){return!!this._def.checks.find((function(e){return"cuid2"===e.kind}))}},{key:"isULID",get:function(){return!!this._def.checks.find((function(e){return"ulid"===e.kind}))}},{key:"isIP",get:function(){return!!this._def.checks.find((function(e){return"ip"===e.kind}))}},{key:"isCIDR",get:function(){return!!this._def.checks.find((function(e){return"cidr"===e.kind}))}},{key:"isBase64",get:function(){return!!this._def.checks.find((function(e){return"base64"===e.kind}))}},{key:"isBase64url",get:function(){return!!this._def.checks.find((function(e){return"base64url"===e.kind}))}},{key:"minLength",get:function(){var e,t=null,n=G(this._def.checks);try{for(n.s();!(e=n.n()).done;){var r=e.value;"min"===r.kind&&(null===t||r.value>t)&&(t=r.value)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"maxLength",get:function(){var e,t=null,n=G(this._def.checks);try{for(n.s();!(e=n.n()).done;){var r=e.value;"max"===r.kind&&(null===t||r.value<t)&&(t=r.value)}}catch(a){n.e(a)}finally{n.f()}return t}}]),n}(be);function ze(e,t){var n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,a=n>r?n:r;return parseInt(e.toFixed(a).replace(".",""))%parseInt(t.toFixed(a).replace(".",""))/Math.pow(10,a)}Ue.create=function(e){var t;return new Ue(q({checks:[],typeName:Ft.ZodString,coerce:null!==(t=null===e||void 0===e?void 0:e.coerce)&&void 0!==t&&t},ye(e)))};var He=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).min=e.gte,e.max=e.lte,e.step=e.multipleOf,e}return I(n,[{key:"_parse",value:function(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==V.number){var t=this._getOrReturnCtx(e);return te(t,{code:J.invalid_type,expected:V.number,received:t.parsedType}),ue}var n,r=void 0,a=new ie,i=G(this._def.checks);try{for(i.s();!(n=i.n()).done;){var u=n.value;if("int"===u.kind)A.isInteger(e.data)||(te(r=this._getOrReturnCtx(e,r),{code:J.invalid_type,expected:"integer",received:"float",message:u.message}),a.dirty());else if("min"===u.kind){(u.inclusive?e.data<u.value:e.data<=u.value)&&(te(r=this._getOrReturnCtx(e,r),{code:J.too_small,minimum:u.value,type:"number",inclusive:u.inclusive,exact:!1,message:u.message}),a.dirty())}else if("max"===u.kind){(u.inclusive?e.data>u.value:e.data>=u.value)&&(te(r=this._getOrReturnCtx(e,r),{code:J.too_big,maximum:u.value,type:"number",inclusive:u.inclusive,exact:!1,message:u.message}),a.dirty())}else"multipleOf"===u.kind?0!==ze(e.data,u.value)&&(te(r=this._getOrReturnCtx(e,r),{code:J.not_multiple_of,multipleOf:u.value,message:u.message}),a.dirty()):"finite"===u.kind?Number.isFinite(e.data)||(te(r=this._getOrReturnCtx(e,r),{code:J.not_finite,message:u.message}),a.dirty()):A.assertNever(u)}}catch(o){i.e(o)}finally{i.f()}return{status:a.value,value:e.data}}},{key:"gte",value:function(e,t){return this.setLimit("min",e,!0,ne.toString(t))}},{key:"gt",value:function(e,t){return this.setLimit("min",e,!1,ne.toString(t))}},{key:"lte",value:function(e,t){return this.setLimit("max",e,!0,ne.toString(t))}},{key:"lt",value:function(e,t){return this.setLimit("max",e,!1,ne.toString(t))}},{key:"setLimit",value:function(e,t,r,a){return new n(q(q({},this._def),{},{checks:[].concat(y(this._def.checks),[{kind:e,value:t,inclusive:r,message:ne.toString(a)}])}))}},{key:"_addCheck",value:function(e){return new n(q(q({},this._def),{},{checks:[].concat(y(this._def.checks),[e])}))}},{key:"int",value:function(e){return this._addCheck({kind:"int",message:ne.toString(e)})}},{key:"positive",value:function(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ne.toString(e)})}},{key:"negative",value:function(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ne.toString(e)})}},{key:"nonpositive",value:function(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ne.toString(e)})}},{key:"nonnegative",value:function(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ne.toString(e)})}},{key:"multipleOf",value:function(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ne.toString(t)})}},{key:"finite",value:function(e){return this._addCheck({kind:"finite",message:ne.toString(e)})}},{key:"safe",value:function(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ne.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ne.toString(e)})}},{key:"minValue",get:function(){var e,t=null,n=G(this._def.checks);try{for(n.s();!(e=n.n()).done;){var r=e.value;"min"===r.kind&&(null===t||r.value>t)&&(t=r.value)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"maxValue",get:function(){var e,t=null,n=G(this._def.checks);try{for(n.s();!(e=n.n()).done;){var r=e.value;"max"===r.kind&&(null===t||r.value<t)&&(t=r.value)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"isInt",get:function(){return!!this._def.checks.find((function(e){return"int"===e.kind||"multipleOf"===e.kind&&A.isInteger(e.value)}))}},{key:"isFinite",get:function(){var e,t=null,n=null,r=G(this._def.checks);try{for(r.s();!(e=r.n()).done;){var a=e.value;if("finite"===a.kind||"int"===a.kind||"multipleOf"===a.kind)return!0;"min"===a.kind?(null===n||a.value>n)&&(n=a.value):"max"===a.kind&&(null===t||a.value<t)&&(t=a.value)}}catch(i){r.e(i)}finally{r.f()}return Number.isFinite(n)&&Number.isFinite(t)}}]),n}(be);He.create=function(e){return new He(q({checks:[],typeName:Ft.ZodNumber,coerce:(null===e||void 0===e?void 0:e.coerce)||!1},ye(e)))};var Ze=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).min=e.gte,e.max=e.lte,e}return I(n,[{key:"_parse",value:function(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch(Mo){return this._getInvalidInput(e)}if(this._getType(e)!==V.bigint)return this._getInvalidInput(e);var t,n=void 0,r=new ie,a=G(this._def.checks);try{for(a.s();!(t=a.n()).done;){var i=t.value;if("min"===i.kind)(i.inclusive?e.data<i.value:e.data<=i.value)&&(te(n=this._getOrReturnCtx(e,n),{code:J.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty());else if("max"===i.kind){(i.inclusive?e.data>i.value:e.data>=i.value)&&(te(n=this._getOrReturnCtx(e,n),{code:J.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty())}else"multipleOf"===i.kind?e.data%i.value!==BigInt(0)&&(te(n=this._getOrReturnCtx(e,n),{code:J.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):A.assertNever(i)}}catch(u){a.e(u)}finally{a.f()}return{status:r.value,value:e.data}}},{key:"_getInvalidInput",value:function(e){var t=this._getOrReturnCtx(e);return te(t,{code:J.invalid_type,expected:V.bigint,received:t.parsedType}),ue}},{key:"gte",value:function(e,t){return this.setLimit("min",e,!0,ne.toString(t))}},{key:"gt",value:function(e,t){return this.setLimit("min",e,!1,ne.toString(t))}},{key:"lte",value:function(e,t){return this.setLimit("max",e,!0,ne.toString(t))}},{key:"lt",value:function(e,t){return this.setLimit("max",e,!1,ne.toString(t))}},{key:"setLimit",value:function(e,t,r,a){return new n(q(q({},this._def),{},{checks:[].concat(y(this._def.checks),[{kind:e,value:t,inclusive:r,message:ne.toString(a)}])}))}},{key:"_addCheck",value:function(e){return new n(q(q({},this._def),{},{checks:[].concat(y(this._def.checks),[e])}))}},{key:"positive",value:function(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ne.toString(e)})}},{key:"negative",value:function(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ne.toString(e)})}},{key:"nonpositive",value:function(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ne.toString(e)})}},{key:"nonnegative",value:function(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ne.toString(e)})}},{key:"multipleOf",value:function(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ne.toString(t)})}},{key:"minValue",get:function(){var e,t=null,n=G(this._def.checks);try{for(n.s();!(e=n.n()).done;){var r=e.value;"min"===r.kind&&(null===t||r.value>t)&&(t=r.value)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"maxValue",get:function(){var e,t=null,n=G(this._def.checks);try{for(n.s();!(e=n.n()).done;){var r=e.value;"max"===r.kind&&(null===t||r.value<t)&&(t=r.value)}}catch(a){n.e(a)}finally{n.f()}return t}}]),n}(be);Ze.create=function(e){var t;return new Ze(q({checks:[],typeName:Ft.ZodBigInt,coerce:null!==(t=null===e||void 0===e?void 0:e.coerce)&&void 0!==t&&t},ye(e)))};var We=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){if(this._def.coerce&&(e.data=Boolean(e.data)),this._getType(e)!==V.boolean){var t=this._getOrReturnCtx(e);return te(t,{code:J.invalid_type,expected:V.boolean,received:t.parsedType}),ue}return se(e.data)}}]),n}(be);We.create=function(e){return new We(q({typeName:Ft.ZodBoolean,coerce:(null===e||void 0===e?void 0:e.coerce)||!1},ye(e)))};var qe=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==V.date){var t=this._getOrReturnCtx(e);return te(t,{code:J.invalid_type,expected:V.date,received:t.parsedType}),ue}if(isNaN(e.data.getTime()))return te(this._getOrReturnCtx(e),{code:J.invalid_date}),ue;var n,r=new ie,a=void 0,i=G(this._def.checks);try{for(i.s();!(n=i.n()).done;){var u=n.value;"min"===u.kind?e.data.getTime()<u.value&&(te(a=this._getOrReturnCtx(e,a),{code:J.too_small,message:u.message,inclusive:!0,exact:!1,minimum:u.value,type:"date"}),r.dirty()):"max"===u.kind?e.data.getTime()>u.value&&(te(a=this._getOrReturnCtx(e,a),{code:J.too_big,message:u.message,inclusive:!0,exact:!1,maximum:u.value,type:"date"}),r.dirty()):A.assertNever(u)}}catch(o){i.e(o)}finally{i.f()}return{status:r.value,value:new Date(e.data.getTime())}}},{key:"_addCheck",value:function(e){return new n(q(q({},this._def),{},{checks:[].concat(y(this._def.checks),[e])}))}},{key:"min",value:function(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:ne.toString(t)})}},{key:"max",value:function(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:ne.toString(t)})}},{key:"minDate",get:function(){var e,t=null,n=G(this._def.checks);try{for(n.s();!(e=n.n()).done;){var r=e.value;"min"===r.kind&&(null===t||r.value>t)&&(t=r.value)}}catch(a){n.e(a)}finally{n.f()}return null!=t?new Date(t):null}},{key:"maxDate",get:function(){var e,t=null,n=G(this._def.checks);try{for(n.s();!(e=n.n()).done;){var r=e.value;"max"===r.kind&&(null===t||r.value<t)&&(t=r.value)}}catch(a){n.e(a)}finally{n.f()}return null!=t?new Date(t):null}}]),n}(be);qe.create=function(e){return new qe(q({checks:[],coerce:(null===e||void 0===e?void 0:e.coerce)||!1,typeName:Ft.ZodDate},ye(e)))};var Ge=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){if(this._getType(e)!==V.symbol){var t=this._getOrReturnCtx(e);return te(t,{code:J.invalid_type,expected:V.symbol,received:t.parsedType}),ue}return se(e.data)}}]),n}(be);Ge.create=function(e){return new Ge(q({typeName:Ft.ZodSymbol},ye(e)))};var Ve=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){if(this._getType(e)!==V.undefined){var t=this._getOrReturnCtx(e);return te(t,{code:J.invalid_type,expected:V.undefined,received:t.parsedType}),ue}return se(e.data)}}]),n}(be);Ve.create=function(e){return new Ve(q({typeName:Ft.ZodUndefined},ye(e)))};var $e=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){if(this._getType(e)!==V.null){var t=this._getOrReturnCtx(e);return te(t,{code:J.invalid_type,expected:V.null,received:t.parsedType}),ue}return se(e.data)}}]),n}(be);$e.create=function(e){return new $e(q({typeName:Ft.ZodNull},ye(e)))};var Je=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments))._any=!0,e}return I(n,[{key:"_parse",value:function(e){return se(e.data)}}]),n}(be);Je.create=function(e){return new Je(q({typeName:Ft.ZodAny},ye(e)))};var Ke=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments))._unknown=!0,e}return I(n,[{key:"_parse",value:function(e){return se(e.data)}}]),n}(be);Ke.create=function(e){return new Ke(q({typeName:Ft.ZodUnknown},ye(e)))};var Qe=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){var t=this._getOrReturnCtx(e);return te(t,{code:J.invalid_type,expected:V.never,received:t.parsedType}),ue}}]),n}(be);Qe.create=function(e){return new Qe(q({typeName:Ft.ZodNever},ye(e)))};var Xe=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){if(this._getType(e)!==V.undefined){var t=this._getOrReturnCtx(e);return te(t,{code:J.invalid_type,expected:V.void,received:t.parsedType}),ue}return se(e.data)}}]),n}(be);Xe.create=function(e){return new Xe(q({typeName:Ft.ZodVoid},ye(e)))};var Ye=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){var t=this._processInputParams(e),n=t.ctx,r=t.status,a=this._def;if(n.parsedType!==V.array)return te(n,{code:J.invalid_type,expected:V.array,received:n.parsedType}),ue;if(null!==a.exactLength){var i=n.data.length>a.exactLength.value,u=n.data.length<a.exactLength.value;(i||u)&&(te(n,{code:i?J.too_big:J.too_small,minimum:u?a.exactLength.value:void 0,maximum:i?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(null!==a.minLength&&n.data.length<a.minLength.value&&(te(n,{code:J.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),null!==a.maxLength&&n.data.length>a.maxLength.value&&(te(n,{code:J.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),n.common.async)return Promise.all(y(n.data).map((function(e,t){return a.type._parseAsync(new ve(n,e,n.path,t))}))).then((function(e){return ie.mergeArray(r,e)}));var o=y(n.data).map((function(e,t){return a.type._parseSync(new ve(n,e,n.path,t))}));return ie.mergeArray(r,o)}},{key:"element",get:function(){return this._def.type}},{key:"min",value:function(e,t){return new n(q(q({},this._def),{},{minLength:{value:e,message:ne.toString(t)}}))}},{key:"max",value:function(e,t){return new n(q(q({},this._def),{},{maxLength:{value:e,message:ne.toString(t)}}))}},{key:"length",value:function(e,t){return new n(q(q({},this._def),{},{exactLength:{value:e,message:ne.toString(t)}}))}},{key:"nonempty",value:function(e){return this.min(1,e)}}]),n}(be);function et(e){if(e instanceof tt){var t={};for(var n in e.shape){var r=e.shape[n];t[n]=bt.create(et(r))}return new tt(q(q({},e._def),{},{shape:function(){return t}}))}return e instanceof Ye?new Ye(q(q({},e._def),{},{type:et(e.element)})):e instanceof bt?bt.create(et(e.unwrap())):e instanceof _t?_t.create(et(e.unwrap())):e instanceof ot?ot.create(e.items.map((function(e){return et(e)}))):e}Ye.create=function(e,t){return new Ye(q({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Ft.ZodArray},ye(t)))};var tt=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments))._cached=null,e.nonstrict=e.passthrough,e.augment=e.extend,e}return I(n,[{key:"_getCached",value:function(){if(null!==this._cached)return this._cached;var e=this._def.shape(),t=A.objectKeys(e);return this._cached={shape:e,keys:t}}},{key:"_parse",value:function(e){if(this._getType(e)!==V.object){var t=this._getOrReturnCtx(e);return te(t,{code:J.invalid_type,expected:V.object,received:t.parsedType}),ue}var n=this._processInputParams(e),r=n.status,a=n.ctx,i=this._getCached(),u=i.shape,o=i.keys,s=[];if(!(this._def.catchall instanceof Qe&&"strip"===this._def.unknownKeys))for(var c in a.data)o.includes(c)||s.push(c);var l,d=[],f=G(o);try{for(f.s();!(l=f.n()).done;){var h=l.value,v=u[h],m=a.data[h];d.push({key:{status:"valid",value:h},value:v._parse(new ve(a,m,a.path,h)),alwaysSet:h in a.data})}}catch(D){f.e(D)}finally{f.f()}if(this._def.catchall instanceof Qe){var y=this._def.unknownKeys;if("passthrough"===y){var g,_=G(s);try{for(_.s();!(g=_.n()).done;){var k=g.value;d.push({key:{status:"valid",value:k},value:{status:"valid",value:a.data[k]}})}}catch(D){_.e(D)}finally{_.f()}}else if("strict"===y)s.length>0&&(te(a,{code:J.unrecognized_keys,keys:s}),r.dirty());else if("strip"!==y)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{var w,x=this._def.catchall,E=G(s);try{for(E.s();!(w=E.n()).done;){var A=w.value,C=a.data[A];d.push({key:{status:"valid",value:A},value:x._parse(new ve(a,C,a.path,A)),alwaysSet:A in a.data})}}catch(D){E.e(D)}finally{E.f()}}return a.common.async?Promise.resolve().then(b(p().mark((function e(){var t,n,r,a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=G(d),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=15;break}return a=r.value,e.next=8,a.key;case 8:return i=e.sent,e.next=11,a.value;case 11:u=e.sent,t.push({key:i,value:u,alwaysSet:a.alwaysSet});case 13:e.next=4;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(2),n.e(e.t0);case 20:return e.prev=20,n.f(),e.finish(20);case 23:return e.abrupt("return",t);case 24:case"end":return e.stop()}}),e,null,[[2,17,20,23]])})))).then((function(e){return ie.mergeObjectSync(r,e)})):ie.mergeObjectSync(r,d)}},{key:"shape",get:function(){return this._def.shape()}},{key:"strict",value:function(e){var t=this;return ne.errToObj,new n(q(q({},this._def),{},{unknownKeys:"strict"},void 0!==e?{errorMap:function(n,r){var a,i,u,o,s=null!==(u=null===(i=(a=t._def).errorMap)||void 0===i?void 0:i.call(a,n,r).message)&&void 0!==u?u:r.defaultError;return"unrecognized_keys"===n.code?{message:null!==(o=ne.errToObj(e).message)&&void 0!==o?o:s}:{message:s}}}:{}))}},{key:"strip",value:function(){return new n(q(q({},this._def),{},{unknownKeys:"strip"}))}},{key:"passthrough",value:function(){return new n(q(q({},this._def),{},{unknownKeys:"passthrough"}))}},{key:"extend",value:function(e){var t=this;return new n(q(q({},this._def),{},{shape:function(){return q(q({},t._def.shape()),e)}}))}},{key:"merge",value:function(e){var t=this;return new n({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:function(){return q(q({},t._def.shape()),e._def.shape())},typeName:Ft.ZodObject})}},{key:"setKey",value:function(e,t){return this.augment(P({},e,t))}},{key:"catchall",value:function(e){return new n(q(q({},this._def),{},{catchall:e}))}},{key:"pick",value:function(e){var t=this,r={};return A.objectKeys(e).forEach((function(n){e[n]&&t.shape[n]&&(r[n]=t.shape[n])})),new n(q(q({},this._def),{},{shape:function(){return r}}))}},{key:"omit",value:function(e){var t=this,r={};return A.objectKeys(this.shape).forEach((function(n){e[n]||(r[n]=t.shape[n])})),new n(q(q({},this._def),{},{shape:function(){return r}}))}},{key:"deepPartial",value:function(){return et(this)}},{key:"partial",value:function(e){var t=this,r={};return A.objectKeys(this.shape).forEach((function(n){var a=t.shape[n];e&&!e[n]?r[n]=a:r[n]=a.optional()})),new n(q(q({},this._def),{},{shape:function(){return r}}))}},{key:"required",value:function(e){var t=this,r={};return A.objectKeys(this.shape).forEach((function(n){if(e&&!e[n])r[n]=t.shape[n];else{for(var a=t.shape[n];a instanceof bt;)a=a._def.innerType;r[n]=a}})),new n(q(q({},this._def),{},{shape:function(){return r}}))}},{key:"keyof",value:function(){return ht(A.objectKeys(this.shape))}}]),n}(be);tt.create=function(e,t){return new tt(q({shape:function(){return e},unknownKeys:"strip",catchall:Qe.create(),typeName:Ft.ZodObject},ye(t)))},tt.strictCreate=function(e,t){return new tt(q({shape:function(){return e},unknownKeys:"strict",catchall:Qe.create(),typeName:Ft.ZodObject},ye(t)))},tt.lazycreate=function(e,t){return new tt(q({shape:e,unknownKeys:"strip",catchall:Qe.create(),typeName:Ft.ZodObject},ye(t)))};var nt=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){var t=this._processInputParams(e).ctx,n=this._def.options;if(t.common.async)return Promise.all(n.map(function(){var e=b(p().mark((function e(n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=q(q({},t),{},{common:q(q({},t.common),{},{issues:[]}),parent:null}),e.next=3,n._parseAsync({data:t.data,path:t.path,parent:r});case 3:return e.t0=e.sent,e.t1=r,e.abrupt("return",{result:e.t0,ctx:e.t1});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).then((function(e){var n,r=G(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if("valid"===a.result.status)return a.result}}catch(l){r.e(l)}finally{r.f()}var i,u=G(e);try{for(u.s();!(i=u.n()).done;){var o,s=i.value;if("dirty"===s.result.status)return(o=t.common.issues).push.apply(o,y(s.ctx.common.issues)),s.result}}catch(l){u.e(l)}finally{u.f()}var c=e.map((function(e){return new K(e.ctx.common.issues)}));return te(t,{code:J.invalid_union,unionErrors:c}),ue}));var r,a,i=void 0,u=[],o=G(n);try{for(o.s();!(r=o.n()).done;){var s=r.value,c=q(q({},t),{},{common:q(q({},t.common),{},{issues:[]}),parent:null}),l=s._parseSync({data:t.data,path:t.path,parent:c});if("valid"===l.status)return l;"dirty"!==l.status||i||(i={result:l,ctx:c}),c.common.issues.length&&u.push(c.common.issues)}}catch(f){o.e(f)}finally{o.f()}if(i)return(a=t.common.issues).push.apply(a,y(i.ctx.common.issues)),i.result;var d=u.map((function(e){return new K(e)}));return te(t,{code:J.invalid_union,unionErrors:d}),ue}},{key:"options",get:function(){return this._def.options}}]),n}(be);nt.create=function(e,t){return new nt(q({options:e,typeName:Ft.ZodUnion},ye(t)))};var rt=function e(t){return t instanceof ft?e(t.schema):t instanceof gt?e(t.innerType()):t instanceof pt?[t.value]:t instanceof vt?t.options:t instanceof mt?A.objectValues(t.enum):t instanceof kt?e(t._def.innerType):t instanceof Ve?[void 0]:t instanceof $e?[null]:t instanceof bt?[void 0].concat(y(e(t.unwrap()))):t instanceof _t?[null].concat(y(e(t.unwrap()))):t instanceof At||t instanceof Dt?e(t.unwrap()):t instanceof wt?e(t._def.innerType):[]},at=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){var t=this._processInputParams(e).ctx;if(t.parsedType!==V.object)return te(t,{code:J.invalid_type,expected:V.object,received:t.parsedType}),ue;var n=this.discriminator,r=t.data[n],a=this.optionsMap.get(r);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):(te(t,{code:J.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),ue)}},{key:"discriminator",get:function(){return this._def.discriminator}},{key:"options",get:function(){return this._def.options}},{key:"optionsMap",get:function(){return this._def.optionsMap}}],[{key:"create",value:function(e,t,r){var a,i=new Map,u=G(t);try{for(u.s();!(a=u.n()).done;){var o=a.value,s=rt(o.shape[e]);if(!s.length)throw new Error("A discriminator value for key `".concat(e,"` could not be extracted from all schema options"));var c,l=G(s);try{for(l.s();!(c=l.n()).done;){var d=c.value;if(i.has(d))throw new Error("Discriminator property ".concat(String(e)," has duplicate value ").concat(String(d)));i.set(d,o)}}catch(f){l.e(f)}finally{l.f()}}}catch(f){u.e(f)}finally{u.f()}return new n(q({typeName:Ft.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i},ye(r)))}}]),n}(be);function it(e,t){var n=$(e),r=$(t);if(e===t)return{valid:!0,data:e};if(n===V.object&&r===V.object){var a,i=A.objectKeys(t),u=A.objectKeys(e).filter((function(e){return-1!==i.indexOf(e)})),o=q(q({},e),t),s=G(u);try{for(s.s();!(a=s.n()).done;){var c=a.value,l=it(e[c],t[c]);if(!l.valid)return{valid:!1};o[c]=l.data}}catch(h){s.e(h)}finally{s.f()}return{valid:!0,data:o}}if(n===V.array&&r===V.array){if(e.length!==t.length)return{valid:!1};for(var d=[],f=0;f<e.length;f++){var p=it(e[f],t[f]);if(!p.valid)return{valid:!1};d.push(p.data)}return{valid:!0,data:d}}return n===V.date&&r===V.date&&+e===+t?{valid:!0,data:e}:{valid:!1}}var ut=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){var t=this._processInputParams(e),n=t.status,r=t.ctx,a=function(e,t){if(ce(e)||ce(t))return ue;var a=it(e.value,t.value);return a.valid?((le(e)||le(t))&&n.dirty(),{status:n.value,value:a.data}):(te(r,{code:J.invalid_intersection_types}),ue)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then((function(e){var t=w(e,2),n=t[0],r=t[1];return a(n,r)})):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}]),n}(be);ut.create=function(e,t,n){return new ut(q({left:e,right:t,typeName:Ft.ZodIntersection},ye(n)))};var ot=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){var t=this,n=this._processInputParams(e),r=n.status,a=n.ctx;if(a.parsedType!==V.array)return te(a,{code:J.invalid_type,expected:V.array,received:a.parsedType}),ue;if(a.data.length<this._def.items.length)return te(a,{code:J.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ue;!this._def.rest&&a.data.length>this._def.items.length&&(te(a,{code:J.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());var i=y(a.data).map((function(e,n){var r=t._def.items[n]||t._def.rest;return r?r._parse(new ve(a,e,a.path,n)):null})).filter((function(e){return!!e}));return a.common.async?Promise.all(i).then((function(e){return ie.mergeArray(r,e)})):ie.mergeArray(r,i)}},{key:"items",get:function(){return this._def.items}},{key:"rest",value:function(e){return new n(q(q({},this._def),{},{rest:e}))}}]),n}(be);ot.create=function(e,t){if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ot(q({items:e,typeName:Ft.ZodTuple,rest:null},ye(t)))};var st=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"keySchema",get:function(){return this._def.keyType}},{key:"valueSchema",get:function(){return this._def.valueType}},{key:"_parse",value:function(e){var t=this._processInputParams(e),n=t.status,r=t.ctx;if(r.parsedType!==V.object)return te(r,{code:J.invalid_type,expected:V.object,received:r.parsedType}),ue;var a=[],i=this._def.keyType,u=this._def.valueType;for(var o in r.data)a.push({key:i._parse(new ve(r,o,r.path,o)),value:u._parse(new ve(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?ie.mergeObjectAsync(n,a):ie.mergeObjectSync(n,a)}},{key:"element",get:function(){return this._def.valueType}}],[{key:"create",value:function(e,t,r){return new n(t instanceof be?q({keyType:e,valueType:t,typeName:Ft.ZodRecord},ye(r)):q({keyType:Ue.create(),valueType:e,typeName:Ft.ZodRecord},ye(t)))}}]),n}(be),ct=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"keySchema",get:function(){return this._def.keyType}},{key:"valueSchema",get:function(){return this._def.valueType}},{key:"_parse",value:function(e){var t=this._processInputParams(e),n=t.status,r=t.ctx;if(r.parsedType!==V.map)return te(r,{code:J.invalid_type,expected:V.map,received:r.parsedType}),ue;var a=this._def.keyType,i=this._def.valueType,u=y(r.data.entries()).map((function(e,t){var n=w(e,2),u=n[0],o=n[1];return{key:a._parse(new ve(r,u,r.path,[t,"key"])),value:i._parse(new ve(r,o,r.path,[t,"value"]))}}));if(r.common.async){var o=new Map;return Promise.resolve().then(b(p().mark((function e(){var t,r,a,i,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=G(u),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=17;break}return a=r.value,e.next=7,a.key;case 7:return i=e.sent,e.next=10,a.value;case 10:if(s=e.sent,"aborted"!==i.status&&"aborted"!==s.status){e.next=13;break}return e.abrupt("return",ue);case 13:"dirty"!==i.status&&"dirty"!==s.status||n.dirty(),o.set(i.value,s.value);case 15:e.next=3;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(1),t.e(e.t0);case 22:return e.prev=22,t.f(),e.finish(22);case 25:return e.abrupt("return",{status:n.value,value:o});case 26:case"end":return e.stop()}}),e,null,[[1,19,22,25]])}))))}var s,c=new Map,l=G(u);try{for(l.s();!(s=l.n()).done;){var d=s.value,f=d.key,h=d.value;if("aborted"===f.status||"aborted"===h.status)return ue;"dirty"!==f.status&&"dirty"!==h.status||n.dirty(),c.set(f.value,h.value)}}catch(v){l.e(v)}finally{l.f()}return{status:n.value,value:c}}}]),n}(be);ct.create=function(e,t,n){return new ct(q({valueType:t,keyType:e,typeName:Ft.ZodMap},ye(n)))};var lt=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){var t=this._processInputParams(e),n=t.status,r=t.ctx;if(r.parsedType!==V.set)return te(r,{code:J.invalid_type,expected:V.set,received:r.parsedType}),ue;var a=this._def;null!==a.minSize&&r.data.size<a.minSize.value&&(te(r,{code:J.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),n.dirty()),null!==a.maxSize&&r.data.size>a.maxSize.value&&(te(r,{code:J.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),n.dirty());var i=this._def.valueType;function u(e){var t,r=new Set,a=G(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;if("aborted"===i.status)return ue;"dirty"===i.status&&n.dirty(),r.add(i.value)}}catch(u){a.e(u)}finally{a.f()}return{status:n.value,value:r}}var o=y(r.data.values()).map((function(e,t){return i._parse(new ve(r,e,r.path,t))}));return r.common.async?Promise.all(o).then((function(e){return u(e)})):u(o)}},{key:"min",value:function(e,t){return new n(q(q({},this._def),{},{minSize:{value:e,message:ne.toString(t)}}))}},{key:"max",value:function(e,t){return new n(q(q({},this._def),{},{maxSize:{value:e,message:ne.toString(t)}}))}},{key:"size",value:function(e,t){return this.min(e,t).max(e,t)}},{key:"nonempty",value:function(e){return this.min(1,e)}}]),n}(be);lt.create=function(e,t){return new lt(q({valueType:e,minSize:null,maxSize:null,typeName:Ft.ZodSet},ye(t)))};var dt=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).validate=e.implement,e}return I(n,[{key:"_parse",value:function(e){var t=this._processInputParams(e).ctx;if(t.parsedType!==V.function)return te(t,{code:J.invalid_type,expected:V.function,received:t.parsedType}),ue;function n(e,n){return ee({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Y(),Q].filter((function(e){return!!e})),issueData:{code:J.invalid_arguments,argumentsError:n}})}function r(e,n){return ee({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Y(),Q].filter((function(e){return!!e})),issueData:{code:J.invalid_return_type,returnTypeError:n}})}var a={errorMap:t.common.contextualErrorMap},i=t.data;if(this._def.returns instanceof yt){var u=this;return se(b(p().mark((function e(){var t,o,s,c,l,d,f,h=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=h.length,o=new Array(t),s=0;s<t;s++)o[s]=h[s];return c=new K([]),e.next=4,u._def.args.parseAsync(o,a).catch((function(e){throw c.addIssue(n(o,e)),c}));case 4:return l=e.sent,e.next=7,Reflect.apply(i,this,l);case 7:return d=e.sent,e.next=10,u._def.returns._def.type.parseAsync(d,a).catch((function(e){throw c.addIssue(r(d,e)),c}));case 10:return f=e.sent,e.abrupt("return",f);case 12:case"end":return e.stop()}}),e,this)}))))}var o=this;return se((function(){for(var e=arguments.length,t=new Array(e),u=0;u<e;u++)t[u]=arguments[u];var s=o._def.args.safeParse(t,a);if(!s.success)throw new K([n(t,s.error)]);var c=Reflect.apply(i,this,s.data),l=o._def.returns.safeParse(c,a);if(!l.success)throw new K([r(c,l.error)]);return l.data}))}},{key:"parameters",value:function(){return this._def.args}},{key:"returnType",value:function(){return this._def.returns}},{key:"args",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new n(q(q({},this._def),{},{args:ot.create(t).rest(Ke.create())}))}},{key:"returns",value:function(e){return new n(q(q({},this._def),{},{returns:e}))}},{key:"implement",value:function(e){return this.parse(e)}},{key:"strictImplement",value:function(e){return this.parse(e)}}],[{key:"create",value:function(e,t,r){return new n(q({args:e||ot.create([]).rest(Ke.create()),returns:t||Ke.create(),typeName:Ft.ZodFunction},ye(r)))}}]),n}(be),ft=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"schema",get:function(){return this._def.getter()}},{key:"_parse",value:function(e){var t=this._processInputParams(e).ctx;return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}]),n}(be);ft.create=function(e,t){return new ft(q({getter:e,typeName:Ft.ZodLazy},ye(t)))};var pt=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){if(e.data!==this._def.value){var t=this._getOrReturnCtx(e);return te(t,{received:t.data,code:J.invalid_literal,expected:this._def.value}),ue}return{status:"valid",value:e.data}}},{key:"value",get:function(){return this._def.value}}]),n}(be);function ht(e,t){return new vt(q({values:e,typeName:Ft.ZodEnum},ye(t)))}pt.create=function(e,t){return new pt(q({value:e,typeName:Ft.ZodLiteral},ye(t)))};var vt=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),e=t.apply(this,arguments),re.set(N(e),void 0),e}return I(n,[{key:"_parse",value:function(e){if("string"!==typeof e.data){var t=this._getOrReturnCtx(e),n=this._def.values;return te(t,{expected:A.joinValues(n),received:t.parsedType,code:J.invalid_type}),ue}if(pe(this,re,"f")||he(this,re,new Set(this._def.values),"f"),!pe(this,re,"f").has(e.data)){var r=this._getOrReturnCtx(e),a=this._def.values;return te(r,{received:r.data,code:J.invalid_enum_value,options:a}),ue}return se(e.data)}},{key:"options",get:function(){return this._def.values}},{key:"enum",get:function(){var e,t={},n=G(this._def.values);try{for(n.s();!(e=n.n()).done;){var r=e.value;t[r]=r}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"Values",get:function(){var e,t={},n=G(this._def.values);try{for(n.s();!(e=n.n()).done;){var r=e.value;t[r]=r}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"Enum",get:function(){var e,t={},n=G(this._def.values);try{for(n.s();!(e=n.n()).done;){var r=e.value;t[r]=r}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"extract",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._def;return n.create(e,q(q({},this._def),t))}},{key:"exclude",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._def;return n.create(this.options.filter((function(t){return!e.includes(t)})),q(q({},this._def),t))}}]),n}(be);re=new WeakMap,vt.create=ht;var mt=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),e=t.apply(this,arguments),ae.set(N(e),void 0),e}return I(n,[{key:"_parse",value:function(e){var t=A.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==V.string&&n.parsedType!==V.number){var r=A.objectValues(t);return te(n,{expected:A.joinValues(r),received:n.parsedType,code:J.invalid_type}),ue}if(pe(this,ae,"f")||he(this,ae,new Set(A.getValidEnumValues(this._def.values)),"f"),!pe(this,ae,"f").has(e.data)){var a=A.objectValues(t);return te(n,{received:n.data,code:J.invalid_enum_value,options:a}),ue}return se(e.data)}},{key:"enum",get:function(){return this._def.values}}]),n}(be);ae=new WeakMap,mt.create=function(e,t){return new mt(q({values:e,typeName:Ft.ZodNativeEnum},ye(t)))};var yt=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"unwrap",value:function(){return this._def.type}},{key:"_parse",value:function(e){var t=this,n=this._processInputParams(e).ctx;if(n.parsedType!==V.promise&&!1===n.common.async)return te(n,{code:J.invalid_type,expected:V.promise,received:n.parsedType}),ue;var r=n.parsedType===V.promise?n.data:Promise.resolve(n.data);return se(r.then((function(e){return t._def.type.parseAsync(e,{path:n.path,errorMap:n.common.contextualErrorMap})})))}}]),n}(be);yt.create=function(e,t){return new yt(q({type:e,typeName:Ft.ZodPromise},ye(t)))};var gt=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"innerType",value:function(){return this._def.schema}},{key:"sourceType",value:function(){return this._def.schema._def.typeName===Ft.ZodEffects?this._def.schema.sourceType():this._def.schema}},{key:"_parse",value:function(e){var t=this,n=this._processInputParams(e),r=n.status,a=n.ctx,i=this._def.effect||null,u={addIssue:function(e){te(a,e),e.fatal?r.abort():r.dirty()},get path(){return a.path}};if(u.addIssue=u.addIssue.bind(u),"preprocess"===i.type){var o=i.transform(a.data,u);if(a.common.async)return Promise.resolve(o).then(function(){var e=b(p().mark((function e(n){var i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("aborted"!==r.value){e.next=2;break}return e.abrupt("return",ue);case 2:return e.next=4,t._def.schema._parseAsync({data:n,path:a.path,parent:a});case 4:if("aborted"!==(i=e.sent).status){e.next=7;break}return e.abrupt("return",ue);case 7:if("dirty"!==i.status){e.next=9;break}return e.abrupt("return",oe(i.value));case 9:if("dirty"!==r.value){e.next=11;break}return e.abrupt("return",oe(i.value));case 11:return e.abrupt("return",i);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());if("aborted"===r.value)return ue;var s=this._def.schema._parseSync({data:o,path:a.path,parent:a});return"aborted"===s.status?ue:"dirty"===s.status||"dirty"===r.value?oe(s.value):s}if("refinement"===i.type){var c=function(e){var t=i.refinement(e,u);if(a.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===a.common.async){var l=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return"aborted"===l.status?ue:("dirty"===l.status&&r.dirty(),c(l.value),{status:r.value,value:l.value})}return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then((function(e){return"aborted"===e.status?ue:("dirty"===e.status&&r.dirty(),c(e.value).then((function(){return{status:r.value,value:e.value}})))}))}if("transform"===i.type){if(!1===a.common.async){var d=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!de(d))return d;var f=i.transform(d.value,u);if(f instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:f}}return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then((function(e){return de(e)?Promise.resolve(i.transform(e.value,u)).then((function(e){return{status:r.value,value:e}})):e}))}A.assertNever(i)}}]),n}(be);gt.create=function(e,t,n){return new gt(q({schema:e,typeName:Ft.ZodEffects,effect:t},ye(n)))},gt.createWithPreprocess=function(e,t,n){return new gt(q({schema:t,effect:{type:"preprocess",transform:e},typeName:Ft.ZodEffects},ye(n)))};var bt=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){return this._getType(e)===V.undefined?se(void 0):this._def.innerType._parse(e)}},{key:"unwrap",value:function(){return this._def.innerType}}]),n}(be);bt.create=function(e,t){return new bt(q({innerType:e,typeName:Ft.ZodOptional},ye(t)))};var _t=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){return this._getType(e)===V.null?se(null):this._def.innerType._parse(e)}},{key:"unwrap",value:function(){return this._def.innerType}}]),n}(be);_t.create=function(e,t){return new _t(q({innerType:e,typeName:Ft.ZodNullable},ye(t)))};var kt=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){var t=this._processInputParams(e).ctx,n=t.data;return t.parsedType===V.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}},{key:"removeDefault",value:function(){return this._def.innerType}}]),n}(be);kt.create=function(e,t){return new kt(q({innerType:e,typeName:Ft.ZodDefault,defaultValue:"function"===typeof t.default?t.default:function(){return t.default}},ye(t)))};var wt=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){var t=this,n=this._processInputParams(e).ctx,r=q(q({},n),{},{common:q(q({},n.common),{},{issues:[]})}),a=this._def.innerType._parse({data:r.data,path:r.path,parent:q({},r)});return fe(a)?a.then((function(e){return{status:"valid",value:"valid"===e.status?e.value:t._def.catchValue({get error(){return new K(r.common.issues)},input:r.data})}})):{status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new K(r.common.issues)},input:r.data})}}},{key:"removeCatch",value:function(){return this._def.innerType}}]),n}(be);wt.create=function(e,t){return new wt(q({innerType:e,typeName:Ft.ZodCatch,catchValue:"function"===typeof t.catch?t.catch:function(){return t.catch}},ye(t)))};var xt=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){if(this._getType(e)!==V.nan){var t=this._getOrReturnCtx(e);return te(t,{code:J.invalid_type,expected:V.nan,received:t.parsedType}),ue}return{status:"valid",value:e.data}}}]),n}(be);xt.create=function(e){return new xt(q({typeName:Ft.ZodNaN},ye(e)))};var Et=Symbol("zod_brand"),At=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){var t=this._processInputParams(e).ctx,n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}},{key:"unwrap",value:function(){return this._def.type}}]),n}(be),Ct=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){var t=this,n=this._processInputParams(e),r=n.status,a=n.ctx;if(a.common.async){var i=function(){var e=b(p().mark((function e(){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._def.in._parseAsync({data:a.data,path:a.path,parent:a});case 2:if("aborted"!==(n=e.sent).status){e.next=5;break}return e.abrupt("return",ue);case 5:if("dirty"!==n.status){e.next=10;break}return r.dirty(),e.abrupt("return",oe(n.value));case 10:return e.abrupt("return",t._def.out._parseAsync({data:n.value,path:a.path,parent:a}));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return i()}var u=this._def.in._parseSync({data:a.data,path:a.path,parent:a});return"aborted"===u.status?ue:"dirty"===u.status?(r.dirty(),{status:"dirty",value:u.value}):this._def.out._parseSync({data:u.value,path:a.path,parent:a})}}],[{key:"create",value:function(e,t){return new n({in:e,out:t,typeName:Ft.ZodPipeline})}}]),n}(be),Dt=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_parse",value:function(e){var t=this._def.innerType._parse(e),n=function(e){return de(e)&&(e.value=Object.freeze(e.value)),e};return fe(t)?t.then((function(e){return n(e)})):n(t)}},{key:"unwrap",value:function(){return this._def.innerType}}]),n}(be);function St(e,t){var n="function"===typeof e?e(t):"string"===typeof e?{message:e}:e;return"string"===typeof n?{message:n}:n}function Ot(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return e?Je.create().superRefine((function(r,a){var i,u,o=e(r);if(o instanceof Promise)return o.then((function(e){var i,u;if(!e){var o=St(t,r),s=null===(u=null!==(i=o.fatal)&&void 0!==i?i:n)||void 0===u||u;a.addIssue(q(q({code:"custom"},o),{},{fatal:s}))}}));if(!o){var s=St(t,r),c=null===(u=null!==(i=s.fatal)&&void 0!==i?i:n)||void 0===u||u;a.addIssue(q(q({code:"custom"},s),{},{fatal:c}))}})):Je.create()}Dt.create=function(e,t){return new Dt(q({innerType:e,typeName:Ft.ZodReadonly},ye(t)))};var Ft,Pt={object:tt.lazycreate};!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(Ft||(Ft={}));var Tt=Ue.create,jt=He.create,It=xt.create,Nt=Ze.create,Rt=We.create,Bt=qe.create,Lt=Ge.create,Mt=Ve.create,Ut=$e.create,zt=Je.create,Ht=Ke.create,Zt=Qe.create,Wt=Xe.create,qt=Ye.create,Gt=tt.create,Vt=tt.strictCreate,$t=nt.create,Jt=at.create,Kt=ut.create,Qt=ot.create,Xt=st.create,Yt=ct.create,en=lt.create,tn=dt.create,nn=ft.create,rn=pt.create,an=vt.create,un=mt.create,on=yt.create,sn=gt.create,cn=bt.create,ln=_t.create,dn=gt.createWithPreprocess,fn=Ct.create,pn={string:function(e){return Ue.create(q(q({},e),{},{coerce:!0}))},number:function(e){return He.create(q(q({},e),{},{coerce:!0}))},boolean:function(e){return We.create(q(q({},e),{},{coerce:!0}))},bigint:function(e){return Ze.create(q(q({},e),{},{coerce:!0}))},date:function(e){return qe.create(q(q({},e),{},{coerce:!0}))}},hn=ue,vn=Object.freeze({__proto__:null,defaultErrorMap:Q,setErrorMap:function(e){X=e},getErrorMap:Y,makeIssue:ee,EMPTY_PATH:[],addIssueToContext:te,ParseStatus:ie,INVALID:ue,DIRTY:oe,OK:se,isAborted:ce,isDirty:le,isValid:de,isAsync:fe,get util(){return A},get objectUtil(){return C},ZodParsedType:V,getParsedType:$,ZodType:be,datetimeRegex:Be,ZodString:Ue,ZodNumber:He,ZodBigInt:Ze,ZodBoolean:We,ZodDate:qe,ZodSymbol:Ge,ZodUndefined:Ve,ZodNull:$e,ZodAny:Je,ZodUnknown:Ke,ZodNever:Qe,ZodVoid:Xe,ZodArray:Ye,ZodObject:tt,ZodUnion:nt,ZodDiscriminatedUnion:at,ZodIntersection:ut,ZodTuple:ot,ZodRecord:st,ZodMap:ct,ZodSet:lt,ZodFunction:dt,ZodLazy:ft,ZodLiteral:pt,ZodEnum:vt,ZodNativeEnum:mt,ZodPromise:yt,ZodEffects:gt,ZodTransformer:gt,ZodOptional:bt,ZodNullable:_t,ZodDefault:kt,ZodCatch:wt,ZodNaN:xt,BRAND:Et,ZodBranded:At,ZodPipeline:Ct,ZodReadonly:Dt,custom:Ot,Schema:be,ZodSchema:be,late:Pt,get ZodFirstPartyTypeKind(){return Ft},coerce:pn,any:zt,array:qt,bigint:Nt,boolean:Rt,date:Bt,discriminatedUnion:Jt,effect:sn,enum:an,function:tn,instanceof:function(e){return Ot((function(t){return t instanceof e}),arguments.length>1&&void 0!==arguments[1]?arguments[1]:{message:"Input not instance of ".concat(e.name)})},intersection:Kt,lazy:nn,literal:rn,map:Yt,nan:It,nativeEnum:un,never:Zt,null:Ut,nullable:ln,number:jt,object:Gt,oboolean:function(){return Rt().optional()},onumber:function(){return jt().optional()},optional:cn,ostring:function(){return Tt().optional()},pipeline:fn,preprocess:dn,promise:on,record:Xt,set:en,strictObject:Vt,string:Tt,symbol:Lt,transformer:sn,tuple:Qt,undefined:Mt,union:$t,unknown:Ht,void:Wt,NEVER:hn,ZodIssueCode:J,quotelessJson:function(e){return JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:")},ZodError:K}),mn=vn.object({name:vn.string().describe("name of victim"),gender:vn.string().describe("gender(male or female)"),age:vn.number().describe("age"),occupation:vn.string().describe("occupation"),appearance:vn.string().describe("A victim's appearance and outfit for identification."),description:vn.string().describe("A description of a victim."),causeOfDeath:vn.string().describe("cause of death")}),yn=vn.object({name:vn.string().describe("name of suspect"),gender:vn.string().describe("gender(male or female)"),age:vn.number().describe("age"),occupation:vn.string().describe("occupation"),appearance:vn.string().describe("A suspect's appearance and outfit for identification."),alibi:vn.string().describe("alibi"),motive:vn.string().describe("motive for murder"),isMurderer:vn.boolean().describe("Whether this suspect is the murderer or not"),story:vn.string().describe("a story related to a case")}),gn=vn.object({murderer:vn.string().describe("name of murderer"),how:vn.string().describe("how to murder(method of murder)"),why:vn.string().describe("why murder(motive of murder)"),trick:vn.string().describe("trick to escape"),loophole:vn.string().describe("loophole in the trick")}),bn=vn.object({title:vn.string().describe("title of scenario"),victim:mn.describe("information of the victim"),crimeScene:vn.string().describe("Describe the crime scene\u2014only what\u2019s visible"),suspects:vn.array(yn).describe("information of the suspects. One of the suspects must be a murderer(set 'isMurderer: true')."),truth:gn.describe("The truth of the murder that the player (== detective role) must reveal"),prologue:vn.string().describe("prologue of the game.")}),_n=JSON.parse('{"title":"Murder at the Gallery","victim":{"name":"Olivia Davis","gender":"female","age":32,"occupation":"Marketing Manager and Artist","appearance":"Olivia was tall and slender, with long, wavy brown hair that she often wore in a messy bun. She had bright green eyes and a warm, infectious smile that drew people to her.","description":"Olivia was known to be charming and sociable, with a natural ability to put people at ease. She was successful in her career as a marketing manager, but was also deeply passionate about her artistic pursuits, spending much of her free time painting and attending gallery openings. She was often described as determined and focused, but also had a gentle and empathetic side, making her a beloved friend to many.","causeOfDeath":"poisoning"},"crimeScene":"Olivia was poisoned during a family dinner at her home.","suspects":[{"name":"Derek Johnson","gender":"male","age":35,"occupation":"CEO of a tech startup","appearance":"Derek is a tall, broad-shouldered man with short, blonde hair and piercing blue eyes. He is always impeccably dressed in designer suits and expensive watches.","alibi":"Derek had been at a business dinner with several colleagues at the time of the murder. There were multiple witnesses who could attest to his whereabouts, and he had no opportunity to leave the dinner without being noticed.","motive":"Derek was in a business partnership with Olivia, but they had a falling out when she discovered he had been embezzling company funds. Olivia threatened to report him to the authorities, which would have ruined his reputation and career.","isMurderer":false,"story":""},{"name":"Emma Martinez","gender":"female","age":28,"occupation":"Lawyer","appearance":"Emma has short, curly black hair and dark, expressive eyes. She has a curvaceous figure and often wears bold, colorful clothing.","alibi":"Emma had been meeting with a client at her law firm at the time of the murder. There was CCTV footage of her entering and leaving the building, which proved that she was not at the scene of the crime.","motive":"Emma had been dating Olivia\'s ex-boyfriend, who had left her to rekindle his relationship with Olivia. Emma was jealous of Olivia\'s success and saw her as a rival in both love and career. She believed that if Olivia were out of the picture, her ex-boyfriend would come back to her.","isMurderer":false,"story":""},{"name":"Marcus Lee","gender":"male","age":40,"occupation":"Artist","appearance":"Marcus has long, unkempt black hair and a scruffy beard. He is usually seen wearing paint-stained clothes and carries around a sketchbook wherever he goes.","alibi":"Marcus had been working on a new art piece in his studio at the time of the murder. He had been alone for most of the day, and did not have any visitors or interruptions. His neighbors reported hearing strange noises, but they could not confirm whether they were related to the murder.","motive":"Marcus had been in a long-standing feud with Olivia over a gallery space that they both wanted to exhibit their work in. Olivia had won the space, which had enraged Marcus and caused him to publicly insult her work. He had also made a scene at one of Olivia\'s gallery showings, which had embarrassed her in front of potential buyers.","isMurderer":false,"story":""},{"name":"Rachel Park","gender":"female","age":27,"occupation":"Barista and Environmental Activist","appearance":"Rachel has long, curly brown hair and bright, hazel eyes. She is petite and has a youthful, girlish appearance.","alibi":"Rachel had set up a fake alibi by asking a friend to cover for her during the time of the murder.","motive":"Rachel is actually Olivia\'s younger half-sister, who had always felt overshadowed by Olivia\'s success and popularity. She had been struggling to make ends meet and was envious of Olivia\'s wealth and achievements. She also felt neglected by Olivia, who had been too busy with work and her own interests to spend much time with her.","isMurderer":true,"story":""}],"truth":{"murderer":"Rachel Park","how":"Rachel poisoned Olivia with a rare and deadly toxin that she had obtained through her work as an environmental activist. She had added the toxin to a drink that Olivia had consumed during a family dinner.","why":"Rachel is actually Olivia\'s younger half-sister, who had always felt overshadowed by Olivia\'s success and popularity. She had been struggling to make ends meet and was envious of Olivia\'s wealth and achievements. She also felt neglected by Olivia, who had been too busy with work and her own interests to spend much time with her.","trick":"Rachel had set up a fake alibi by asking a friend to cover for her during the time of the murder. She had also made sure to wear gloves and dispose of all evidence, including the glass that had contained the poison.","loophole":"The loophole in Rachel\'s alibi was that she had accidentally left a small amount of the toxin on her clothes while handling it. This toxin was later found on a jacket that she had worn on the night of the murder, which placed her at the scene of the crime. Additionally, a witness reported seeing Rachel sneaking out of the house around the time of the murder, which contradicted her alibi. These pieces of evidence were enough to prove that Rachel was the killer."},"prologue":"Olivia Davis, a successful marketing manager and artist, was poisoned during a family dinner at her home. The suspects include Derek Johnson, CEO of a tech startup; Emma Martinez, a lawyer; Marcus Lee, an artist; and Rachel Park, Olivia\'s younger half-sister and a barista and environmental activist. Through investigation, it was revealed that Rachel was the killer, having poisoned Olivia with a rare toxin and setting up a fake alibi. However, a small amount of the toxin was found on Rachel\'s clothes, and a witness reported seeing her sneaking out of the house around the time of the murder, leading to her arrest and conviction."}');function kn(){return kn="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=L(e)););return e}(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},kn.apply(this,arguments)}function wn(e,t){this.v=e,this.k=t}function xn(e){return new wn(e,0)}function En(e){var t,n;function r(t,n){try{var i=e[t](n),u=i.value,o=u instanceof wn;Promise.resolve(o?u.v:u).then((function(n){if(o){var s="return"===t?"return":"next";if(!u.k||n.done)return r(s,n);n=e[s](n).value}a(i.done?"return":"normal",n)}),(function(e){r("throw",e)}))}catch(s){a("throw",s)}}function a(e,a){switch(e){case"return":t.resolve({value:a,done:!0});break;case"throw":t.reject(a);break;default:t.resolve({value:a,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,a){return new Promise((function(i,u){var o={key:e,arg:a,resolve:i,reject:u,next:null};n?n=n.next=o:(t=n=o,r(e,a))}))},"function"!=typeof e.return&&(this.return=void 0)}function An(e){return function(){return new En(e.apply(this,arguments))}}function Cn(e){var t,n,r,a=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);a--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new Dn(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function Dn(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return Dn=function(e){this.s=e,this.n=e.next},Dn.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new Dn(e)}function Sn(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}En.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},En.prototype.next=function(e){return this._invoke("next",e)},En.prototype.throw=function(e){return this._invoke("throw",e)},En.prototype.return=function(e){return this._invoke("return",e)};var On="RFC3986",Fn={RFC1738:function(e){return String(e).replace(/%20/g,"+")},RFC3986:function(e){return String(e)}},Pn=(Object.prototype.hasOwnProperty,Array.isArray),Tn=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}();var jn=1024;function In(e,t){if(Pn(e)){for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)}var Nn=Object.prototype.hasOwnProperty,Rn={brackets:function(e){return String(e)+"[]"},comma:"comma",indices:function(e,t){return String(e)+"["+t+"]"},repeat:function(e){return String(e)}},Bn=Array.isArray,Ln=Array.prototype.push,Mn=function(e,t){Ln.apply(e,Bn(t)?t:[t])},Un=Date.prototype.toISOString,zn={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:function(e,t,n,r,a){if(0===e.length)return e;var i=e;if("symbol"===typeof e?i=Symbol.prototype.toString.call(e):"string"!==typeof e&&(i=String(e)),"iso-8859-1"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var u="",o=0;o<i.length;o+=jn){for(var s=i.length>=jn?i.slice(o,o+jn):i,c=[],l=0;l<s.length;++l){var d=s.charCodeAt(l);45===d||46===d||95===d||126===d||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||"RFC1738"===a&&(40===d||41===d)?c[c.length]=s.charAt(l):d<128?c[c.length]=Tn[d]:d<2048?c[c.length]=Tn[192|d>>6]+Tn[128|63&d]:d<55296||d>=57344?c[c.length]=Tn[224|d>>12]+Tn[128|d>>6&63]+Tn[128|63&d]:(l+=1,d=65536+((1023&d)<<10|1023&s.charCodeAt(l)),c[c.length]=Tn[240|d>>18]+Tn[128|d>>12&63]+Tn[128|d>>6&63]+Tn[128|63&d])}u+=c.join("")}return u},encodeValuesOnly:!1,format:On,formatter:Fn[On],indices:!1,serializeDate:function(e){return Un.call(e)},skipNulls:!1,strictNullHandling:!1};var Hn={};function Zn(e,t,n,r,a,i,u,o,s,c,l,d,f,p,h,v,m,y){for(var g,b=e,_=y,k=0,w=!1;void 0!==(_=_.get(Hn))&&!w;){var x=_.get(e);if(k+=1,"undefined"!==typeof x){if(x===k)throw new RangeError("Cyclic object value");w=!0}"undefined"===typeof _.get(Hn)&&(k=0)}if("function"===typeof c?b=c(t,b):b instanceof Date?b=null===f||void 0===f?void 0:f(b):"comma"===n&&Bn(b)&&(b=In(b,(function(e){return e instanceof Date?null===f||void 0===f?void 0:f(e):e}))),null===b){if(i)return s&&!v?s(t,zn.encoder,m,"key",p):t;b=""}if("string"===typeof(g=b)||"number"===typeof g||"boolean"===typeof g||"symbol"===typeof g||"bigint"===typeof g||function(e){return!(!e||"object"!==typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}(b)){if(s){var E=v?t:s(t,zn.encoder,m,"key",p);return[(null===h||void 0===h?void 0:h(E))+"="+(null===h||void 0===h?void 0:h(s(b,zn.encoder,m,"value",p)))]}return[(null===h||void 0===h?void 0:h(t))+"="+(null===h||void 0===h?void 0:h(String(b)))]}var A,C=[];if("undefined"===typeof b)return C;if("comma"===n&&Bn(b))v&&s&&(b=In(b,s)),A=[{value:b.length>0?b.join(",")||null:void 0}];else if(Bn(c))A=c;else{var D=Object.keys(b);A=l?D.sort(l):D}var S=o?String(t).replace(/\./g,"%2E"):String(t),O=r&&Bn(b)&&1===b.length?S+"[]":S;if(a&&Bn(b)&&0===b.length)return O+"[]";for(var F=0;F<A.length;++F){var P=A[F],T="object"===typeof P&&"undefined"!==typeof P.value?P.value:b[P];if(!u||null!==T){var j=d&&o?P.replace(/\./g,"%2E"):P,I=Bn(b)?"function"===typeof n?n(O,j):O:O+(d?"."+j:"["+j+"]");y.set(e,k);var N=new WeakMap;N.set(Hn,y),Mn(C,Zn(T,I,n,r,a,i,u,o,"comma"===n&&v&&Bn(b)?null:s,c,l,d,f,p,h,v,m,N))}}return C}function Wn(e){var t,n=e,r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zn;if("undefined"!==typeof e.allowEmptyArrays&&"boolean"!==typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if("undefined"!==typeof e.encodeDotInKeys&&"boolean"!==typeof e.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&"undefined"!==typeof e.encoder&&"function"!==typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||zn.charset;if("undefined"!==typeof e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=On;if("undefined"!==typeof e.format){if(!Nn.call(Fn,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var r,a=Fn[n],i=zn.filter;if(("function"===typeof e.filter||Bn(e.filter))&&(i=e.filter),r=e.arrayFormat&&e.arrayFormat in Rn?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":zn.arrayFormat,"commaRoundTrip"in e&&"boolean"!==typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var u="undefined"===typeof e.allowDots?!0===!!e.encodeDotInKeys||zn.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"===typeof e.addQueryPrefix?e.addQueryPrefix:zn.addQueryPrefix,allowDots:u,allowEmptyArrays:"boolean"===typeof e.allowEmptyArrays?!!e.allowEmptyArrays:zn.allowEmptyArrays,arrayFormat:r,charset:t,charsetSentinel:"boolean"===typeof e.charsetSentinel?e.charsetSentinel:zn.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:"undefined"===typeof e.delimiter?zn.delimiter:e.delimiter,encode:"boolean"===typeof e.encode?e.encode:zn.encode,encodeDotInKeys:"boolean"===typeof e.encodeDotInKeys?e.encodeDotInKeys:zn.encodeDotInKeys,encoder:"function"===typeof e.encoder?e.encoder:zn.encoder,encodeValuesOnly:"boolean"===typeof e.encodeValuesOnly?e.encodeValuesOnly:zn.encodeValuesOnly,filter:i,format:n,formatter:a,serializeDate:"function"===typeof e.serializeDate?e.serializeDate:zn.serializeDate,skipNulls:"boolean"===typeof e.skipNulls?e.skipNulls:zn.skipNulls,sort:"function"===typeof e.sort?e.sort:null,strictNullHandling:"boolean"===typeof e.strictNullHandling?e.strictNullHandling:zn.strictNullHandling}}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});"function"===typeof r.filter?n=(0,r.filter)("",n):Bn(r.filter)&&(t=r.filter);var a=[];if("object"!==typeof n||null===n)return"";var i=Rn[r.arrayFormat],u="comma"===i&&r.commaRoundTrip;t||(t=Object.keys(n)),r.sort&&t.sort(r.sort);for(var o=new WeakMap,s=0;s<t.length;++s){var c=t[s];r.skipNulls&&null===n[c]||Mn(a,Zn(n[c],c,i,u,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,o))}var l=a.join(r.delimiter),d=!0===r.addQueryPrefix?"?":"";return r.charsetSentinel&&("iso-8859-1"===r.charset?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),l.length>0?d+l:""}var qn="4.91.0",Gn=!1,Vn=void 0,$n=void 0,Jn=void 0,Kn=void 0,Qn=void 0,Xn=void 0,Yn=void 0,er=void 0,tr=void 0;var nr=function(e){function t(e){T(this,t),this.body=e}return I(t,[{key:Symbol.toStringTag,get:function(){return"MultipartBody"}}]),t}();var rr=function(){Vn||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{auto:!1};if(Gn)throw new Error("you must `import 'openai/shims/".concat(e.kind,"'` before importing anything else from openai"));if(Vn)throw new Error("can't `import 'openai/shims/".concat(e.kind,"'` after `import 'openai/shims/").concat(Vn,"'`"));Gn=t.auto,Vn=e.kind,$n=e.fetch,e.Request,e.Response,e.Headers,Jn=e.FormData,e.Blob,Kn=e.File,Qn=e.ReadableStream,Xn=e.getMultipartRequestOptions,Yn=e.getDefaultAgent,er=e.fileFromPath,tr=e.isFsReadStream}(function(){var e,t,n,r,a=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).manuallyImported?"You may need to use polyfills":"Add one of these imports before your first `import \u2026 from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";try{e=fetch,t=Request,n=Response,r=Headers}catch(i){throw new Error("this environment is missing the following Web Fetch API type: ".concat(i.message,". ").concat(a))}return{kind:"web",fetch:e,Request:t,Response:n,Headers:r,FormData:"undefined"!==typeof FormData?FormData:I((function e(){throw T(this,e),new Error("file uploads aren't supported in this environment yet as 'FormData' is undefined. ".concat(a))})),Blob:"undefined"!==typeof Blob?Blob:I((function e(){throw T(this,e),new Error("file uploads aren't supported in this environment yet as 'Blob' is undefined. ".concat(a))})),File:"undefined"!==typeof File?File:I((function e(){throw T(this,e),new Error("file uploads aren't supported in this environment yet as 'File' is undefined. ".concat(a))})),ReadableStream:"undefined"!==typeof ReadableStream?ReadableStream:I((function e(){throw T(this,e),new Error("streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ".concat(a))})),getMultipartRequestOptions:function(){var e=b(p().mark((function e(t,n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",q(q({},n),{},{body:new nr(t)}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),getDefaultAgent:function(e){},fileFromPath:function(){throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:function(e){return!1}}}(),{auto:!0})};rr();var ar,ir=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Z(Error)),ur=function(e){B(n,e);var t=z(n);function n(e,r,a,i){var u;T(this,n),(u=t.call(this,"".concat(n.makeMessage(e,r,a)))).status=e,u.headers=i,u.request_id=null===i||void 0===i?void 0:i["x-request-id"],u.error=r;var o=r;return u.code=null===o||void 0===o?void 0:o.code,u.param=null===o||void 0===o?void 0:o.param,u.type=null===o||void 0===o?void 0:o.type,u}return I(n,null,[{key:"makeMessage",value:function(e,t,n){var r=null!==t&&void 0!==t&&t.message?"string"===typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?"".concat(e," ").concat(r):e?"".concat(e," status code (no body)"):r||"(no status code or body)"}},{key:"generate",value:function(e,t,r,a){if(!e||!a)return new sr({message:r,cause:ga(t)});var i=null===t||void 0===t?void 0:t.error;return 400===e?new lr(e,i,r,a):401===e?new dr(e,i,r,a):403===e?new fr(e,i,r,a):404===e?new pr(e,i,r,a):409===e?new hr(e,i,r,a):422===e?new vr(e,i,r,a):429===e?new mr(e,i,r,a):e>=500?new yr(e,i,r,a):new n(e,i,r,a)}}]),n}(ir),or=function(e){B(n,e);var t=z(n);function n(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).message;return T(this,n),t.call(this,void 0,void 0,e||"Request was aborted.",void 0)}return I(n)}(ur),sr=function(e){B(n,e);var t=z(n);function n(e){var r,a=e.message,i=e.cause;return T(this,n),r=t.call(this,void 0,void 0,a||"Connection error.",void 0),i&&(r.cause=i),r}return I(n)}(ur),cr=function(e){B(n,e);var t=z(n);function n(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).message;return T(this,n),t.call(this,{message:null!==e&&void 0!==e?e:"Request timed out."})}return I(n)}(sr),lr=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(ur),dr=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(ur),fr=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(ur),pr=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(ur),hr=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(ur),vr=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(ur),mr=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(ur),yr=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(ur),gr=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.call(this,"Could not parse response content as the length limit was reached")}return I(n)}(ir),br=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.call(this,"Could not parse response content as the request was rejected by the content filter")}return I(n)}(ir),_r=function(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n},kr=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},wr=function(){function e(){T(this,e),ar.set(this,void 0),this.buffer=new Uint8Array,_r(this,ar,null,"f")}return I(e,[{key:"decode",value:function(e){if(null==e)return[];var t=e instanceof ArrayBuffer?new Uint8Array(e):"string"===typeof e?(new TextEncoder).encode(e):e,n=new Uint8Array(this.buffer.length+t.length);n.set(this.buffer),n.set(t,this.buffer.length),this.buffer=n;for(var r,a=[];null!=(r=xr(this.buffer,kr(this,ar,"f")));)if(r.carriage&&null==kr(this,ar,"f"))_r(this,ar,r.index,"f");else if(null==kr(this,ar,"f")||r.index===kr(this,ar,"f")+1&&!r.carriage){var i=null!==kr(this,ar,"f")?r.preceding-1:r.preceding,u=this.decodeText(this.buffer.slice(0,i));a.push(u),this.buffer=this.buffer.slice(r.index),_r(this,ar,null,"f")}else a.push(this.decodeText(this.buffer.slice(0,kr(this,ar,"f")-1))),this.buffer=this.buffer.slice(kr(this,ar,"f")),_r(this,ar,null,"f");return a}},{key:"decodeText",value:function(e){if(null==e)return"";if("string"===typeof e)return e;if("undefined"!==typeof Buffer){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new ir("Unexpected: received non-Uint8Array (".concat(e.constructor.name,') stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.'))}if("undefined"!==typeof TextDecoder){var t;if(e instanceof Uint8Array||e instanceof ArrayBuffer)return null!==(t=this.textDecoder)&&void 0!==t||(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new ir("Unexpected: received non-Uint8Array/ArrayBuffer (".concat(e.constructor.name,") in a web platform. Please report this error."))}throw new ir("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}},{key:"flush",value:function(){return this.buffer.length?this.decode("\n"):[]}}]),e}();function xr(e,t){for(var n=null!==t&&void 0!==t?t:0;n<e.length;n++){if(10===e[n])return{preceding:n,index:n+1,carriage:!1};if(13===e[n])return{preceding:n,index:n+1,carriage:!0}}return null}function Er(e){for(var t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1])return t+2;if(13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return-1}function Ar(e){if(e[Symbol.asyncIterator])return e;var t=e.getReader();return P({next:function(){return b(p().mark((function e(){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.read();case 3:return null!==(n=e.sent)&&void 0!==n&&n.done&&t.releaseLock(),e.abrupt("return",n);case 8:throw e.prev=8,e.t0=e.catch(0),t.releaseLock(),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))()},return:function(){return b(p().mark((function e(){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.cancel(),t.releaseLock(),e.next=4,n;case 4:return e.abrupt("return",{done:!0,value:void 0});case 5:case"end":return e.stop()}}),e)})))()}},Symbol.asyncIterator,(function(){return this}))}ar=new WeakMap,wr.NEWLINE_CHARS=new Set(["\n","\r"]),wr.NEWLINE_REGEXP=/\r\n|[\n\r]/g;var Cr=function(e){function t(e,n){T(this,t),this.iterator=e,this.controller=n}return I(t,[{key:Symbol.asyncIterator,value:function(){return this.iterator()}},{key:"tee",value:function(){var e=[],n=[],r=this.iterator(),a=function(t){return{next:function(){if(0===t.length){var a=r.next();e.push(a),n.push(a)}return t.shift()}}};return[new t((function(){return a(e)}),this.controller),new t((function(){return a(n)}),this.controller)]}},{key:"toReadableStream",value:function(){var e,t=this,n=new TextEncoder;return new Qn({start:function(){return b(p().mark((function n(){return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e=t[Symbol.asyncIterator]();case 1:case"end":return n.stop()}}),n)})))()},pull:function(t){return b(p().mark((function r(){var a,i,u;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.next();case 3:if(a=r.sent,i=a.value,!a.done){r.next=8;break}return r.abrupt("return",t.close());case 8:u=n.encode(JSON.stringify(i)+"\n"),t.enqueue(u),r.next=15;break;case 12:r.prev=12,r.t0=r.catch(0),t.error(r.t0);case 15:case"end":return r.stop()}}),r,null,[[0,12]])})))()},cancel:function(){return b(p().mark((function t(){var n,r;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(n=(r=e).return)||void 0===n?void 0:n.call(r);case 2:case"end":return t.stop()}}),t)})))()}})}}],[{key:"fromSSEResponse",value:function(e,n){var r=!1;function a(){return(a=An(p().mark((function t(){var a,i,u,o,s,c,l,d,f;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=2;break}throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");case 2:r=!0,a=!1,t.prev=4,i=!1,u=!1,t.prev=7,s=Cn(Dr(e,n));case 9:return t.next=11,xn(s.next());case 11:if(!(i=!(c=t.sent).done)){t.next=52;break}if(l=c.value,!a){t.next=15;break}return t.abrupt("continue",49);case 15:if(!l.data.startsWith("[DONE]")){t.next=18;break}return a=!0,t.abrupt("continue",49);case 18:if(null!==l.event&&!l.event.startsWith("response.")&&!l.event.startsWith("transcript.")){t.next=35;break}d=void 0,t.prev=20,d=JSON.parse(l.data),t.next=29;break;case 24:throw t.prev=24,t.t0=t.catch(20),console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),t.t0;case 29:if(!d||!d.error){t.next=31;break}throw new ur(void 0,d.error,void 0,ia(e.headers));case 31:return t.next=33,d;case 33:t.next=49;break;case 35:f=void 0,t.prev=36,f=JSON.parse(l.data),t.next=45;break;case 40:throw t.prev=40,t.t1=t.catch(36),console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),t.t1;case 45:if("error"!=l.event){t.next=47;break}throw new ur(void 0,f.error,f.message,void 0);case 47:return t.next=49,{event:l.event,data:f};case 49:i=!1,t.next=9;break;case 52:t.next=58;break;case 54:t.prev=54,t.t2=t.catch(7),u=!0,o=t.t2;case 58:if(t.prev=58,t.prev=59,!i||null==s.return){t.next=63;break}return t.next=63,xn(s.return());case 63:if(t.prev=63,!u){t.next=66;break}throw o;case 66:return t.finish(63);case 67:return t.finish(58);case 68:a=!0,t.next=76;break;case 71:if(t.prev=71,t.t3=t.catch(4),!(t.t3 instanceof Error&&"AbortError"===t.t3.name)){t.next=75;break}return t.abrupt("return");case 75:throw t.t3;case 76:return t.prev=76,a||n.abort(),t.finish(76);case 79:case"end":return t.stop()}}),t,null,[[4,71,76,79],[7,54,58,68],[20,24],[36,40],[59,,63,67]])})))).apply(this,arguments)}return new t((function(){return a.apply(this,arguments)}),n)}},{key:"fromReadableStream",value:function(e,n){var r=!1;function a(){return i.apply(this,arguments)}function i(){return(i=An(p().mark((function t(){var n,r,a,i,u,o,s,c,l,d,f,h,v,m;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new wr,r=Ar(e),a=!1,i=!1,t.prev=4,o=Cn(r);case 6:return t.next=8,xn(o.next());case 8:if(!(a=!(s=t.sent).done)){t.next=30;break}c=s.value,l=G(n.decode(c)),t.prev=11,l.s();case 13:if((d=l.n()).done){t.next=19;break}return f=d.value,t.next=17,f;case 17:t.next=13;break;case 19:t.next=24;break;case 21:t.prev=21,t.t0=t.catch(11),l.e(t.t0);case 24:return t.prev=24,l.f(),t.finish(24);case 27:a=!1,t.next=6;break;case 30:t.next=36;break;case 32:t.prev=32,t.t1=t.catch(4),i=!0,u=t.t1;case 36:if(t.prev=36,t.prev=37,!a||null==o.return){t.next=41;break}return t.next=41,xn(o.return());case 41:if(t.prev=41,!i){t.next=44;break}throw u;case 44:return t.finish(41);case 45:return t.finish(36);case 46:h=G(n.flush()),t.prev=47,h.s();case 49:if((v=h.n()).done){t.next=55;break}return m=v.value,t.next=53,m;case 53:t.next=49;break;case 55:t.next=60;break;case 57:t.prev=57,t.t2=t.catch(47),h.e(t.t2);case 60:return t.prev=60,h.f(),t.finish(60);case 63:case"end":return t.stop()}}),t,null,[[4,32,36,46],[11,21,24,27],[37,,41,45],[47,57,60,63]])})))).apply(this,arguments)}function u(){return(u=An(p().mark((function e(){var t,i,u,o,s,c,l;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=2;break}throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");case 2:r=!0,t=!1,e.prev=4,i=!1,u=!1,e.prev=7,s=Cn(a());case 9:return e.next=11,xn(s.next());case 11:if(!(i=!(c=e.sent).done)){e.next=21;break}if(l=c.value,!t){e.next=15;break}return e.abrupt("continue",18);case 15:if(!l){e.next=18;break}return e.next=18,JSON.parse(l);case 18:i=!1,e.next=9;break;case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(7),u=!0,o=e.t0;case 27:if(e.prev=27,e.prev=28,!i||null==s.return){e.next=32;break}return e.next=32,xn(s.return());case 32:if(e.prev=32,!u){e.next=35;break}throw o;case 35:return e.finish(32);case 36:return e.finish(27);case 37:t=!0,e.next=45;break;case 40:if(e.prev=40,e.t1=e.catch(4),!(e.t1 instanceof Error&&"AbortError"===e.t1.name)){e.next=44;break}return e.abrupt("return");case 44:throw e.t1;case 45:return e.prev=45,t||n.abort(),e.finish(45);case 48:case"end":return e.stop()}}),e,null,[[4,40,45,48],[7,23,27,37],[28,,32,36]])})))).apply(this,arguments)}return new t((function(){return u.apply(this,arguments)}),n)}}]),t}();function Dr(e,t){return Sr.apply(this,arguments)}function Sr(){return(Sr=An(p().mark((function e(t,n){var r,a,i,u,o,s,c,l,d,f,h,v,m,y,g,b,_;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.body){e.next=3;break}throw n.abort(),new ir("Attempted to iterate over a response with no body");case 3:r=new Pr,a=new wr,i=Ar(t.body),u=!1,o=!1,e.prev=8,c=Cn(Or(i));case 10:return e.next=12,xn(c.next());case 12:if(!(u=!(l=e.sent).done)){e.next=36;break}d=l.value,f=G(a.decode(d)),e.prev=15,f.s();case 17:if((h=f.n()).done){e.next=25;break}if(v=h.value,!(m=r.decode(v))){e.next=23;break}return e.next=23,m;case 23:e.next=17;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(15),f.e(e.t0);case 30:return e.prev=30,f.f(),e.finish(30);case 33:u=!1,e.next=10;break;case 36:e.next=42;break;case 38:e.prev=38,e.t1=e.catch(8),o=!0,s=e.t1;case 42:if(e.prev=42,e.prev=43,!u||null==c.return){e.next=47;break}return e.next=47,xn(c.return());case 47:if(e.prev=47,!o){e.next=50;break}throw s;case 50:return e.finish(47);case 51:return e.finish(42);case 52:y=G(a.flush()),e.prev=53,y.s();case 55:if((g=y.n()).done){e.next=63;break}if(b=g.value,!(_=r.decode(b))){e.next=61;break}return e.next=61,_;case 61:e.next=55;break;case 63:e.next=68;break;case 65:e.prev=65,e.t2=e.catch(53),y.e(e.t2);case 68:return e.prev=68,y.f(),e.finish(68);case 71:case"end":return e.stop()}}),e,null,[[8,38,42,52],[15,27,30,33],[43,,47,51],[53,65,68,71]])})))).apply(this,arguments)}function Or(e){return Fr.apply(this,arguments)}function Fr(){return(Fr=An(p().mark((function e(t){var n,r,a,i,u,o,s,c,l,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=new Uint8Array,r=!1,a=!1,e.prev=3,u=Cn(t);case 5:return e.next=7,xn(u.next());case 7:if(!(r=!(o=e.sent).done)){e.next=26;break}if(null!=(s=o.value)){e.next=11;break}return e.abrupt("continue",23);case 11:c=s instanceof ArrayBuffer?new Uint8Array(s):"string"===typeof s?(new TextEncoder).encode(s):s,(l=new Uint8Array(n.length+c.length)).set(n),l.set(c,n.length),n=l,d=void 0;case 17:if(-1===(d=Er(n))){e.next=23;break}return e.next=20,n.slice(0,d);case 20:n=n.slice(d),e.next=17;break;case 23:r=!1,e.next=5;break;case 26:e.next=32;break;case 28:e.prev=28,e.t0=e.catch(3),a=!0,i=e.t0;case 32:if(e.prev=32,e.prev=33,!r||null==u.return){e.next=37;break}return e.next=37,xn(u.return());case 37:if(e.prev=37,!a){e.next=40;break}throw i;case 40:return e.finish(37);case 41:return e.finish(32);case 42:if(!(n.length>0)){e.next=45;break}return e.next=45,n;case 45:case"end":return e.stop()}}),e,null,[[3,28,32,42],[33,,37,41]])})))).apply(this,arguments)}var Pr=function(){function e(){T(this,e),this.event=null,this.data=[],this.chunks=[]}return I(e,[{key:"decode",value:function(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;var t={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],t}if(this.chunks.push(e),e.startsWith(":"))return null;var n=function(e,t){var n=e.indexOf(t);if(-1!==n)return[e.substring(0,n),t,e.substring(n+t.length)];return[e,"",""]}(e,":"),r=w(n,3),a=r[0],i=(r[1],r[2]);return i.startsWith(" ")&&(i=i.substring(1)),"event"===a?this.event=i:"data"===a&&this.data.push(i),null}}]),e}();var Tr=function(e){return null!=e&&"object"===typeof e&&"string"===typeof e.url&&"function"===typeof e.blob},jr=function(e){return null!=e&&"object"===typeof e&&"string"===typeof e.name&&"number"===typeof e.lastModified&&Ir(e)},Ir=function(e){return null!=e&&"object"===typeof e&&"number"===typeof e.size&&"string"===typeof e.type&&"function"===typeof e.text&&"function"===typeof e.slice&&"function"===typeof e.arrayBuffer},Nr=function(e){return jr(e)||Tr(e)||tr(e)};function Rr(e,t,n){return Br.apply(this,arguments)}function Br(){return(Br=b(p().mark((function e(t,n,r){var a,i,u,o,s,c,l,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(t=e.sent,!jr(t)){e.next=5;break}return e.abrupt("return",t);case 5:if(!Tr(t)){e.next=20;break}return e.next=8,t.blob();case 8:if(o=e.sent,n||(n=null!==(u=new URL(t.url).pathname.split(/[\\/]/).pop())&&void 0!==u?u:"unknown_file"),!Ir(o)){e.next=17;break}return e.next=13,o.arrayBuffer();case 13:e.t1=e.sent,e.t0=[e.t1],e.next=18;break;case 17:e.t0=[o];case 18:return s=e.t0,e.abrupt("return",new Kn(s,n,r));case 20:return e.next=22,Lr(t);case 22:return c=e.sent,n||(n=null!==(a=zr(t))&&void 0!==a?a:"unknown_file"),null!==(i=r)&&void 0!==i&&i.type||"string"===typeof(d=null===(l=c[0])||void 0===l?void 0:l.type)&&(r=q(q({},r),{},{type:d})),e.abrupt("return",new Kn(c,n,r));case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Lr(e){return Mr.apply(this,arguments)}function Mr(){return(Mr=b(p().mark((function e(t){var n,r,a,i,u,o,s,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],!("string"===typeof t||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)){e.next=5;break}n.push(t),e.next=45;break;case 5:if(!Ir(t)){e.next=13;break}return e.t0=n,e.next=9,t.arrayBuffer();case 9:e.t1=e.sent,e.t0.push.call(e.t0,e.t1),e.next=45;break;case 13:if(!Wr(t)){e.next=44;break}r=!1,a=!1,e.prev=16,u=Cn(t);case 18:return e.next=20,u.next();case 20:if(!(r=!(o=e.sent).done)){e.next=26;break}s=o.value,n.push(s);case 23:r=!1,e.next=18;break;case 26:e.next=32;break;case 28:e.prev=28,e.t2=e.catch(16),a=!0,i=e.t2;case 32:if(e.prev=32,e.prev=33,!r||null==u.return){e.next=37;break}return e.next=37,u.return();case 37:if(e.prev=37,!a){e.next=40;break}throw i;case 40:return e.finish(37);case 41:return e.finish(32);case 42:e.next=45;break;case 44:throw new Error("Unexpected data type: ".concat(typeof t,"; constructor: ").concat(null===t||void 0===t||null===(c=t.constructor)||void 0===c?void 0:c.name,"; props: ").concat(Ur(t)));case 45:return e.abrupt("return",n);case 46:case"end":return e.stop()}}),e,null,[[16,28,32,42],[33,,37,41]])})))).apply(this,arguments)}function Ur(e){var t=Object.getOwnPropertyNames(e);return"[".concat(t.map((function(e){return'"'.concat(e,'"')})).join(", "),"]")}function zr(e){var t;return Zr(e.name)||Zr(e.filename)||(null===(t=Zr(e.path))||void 0===t?void 0:t.split(/[\\/]/).pop())}var Hr,Zr=function(e){return"string"===typeof e?e:"undefined"!==typeof Buffer&&e instanceof Buffer?String(e):void 0},Wr=function(e){return null!=e&&"object"===typeof e&&"function"===typeof e[Symbol.asyncIterator]},qr=function(e){return e&&"object"===typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag]},Gr=function(){var e=b(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Vr(t.body);case 2:return n=e.sent,e.abrupt("return",Xn(n,t));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Vr=function(){var e=b(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Jn,e.next=3,Promise.all(Object.entries(t||{}).map((function(e){var t=w(e,2),r=t[0],a=t[1];return $r(n,r,a)})));case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$r=function(){var e=b(p().mark((function e(t,n,r){var a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==r){e.next=2;break}return e.abrupt("return");case 2:if(null!=r){e.next=4;break}throw new TypeError('Received null for "'.concat(n,"\"; to pass null in FormData, you must use the string 'null'"));case 4:if("string"!==typeof r&&"number"!==typeof r&&"boolean"!==typeof r){e.next=8;break}t.append(n,String(r)),e.next=26;break;case 8:if(!Nr(r)){e.next=15;break}return e.next=11,Rr(r);case 11:a=e.sent,t.append(n,a),e.next=26;break;case 15:if(!Array.isArray(r)){e.next=20;break}return e.next=18,Promise.all(r.map((function(e){return $r(t,n+"[]",e)})));case 18:case 23:e.next=26;break;case 20:if("object"!==typeof r){e.next=25;break}return e.next=23,Promise.all(Object.entries(r).map((function(e){var r=w(e,2),a=r[0],i=r[1];return $r(t,"".concat(n,"[").concat(a,"]"),i)})));case 25:throw new TypeError("Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ".concat(r," instead"));case 26:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Jr=["signal"],Kr=function(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n},Qr=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};function Xr(e){return Yr.apply(this,arguments)}function Yr(){return(Yr=b(p().mark((function e(t){var n,r,a,i,u,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.response,!t.options.stream){e.next=6;break}if(Ea("response",r.status,r.url,r.headers,r.body),!t.options.__streamClass){e.next=5;break}return e.abrupt("return",t.options.__streamClass.fromSSEResponse(r,t.controller));case 5:return e.abrupt("return",Cr.fromSSEResponse(r,t.controller));case 6:if(204!==r.status){e.next=8;break}return e.abrupt("return",null);case 8:if(!t.options.__binaryResponse){e.next=10;break}return e.abrupt("return",r);case 10:if(a=r.headers.get("content-type"),i=null===a||void 0===a||null===(n=a.split(";")[0])||void 0===n?void 0:n.trim(),!((null===i||void 0===i?void 0:i.includes("application/json"))||(null===i||void 0===i?void 0:i.endsWith("+json")))){e.next=19;break}return e.next=16,r.json();case 16:return u=e.sent,Ea("response",r.status,r.url,r.headers,u),e.abrupt("return",ea(u,r));case 19:return e.next=21,r.text();case 21:return o=e.sent,Ea("response",r.status,r.url,r.headers,o),e.abrupt("return",o);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ea(e,t){return!e||"object"!==typeof e||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}rr();var ta=function(e){B(n,e);var t=z(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xr;return T(this,n),(r=t.call(this,(function(e){e(null)}))).responsePromise=e,r.parseResponse=a,r}return I(n,[{key:"_thenUnwrap",value:function(e){var t=this;return new n(this.responsePromise,function(){var n=b(p().mark((function n(r){return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=ea,n.t1=e,n.next=4,t.parseResponse(r);case 4:return n.t2=n.sent,n.t3=r,n.t4=(0,n.t1)(n.t2,n.t3),n.t5=r.response,n.abrupt("return",(0,n.t0)(n.t4,n.t5));case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}},{key:"asResponse",value:function(){return this.responsePromise.then((function(e){return e.response}))}},{key:"withResponse",value:function(){var e=b(p().mark((function e(){var t,n,r,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.parse(),this.asResponse()]);case 2:return t=e.sent,n=w(t,2),r=n[0],a=n[1],e.abrupt("return",{data:r,response:a,request_id:a.headers.get("x-request-id")});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"parse",value:function(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}},{key:"then",value:function(e,t){return this.parse().then(e,t)}},{key:"catch",value:function(e){return this.parse().catch(e)}},{key:"finally",value:function(e){return this.parse().finally(e)}}]),n}(Z(Promise)),na=function(){function e(t){var n=t.baseURL,r=t.maxRetries,a=void 0===r?2:r,i=t.timeout,u=void 0===i?6e5:i,o=t.httpAgent,s=t.fetch;T(this,e),this.baseURL=n,this.maxRetries=ya("maxRetries",a),this.timeout=ya("timeout",u),this.httpAgent=o,this.fetch=null!==s&&void 0!==s?s:$n}return I(e,[{key:"authHeaders",value:function(e){return{}}},{key:"defaultHeaders",value:function(e){return q(q({Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent()},fa()),this.authHeaders(e))}},{key:"validateHeaders",value:function(e,t){}},{key:"defaultIdempotencyKey",value:function(){return"stainless-node-retry-".concat(Aa())}},{key:"get",value:function(e,t){return this.methodRequest("get",e,t)}},{key:"post",value:function(e,t){return this.methodRequest("post",e,t)}},{key:"patch",value:function(e,t){return this.methodRequest("patch",e,t)}},{key:"put",value:function(e,t){return this.methodRequest("put",e,t)}},{key:"delete",value:function(e,t){return this.methodRequest("delete",e,t)}},{key:"methodRequest",value:function(e,t,n){return this.request(Promise.resolve(n).then(function(){var n=b(p().mark((function n(r){var a;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!r||!Ir(null===r||void 0===r?void 0:r.body)){n.next=8;break}return n.t1=DataView,n.next=4,r.body.arrayBuffer();case 4:n.t2=n.sent,n.t0=new n.t1(n.t2),n.next=9;break;case 8:n.t0=(null===r||void 0===r?void 0:r.body)instanceof DataView?r.body:(null===r||void 0===r?void 0:r.body)instanceof ArrayBuffer?new DataView(r.body):r&&ArrayBuffer.isView(null===r||void 0===r?void 0:r.body)?new DataView(r.body.buffer):null===r||void 0===r?void 0:r.body;case 9:return a=n.t0,n.abrupt("return",q(q({method:e,path:t},r),{},{body:a}));case 11:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()))}},{key:"getAPIList",value:function(e,t,n){return this.requestAPIList(t,q({method:"get",path:e},n))}},{key:"calculateContentLength",value:function(e){if("string"===typeof e){if("undefined"!==typeof Buffer)return Buffer.byteLength(e,"utf8").toString();if("undefined"!==typeof TextEncoder)return(new TextEncoder).encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}},{key:"buildRequest",value:function(e){var t,n,r,a,i,u,o=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).retryCount,s=void 0===o?0:o,c=e=q({},e),l=c.method,d=c.path,f=c.query,p=c.headers,h=void 0===p?{}:p,v=ArrayBuffer.isView(e.body)||e.__binaryRequest&&"string"===typeof e.body?e.body:qr(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,m=this.calculateContentLength(v),y=this.buildURL(d,f);"timeout"in e&&ya("timeout",e.timeout),e.timeout=null!==(t=e.timeout)&&void 0!==t?t:this.timeout;var g=null!==(n=null!==(r=e.httpAgent)&&void 0!==r?r:this.httpAgent)&&void 0!==n?n:Yn(y),b=e.timeout+1e3;"number"===typeof(null===g||void 0===g||null===(a=g.options)||void 0===a?void 0:a.timeout)&&b>(null!==(i=g.options.timeout)&&void 0!==i?i:0)&&(g.options.timeout=b),this.idempotencyHeader&&"get"!==l&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),h[this.idempotencyHeader]=e.idempotencyKey);var _=this.buildHeaders({options:e,headers:h,contentLength:m,retryCount:s});return{req:q(q(q({method:l},v&&{body:v}),{},{headers:_},g&&{agent:g}),{},{signal:null!==(u=e.signal)&&void 0!==u?u:null}),url:y,timeout:e.timeout}}},{key:"buildHeaders",value:function(e){var t=e.options,n=e.headers,r=e.contentLength,a=e.retryCount,i={};r&&(i["content-length"]=r);var u=this.defaultHeaders(t);return wa(i,u),wa(i,n),qr(t.body)&&"node"!==Vn&&delete i["content-type"],void 0===Ca(u,"x-stainless-retry-count")&&void 0===Ca(n,"x-stainless-retry-count")&&(i["x-stainless-retry-count"]=String(a)),void 0===Ca(u,"x-stainless-timeout")&&void 0===Ca(n,"x-stainless-timeout")&&t.timeout&&(i["x-stainless-timeout"]=String(t.timeout)),this.validateHeaders(i,n),i}},{key:"prepareOptions",value:function(){var e=b(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"prepareRequest",value:function(){var e=b(p().mark((function e(t,n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.url,n.options;case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"parseHeaders",value:function(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map((function(e){return y(e)}))):q({},e):{}}},{key:"makeStatusError",value:function(e,t,n,r){return ur.generate(e,t,n,r)}},{key:"request",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new ta(this.makeRequest(e,t))}},{key:"makeRequest",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u,o,s,c,l,d,f,h,v,m,y,g,b;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:return i=e.sent,u=null!==(r=i.maxRetries)&&void 0!==r?r:this.maxRetries,null==n&&(n=u),e.next=7,this.prepareOptions(i);case 7:return o=this.buildRequest(i,{retryCount:u-n}),s=o.req,c=o.url,l=o.timeout,e.next=10,this.prepareRequest(s,{url:c,options:i});case 10:if(Ea("request",c,i,s.headers),null===(a=i.signal)||void 0===a||!a.aborted){e.next=13;break}throw new or;case 13:return d=new AbortController,e.next=16,this.fetchWithTimeout(c,s,l,d).catch(ga);case 16:if(!((f=e.sent)instanceof Error)){e.next=25;break}if(null===(h=i.signal)||void 0===h||!h.aborted){e.next=20;break}throw new or;case 20:if(!n){e.next=22;break}return e.abrupt("return",this.retryRequest(i,n));case 22:if("AbortError"!==f.name){e.next=24;break}throw new cr;case 24:throw new sr({cause:f});case 25:if(v=ia(f.headers),f.ok){e.next=40;break}if(!n||!this.shouldRetry(f)){e.next=31;break}return m="retrying, ".concat(n," attempts remaining"),Ea("response (error; ".concat(m,")"),f.status,c,v),e.abrupt("return",this.retryRequest(i,n,v));case 31:return e.next=33,f.text().catch((function(e){return ga(e).message}));case 33:throw y=e.sent,g=pa(y),b=g?void 0:y,Ea("response (error; ".concat(n?"(error; no more retries left)":"(error; not retryable)",")"),f.status,c,v,b),this.makeStatusError(f.status,g,b,v);case 40:return e.abrupt("return",{response:f,options:i,controller:d});case 41:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"requestAPIList",value:function(e,t){var n=this.makeRequest(t,null);return new aa(this,n,e)}},{key:"buildURL",value:function(e,t){var n=va(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return _a(r)||(t=q(q({},r),t)),"object"===typeof t&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}},{key:"stringifyQuery",value:function(e){return Object.entries(e).filter((function(e){var t=w(e,2);t[0];return"undefined"!==typeof t[1]})).map((function(e){var t=w(e,2),n=t[0],r=t[1];if("string"===typeof r||"number"===typeof r||"boolean"===typeof r)return"".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(r));if(null===r)return"".concat(encodeURIComponent(n),"=");throw new ir("Cannot stringify type ".concat(typeof r,"; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case."))})).join("&")}},{key:"fetchWithTimeout",value:function(){var e=b(p().mark((function e(t,n,r,a){var i,u,o,s,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=(i=n||{}).signal,o=Sn(i,Jr),u&&u.addEventListener("abort",(function(){return a.abort()})),s=setTimeout((function(){return a.abort()}),r),(c=q({signal:a.signal},o)).method&&(c.method=c.method.toUpperCase()),e.abrupt("return",this.fetch.call(void 0,t,c).finally((function(){clearTimeout(s)})));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"shouldRetry",value:function(e){var t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||(409===e.status||(429===e.status||e.status>=500)))}},{key:"retryRequest",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c,l;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=null===r||void 0===r?void 0:r["retry-after-ms"])&&(u=parseFloat(i),Number.isNaN(u)||(a=u)),(o=null===r||void 0===r?void 0:r["retry-after"])&&!a&&(s=parseFloat(o),a=Number.isNaN(s)?Date.parse(o)-Date.now():1e3*s),a&&0<=a&&a<6e4||(l=null!==(c=t.maxRetries)&&void 0!==c?c:this.maxRetries,a=this.calculateDefaultRetryTimeoutMillis(n,l)),e.next=7,ma(a);case 7:return e.abrupt("return",this.makeRequest(t,n-1));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"calculateDefaultRetryTimeoutMillis",value:function(e,t){var n=t-e;return Math.min(.5*Math.pow(2,n),8)*(1-.25*Math.random())*1e3}},{key:"getUserAgent",value:function(){return"".concat(this.constructor.name,"/JS ").concat(qn)}}]),e}(),ra=function(e){function t(e,n,r,a){T(this,t),Hr.set(this,void 0),Kr(this,Hr,e,"f"),this.options=a,this.response=n,this.body=r}return I(t,[{key:"hasNextPage",value:function(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}},{key:"getNextPage",value:function(){var e=b(p().mark((function e(){var t,n,r,a,i,u,o,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.nextPageInfo()){e.next=3;break}throw new ir("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");case 3:if(n=q({},this.options),"params"in t&&"object"===typeof n.query)n.query=q(q({},n.query),t.params);else if("url"in t){r=[].concat(y(Object.entries(n.query||{})),y(t.url.searchParams.entries())),a=G(r);try{for(a.s();!(i=a.n()).done;)u=w(i.value,2),o=u[0],s=u[1],t.url.searchParams.set(o,s)}catch(c){a.e(c)}finally{a.f()}n.query=void 0,n.path=t.url.toString()}return e.next=7,Qr(this,Hr,"f").requestAPIList(this.constructor,n);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"iterPages",value:function(){var e=this;return An(p().mark((function t(){var n;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e,t.next=3,n;case 3:if(!n.hasNextPage()){t.next=11;break}return t.next=6,xn(n.getNextPage());case 6:return n=t.sent,t.next=9,n;case 9:t.next=3;break;case 11:case"end":return t.stop()}}),t)})))()}},{key:e,value:function(){var e=this;return An(p().mark((function t(){var n,r,a,i,u,o,s,c,l;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=!1,r=!1,t.prev=2,i=Cn(e.iterPages());case 4:return t.next=6,xn(i.next());case 6:if(!(n=!(u=t.sent).done)){t.next=28;break}o=u.value,s=G(o.getPaginatedItems()),t.prev=9,s.s();case 11:if((c=s.n()).done){t.next=17;break}return l=c.value,t.next=15,l;case 15:t.next=11;break;case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(9),s.e(t.t0);case 22:return t.prev=22,s.f(),t.finish(22);case 25:n=!1,t.next=4;break;case 28:t.next=34;break;case 30:t.prev=30,t.t1=t.catch(2),r=!0,a=t.t1;case 34:if(t.prev=34,t.prev=35,!n||null==i.return){t.next=39;break}return t.next=39,xn(i.return());case 39:if(t.prev=39,!r){t.next=42;break}throw a;case 42:return t.finish(39);case 43:return t.finish(34);case 44:case"end":return t.stop()}}),t,null,[[2,30,34,44],[9,19,22,25],[35,,39,43]])})))()}}]),t}((Hr=new WeakMap,Symbol.asyncIterator)),aa=function(e,t){B(r,e);var n=z(r);function r(e,t,a){return T(this,r),n.call(this,t,function(){var t=b(p().mark((function t(n){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=a,t.t1=e,t.t2=n.response,t.next=5,Xr(n);case 5:return t.t3=t.sent,t.t4=n.options,t.abrupt("return",new t.t0(t.t1,t.t2,t.t3,t.t4));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}return I(r,[{key:t,value:function(){var e=this;return An(p().mark((function t(){var n,r,a,i,u,o,s;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,xn(e);case 2:n=t.sent,r=!1,a=!1,t.prev=5,u=Cn(n);case 7:return t.next=9,xn(u.next());case 9:if(!(r=!(o=t.sent).done)){t.next=16;break}return s=o.value,t.next=13,s;case 13:r=!1,t.next=7;break;case 16:t.next=22;break;case 18:t.prev=18,t.t0=t.catch(5),a=!0,i=t.t0;case 22:if(t.prev=22,t.prev=23,!r||null==u.return){t.next=27;break}return t.next=27,xn(u.return());case 27:if(t.prev=27,!a){t.next=30;break}throw i;case 30:return t.finish(27);case 31:return t.finish(22);case 32:case"end":return t.stop()}}),t,null,[[5,18,22,32],[23,,27,31]])})))()}}]),r}(ta,Symbol.asyncIterator),ia=function(e){return new Proxy(Object.fromEntries(e.entries()),{get:function(e,t){var n=t.toString();return e[n.toLowerCase()]||e[n]}})},ua={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},oa=function(e){return"object"===typeof e&&null!==e&&!_a(e)&&Object.keys(e).every((function(e){return ka(ua,e)}))},sa=function(){var e,t;if("undefined"!==typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":qn,"X-Stainless-OS":da(Deno.build.os),"X-Stainless-Arch":la(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"===typeof Deno.version?Deno.version:null!==(e=null===(t=Deno.version)||void 0===t?void 0:t.deno)&&void 0!==e?e:"unknown"};if("undefined"!==typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":qn,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"other:".concat(EdgeRuntime),"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if("[object process]"===Object.prototype.toString.call("undefined"!==typeof process?process:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":qn,"X-Stainless-OS":da(process.platform),"X-Stainless-Arch":la(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};var n=function(){if("undefined"===typeof navigator||!navigator)return null;for(var e=0,t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];e<t.length;e++){var n=t[e],r=n.key,a=n.pattern.exec(navigator.userAgent);if(a){var i=a[1]||0,u=a[2]||0,o=a[3]||0;return{browser:r,version:"".concat(i,".").concat(u,".").concat(o)}}}return null}();return n?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":qn,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"browser:".concat(n.browser),"X-Stainless-Runtime-Version":n.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":qn,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};var ca,la=function(e){return"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?"other:".concat(e):"unknown"},da=function(e){return(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?"Other:".concat(e):"Unknown"},fa=function(){var e;return null!==(e=ca)&&void 0!==e?e:ca=sa()},pa=function(e){try{return JSON.parse(e)}catch(t){return}},ha=/^[a-z][a-z0-9+.-]*:/i,va=function(e){return ha.test(e)},ma=function(e){return new Promise((function(t){return setTimeout(t,e)}))},ya=function(e,t){if("number"!==typeof t||!Number.isInteger(t))throw new ir("".concat(e," must be an integer"));if(t<0)throw new ir("".concat(e," must be a positive integer"));return t},ga=function(e){if(e instanceof Error)return e;if("object"===typeof e&&null!==e)try{return new Error(JSON.stringify(e))}catch(t){}return new Error(e)},ba=function(e){var t,n,r,a,i,u;return"undefined"!==typeof process?null!==(t=null===(n={NODE_ENV:"production",PUBLIC_URL:"/detective-infinity",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})||void 0===n||null===(r=n[e])||void 0===r?void 0:r.trim())&&void 0!==t?t:void 0:"undefined"!==typeof Deno?null===(a=Deno.env)||void 0===a||null===(i=a.get)||void 0===i||null===(u=i.call(a,e))||void 0===u?void 0:u.trim():void 0};function _a(e){if(!e)return!0;for(var t in e)return!1;return!0}function ka(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function wa(e,t){for(var n in t)if(ka(t,n)){var r=n.toLowerCase();if(r){var a=t[n];null===a?delete e[r]:void 0!==a&&(e[r]=a)}}}var xa=new Set(["authorization","api-key"]);function Ea(e){var t,n;if("undefined"!==typeof process&&"true"===(null===(t=process)||void 0===t||null===(n={NODE_ENV:"production",PUBLIC_URL:"/detective-infinity",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})||void 0===n?void 0:n.DEBUG)){for(var r,a=arguments.length,i=new Array(a>1?a-1:0),u=1;u<a;u++)i[u-1]=arguments[u];var o=i.map((function(e){var t;if(!e)return e;if(e.headers){var n=q(q({},e),{},{headers:q({},e.headers)});for(var r in e.headers)xa.has(r.toLowerCase())&&(n.headers[r]="REDACTED");return n}var a=null;for(var i in e){var u;if(xa.has(i.toLowerCase()))null!==(u=a)&&void 0!==u||(a=q({},e)),a[i]="REDACTED"}return null!==(t=a)&&void 0!==t?t:e}));(r=console).log.apply(r,["OpenAI:DEBUG:".concat(e)].concat(y(o)))}}var Aa=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},Ca=function(e,t){var n=t.toLowerCase();if(function(e){return"function"===typeof(null===e||void 0===e?void 0:e.get)}(e))for(var r,a=(null===(r=t[0])||void 0===r?void 0:r.toUpperCase())+t.substring(1).replace(/([^\w])(\w)/g,(function(e,t,n){return t+n.toUpperCase()})),i=0,u=[t,n,t.toUpperCase(),a];i<u.length;i++){var o=u[i],s=e.get(o);if(s)return s}for(var c=0,l=Object.entries(e);c<l.length;c++){var d=w(l[c],2),f=d[0],p=d[1];if(f.toLowerCase()===n)return Array.isArray(p)?(p.length<=1||console.warn("Received ".concat(p.length," entries for the ").concat(t," header, using the first entry.")),p[0]):p}};function Da(e){return null!=e&&"object"===typeof e&&!Array.isArray(e)}var Sa=I((function e(t){T(this,e),this._client=t})),Oa=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"create",value:function(e,t){var n;return this._client.post("/completions",q(q({body:e},t),{},{stream:null!==(n=e.stream)&&void 0!==n&&n}))}}]),n}(Sa),Fa=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"list",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return oa(t)?this.list(e,{},t):this._client.getAPIList("/chat/completions/".concat(e,"/messages"),Na,q({query:t},n))}}]),n}(Sa),Pa=function(e){B(n,e);var t=z(n);function n(e,r,a,i){var u;return T(this,n),(u=t.call(this,e,r,a,i)).data=a.data||[],u.object=a.object,u}return I(n,[{key:"getPaginatedItems",value:function(){var e;return null!==(e=this.data)&&void 0!==e?e:[]}},{key:"nextPageParams",value:function(){return null}},{key:"nextPageInfo",value:function(){return null}}]),n}(ra),Ta=function(e){B(n,e);var t=z(n);function n(e,r,a,i){var u;return T(this,n),(u=t.call(this,e,r,a,i)).data=a.data||[],u.has_more=a.has_more||!1,u}return I(n,[{key:"getPaginatedItems",value:function(){var e;return null!==(e=this.data)&&void 0!==e?e:[]}},{key:"hasNextPage",value:function(){return!1!==this.has_more&&kn(L(n.prototype),"hasNextPage",this).call(this)}},{key:"nextPageParams",value:function(){var e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;var t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}},{key:"nextPageInfo",value:function(){var e,t=this.getPaginatedItems();if(!t.length)return null;var n=null===(e=t[t.length-1])||void 0===e?void 0:e.id;return n?{params:{after:n}}:null}}]),n}(ra),ja=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).messages=new Fa(e._client),e}return I(n,[{key:"create",value:function(e,t){var n;return this._client.post("/chat/completions",q(q({body:e},t),{},{stream:null!==(n=e.stream)&&void 0!==n&&n}))}},{key:"retrieve",value:function(e,t){return this._client.get("/chat/completions/".concat(e),t)}},{key:"update",value:function(e,t,n){return this._client.post("/chat/completions/".concat(e),q({body:t},n))}},{key:"list",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return oa(e)?this.list({},e):this._client.getAPIList("/chat/completions",Ia,q({query:e},t))}},{key:"del",value:function(e,t){return this._client.delete("/chat/completions/".concat(e),t)}}]),n}(Sa),Ia=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Ta),Na=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Ta);ja.ChatCompletionsPage=Ia,ja.Messages=Fa;var Ra=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).completions=new ja(e._client),e}return I(n)}(Sa);Ra.Completions=ja,Ra.ChatCompletionsPage=Ia;var Ba=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"create",value:function(e,t){var n=!!e.encoding_format,r=n?e.encoding_format:"base64";n&&Ea("Request","User defined encoding_format:",e.encoding_format);var a=this._client.post("/embeddings",q({body:q(q({},e),{},{encoding_format:r})},t));return n?a:(Ea("response","Decoding base64 embeddings to float32 array"),a._thenUnwrap((function(e){return e&&e.data&&e.data.forEach((function(e){var t=e.embedding;e.embedding=function(e){if("undefined"!==typeof Buffer)return Array.from(new Float32Array(Buffer.from(e,"base64").buffer));for(var t=atob(e),n=t.length,r=new Uint8Array(n),a=0;a<n;a++)r[a]=t.charCodeAt(a);return Array.from(new Float32Array(r.buffer))}(t)})),e})))}}]),n}(Sa),La=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"create",value:function(e,t){return this._client.post("/files",Gr(q({body:e},t)))}},{key:"retrieve",value:function(e,t){return this._client.get("/files/".concat(e),t)}},{key:"list",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return oa(e)?this.list({},e):this._client.getAPIList("/files",Ma,q({query:e},t))}},{key:"del",value:function(e,t){return this._client.delete("/files/".concat(e),t)}},{key:"content",value:function(e,t){return this._client.get("/files/".concat(e,"/content"),q(q({},t),{},{headers:q({Accept:"application/binary"},null===t||void 0===t?void 0:t.headers),__binaryResponse:!0}))}},{key:"retrieveContent",value:function(e,t){return this._client.get("/files/".concat(e,"/content"),t)}},{key:"waitForProcessing",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n=l.length>1&&void 0!==l[1]?l[1]:{}).pollInterval,a=void 0===r?5e3:r,i=n.maxWait,u=void 0===i?18e5:i,o=new Set(["processed","error","deleted"]),s=Date.now(),e.next=5,this.retrieve(t);case 5:c=e.sent;case 6:if(c.status&&o.has(c.status)){e.next=16;break}return e.next=9,ma(a);case 9:return e.next=11,this.retrieve(t);case 11:if(c=e.sent,!(Date.now()-s>u)){e.next=14;break}throw new cr({message:"Giving up on waiting for file ".concat(t," to finish processing after ").concat(u," milliseconds.")});case 14:e.next=6;break;case 16:return e.abrupt("return",c);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Sa),Ma=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Ta);La.FileObjectsPage=Ma;var Ua=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"createVariation",value:function(e,t){return this._client.post("/images/variations",Gr(q({body:e},t)))}},{key:"edit",value:function(e,t){return this._client.post("/images/edits",Gr(q({body:e},t)))}},{key:"generate",value:function(e,t){return this._client.post("/images/generations",q({body:e},t))}}]),n}(Sa),za=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"create",value:function(e,t){return this._client.post("/audio/speech",q(q({body:e},t),{},{headers:q({Accept:"application/octet-stream"},null===t||void 0===t?void 0:t.headers),__binaryResponse:!0}))}}]),n}(Sa),Ha=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"create",value:function(e,t){var n;return this._client.post("/audio/transcriptions",Gr(q(q({body:e},t),{},{stream:null!==(n=e.stream)&&void 0!==n&&n,__metadata:{model:e.model}})))}}]),n}(Sa),Za=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"create",value:function(e,t){return this._client.post("/audio/translations",Gr(q(q({body:e},t),{},{__metadata:{model:e.model}})))}}]),n}(Sa),Wa=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).transcriptions=new Ha(e._client),e.translations=new Za(e._client),e.speech=new za(e._client),e}return I(n)}(Sa);Wa.Transcriptions=Ha,Wa.Translations=Za,Wa.Speech=za;var qa=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"create",value:function(e,t){return this._client.post("/moderations",q({body:e},t))}}]),n}(Sa),Ga=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"retrieve",value:function(e,t){return this._client.get("/models/".concat(e),t)}},{key:"list",value:function(e){return this._client.getAPIList("/models",Va,e)}},{key:"del",value:function(e,t){return this._client.delete("/models/".concat(e),t)}}]),n}(Sa),Va=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Pa);Ga.ModelsPage=Va;var $a=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"list",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return oa(t)?this.list(e,{},t):this._client.getAPIList("/fine_tuning/jobs/".concat(e,"/checkpoints"),Ja,q({query:t},n))}}]),n}(Sa),Ja=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Ta);$a.FineTuningJobCheckpointsPage=Ja;var Ka=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).checkpoints=new $a(e._client),e}return I(n,[{key:"create",value:function(e,t){return this._client.post("/fine_tuning/jobs",q({body:e},t))}},{key:"retrieve",value:function(e,t){return this._client.get("/fine_tuning/jobs/".concat(e),t)}},{key:"list",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return oa(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Qa,q({query:e},t))}},{key:"cancel",value:function(e,t){return this._client.post("/fine_tuning/jobs/".concat(e,"/cancel"),t)}},{key:"listEvents",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return oa(t)?this.listEvents(e,{},t):this._client.getAPIList("/fine_tuning/jobs/".concat(e,"/events"),Xa,q({query:t},n))}}]),n}(Sa),Qa=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Ta),Xa=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Ta);Ka.FineTuningJobsPage=Qa,Ka.FineTuningJobEventsPage=Xa,Ka.Checkpoints=$a,Ka.FineTuningJobCheckpointsPage=Ja;var Ya=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).jobs=new Ka(e._client),e}return I(n)}(Sa);Ya.Jobs=Ka,Ya.FineTuningJobsPage=Qa,Ya.FineTuningJobEventsPage=Xa;var ei=function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.allSettled(t);case 2:if(n=e.sent,r=n.filter((function(e){return"rejected"===e.status})),!r.length){e.next=8;break}a=G(r);try{for(a.s();!(i=a.n()).done;)u=i.value,console.error(u.reason)}catch(d){a.e(d)}finally{a.f()}throw new Error("".concat(r.length," promise(s) failed - see the above errors"));case 8:o=[],s=G(n);try{for(s.s();!(c=s.n()).done;)"fulfilled"===(l=c.value).status&&o.push(l.value)}catch(d){s.e(d)}finally{s.f()}return e.abrupt("return",o);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ti=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"create",value:function(e,t,n){return this._client.post("/vector_stores/".concat(e,"/files"),q(q({body:t},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}},{key:"retrieve",value:function(e,t,n){return this._client.get("/vector_stores/".concat(e,"/files/").concat(t),q(q({},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}},{key:"update",value:function(e,t,n,r){return this._client.post("/vector_stores/".concat(e,"/files/").concat(t),q(q({body:n},r),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===r||void 0===r?void 0:r.headers)}))}},{key:"list",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return oa(t)?this.list(e,{},t):this._client.getAPIList("/vector_stores/".concat(e,"/files"),ni,q(q({query:t},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}},{key:"del",value:function(e,t,n){return this._client.delete("/vector_stores/".concat(e,"/files/").concat(t),q(q({},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}},{key:"createAndPoll",value:function(){var e=b(p().mark((function e(t,n,r){var a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.create(t,n,r);case 2:return a=e.sent,e.next=5,this.poll(t,a.id,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"poll",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=q(q({},null===r||void 0===r?void 0:r.headers),{},{"X-Stainless-Poll-Helper":"true"}),null!==r&&void 0!==r&&r.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());case 2:return e.next=5,this.retrieve(t,n,q(q({},r),{},{headers:a})).withResponse();case 5:i=e.sent,u=i.data,e.t0=u.status,e.next="in_progress"===e.t0?10:"failed"===e.t0||"completed"===e.t0?15:16;break;case 10:return o=5e3,null!==r&&void 0!==r&&r.pollIntervalMs?o=r.pollIntervalMs:(s=i.response.headers.get("openai-poll-after-ms"))&&(c=parseInt(s),isNaN(c)||(o=c)),e.next=14,ma(o);case 14:return e.abrupt("break",16);case 15:return e.abrupt("return",u);case 16:e.next=2;break;case 18:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"upload",value:function(){var e=b(p().mark((function e(t,n,r){var a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._client.files.create({file:n,purpose:"assistants"},r);case 2:return a=e.sent,e.abrupt("return",this.create(t,{file_id:a.id},r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"uploadAndPoll",value:function(){var e=b(p().mark((function e(t,n,r){var a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upload(t,n,r);case 2:return a=e.sent,e.next=5,this.poll(t,a.id,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"content",value:function(e,t,n){return this._client.getAPIList("/vector_stores/".concat(e,"/files/").concat(t,"/content"),ri,q(q({},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}}]),n}(Sa),ni=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Ta),ri=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Pa);ti.VectorStoreFilesPage=ni,ti.FileContentResponsesPage=ri;var ai=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"create",value:function(e,t,n){return this._client.post("/vector_stores/".concat(e,"/file_batches"),q(q({body:t},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}},{key:"retrieve",value:function(e,t,n){return this._client.get("/vector_stores/".concat(e,"/file_batches/").concat(t),q(q({},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}},{key:"cancel",value:function(e,t,n){return this._client.post("/vector_stores/".concat(e,"/file_batches/").concat(t,"/cancel"),q(q({},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}},{key:"createAndPoll",value:function(){var e=b(p().mark((function e(t,n,r){var a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.create(t,n);case 2:return a=e.sent,e.next=5,this.poll(t,a.id,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"listFiles",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;return oa(n)?this.listFiles(e,t,{},n):this._client.getAPIList("/vector_stores/".concat(e,"/file_batches/").concat(t,"/files"),ni,q(q({query:n},r),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===r||void 0===r?void 0:r.headers)}))}},{key:"poll",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c,l;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=q(q({},null===r||void 0===r?void 0:r.headers),{},{"X-Stainless-Poll-Helper":"true"}),null!==r&&void 0!==r&&r.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());case 2:return e.next=5,this.retrieve(t,n,q(q({},r),{},{headers:a})).withResponse();case 5:i=e.sent,u=i.data,o=i.response,e.t0=u.status,e.next="in_progress"===e.t0?11:"failed"===e.t0||"cancelled"===e.t0||"completed"===e.t0?16:17;break;case 11:return s=5e3,null!==r&&void 0!==r&&r.pollIntervalMs?s=r.pollIntervalMs:(c=o.headers.get("openai-poll-after-ms"))&&(l=parseInt(c),isNaN(l)||(s=l)),e.next=15,ma(s);case 15:return e.abrupt("break",17);case 16:return e.abrupt("return",u);case 17:e.next=2;break;case 19:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"uploadAndPoll",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c,l,d,f,h,v,m;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v=function(){return(v=b(p().mark((function e(t){var n,a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=G(t),e.prev=1,n.s();case 3:if((a=n.n()).done){e.next=11;break}return i=a.value,e.next=7,l.files.create({file:i,purpose:"assistants"},r);case 7:u=e.sent,f.push(u.id);case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),n.e(e.t0);case 16:return e.prev=16,n.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[1,13,16,19]])})))).apply(this,arguments)},h=function(e){return v.apply(this,arguments)},i=n.files,u=n.fileIds,o=void 0===u?[]:u,null!=i&&0!=i.length){e.next=5;break}throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");case 5:return s=null!==(a=null===r||void 0===r?void 0:r.maxConcurrency)&&void 0!==a?a:5,c=Math.min(s,i.length),l=this._client,d=i.values(),f=y(o),m=Array(c).fill(d).map(h),e.next=13,ei(m);case 13:return e.next=15,this.createAndPoll(t,{file_ids:f});case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(Sa),ii=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).files=new ti(e._client),e.fileBatches=new ai(e._client),e}return I(n,[{key:"create",value:function(e,t){return this._client.post("/vector_stores",q(q({body:e},t),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}},{key:"retrieve",value:function(e,t){return this._client.get("/vector_stores/".concat(e),q(q({},t),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}},{key:"update",value:function(e,t,n){return this._client.post("/vector_stores/".concat(e),q(q({body:t},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}},{key:"list",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return oa(e)?this.list({},e):this._client.getAPIList("/vector_stores",ui,q(q({query:e},t),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}},{key:"del",value:function(e,t){return this._client.delete("/vector_stores/".concat(e),q(q({},t),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}},{key:"search",value:function(e,t,n){return this._client.getAPIList("/vector_stores/".concat(e,"/search"),oi,q(q({body:t,method:"post"},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}}]),n}(Sa),ui=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Ta),oi=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Pa);ii.VectorStoresPage=ui,ii.VectorStoreSearchResponsesPage=oi,ii.Files=ti,ii.VectorStoreFilesPage=ni,ii.FileContentResponsesPage=ri,ii.FileBatches=ai;var si=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"create",value:function(e,t){return this._client.post("/assistants",q(q({body:e},t),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}},{key:"retrieve",value:function(e,t){return this._client.get("/assistants/".concat(e),q(q({},t),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}},{key:"update",value:function(e,t,n){return this._client.post("/assistants/".concat(e),q(q({body:t},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}},{key:"list",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return oa(e)?this.list({},e):this._client.getAPIList("/assistants",ci,q(q({query:e},t),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}},{key:"del",value:function(e,t){return this._client.delete("/assistants/".concat(e),q(q({},t),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}}]),n}(Sa),ci=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Ta);function li(e){return"function"===typeof e.parse}si.AssistantsPage=ci;var di=function(e){return"assistant"===(null===e||void 0===e?void 0:e.role)},fi=function(e){return"function"===(null===e||void 0===e?void 0:e.role)},pi=function(e){return"tool"===(null===e||void 0===e?void 0:e.role)};var hi,vi,mi,yi,gi,bi,_i,ki,wi,xi,Ei,Ai,Ci,Di=function(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n},Si=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},Oi=function(){function e(){var t=this;T(this,e),hi.add(this),this.controller=new AbortController,vi.set(this,void 0),mi.set(this,(function(){})),yi.set(this,(function(){})),gi.set(this,void 0),bi.set(this,(function(){})),_i.set(this,(function(){})),ki.set(this,{}),wi.set(this,!1),xi.set(this,!1),Ei.set(this,!1),Ai.set(this,!1),Di(this,vi,new Promise((function(e,n){Di(t,mi,e,"f"),Di(t,yi,n,"f")})),"f"),Di(this,gi,new Promise((function(e,n){Di(t,bi,e,"f"),Di(t,_i,n,"f")})),"f"),Si(this,vi,"f").catch((function(){})),Si(this,gi,"f").catch((function(){}))}return I(e,[{key:"_run",value:function(e){var t=this;setTimeout((function(){e().then((function(){t._emitFinal(),t._emit("end")}),Si(t,hi,"m",Ci).bind(t))}),0)}},{key:"_connected",value:function(){this.ended||(Si(this,mi,"f").call(this),this._emit("connect"))}},{key:"ended",get:function(){return Si(this,wi,"f")}},{key:"errored",get:function(){return Si(this,xi,"f")}},{key:"aborted",get:function(){return Si(this,Ei,"f")}},{key:"abort",value:function(){this.controller.abort()}},{key:"on",value:function(e,t){return(Si(this,ki,"f")[e]||(Si(this,ki,"f")[e]=[])).push({listener:t}),this}},{key:"off",value:function(e,t){var n=Si(this,ki,"f")[e];if(!n)return this;var r=n.findIndex((function(e){return e.listener===t}));return r>=0&&n.splice(r,1),this}},{key:"once",value:function(e,t){return(Si(this,ki,"f")[e]||(Si(this,ki,"f")[e]=[])).push({listener:t,once:!0}),this}},{key:"emitted",value:function(e){var t=this;return new Promise((function(n,r){Di(t,Ai,!0,"f"),"error"!==e&&t.once("error",r),t.once(e,n)}))}},{key:"done",value:function(){var e=b(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Di(this,Ai,!0,"f"),e.next=3,Si(this,gi,"f");case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(!Si(this,wi,"f")){"end"===e&&(Di(this,wi,!0,"f"),Si(this,bi,"f").call(this));var a=Si(this,ki,"f")[e];if(a&&(Si(this,ki,"f")[e]=a.filter((function(e){return!e.once})),a.forEach((function(e){return e.listener.apply(void 0,n)}))),"abort"===e){var i=n[0];return Si(this,Ai,"f")||null!==a&&void 0!==a&&a.length||Promise.reject(i),Si(this,yi,"f").call(this,i),Si(this,_i,"f").call(this,i),void this._emit("end")}if("error"===e){var u=n[0];Si(this,Ai,"f")||null!==a&&void 0!==a&&a.length||Promise.reject(u),Si(this,yi,"f").call(this,u),Si(this,_i,"f").call(this,u),this._emit("end")}}}},{key:"_emitFinal",value:function(){}}]),e}();function Fi(e){return"auto-parseable-response-format"===(null===e||void 0===e?void 0:e.$brand)}function Pi(e){return"auto-parseable-tool"===(null===e||void 0===e?void 0:e.$brand)}function Ti(e,t){var n=e.choices.map((function(e){var n,r;if("length"===e.finish_reason)throw new gr;if("content_filter"===e.finish_reason)throw new br;return q(q({},e),{},{message:q(q(q({},e.message),e.message.tool_calls?{tool_calls:null!==(n=null===(r=e.message.tool_calls)||void 0===r?void 0:r.map((function(e){return function(e,t){var n,r=null===(n=e.tools)||void 0===n?void 0:n.find((function(e){var n;return(null===(n=e.function)||void 0===n?void 0:n.name)===t.function.name}));return q(q({},t),{},{function:q(q({},t.function),{},{parsed_arguments:Pi(r)?r.$parseRaw(t.function.arguments):null!==r&&void 0!==r&&r.function.strict?JSON.parse(t.function.arguments):null})})}(t,e)})))&&void 0!==n?n:void 0}:void 0),{},{parsed:e.message.content&&!e.message.refusal?ji(t,e.message.content):null})})}));return q(q({},e),{},{choices:n})}function ji(e,t){var n,r;return"json_schema"!==(null===(n=e.response_format)||void 0===n?void 0:n.type)?null:"json_schema"===(null===(r=e.response_format)||void 0===r?void 0:r.type)?"$parseRaw"in e.response_format?e.response_format.$parseRaw(t):JSON.parse(t):null}function Ii(e,t){var n;if(!e)return!1;var r=null===(n=e.tools)||void 0===n?void 0:n.find((function(e){var n;return(null===(n=e.function)||void 0===n?void 0:n.name)===t.function.name}));return Pi(r)||(null===r||void 0===r?void 0:r.function.strict)||!1}function Ni(e){var t,n;return!!Fi(e.response_format)||null!==(t=null===(n=e.tools)||void 0===n?void 0:n.some((function(e){return Pi(e)||"function"===e.type&&!0===e.function.strict})))&&void 0!==t&&t}vi=new WeakMap,mi=new WeakMap,yi=new WeakMap,gi=new WeakMap,bi=new WeakMap,_i=new WeakMap,ki=new WeakMap,wi=new WeakMap,xi=new WeakMap,Ei=new WeakMap,Ai=new WeakMap,hi=new WeakSet,Ci=function(e){if(Di(this,xi,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new or),e instanceof or)return Di(this,Ei,!0,"f"),this._emit("abort",e);if(e instanceof ir)return this._emit("error",e);if(e instanceof Error){var t=new ir(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new ir(String(e)))};var Ri,Bi,Li,Mi,Ui,zi,Hi,Zi,Wi=["function_call","stream"],qi=["tool_choice","stream"],Gi=["function_call"],Vi=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},$i=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),e=t.apply(this,arguments),Ri.add(N(e)),e._chatCompletions=[],e.messages=[],e}return I(n,[{key:"_addChatCompletion",value:function(e){var t;this._chatCompletions.push(e),this._emit("chatCompletion",e);var n=null===(t=e.choices[0])||void 0===t?void 0:t.message;return n&&this._addMessage(n),e}},{key:"_addMessage",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("content"in e||(e.content=null),this.messages.push(e),t)if(this._emit("message",e),(fi(e)||pi(e))&&e.content)this._emit("functionCallResult",e.content);else if(di(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(di(e)&&e.tool_calls){var n,r=G(e.tool_calls);try{for(r.s();!(n=r.n()).done;){var a=n.value;"function"===a.type&&this._emit("functionCall",a.function)}}catch(i){r.e(i)}finally{r.f()}}}},{key:"finalChatCompletion",value:function(){var e=b(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.done();case 2:if(t=this._chatCompletions[this._chatCompletions.length-1]){e.next=5;break}throw new ir("stream ended without producing a ChatCompletion");case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"finalContent",value:function(){var e=b(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.done();case 2:return e.abrupt("return",Vi(this,Ri,"m",Bi).call(this));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"finalMessage",value:function(){var e=b(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.done();case 2:return e.abrupt("return",Vi(this,Ri,"m",Li).call(this));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"finalFunctionCall",value:function(){var e=b(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.done();case 2:return e.abrupt("return",Vi(this,Ri,"m",Mi).call(this));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"finalFunctionCallResult",value:function(){var e=b(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.done();case 2:return e.abrupt("return",Vi(this,Ri,"m",Ui).call(this));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"totalUsage",value:function(){var e=b(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.done();case 2:return e.abrupt("return",Vi(this,Ri,"m",zi).call(this));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"allChatCompletions",value:function(){return y(this._chatCompletions)}},{key:"_emitFinal",value:function(){var e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);var t=Vi(this,Ri,"m",Li).call(this);t&&this._emit("finalMessage",t);var n=Vi(this,Ri,"m",Bi).call(this);n&&this._emit("finalContent",n);var r=Vi(this,Ri,"m",Mi).call(this);r&&this._emit("finalFunctionCall",r);var a=Vi(this,Ri,"m",Ui).call(this);null!=a&&this._emit("finalFunctionCallResult",a),this._chatCompletions.some((function(e){return e.usage}))&&this._emit("totalUsage",Vi(this,Ri,"m",zi).call(this))}},{key:"_createChatCompletion",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=null===r||void 0===r?void 0:r.signal)&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",(function(){return u.controller.abort()}))),Vi(this,Ri,"m",Hi).call(this,n),e.next=5,t.chat.completions.create(q(q({},n),{},{stream:!1}),q(q({},r),{},{signal:this.controller.signal}));case 5:return i=e.sent,this._connected(),e.abrupt("return",this._addChatCompletion(Ti(i,n)));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_runChatCompletion",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=G(n.messages);try{for(a.s();!(i=a.n()).done;)u=i.value,this._addMessage(u,!1)}catch(o){a.e(o)}finally{a.f()}return e.next=4,this._createChatCompletion(t,n,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_runFunctions",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c,l,d,f,h,v,m,g,b,_,k,w,x,E,A,C,D,S,O,F,P,T,j;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a="function",i=n.function_call,u=void 0===i?"auto":i,n.stream,o=Sn(n,Wi),s="string"!==typeof u&&(null===u||void 0===u?void 0:u.name),c=(r||{}).maxChatCompletions,l=void 0===c?10:c,d={},f=G(n.functions);try{for(f.s();!(h=f.n()).done;)v=h.value,d[v.name||v.function.name]=v}catch(p){f.e(p)}finally{f.f()}m=n.functions.map((function(e){return{name:e.name||e.function.name,parameters:e.parameters,description:e.description}})),g=G(n.messages);try{for(g.s();!(b=g.n()).done;)_=b.value,this._addMessage(_,!1)}catch(p){g.e(p)}finally{g.f()}k=0;case 11:if(!(k<l)){e.next=58;break}return e.next=14,this._createChatCompletion(t,q(q({},o),{},{function_call:u,functions:m,messages:y(this.messages)}),r);case 14:if(x=e.sent,E=null===(w=x.choices[0])||void 0===w?void 0:w.message){e.next=18;break}throw new ir("missing message in ChatCompletion response");case 18:if(E.function_call){e.next=20;break}return e.abrupt("return");case 20:if(A=E.function_call,C=A.name,D=A.arguments,S=d[C]){e.next=28;break}return O="Invalid function_call: ".concat(JSON.stringify(C),". Available options are: ").concat(m.map((function(e){return JSON.stringify(e.name)})).join(", "),". Please try again"),this._addMessage({role:a,name:C,content:O}),e.abrupt("continue",55);case 28:if(!s||s===C){e.next=32;break}return F="Invalid function_call: ".concat(JSON.stringify(C),". ").concat(JSON.stringify(s)," requested. Please try again"),this._addMessage({role:a,name:C,content:F}),e.abrupt("continue",55);case 32:if(P=void 0,e.prev=33,!li(S)){e.next=40;break}return e.next=37,S.parse(D);case 37:e.t0=e.sent,e.next=41;break;case 40:e.t0=D;case 41:P=e.t0,e.next=48;break;case 44:return e.prev=44,e.t1=e.catch(33),this._addMessage({role:a,name:C,content:e.t1 instanceof Error?e.t1.message:String(e.t1)}),e.abrupt("continue",55);case 48:return e.next=50,S.function(P,this);case 50:if(T=e.sent,j=Vi(this,Ri,"m",Zi).call(this,T),this._addMessage({role:a,name:C,content:j}),!s){e.next=55;break}return e.abrupt("return");case 55:++k,e.next=11;break;case 58:case"end":return e.stop()}}),e,this,[[33,44]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_runTools",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c,l,d,f,h,v,m,g,b,_,k,w,x,E,A,C,D,S,O,F,P,T,j,I,N,R,B,L,M,U,z;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i="tool",u=n.tool_choice,o=void 0===u?"auto":u,n.stream,s=Sn(n,qi),c="string"!==typeof o&&(null===o||void 0===o||null===(a=o.function)||void 0===a?void 0:a.name),l=(r||{}).maxChatCompletions,d=void 0===l?10:l,f=n.tools.map((function(e){if(Pi(e)){if(!e.$callback)throw new ir("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:e.$callback,name:e.function.name,description:e.function.description||"",parameters:e.function.parameters,parse:e.$parseRaw,strict:!0}}}return e})),h={},v=G(f);try{for(v.s();!(m=v.n()).done;)"function"===(g=m.value).type&&(h[g.function.name||g.function.function.name]=g.function)}catch(p){v.e(p)}finally{v.f()}b="tools"in n?f.map((function(e){return"function"===e.type?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description,strict:e.function.strict}}:e})):void 0,_=G(n.messages);try{for(_.s();!(k=_.n()).done;)w=k.value,this._addMessage(w,!1)}catch(p){_.e(p)}finally{_.f()}x=0;case 12:if(!(x<d)){e.next=78;break}return e.next=15,this._createChatCompletion(t,q(q({},s),{},{tool_choice:o,tools:b,messages:y(this.messages)}),r);case 15:if(C=e.sent,D=null===(E=C.choices[0])||void 0===E?void 0:E.message){e.next=19;break}throw new ir("missing message in ChatCompletion response");case 19:if(null!==(A=D.tool_calls)&&void 0!==A&&A.length){e.next=21;break}return e.abrupt("return");case 21:S=G(D.tool_calls),e.prev=22,S.s();case 24:if((O=S.n()).done){e.next=67;break}if("function"===(F=O.value).type){e.next=28;break}return e.abrupt("continue",65);case 28:if(P=F.id,T=F.function,j=T.name,I=T.arguments,N=h[j]){e.next=37;break}return R="Invalid tool_call: ".concat(JSON.stringify(j),". Available options are: ").concat(Object.keys(h).map((function(e){return JSON.stringify(e)})).join(", "),". Please try again"),this._addMessage({role:i,tool_call_id:P,content:R}),e.abrupt("continue",65);case 37:if(!c||c===j){e.next=41;break}return B="Invalid tool_call: ".concat(JSON.stringify(j),". ").concat(JSON.stringify(c)," requested. Please try again"),this._addMessage({role:i,tool_call_id:P,content:B}),e.abrupt("continue",65);case 41:if(L=void 0,e.prev=42,!li(N)){e.next=49;break}return e.next=46,N.parse(I);case 46:e.t0=e.sent,e.next=50;break;case 49:e.t0=I;case 50:L=e.t0,e.next=58;break;case 53:return e.prev=53,e.t1=e.catch(42),M=e.t1 instanceof Error?e.t1.message:String(e.t1),this._addMessage({role:i,tool_call_id:P,content:M}),e.abrupt("continue",65);case 58:return e.next=60,N.function(L,this);case 60:if(U=e.sent,z=Vi(this,Ri,"m",Zi).call(this,U),this._addMessage({role:i,tool_call_id:P,content:z}),!c){e.next=65;break}return e.abrupt("return");case 65:e.next=24;break;case 67:e.next=72;break;case 69:e.prev=69,e.t2=e.catch(22),S.e(e.t2);case 72:return e.prev=72,S.f(),e.finish(72);case 75:++x,e.next=12;break;case 78:return e.abrupt("return");case 79:case"end":return e.stop()}}),e,this,[[22,69,72,75],[42,53]])})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(Oi);Ri=new WeakSet,Bi=function(){var e;return null!==(e=Vi(this,Ri,"m",Li).call(this).content)&&void 0!==e?e:null},Li=function(){for(var e=this.messages.length;e-- >0;){var t=this.messages[e];if(di(t)){var n,r,a=t.function_call,i=q(q({},Sn(t,Gi)),{},{content:null!==(n=t.content)&&void 0!==n?n:null,refusal:null!==(r=t.refusal)&&void 0!==r?r:null});return a&&(i.function_call=a),i}}throw new ir("stream ended without producing a ChatCompletionMessage with role=assistant")},Mi=function(){for(var e=this.messages.length-1;e>=0;e--){var t,n,r=this.messages[e];if(di(r)&&null!==r&&void 0!==r&&r.function_call)return r.function_call;if(di(r)&&null!==r&&void 0!==r&&null!==(t=r.tool_calls)&&void 0!==t&&t.length)return null===(n=r.tool_calls.at(-1))||void 0===n?void 0:n.function}},Ui=function(){for(var e=this,t=function(){var t=e.messages[n];return fi(t)&&null!=t.content||pi(t)&&null!=t.content&&"string"===typeof t.content&&e.messages.some((function(e){var n;return"assistant"===e.role&&(null===(n=e.tool_calls)||void 0===n?void 0:n.some((function(e){return"function"===e.type&&e.id===t.tool_call_id})))}))?{v:t.content}:void 0},n=this.messages.length-1;n>=0;n--){var r=t();if("object"===typeof r)return r.v}},zi=function(){var e,t={completion_tokens:0,prompt_tokens:0,total_tokens:0},n=G(this._chatCompletions);try{for(n.s();!(e=n.n()).done;){var r=e.value.usage;r&&(t.completion_tokens+=r.completion_tokens,t.prompt_tokens+=r.prompt_tokens,t.total_tokens+=r.total_tokens)}}catch(a){n.e(a)}finally{n.f()}return t},Hi=function(e){if(null!=e.n&&e.n>1)throw new ir("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Zi=function(e){return"string"===typeof e?e:void 0===e?"undefined":JSON.stringify(e)};var Ji=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_addMessage",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];kn(L(n.prototype),"_addMessage",this).call(this,e,t),di(e)&&e.content&&this._emit("content",e.content)}}],[{key:"runFunctions",value:function(e,t,r){var a=new n,i=q(q({},r),{},{headers:q(q({},null===r||void 0===r?void 0:r.headers),{},{"X-Stainless-Helper-Method":"runFunctions"})});return a._run((function(){return a._runFunctions(e,t,i)})),a}},{key:"runTools",value:function(e,t,r){var a=new n,i=q(q({},r),{},{headers:q(q({},null===r||void 0===r?void 0:r.headers),{},{"X-Stainless-Helper-Method":"runTools"})});return a._run((function(){return a._runTools(e,t,i)})),a}}]),n}($i),Ki={STR:1,NUM:2,ARR:4,OBJ:8,NULL:16,BOOL:32,NAN:64,INFINITY:128,MINUS_INFINITY:256,INF:384,SPECIAL:496,ATOM:499,COLLECTION:12,ALL:511},Qi=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Z(Error)),Xi=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Z(Error));var Yi,eu,tu,nu,ru,au,iu,uu,ou,su,cu,lu,du=function(e,t){var n=e.length,r=0,a=function(e){throw new Qi("".concat(e," at position ").concat(r))},i=function(e){throw new Xi("".concat(e," at position ").concat(r))},u=function(){return d(),r>=n&&a("Unexpected end of input"),'"'===e[r]?o():"{"===e[r]?s():"["===e[r]?c():"null"===e.substring(r,r+4)||Ki.NULL&t&&n-r<4&&"null".startsWith(e.substring(r))?(r+=4,null):"true"===e.substring(r,r+4)||Ki.BOOL&t&&n-r<4&&"true".startsWith(e.substring(r))?(r+=4,!0):"false"===e.substring(r,r+5)||Ki.BOOL&t&&n-r<5&&"false".startsWith(e.substring(r))?(r+=5,!1):"Infinity"===e.substring(r,r+8)||Ki.INFINITY&t&&n-r<8&&"Infinity".startsWith(e.substring(r))?(r+=8,1/0):"-Infinity"===e.substring(r,r+9)||Ki.MINUS_INFINITY&t&&1<n-r&&n-r<9&&"-Infinity".startsWith(e.substring(r))?(r+=9,-1/0):"NaN"===e.substring(r,r+3)||Ki.NAN&t&&n-r<3&&"NaN".startsWith(e.substring(r))?(r+=3,NaN):l()},o=function(){var u=r,o=!1;for(r++;r<n&&('"'!==e[r]||o&&"\\"===e[r-1]);)o="\\"===e[r]&&!o,r++;if('"'==e.charAt(r))try{return JSON.parse(e.substring(u,++r-Number(o)))}catch(s){i(String(s))}else if(Ki.STR&t)try{return JSON.parse(e.substring(u,r-Number(o))+'"')}catch(s){return JSON.parse(e.substring(u,e.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},s=function(){r++,d();var i={};try{for(;"}"!==e[r];){if(d(),r>=n&&Ki.OBJ&t)return i;var s=o();d(),r++;try{var c=u();Object.defineProperty(i,s,{value:c,writable:!0,enumerable:!0,configurable:!0})}catch(l){if(Ki.OBJ&t)return i;throw l}d(),","===e[r]&&r++}}catch(l){if(Ki.OBJ&t)return i;a("Expected '}' at end of object")}return r++,i},c=function(){r++;var n=[];try{for(;"]"!==e[r];)n.push(u()),d(),","===e[r]&&r++}catch(i){if(Ki.ARR&t)return n;a("Expected ']' at end of array")}return r++,n},l=function(){if(0===r){"-"===e&&Ki.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e)}catch(o){if(Ki.NUM&t)try{return"."===e[e.length-1]?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch(o){}i(String(o))}}var u=r;for("-"===e[r]&&r++;e[r]&&!",]}".includes(e[r]);)r++;r!=n||Ki.NUM&t||a("Unterminated number literal");try{return JSON.parse(e.substring(u,r))}catch(o){"-"===e.substring(u,r)&&Ki.NUM&t&&a("Not sure what '-' is");try{return JSON.parse(e.substring(u,e.lastIndexOf("e")))}catch(o){i(String(o))}}},d=function(){for(;r<n&&" \n\r\t".includes(e[r]);)r++};return u()},fu=function(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ki.ALL;if("string"!==typeof e)throw new TypeError("expecting str, got ".concat(typeof e));if(!e.trim())throw new Error("".concat(e," is empty"));return du(e.trim(),t)}(e,Ki.ALL^Ki.NUM)},pu=["choices"],hu=["delta","finish_reason","index","logprobs"],vu=["content","refusal"],mu=["content","refusal","function_call","role","tool_calls"],yu=["index","id","type","function"],gu=["id","choices","created","model","system_fingerprint"],bu=["message","finish_reason","index","logprobs"],_u=["content","function_call","tool_calls"],ku=["function","type","id"],wu=["arguments","name"],xu=function(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n},Eu=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},Au=function(e,t){B(r,e);var n=z(r);function r(e){var t;return T(this,r),t=n.call(this),Yi.add(N(t)),eu.set(N(t),void 0),tu.set(N(t),void 0),nu.set(N(t),void 0),xu(N(t),eu,e,"f"),xu(N(t),tu,[],"f"),t}return I(r,[{key:"currentChatCompletionSnapshot",get:function(){return Eu(this,nu,"f")}},{key:"_createChatCompletion",value:function(){var e=b(p().mark((function e(t,n,a){var i,u,o,s,c,l,d,f,h,v=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return kn(L(r.prototype),"_createChatCompletion",this),(u=null===a||void 0===a?void 0:a.signal)&&(u.aborted&&this.controller.abort(),u.addEventListener("abort",(function(){return v.controller.abort()}))),Eu(this,Yi,"m",ru).call(this),e.next=6,t.chat.completions.create(q(q({},n),{},{stream:!0}),q(q({},a),{},{signal:this.controller.signal}));case 6:o=e.sent,this._connected(),s=!1,c=!1,e.prev=10,d=Cn(o);case 12:return e.next=14,d.next();case 14:if(!(s=!(f=e.sent).done)){e.next=20;break}h=f.value,Eu(this,Yi,"m",iu).call(this,h);case 17:s=!1,e.next=12;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(10),c=!0,l=e.t0;case 26:if(e.prev=26,e.prev=27,!s||null==d.return){e.next=31;break}return e.next=31,d.return();case 31:if(e.prev=31,!c){e.next=34;break}throw l;case 34:return e.finish(31);case 35:return e.finish(26);case 36:if(null===(i=o.controller.signal)||void 0===i||!i.aborted){e.next=38;break}throw new or;case 38:return e.abrupt("return",this._addChatCompletion(Eu(this,Yi,"m",su).call(this)));case 39:case"end":return e.stop()}}),e,this,[[10,22,26,36],[27,,31,35]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_fromReadableStream",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u,o,s,c,l,d,f,h=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=null===n||void 0===n?void 0:n.signal)&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",(function(){return h.controller.abort()}))),Eu(this,Yi,"m",ru).call(this),this._connected(),i=Cr.fromReadableStream(t,this.controller),o=!1,s=!1,e.prev=7,l=Cn(i);case 9:return e.next=11,l.next();case 11:if(!(o=!(d=e.sent).done)){e.next=19;break}f=d.value,u&&u!==f.id&&this._addChatCompletion(Eu(this,Yi,"m",su).call(this)),Eu(this,Yi,"m",iu).call(this,f),u=f.id;case 16:o=!1,e.next=9;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(7),s=!0,c=e.t0;case 25:if(e.prev=25,e.prev=26,!o||null==l.return){e.next=30;break}return e.next=30,l.return();case 30:if(e.prev=30,!s){e.next=33;break}throw c;case 33:return e.finish(30);case 34:return e.finish(25);case 35:if(null===(r=i.controller.signal)||void 0===r||!r.aborted){e.next=37;break}throw new or;case 37:return e.abrupt("return",this._addChatCompletion(Eu(this,Yi,"m",su).call(this)));case 38:case"end":return e.stop()}}),e,this,[[7,21,25,35],[26,,30,34]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:t,value:function(){var e=this,t=[],n=[],r=!1;return this.on("chunk",(function(e){var r=n.shift();r?r.resolve(e):t.push(e)})),this.on("end",(function(){r=!0;for(var e=0,t=n;e<t.length;e++){t[e].resolve(void 0)}n.length=0})),this.on("abort",(function(e){r=!0;for(var t=0,a=n;t<a.length;t++){a[t].reject(e)}n.length=0})),this.on("error",(function(e){r=!0;for(var t=0,a=n;t<a.length;t++){a[t].reject(e)}n.length=0})),{next:function(){var e=b(p().mark((function e(){var a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length){e.next=4;break}if(!r){e.next=3;break}return e.abrupt("return",{value:void 0,done:!0});case 3:return e.abrupt("return",new Promise((function(e,t){return n.push({resolve:e,reject:t})})).then((function(e){return e?{value:e,done:!1}:{value:void 0,done:!0}})));case 4:return a=t.shift(),e.abrupt("return",{value:a,done:!1});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),return:function(){var t=b(p().mark((function t(){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.abort(),t.abrupt("return",{value:void 0,done:!0});case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}}},{key:"toReadableStream",value:function(){return new Cr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}],[{key:"fromReadableStream",value:function(e){var t=new r(null);return t._run((function(){return t._fromReadableStream(e)})),t}},{key:"createChatCompletion",value:function(e,t,n){var a=new r(t);return a._run((function(){return a._runChatCompletion(e,q(q({},t),{},{stream:!0}),q(q({},n),{},{headers:q(q({},null===n||void 0===n?void 0:n.headers),{},{"X-Stainless-Helper-Method":"stream"})}))})),a}}]),r}($i,(eu=new WeakMap,tu=new WeakMap,nu=new WeakMap,Yi=new WeakSet,ru=function(){this.ended||xu(this,nu,void 0,"f")},au=function(e){var t=Eu(this,tu,"f")[e.index];return t||(t={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Eu(this,tu,"f")[e.index]=t,t)},iu=function(e){if(!this.ended){var t=Eu(this,Yi,"m",lu).call(this,e);this._emit("chunk",e,t);var n,r=G(e.choices);try{for(r.s();!(n=r.n()).done;){var a,i,u,o,s,c,l,d,f,p,h,v,m,y,g,b,_=n.value,k=t.choices[_.index];if(null!=_.delta.content&&"assistant"===(null===(a=k.message)||void 0===a?void 0:a.role)&&null!==(i=k.message)&&void 0!==i&&i.content&&(this._emit("content",_.delta.content,k.message.content),this._emit("content.delta",{delta:_.delta.content,snapshot:k.message.content,parsed:k.message.parsed})),null!=_.delta.refusal&&"assistant"===(null===(u=k.message)||void 0===u?void 0:u.role)&&null!==(o=k.message)&&void 0!==o&&o.refusal&&this._emit("refusal.delta",{delta:_.delta.refusal,snapshot:k.message.refusal}),null!=(null===(s=_.logprobs)||void 0===s?void 0:s.content)&&"assistant"===(null===(c=k.message)||void 0===c?void 0:c.role))this._emit("logprobs.content.delta",{content:null===(h=_.logprobs)||void 0===h?void 0:h.content,snapshot:null!==(v=null===(m=k.logprobs)||void 0===m?void 0:m.content)&&void 0!==v?v:[]});if(null!=(null===(l=_.logprobs)||void 0===l?void 0:l.refusal)&&"assistant"===(null===(d=k.message)||void 0===d?void 0:d.role))this._emit("logprobs.refusal.delta",{refusal:null===(y=_.logprobs)||void 0===y?void 0:y.refusal,snapshot:null!==(g=null===(b=k.logprobs)||void 0===b?void 0:b.refusal)&&void 0!==g?g:[]});var w=Eu(this,Yi,"m",au).call(this,k);k.finish_reason&&(Eu(this,Yi,"m",ou).call(this,k),null!=w.current_tool_call_index&&Eu(this,Yi,"m",uu).call(this,k,w.current_tool_call_index));var x,E=G(null!==(f=_.delta.tool_calls)&&void 0!==f?f:[]);try{for(E.s();!(x=E.n()).done;){var A=x.value;w.current_tool_call_index!==A.index&&(Eu(this,Yi,"m",ou).call(this,k),null!=w.current_tool_call_index&&Eu(this,Yi,"m",uu).call(this,k,w.current_tool_call_index)),w.current_tool_call_index=A.index}}catch(I){E.e(I)}finally{E.f()}var C,D=G(null!==(p=_.delta.tool_calls)&&void 0!==p?p:[]);try{for(D.s();!(C=D.n()).done;){var S,O,F,P,T=C.value,j=null===(S=k.message.tool_calls)||void 0===S?void 0:S[T.index];if(null!==j&&void 0!==j&&j.type)if("function"===(null===j||void 0===j?void 0:j.type))this._emit("tool_calls.function.arguments.delta",{name:null===(O=j.function)||void 0===O?void 0:O.name,index:T.index,arguments:j.function.arguments,parsed_arguments:j.function.parsed_arguments,arguments_delta:null!==(F=null===(P=T.function)||void 0===P?void 0:P.arguments)&&void 0!==F?F:""});else null===j||void 0===j||j.type}}catch(I){D.e(I)}finally{D.f()}}}catch(I){r.e(I)}finally{r.f()}}},uu=function(e,t){var n;if(!Eu(this,Yi,"m",au).call(this,e).done_tool_calls.has(t)){var r=null===(n=e.message.tool_calls)||void 0===n?void 0:n[t];if(!r)throw new Error("no tool call snapshot");if(!r.type)throw new Error("tool call snapshot missing `type`");if("function"===r.type){var a,i,u=null===(a=Eu(this,eu,"f"))||void 0===a||null===(i=a.tools)||void 0===i?void 0:i.find((function(e){return"function"===e.type&&e.function.name===r.function.name}));this._emit("tool_calls.function.arguments.done",{name:r.function.name,index:t,arguments:r.function.arguments,parsed_arguments:Pi(u)?u.$parseRaw(r.function.arguments):null!==u&&void 0!==u&&u.function.strict?JSON.parse(r.function.arguments):null})}else r.type}},ou=function(e){var t,n,r=Eu(this,Yi,"m",au).call(this,e);if(e.message.content&&!r.content_done){r.content_done=!0;var a=Eu(this,Yi,"m",cu).call(this);this._emit("content.done",{content:e.message.content,parsed:a?a.$parseRaw(e.message.content):null})}e.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:e.message.refusal})),null!==(t=e.logprobs)&&void 0!==t&&t.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:e.logprobs.content})),null!==(n=e.logprobs)&&void 0!==n&&n.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:e.logprobs.refusal}))},su=function(){if(this.ended)throw new ir("stream has ended, this shouldn't happen");var e=Eu(this,nu,"f");if(!e)throw new ir("request ended without sending any chunks");return xu(this,nu,void 0,"f"),xu(this,tu,[],"f"),function(e,t){var n=e.id,r=e.choices,a=e.created,i=e.model,u=e.system_fingerprint,o=Sn(e,gu),s=q(q({},o),{},{id:n,choices:r.map((function(t){var n,r=t.message,a=t.finish_reason,i=t.index,u=t.logprobs,o=Sn(t,bu);if(!a)throw new ir("missing finish_reason for choice ".concat(i));var s,c=r.content,l=void 0===c?null:c,d=r.function_call,f=r.tool_calls,p=Sn(r,_u),h=r.role;if(!h)throw new ir("missing role for choice ".concat(i));if(d){var v,m=d.arguments,y=d.name;if(null==m)throw new ir("missing function_call.arguments for choice ".concat(i));if(!y)throw new ir("missing function_call.name for choice ".concat(i));return q(q({},o),{},{message:{content:l,function_call:{arguments:m,name:y},role:h,refusal:null!==(v=r.refusal)&&void 0!==v?v:null},finish_reason:a,index:i,logprobs:u})}return q(q({},o),{},f?{index:i,finish_reason:a,logprobs:u,message:q(q({},p),{},{role:h,content:l,refusal:null!==(s=r.refusal)&&void 0!==s?s:null,tool_calls:f.map((function(t,n){var r=t.function,a=t.type,u=t.id,o=Sn(t,ku),s=r||{},c=s.arguments,l=s.name,d=Sn(s,wu);if(null==u)throw new ir("missing choices[".concat(i,"].tool_calls[").concat(n,"].id\n").concat(Cu(e)));if(null==a)throw new ir("missing choices[".concat(i,"].tool_calls[").concat(n,"].type\n").concat(Cu(e)));if(null==l)throw new ir("missing choices[".concat(i,"].tool_calls[").concat(n,"].function.name\n").concat(Cu(e)));if(null==c)throw new ir("missing choices[".concat(i,"].tool_calls[").concat(n,"].function.arguments\n").concat(Cu(e)));return q(q({},o),{},{id:u,type:a,function:q(q({},d),{},{name:l,arguments:c})})}))})}:{message:q(q({},p),{},{content:l,role:h,refusal:null!==(n=r.refusal)&&void 0!==n?n:null}),finish_reason:a,index:i,logprobs:u})})),created:a,model:i,object:"chat.completion"},u?{system_fingerprint:u}:{});return function(e,t){return t&&Ni(t)?Ti(e,t):q(q({},e),{},{choices:e.choices.map((function(e){return q(q({},e),{},{message:q(q({},e.message),{},{parsed:null},e.message.tool_calls?{tool_calls:e.message.tool_calls}:void 0)})}))})}(s,t)}(e,Eu(this,eu,"f"))},cu=function(){var e,t=null===(e=Eu(this,eu,"f"))||void 0===e?void 0:e.response_format;return Fi(t)?t:null},lu=function(e){var t,n,r,a,i=Eu(this,nu,"f"),u=(e.choices,Sn(e,pu));i?Object.assign(i,u):i=xu(this,nu,q(q({},u),{},{choices:[]}),"f");var o,s=G(e.choices);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=c.delta,d=c.finish_reason,f=c.index,p=c.logprobs,h=void 0===p?null:p,v=Sn(c,hu),m=i.choices[f];if(m||(m=i.choices[f]=q({finish_reason:d,index:f,message:{},logprobs:h},v)),h)if(m.logprobs){var g,b,_,k,w=h.content,x=h.refusal,E=Sn(h,vu);if(Object.assign(m.logprobs,E),w)null!==(g=(t=m.logprobs).content)&&void 0!==g||(t.content=[]),(b=m.logprobs.content).push.apply(b,y(w));if(x)null!==(_=(n=m.logprobs).refusal)&&void 0!==_||(n.refusal=[]),(k=m.logprobs.refusal).push.apply(k,y(x))}else m.logprobs=Object.assign({},h);if(d&&(m.finish_reason=d,Eu(this,eu,"f")&&Ni(Eu(this,eu,"f")))){if("length"===d)throw new gr;if("content_filter"===d)throw new br}if(Object.assign(m,v),l){var A,C=l.content,D=l.refusal,S=l.function_call,O=l.role,F=l.tool_calls,P=Sn(l,mu);if(Object.assign(m.message,P),D&&(m.message.refusal=(m.message.refusal||"")+D),O&&(m.message.role=O),S)if(m.message.function_call){if(S.name&&(m.message.function_call.name=S.name),S.arguments)null!==(A=(r=m.message.function_call).arguments)&&void 0!==A||(r.arguments=""),m.message.function_call.arguments+=S.arguments}else m.message.function_call=S;if(C&&(m.message.content=(m.message.content||"")+C,!m.message.refusal&&Eu(this,Yi,"m",cu).call(this)&&(m.message.parsed=fu(m.message.content))),F){m.message.tool_calls||(m.message.tool_calls=[]);var T,j=G(F);try{for(j.s();!(T=j.n()).done;){var I,N,R,B=T.value,L=B.index,M=B.id,U=B.type,z=B.function,H=Sn(B,yu),Z=null!==(I=(a=m.message.tool_calls)[L])&&void 0!==I?I:a[L]={};Object.assign(Z,H),M&&(Z.id=M),U&&(Z.type=U),z&&(null!==(N=Z.function)&&void 0!==N||(Z.function={name:null!==(R=z.name)&&void 0!==R?R:"",arguments:""})),null!==z&&void 0!==z&&z.name&&(Z.function.name=z.name),null!==z&&void 0!==z&&z.arguments&&(Z.function.arguments+=z.arguments,Ii(Eu(this,eu,"f"),Z)&&(Z.function.parsed_arguments=fu(Z.function.arguments)))}}catch(W){j.e(W)}finally{j.f()}}}}}catch(W){s.e(W)}finally{s.f()}return i},Symbol.asyncIterator));function Cu(e){return JSON.stringify(e)}var Du=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,null,[{key:"fromReadableStream",value:function(e){var t=new n(null);return t._run((function(){return t._fromReadableStream(e)})),t}},{key:"runFunctions",value:function(e,t,r){var a=new n(null),i=q(q({},r),{},{headers:q(q({},null===r||void 0===r?void 0:r.headers),{},{"X-Stainless-Helper-Method":"runFunctions"})});return a._run((function(){return a._runFunctions(e,t,i)})),a}},{key:"runTools",value:function(e,t,r){var a=new n(t),i=q(q({},r),{},{headers:q(q({},null===r||void 0===r?void 0:r.headers),{},{"X-Stainless-Helper-Method":"runTools"})});return a._run((function(){return a._runTools(e,t,i)})),a}}]),n}(Au),Su=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"parse",value:function(e,t){return function(e){var t,n=G(null!==e&&void 0!==e?e:[]);try{for(n.s();!(t=n.n()).done;){var r=t.value;if("function"!==r.type)throw new ir("Currently only `function` tool types support auto-parsing; Received `".concat(r.type,"`"));if(!0!==r.function.strict)throw new ir("The `".concat(r.function.name,"` tool is not marked with `strict: true`. Only strict function tools can be auto-parsed"))}}catch(a){n.e(a)}finally{n.f()}}(e.tools),this._client.chat.completions.create(e,q(q({},t),{},{headers:q(q({},null===t||void 0===t?void 0:t.headers),{},{"X-Stainless-Helper-Method":"beta.chat.completions.parse"})}))._thenUnwrap((function(t){return Ti(t,e)}))}},{key:"runFunctions",value:function(e,t){return e.stream?Du.runFunctions(this._client,e,t):Ji.runFunctions(this._client,e,t)}},{key:"runTools",value:function(e,t){return e.stream?Du.runTools(this._client,e,t):Ji.runTools(this._client,e,t)}},{key:"stream",value:function(e,t){return Au.createChatCompletion(this._client,e,t)}}]),n}(Sa),Ou=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).completions=new Su(e._client),e}return I(n)}(Sa);!function(e){e.Completions=Su}(Ou||(Ou={}));var Fu=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"create",value:function(e,t){return this._client.post("/realtime/sessions",q(q({body:e},t),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}}]),n}(Sa),Pu=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"create",value:function(e,t){return this._client.post("/realtime/transcription_sessions",q(q({body:e},t),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}}]),n}(Sa),Tu=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).sessions=new Fu(e._client),e.transcriptionSessions=new Pu(e._client),e}return I(n)}(Sa);Tu.Sessions=Fu,Tu.TranscriptionSessions=Pu;var ju,Iu,Nu,Ru,Bu,Lu,Mu,Uu,zu,Hu,Zu,Wu,qu,Gu,Vu,$u,Ju,Ku,Qu,Xu,Yu,eo,to=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},no=function(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n},ro=function(e,t){B(r,e);var n=z(r);function r(){var e;return T(this,r),e=n.apply(this,arguments),ju.add(N(e)),Iu.set(N(e),[]),Nu.set(N(e),{}),Ru.set(N(e),{}),Bu.set(N(e),void 0),Lu.set(N(e),void 0),Mu.set(N(e),void 0),Uu.set(N(e),void 0),zu.set(N(e),void 0),Hu.set(N(e),void 0),Zu.set(N(e),void 0),Wu.set(N(e),void 0),qu.set(N(e),void 0),e}return I(r,[{key:t,value:function(){var e=this,t=[],n=[],r=!1;return this.on("event",(function(e){var r=n.shift();r?r.resolve(e):t.push(e)})),this.on("end",(function(){r=!0;for(var e=0,t=n;e<t.length;e++){t[e].resolve(void 0)}n.length=0})),this.on("abort",(function(e){r=!0;for(var t=0,a=n;t<a.length;t++){a[t].reject(e)}n.length=0})),this.on("error",(function(e){r=!0;for(var t=0,a=n;t<a.length;t++){a[t].reject(e)}n.length=0})),{next:function(){var e=b(p().mark((function e(){var a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length){e.next=4;break}if(!r){e.next=3;break}return e.abrupt("return",{value:void 0,done:!0});case 3:return e.abrupt("return",new Promise((function(e,t){return n.push({resolve:e,reject:t})})).then((function(e){return e?{value:e,done:!1}:{value:void 0,done:!0}})));case 4:return a=t.shift(),e.abrupt("return",{value:a,done:!1});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),return:function(){var t=b(p().mark((function t(){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.abort(),t.abrupt("return",{value:void 0,done:!0});case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}}},{key:"_fromReadableStream",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u,o,s,c,l,d,f=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=null===n||void 0===n?void 0:n.signal)&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",(function(){return f.controller.abort()}))),this._connected(),i=Cr.fromReadableStream(t,this.controller),u=!1,o=!1,e.prev=6,c=Cn(i);case 8:return e.next=10,c.next();case 10:if(!(u=!(l=e.sent).done)){e.next=16;break}d=l.value,to(this,ju,"m",Gu).call(this,d);case 13:u=!1,e.next=8;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(6),o=!0,s=e.t0;case 22:if(e.prev=22,e.prev=23,!u||null==c.return){e.next=27;break}return e.next=27,c.return();case 27:if(e.prev=27,!o){e.next=30;break}throw s;case 30:return e.finish(27);case 31:return e.finish(22);case 32:if(null===(r=i.controller.signal)||void 0===r||!r.aborted){e.next=34;break}throw new or;case 34:return e.abrupt("return",this._addRun(to(this,ju,"m",Vu).call(this)));case 35:case"end":return e.stop()}}),e,this,[[6,18,22,32],[23,,27,31]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"toReadableStream",value:function(){return new Cr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}},{key:"_createToolAssistantStream",value:function(){var e=b(p().mark((function e(t,n,r,a,i){var u,o,s,c,l,d,f,h,v,m,y=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=null===i||void 0===i?void 0:i.signal)&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",(function(){return y.controller.abort()}))),s=q(q({},a),{},{stream:!0}),e.next=5,t.submitToolOutputs(n,r,s,q(q({},i),{},{signal:this.controller.signal}));case 5:c=e.sent,this._connected(),l=!1,d=!1,e.prev=9,h=Cn(c);case 11:return e.next=13,h.next();case 13:if(!(l=!(v=e.sent).done)){e.next=19;break}m=v.value,to(this,ju,"m",Gu).call(this,m);case 16:l=!1,e.next=11;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(9),d=!0,f=e.t0;case 25:if(e.prev=25,e.prev=26,!l||null==h.return){e.next=30;break}return e.next=30,h.return();case 30:if(e.prev=30,!d){e.next=33;break}throw f;case 33:return e.finish(30);case 34:return e.finish(25);case 35:if(null===(u=c.controller.signal)||void 0===u||!u.aborted){e.next=37;break}throw new or;case 37:return e.abrupt("return",this._addRun(to(this,ju,"m",Vu).call(this)));case 38:case"end":return e.stop()}}),e,this,[[9,21,25,35],[26,,30,34]])})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()},{key:"currentEvent",value:function(){return to(this,Zu,"f")}},{key:"currentRun",value:function(){return to(this,Wu,"f")}},{key:"currentMessageSnapshot",value:function(){return to(this,Bu,"f")}},{key:"currentRunStepSnapshot",value:function(){return to(this,qu,"f")}},{key:"finalRunSteps",value:function(){var e=b(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.done();case 2:return e.abrupt("return",Object.values(to(this,Nu,"f")));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"finalMessages",value:function(){var e=b(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.done();case 2:return e.abrupt("return",Object.values(to(this,Ru,"f")));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"finalRun",value:function(){var e=b(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.done();case 2:if(to(this,Lu,"f")){e.next=4;break}throw Error("Final run was not received.");case 4:return e.abrupt("return",to(this,Lu,"f"));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_createThreadAssistantStream",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c,l,d,f,h,v=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=null===r||void 0===r?void 0:r.signal)&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",(function(){return v.controller.abort()}))),u=q(q({},n),{},{stream:!0}),e.next=5,t.createAndRun(u,q(q({},r),{},{signal:this.controller.signal}));case 5:o=e.sent,this._connected(),s=!1,c=!1,e.prev=9,d=Cn(o);case 11:return e.next=13,d.next();case 13:if(!(s=!(f=e.sent).done)){e.next=19;break}h=f.value,to(this,ju,"m",Gu).call(this,h);case 16:s=!1,e.next=11;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(9),c=!0,l=e.t0;case 25:if(e.prev=25,e.prev=26,!s||null==d.return){e.next=30;break}return e.next=30,d.return();case 30:if(e.prev=30,!c){e.next=33;break}throw l;case 33:return e.finish(30);case 34:return e.finish(25);case 35:if(null===(a=o.controller.signal)||void 0===a||!a.aborted){e.next=37;break}throw new or;case 37:return e.abrupt("return",this._addRun(to(this,ju,"m",Vu).call(this)));case 38:case"end":return e.stop()}}),e,this,[[9,21,25,35],[26,,30,34]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_createAssistantStream",value:function(){var e=b(p().mark((function e(t,n,r,a){var i,u,o,s,c,l,d,f,h,v,m=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(u=null===a||void 0===a?void 0:a.signal)&&(u.aborted&&this.controller.abort(),u.addEventListener("abort",(function(){return m.controller.abort()}))),o=q(q({},r),{},{stream:!0}),e.next=5,t.create(n,o,q(q({},a),{},{signal:this.controller.signal}));case 5:s=e.sent,this._connected(),c=!1,l=!1,e.prev=9,f=Cn(s);case 11:return e.next=13,f.next();case 13:if(!(c=!(h=e.sent).done)){e.next=19;break}v=h.value,to(this,ju,"m",Gu).call(this,v);case 16:c=!1,e.next=11;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(9),l=!0,d=e.t0;case 25:if(e.prev=25,e.prev=26,!c||null==f.return){e.next=30;break}return e.next=30,f.return();case 30:if(e.prev=30,!l){e.next=33;break}throw d;case 33:return e.finish(30);case 34:return e.finish(25);case 35:if(null===(i=s.controller.signal)||void 0===i||!i.aborted){e.next=37;break}throw new or;case 37:return e.abrupt("return",this._addRun(to(this,ju,"m",Vu).call(this)));case 38:case"end":return e.stop()}}),e,this,[[9,21,25,35],[26,,30,34]])})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"_addRun",value:function(e){return e}},{key:"_threadAssistantStream",value:function(){var e=b(p().mark((function e(t,n,r){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._createThreadAssistantStream(n,t,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_runAssistantStream",value:function(){var e=b(p().mark((function e(t,n,r,a){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._createAssistantStream(n,t,r,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"_runToolAssistantStream",value:function(){var e=b(p().mark((function e(t,n,r,a,i){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._createToolAssistantStream(r,t,n,a,i);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()}],[{key:"fromReadableStream",value:function(e){var t=new r;return t._run((function(){return t._fromReadableStream(e)})),t}},{key:"createToolAssistantStream",value:function(e,t,n,a,i){var u=new r;return u._run((function(){return u._runToolAssistantStream(e,t,n,a,q(q({},i),{},{headers:q(q({},null===i||void 0===i?void 0:i.headers),{},{"X-Stainless-Helper-Method":"stream"})}))})),u}},{key:"createThreadAssistantStream",value:function(e,t,n){var a=new r;return a._run((function(){return a._threadAssistantStream(e,t,q(q({},n),{},{headers:q(q({},null===n||void 0===n?void 0:n.headers),{},{"X-Stainless-Helper-Method":"stream"})}))})),a}},{key:"createAssistantStream",value:function(e,t,n,a){var i=new r;return i._run((function(){return i._runAssistantStream(e,t,n,q(q({},a),{},{headers:q(q({},null===a||void 0===a?void 0:a.headers),{},{"X-Stainless-Helper-Method":"stream"})}))})),i}},{key:"accumulateDelta",value:function(e,t){for(var n=0,r=Object.entries(t);n<r.length;n++){var a=w(r[n],2),i=a[0],u=a[1];if(e.hasOwnProperty(i)){var o=e[i];if(null!==o&&void 0!==o)if("index"!==i&&"type"!==i){if("string"===typeof o&&"string"===typeof u)o+=u;else if("number"===typeof o&&"number"===typeof u)o+=u;else{if(!Da(o)||!Da(u)){if(Array.isArray(o)&&Array.isArray(u)){if(o.every((function(e){return"string"===typeof e||"number"===typeof e}))){var s;(s=o).push.apply(s,y(u));continue}var c,l=G(u);try{for(l.s();!(c=l.n()).done;){var d=c.value;if(!Da(d))throw new Error("Expected array delta entry to be an object but got: ".concat(d));var f=d.index;if(null==f)throw console.error(d),new Error("Expected array delta entry to have an `index` property");if("number"!==typeof f)throw new Error("Expected array delta entry `index` property to be a number but got ".concat(f));var p=o[f];null==p?o.push(d):o[f]=this.accumulateDelta(p,d)}}catch(h){l.e(h)}finally{l.f()}continue}throw Error("Unhandled record type: ".concat(i,", deltaValue: ").concat(u,", accValue: ").concat(o))}o=this.accumulateDelta(o,u)}e[i]=o}else e[i]=u;else e[i]=u}else e[i]=u}return e}}]),r}(Oi,(Iu=new WeakMap,Nu=new WeakMap,Ru=new WeakMap,Bu=new WeakMap,Lu=new WeakMap,Mu=new WeakMap,Uu=new WeakMap,zu=new WeakMap,Hu=new WeakMap,Zu=new WeakMap,Wu=new WeakMap,qu=new WeakMap,ju=new WeakSet,Symbol.asyncIterator));Gu=function(e){if(!this.ended)switch(no(this,Zu,e,"f"),to(this,ju,"m",Ku).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":to(this,ju,"m",eo).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":to(this,ju,"m",Ju).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":to(this,ju,"m",$u).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Vu=function(){if(this.ended)throw new ir("stream has ended, this shouldn't happen");if(!to(this,Lu,"f"))throw Error("Final run has not been received");return to(this,Lu,"f")},$u=function(e){var t=w(to(this,ju,"m",Xu).call(this,e,to(this,Bu,"f")),2),n=t[0],r=t[1];no(this,Bu,n,"f"),to(this,Ru,"f")[n.id]=n;var a,i=G(r);try{for(i.s();!(a=i.n()).done;){var u=a.value,o=n.content[u.index];"text"==(null===o||void 0===o?void 0:o.type)&&this._emit("textCreated",o.text)}}catch(h){i.e(h)}finally{i.f()}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content){var s,c=G(e.data.delta.content);try{for(c.s();!(s=c.n()).done;){var l=s.value;if("text"==l.type&&l.text){var d=l.text,f=n.content[l.index];if(!f||"text"!=f.type)throw Error("The snapshot associated with this text delta is not text or missing");this._emit("textDelta",d,f.text)}if(l.index!=to(this,Mu,"f")){if(to(this,Uu,"f"))switch(to(this,Uu,"f").type){case"text":this._emit("textDone",to(this,Uu,"f").text,to(this,Bu,"f"));break;case"image_file":this._emit("imageFileDone",to(this,Uu,"f").image_file,to(this,Bu,"f"))}no(this,Mu,l.index,"f")}no(this,Uu,n.content[l.index],"f")}}catch(h){c.e(h)}finally{c.f()}}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==to(this,Mu,"f")){var p=e.data.content[to(this,Mu,"f")];if(p)switch(p.type){case"image_file":this._emit("imageFileDone",p.image_file,to(this,Bu,"f"));break;case"text":this._emit("textDone",p.text,to(this,Bu,"f"))}}to(this,Bu,"f")&&this._emit("messageDone",e.data),no(this,Bu,void 0,"f")}},Ju=function(e){var t=to(this,ju,"m",Qu).call(this,e);switch(no(this,qu,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":var n=e.data.delta;if(n.step_details&&"tool_calls"==n.step_details.type&&n.step_details.tool_calls&&"tool_calls"==t.step_details.type){var r,a=G(n.step_details.tool_calls);try{for(a.s();!(r=a.n()).done;){var i=r.value;i.index==to(this,zu,"f")?this._emit("toolCallDelta",i,t.step_details.tool_calls[i.index]):(to(this,Hu,"f")&&this._emit("toolCallDone",to(this,Hu,"f")),no(this,zu,i.index,"f"),no(this,Hu,t.step_details.tool_calls[i.index],"f"),to(this,Hu,"f")&&this._emit("toolCallCreated",to(this,Hu,"f")))}}catch(u){a.e(u)}finally{a.f()}}this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":no(this,qu,void 0,"f"),"tool_calls"==e.data.step_details.type&&to(this,Hu,"f")&&(this._emit("toolCallDone",to(this,Hu,"f")),no(this,Hu,void 0,"f")),this._emit("runStepDone",e.data,t)}},Ku=function(e){to(this,Iu,"f").push(e),this._emit("event",e)},Qu=function(e){switch(e.event){case"thread.run.step.created":return to(this,Nu,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":var t=to(this,Nu,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");var n=e.data;if(n.delta){var r=ro.accumulateDelta(t,n.delta);to(this,Nu,"f")[e.data.id]=r}return to(this,Nu,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":to(this,Nu,"f")[e.data.id]=e.data}if(to(this,Nu,"f")[e.data.id])return to(this,Nu,"f")[e.data.id];throw new Error("No snapshot available")},Xu=function(e,t){var n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");var r=e.data;if(r.delta.content){var a,i=G(r.delta.content);try{for(i.s();!(a=i.n()).done;){var u=a.value;if(u.index in t.content){var o=t.content[u.index];t.content[u.index]=to(this,ju,"m",Yu).call(this,u,o)}else t.content[u.index]=u,n.push(u)}}catch(s){i.e(s)}finally{i.f()}}return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Yu=function(e,t){return ro.accumulateDelta(t,e)},eo=function(e){switch(no(this,Wu,e.data,"f"),e.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.cancelling":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":no(this,Lu,e.data,"f"),to(this,Hu,"f")&&(this._emit("toolCallDone",to(this,Hu,"f")),no(this,Hu,void 0,"f"))}};var ao=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"create",value:function(e,t,n){return this._client.post("/threads/".concat(e,"/messages"),q(q({body:t},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}},{key:"retrieve",value:function(e,t,n){return this._client.get("/threads/".concat(e,"/messages/").concat(t),q(q({},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}},{key:"update",value:function(e,t,n,r){return this._client.post("/threads/".concat(e,"/messages/").concat(t),q(q({body:n},r),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===r||void 0===r?void 0:r.headers)}))}},{key:"list",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return oa(t)?this.list(e,{},t):this._client.getAPIList("/threads/".concat(e,"/messages"),io,q(q({query:t},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}},{key:"del",value:function(e,t,n){return this._client.delete("/threads/".concat(e,"/messages/").concat(t),q(q({},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}}]),n}(Sa),io=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Ta);ao.MessagesPage=io;var uo=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"retrieve",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4?arguments[4]:void 0;return oa(r)?this.retrieve(e,t,n,{},r):this._client.get("/threads/".concat(e,"/runs/").concat(t,"/steps/").concat(n),q(q({query:r},a),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===a||void 0===a?void 0:a.headers)}))}},{key:"list",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;return oa(n)?this.list(e,t,{},n):this._client.getAPIList("/threads/".concat(e,"/runs/").concat(t,"/steps"),oo,q(q({query:n},r),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===r||void 0===r?void 0:r.headers)}))}}]),n}(Sa),oo=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Ta);uo.RunStepsPage=oo;var so=["include"],co=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).steps=new uo(e._client),e}return I(n,[{key:"create",value:function(e,t,n){var r,a=t.include,i=Sn(t,so);return this._client.post("/threads/".concat(e,"/runs"),q(q({query:{include:a},body:i},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers),stream:null!==(r=t.stream)&&void 0!==r&&r}))}},{key:"retrieve",value:function(e,t,n){return this._client.get("/threads/".concat(e,"/runs/").concat(t),q(q({},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}},{key:"update",value:function(e,t,n,r){return this._client.post("/threads/".concat(e,"/runs/").concat(t),q(q({body:n},r),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===r||void 0===r?void 0:r.headers)}))}},{key:"list",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return oa(t)?this.list(e,{},t):this._client.getAPIList("/threads/".concat(e,"/runs"),lo,q(q({query:t},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}},{key:"cancel",value:function(e,t,n){return this._client.post("/threads/".concat(e,"/runs/").concat(t,"/cancel"),q(q({},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}},{key:"createAndPoll",value:function(){var e=b(p().mark((function e(t,n,r){var a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.create(t,n,r);case 2:return a=e.sent,e.next=5,this.poll(t,a.id,r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"createAndStream",value:function(e,t,n){return ro.createAssistantStream(e,this._client.beta.threads.runs,t,n)}},{key:"poll",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c,l;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=q(q({},null===r||void 0===r?void 0:r.headers),{},{"X-Stainless-Poll-Helper":"true"}),null!==r&&void 0!==r&&r.pollIntervalMs&&(a["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());case 2:return e.next=5,this.retrieve(t,n,q(q({},r),{},{headers:q(q({},null===r||void 0===r?void 0:r.headers),a)})).withResponse();case 5:i=e.sent,u=i.data,o=i.response,e.t0=u.status,e.next="queued"===e.t0||"in_progress"===e.t0||"cancelling"===e.t0?11:"requires_action"===e.t0||"incomplete"===e.t0||"cancelled"===e.t0||"completed"===e.t0||"failed"===e.t0||"expired"===e.t0?16:17;break;case 11:return s=5e3,null!==r&&void 0!==r&&r.pollIntervalMs?s=r.pollIntervalMs:(c=o.headers.get("openai-poll-after-ms"))&&(l=parseInt(c),isNaN(l)||(s=l)),e.next=15,ma(s);case 15:return e.abrupt("break",17);case 16:return e.abrupt("return",u);case 17:e.next=2;break;case 19:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"stream",value:function(e,t,n){return ro.createAssistantStream(e,this._client.beta.threads.runs,t,n)}},{key:"submitToolOutputs",value:function(e,t,n,r){var a;return this._client.post("/threads/".concat(e,"/runs/").concat(t,"/submit_tool_outputs"),q(q({body:n},r),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===r||void 0===r?void 0:r.headers),stream:null!==(a=n.stream)&&void 0!==a&&a}))}},{key:"submitToolOutputsAndPoll",value:function(){var e=b(p().mark((function e(t,n,r,a){var i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.submitToolOutputs(t,n,r,a);case 2:return i=e.sent,e.next=5,this.poll(t,i.id,a);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"submitToolOutputsStream",value:function(e,t,n,r){return ro.createToolAssistantStream(e,t,this._client.beta.threads.runs,n,r)}}]),n}(Sa),lo=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Ta);co.RunsPage=lo,co.Steps=uo,co.RunStepsPage=oo;var fo=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).runs=new co(e._client),e.messages=new ao(e._client),e}return I(n,[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return oa(e)?this.create({},e):this._client.post("/threads",q(q({body:e},t),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}},{key:"retrieve",value:function(e,t){return this._client.get("/threads/".concat(e),q(q({},t),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}},{key:"update",value:function(e,t,n){return this._client.post("/threads/".concat(e),q(q({body:t},n),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===n||void 0===n?void 0:n.headers)}))}},{key:"del",value:function(e,t){return this._client.delete("/threads/".concat(e),q(q({},t),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers)}))}},{key:"createAndRun",value:function(e,t){var n;return this._client.post("/threads/runs",q(q({body:e},t),{},{headers:q({"OpenAI-Beta":"assistants=v2"},null===t||void 0===t?void 0:t.headers),stream:null!==(n=e.stream)&&void 0!==n&&n}))}},{key:"createAndRunPoll",value:function(){var e=b(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.createAndRun(t,n);case 2:return r=e.sent,e.next=5,this.runs.poll(r.thread_id,r.id,n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createAndRunStream",value:function(e,t){return ro.createThreadAssistantStream(e,this._client.beta.threads,t)}}]),n}(Sa);fo.Runs=co,fo.RunsPage=lo,fo.Messages=ao,fo.MessagesPage=io;var po=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).realtime=new Tu(e._client),e.chat=new Ou(e._client),e.assistants=new si(e._client),e.threads=new fo(e._client),e}return I(n)}(Sa);po.Realtime=Tu,po.Assistants=si,po.AssistantsPage=ci,po.Threads=fo;var ho=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"create",value:function(e,t){return this._client.post("/batches",q({body:e},t))}},{key:"retrieve",value:function(e,t){return this._client.get("/batches/".concat(e),t)}},{key:"list",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return oa(e)?this.list({},e):this._client.getAPIList("/batches",vo,q({query:e},t))}},{key:"cancel",value:function(e,t){return this._client.post("/batches/".concat(e,"/cancel"),t)}}]),n}(Sa),vo=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Ta);ho.BatchesPage=vo;var mo=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"create",value:function(e,t,n){return this._client.post("/uploads/".concat(e,"/parts"),Gr(q({body:t},n)))}}]),n}(Sa),yo=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).parts=new mo(e._client),e}return I(n,[{key:"create",value:function(e,t){return this._client.post("/uploads",q({body:e},t))}},{key:"cancel",value:function(e,t){return this._client.post("/uploads/".concat(e,"/cancel"),t)}},{key:"complete",value:function(e,t,n){return this._client.post("/uploads/".concat(e,"/complete"),q({body:t},n))}}]),n}(Sa);function go(e,t){return t&&function(e){var t;if(Fi(null===(t=e.text)||void 0===t?void 0:t.format))return!0;return!1}(t)?bo(e,t):q(q({},e),{},{output_parsed:null,output:e.output.map((function(e){return"function_call"===e.type?q(q({},e),{},{parsed_arguments:null}):"message"===e.type?q(q({},e),{},{content:e.content.map((function(e){return q(q({},e),{},{parsed:null})}))}):e}))})}function bo(e,t){var n=e.output.map((function(e){if("function_call"===e.type)return q(q({},e),{},{parsed_arguments:xo(t,e)});if("message"===e.type){var n=e.content.map((function(e){return"output_text"===e.type?q(q({},e),{},{parsed:_o(t,e.text)}):e}));return q(q({},e),{},{content:n})}return e})),r=Object.assign({},e,{output:n});return Object.getOwnPropertyDescriptor(e,"output_text")||Eo(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get:function(){var e,t=G(r.output);try{for(t.s();!(e=t.n()).done;){var n=e.value;if("message"===n.type){var a,i=G(n.content);try{for(i.s();!(a=i.n()).done;){var u=a.value;if("output_text"===u.type&&null!==u.parsed)return u.parsed}}catch(o){i.e(o)}finally{i.f()}}}}catch(o){t.e(o)}finally{t.f()}return null}}),r}function _o(e,t){var n,r,a,i;return"json_schema"!==(null===(n=e.text)||void 0===n||null===(r=n.format)||void 0===r?void 0:r.type)?null:"$parseRaw"in(null===(a=e.text)||void 0===a?void 0:a.format)?(null===(i=e.text)||void 0===i?void 0:i.format).$parseRaw(t):JSON.parse(t)}function ko(e){return"auto-parseable-tool"===(null===e||void 0===e?void 0:e.$brand)}function wo(e,t){return e.find((function(e){return"function"===e.type&&e.name===t}))}function xo(e,t){var n,r=wo(null!==(n=e.tools)&&void 0!==n?n:[],t.name);return q(q(q({},t),t),{},{parsed_arguments:ko(r)?r.$parseRaw(t.arguments):null!==r&&void 0!==r&&r.strict?JSON.parse(t.arguments):null})}function Eo(e){var t,n=[],r=G(e.output);try{for(r.s();!(t=r.n()).done;){var a=t.value;if("message"===a.type){var i,u=G(a.content);try{for(u.s();!(i=u.n()).done;){var o=i.value;"output_text"===o.type&&n.push(o.text)}}catch(s){u.e(s)}finally{u.f()}}}}catch(s){r.e(s)}finally{r.f()}e.output_text=n.join("")}yo.Parts=mo;var Ao,Co,Do,So,Oo,Fo,Po,To,jo=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"list",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return oa(t)?this.list(e,{},t):this._client.getAPIList("/responses/".concat(e,"/input_items"),Lo,q({query:t},n))}}]),n}(Sa),Io=function(e,t,n,r,a){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?a.call(e,n):a?a.value=n:t.set(e,n),n},No=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},Ro=function(e,t){B(r,e);var n=z(r);function r(e){var t;return T(this,r),t=n.call(this),Ao.add(N(t)),Co.set(N(t),void 0),Do.set(N(t),void 0),So.set(N(t),void 0),Io(N(t),Co,e,"f"),t}return I(r,[{key:"_createResponse",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c,l,d,f,h=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=null===r||void 0===r?void 0:r.signal)&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",(function(){return h.controller.abort()}))),No(this,Ao,"m",Oo).call(this),e.next=5,t.responses.create(q(q({},n),{},{stream:!0}),q(q({},r),{},{signal:this.controller.signal}));case 5:u=e.sent,this._connected(),o=!1,s=!1,e.prev=9,l=Cn(u);case 11:return e.next=13,l.next();case 13:if(!(o=!(d=e.sent).done)){e.next=19;break}f=d.value,No(this,Ao,"m",Fo).call(this,f);case 16:o=!1,e.next=11;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(9),s=!0,c=e.t0;case 25:if(e.prev=25,e.prev=26,!o||null==l.return){e.next=30;break}return e.next=30,l.return();case 30:if(e.prev=30,!s){e.next=33;break}throw c;case 33:return e.finish(30);case 34:return e.finish(25);case 35:if(null===(a=u.controller.signal)||void 0===a||!a.aborted){e.next=37;break}throw new or;case 37:return e.abrupt("return",No(this,Ao,"m",Po).call(this));case 38:case"end":return e.stop()}}),e,this,[[9,21,25,35],[26,,30,34]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:t,value:function(){var e=this,t=[],n=[],r=!1;return this.on("event",(function(e){var r=n.shift();r?r.resolve(e):t.push(e)})),this.on("end",(function(){r=!0;for(var e=0,t=n;e<t.length;e++){t[e].resolve(void 0)}n.length=0})),this.on("abort",(function(e){r=!0;for(var t=0,a=n;t<a.length;t++){a[t].reject(e)}n.length=0})),this.on("error",(function(e){r=!0;for(var t=0,a=n;t<a.length;t++){a[t].reject(e)}n.length=0})),{next:function(){var e=b(p().mark((function e(){var a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length){e.next=4;break}if(!r){e.next=3;break}return e.abrupt("return",{value:void 0,done:!0});case 3:return e.abrupt("return",new Promise((function(e,t){return n.push({resolve:e,reject:t})})).then((function(e){return e?{value:e,done:!1}:{value:void 0,done:!0}})));case 4:return a=t.shift(),e.abrupt("return",{value:a,done:!1});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),return:function(){var t=b(p().mark((function t(){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.abort(),t.abrupt("return",{value:void 0,done:!0});case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}}},{key:"finalResponse",value:function(){var e=b(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.done();case 2:if(t=No(this,So,"f")){e.next=5;break}throw new ir("stream ended without producing a ChatCompletion");case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"createResponse",value:function(e,t,n){var a=new r(t);return a._run((function(){return a._createResponse(e,t,q(q({},n),{},{headers:q(q({},null===n||void 0===n?void 0:n.headers),{},{"X-Stainless-Helper-Method":"stream"})}))})),a}}]),r}(Oi,(Co=new WeakMap,Do=new WeakMap,So=new WeakMap,Ao=new WeakSet,Oo=function(){this.ended||Io(this,Do,void 0,"f")},Fo=function(e){if(!this.ended){var t=No(this,Ao,"m",To).call(this,e);switch(this._emit("event",e),e.type){case"response.output_text.delta":var n=t.output[e.output_index];if(!n)throw new ir("missing output at index ".concat(e.output_index));if("message"===n.type){var r=n.content[e.content_index];if(!r)throw new ir("missing content at index ".concat(e.content_index));if("output_text"!==r.type)throw new ir("expected content to be 'output_text', got ".concat(r.type));this._emit("response.output_text.delta",q(q({},e),{},{snapshot:r.text}))}break;case"response.function_call_arguments.delta":var a=t.output[e.output_index];if(!a)throw new ir("missing output at index ".concat(e.output_index));"function_call"===a.type&&this._emit("response.function_call_arguments.delta",q(q({},e),{},{snapshot:a.arguments}));break;default:this._emit(e.type,e)}}},Po=function(){if(this.ended)throw new ir("stream has ended, this shouldn't happen");var e=No(this,Do,"f");if(!e)throw new ir("request ended without sending any events");Io(this,Do,void 0,"f");var t=function(e,t){return go(e,t)}(e,No(this,Co,"f"));return Io(this,So,t,"f"),t},To=function(e){var t=No(this,Do,"f");if(!t){if("response.created"!==e.type)throw new ir("When snapshot hasn't been set yet, expected 'response.created' event, got ".concat(e.type));return t=Io(this,Do,e.response,"f")}switch(e.type){case"response.output_item.added":t.output.push(e.item);break;case"response.content_part.added":var n=t.output[e.output_index];if(!n)throw new ir("missing output at index ".concat(e.output_index));"message"===n.type&&n.content.push(e.part);break;case"response.output_text.delta":var r=t.output[e.output_index];if(!r)throw new ir("missing output at index ".concat(e.output_index));if("message"===r.type){var a=r.content[e.content_index];if(!a)throw new ir("missing content at index ".concat(e.content_index));if("output_text"!==a.type)throw new ir("expected content to be 'output_text', got ".concat(a.type));a.text+=e.delta}break;case"response.function_call_arguments.delta":var i=t.output[e.output_index];if(!i)throw new ir("missing output at index ".concat(e.output_index));"function_call"===i.type&&(i.arguments+=e.delta);break;case"response.completed":Io(this,Do,e.response,"f")}return t},Symbol.asyncIterator));var Bo=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),(e=t.apply(this,arguments)).inputItems=new jo(e._client),e}return I(n,[{key:"create",value:function(e,t){var n;return this._client.post("/responses",q(q({body:e},t),{},{stream:null!==(n=e.stream)&&void 0!==n&&n}))._thenUnwrap((function(e){return"object"in e&&"response"===e.object&&Eo(e),e}))}},{key:"retrieve",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return oa(t)?this.retrieve(e,{},t):this._client.get("/responses/".concat(e),q({query:t},n))}},{key:"del",value:function(e,t){return this._client.delete("/responses/".concat(e),q(q({},t),{},{headers:q({Accept:"*/*"},null===t||void 0===t?void 0:t.headers)}))}},{key:"parse",value:function(e,t){return this._client.responses.create(e,t)._thenUnwrap((function(t){return bo(t,e)}))}},{key:"stream",value:function(e,t){return Ro.createResponse(this._client,e,t)}}]),n}(Sa),Lo=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Ta);Bo.InputItems=jo;var Mo,Uo=["baseURL","apiKey","organization","project"],zo=function(e){B(n,e);var t=z(n);function n(){var e,r,a,i,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=u.baseURL,s=void 0===o?ba("OPENAI_BASE_URL"):o,c=u.apiKey,l=void 0===c?ba("OPENAI_API_KEY"):c,d=u.organization,f=void 0===d?null!==(e=ba("OPENAI_ORG_ID"))&&void 0!==e?e:null:d,p=u.project,h=void 0===p?null!==(r=ba("OPENAI_PROJECT_ID"))&&void 0!==r?r:null:p,v=Sn(u,Uo);if(T(this,n),void 0===l)throw new ir("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");var m=q(q({apiKey:l,organization:f,project:h},v),{},{baseURL:s||"https://api.openai.com/v1"});if(!m.dangerouslyAllowBrowser&&"undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof navigator)throw new ir("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");return(i=t.call(this,{baseURL:m.baseURL,timeout:null!==(a=m.timeout)&&void 0!==a?a:6e5,httpAgent:m.httpAgent,maxRetries:m.maxRetries,fetch:m.fetch})).completions=new Oa(N(i)),i.chat=new Ra(N(i)),i.embeddings=new Ba(N(i)),i.files=new La(N(i)),i.images=new Ua(N(i)),i.audio=new Wa(N(i)),i.moderations=new qa(N(i)),i.models=new Ga(N(i)),i.fineTuning=new Ya(N(i)),i.vectorStores=new ii(N(i)),i.beta=new po(N(i)),i.batches=new ho(N(i)),i.uploads=new yo(N(i)),i.responses=new Bo(N(i)),i._options=m,i.apiKey=l,i.organization=f,i.project=h,i}return I(n,[{key:"defaultQuery",value:function(){return this._options.defaultQuery}},{key:"defaultHeaders",value:function(e){return q(q({},kn(L(n.prototype),"defaultHeaders",this).call(this,e)),{},{"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},this._options.defaultHeaders)}},{key:"authHeaders",value:function(e){return{Authorization:"Bearer ".concat(this.apiKey)}}},{key:"stringifyQuery",value:function(e){return Wn(e,{arrayFormat:"brackets"})}}]),n}(na);Mo=zo,zo.OpenAI=Mo,zo.DEFAULT_TIMEOUT=6e5,zo.OpenAIError=ir,zo.APIError=ur,zo.APIConnectionError=sr,zo.APIConnectionTimeoutError=cr,zo.APIUserAbortError=or,zo.NotFoundError=pr,zo.ConflictError=hr,zo.RateLimitError=mr,zo.BadRequestError=lr,zo.AuthenticationError=dr,zo.InternalServerError=yr,zo.PermissionDeniedError=fr,zo.UnprocessableEntityError=vr,zo.toFile=Rr,zo.fileFromPath=er,zo.Completions=Oa,zo.Chat=Ra,zo.ChatCompletionsPage=Ia,zo.Embeddings=Ba,zo.Files=La,zo.FileObjectsPage=Ma,zo.Images=Ua,zo.Audio=Wa,zo.Moderations=qa,zo.Models=Ga,zo.ModelsPage=Va,zo.FineTuning=Ya,zo.VectorStores=ii,zo.VectorStoresPage=ui,zo.VectorStoreSearchResponsesPage=oi,zo.Beta=po,zo.Batches=ho,zo.BatchesPage=vo,zo.Uploads=yo,zo.Responses=Bo;new Set(["/completions","/chat/completions","/embeddings","/audio/transcriptions","/audio/translations","/audio/speech","/images/generations"]);function Ho(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zo;e=e.trim();var n=/```(json)?([\s\S]*)```/.exec(e);return t(n?n[2]:e)}function Zo(e){if("undefined"===typeof e)return null;try{return JSON.parse(e)}catch(c){}var t,n="",r=[],a=!1,i=!1,u=G(e);try{for(u.s();!(t=u.n()).done;){var o=t.value;if(a)'"'!==o||i?"\n"!==o||i?i="\\"===o&&!i:o="\\n":a=!1;else if('"'===o)a=!0,i=!1;else if("{"===o)r.push("}");else if("["===o)r.push("]");else if("}"===o||"]"===o){if(!r||r[r.length-1]!==o)return null;r.pop()}n+=o}}catch(l){u.e(l)}finally{u.f()}a&&(n+='"');for(var s=r.length-1;s>=0;s-=1)n+=r[s];try{return JSON.parse(n)}catch(c){return null}}function Wo(e){return _(e)||v(e)||m(e)||k()}var qo=n(5578);n(8856);function Go(e,t){return(null===t||void 0===t?void 0:t[e])||qo(e)}function Vo(e,t,n){var r={};for(var a in e)Object.hasOwn(e,a)&&(r[t(a,n)]=e[a]);return r}function $o(e){return Array.isArray(e)?y(e):q({},e)}function Jo(e,t){for(var n=$o(e),r=0,a=Object.entries(t);r<a.length;r++){var i,u=w(a[r],2),o=u[0],s=u[1],c=Wo(o.split(".").reverse()),l=c[0],d=n,f=G(c.slice(1).reverse());try{for(f.s();!(i=f.n()).done;){var p=i.value;if(void 0===d[p])break;d[p]=$o(d[p]),d=d[p]}}catch(h){f.e(h)}finally{f.f()}void 0!==d[l]&&(d[l]={lc:1,type:"secret",id:[s]})}return n}function Ko(e){var t=Object.getPrototypeOf(e);return"function"===typeof e.lc_name&&("function"!==typeof t.lc_name||e.lc_name()!==t.lc_name())?e.lc_name():e.name}var Qo=function(){function e(t){var n=this;T(this,e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),void 0!==this.lc_serializable_keys?this.lc_kwargs=Object.fromEntries(Object.entries(t||{}).filter((function(e){var t,r=w(e,1)[0];return null===(t=n.lc_serializable_keys)||void 0===t?void 0:t.includes(r)}))):this.lc_kwargs=null!==t&&void 0!==t?t:{}}return I(e,[{key:"lc_id",get:function(){return[].concat(y(this.lc_namespace),[Ko(this.constructor)])}},{key:"lc_secrets",get:function(){}},{key:"lc_attributes",get:function(){}},{key:"lc_aliases",get:function(){}},{key:"lc_serializable_keys",get:function(){}},{key:"toJSON",value:function(){var t=this;if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof e||"object"!==typeof this.lc_kwargs||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();for(var n={},r={},a=Object.keys(this.lc_kwargs).reduce((function(e,n){return e[n]=n in t?t[n]:t.lc_kwargs[n],e}),{}),i=Object.getPrototypeOf(this);i;i=Object.getPrototypeOf(i))Object.assign(n,Reflect.get(i,"lc_aliases",this)),Object.assign(r,Reflect.get(i,"lc_secrets",this)),Object.assign(a,Reflect.get(i,"lc_attributes",this));return Object.keys(r).forEach((function(e){var n,r=t,i=a,u=Wo(e.split(".").reverse()),o=u[0],s=G(u.slice(1).reverse());try{for(s.s();!(n=s.n()).done;){var c=n.value;if(!(c in r)||void 0===r[c])return;c in i&&void 0!==i[c]||("object"===typeof r[c]&&null!=r[c]?i[c]={}:Array.isArray(r[c])&&(i[c]=[])),r=r[c],i=i[c]}}catch(l){s.e(l)}finally{s.f()}o in r&&void 0!==r[o]&&(i[o]=i[o]||r[o])})),{lc:1,type:"constructor",id:this.lc_id,kwargs:Vo(Object.keys(r).length?Jo(a,r):a,Go,n)}}},{key:"toJSONNotImplemented",value:function(){return{lc:1,type:"not_implemented",id:this.lc_id}}}],[{key:"lc_name",value:function(){return this.name}}]),e}();function Xo(e,t){return"string"===typeof e?""===e?t:"string"===typeof t?e+t:[{type:"text",text:e}].concat(y(t)):Array.isArray(t)?null!==(n=ts(e,t))&&void 0!==n?n:[].concat(y(e),y(t)):""===t?e:[].concat(y(e),[{type:"text",text:t}]);var n}var Yo=function(e,t,n){B(a,e);var r=z(a);function a(e,t){var n;return T(this,a),"string"===typeof e&&(e={content:e,additional_kwargs:t,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),n=r.call(this,e),Object.defineProperty(N(n),"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(N(n),"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(N(n),"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(n),"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(n),"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(n),"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(n),"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.name=e.name,n.content=e.content,n.additional_kwargs=e.additional_kwargs,n.response_metadata=e.response_metadata,n.id=e.id,n}return I(a,[{key:"lc_aliases",get:function(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}},{key:"text",get:function(){return"string"===typeof this.content?this.content:Array.isArray(this.content)?this.content.map((function(e){return"string"===typeof e?e:"text"===e.type?e.text:""})).join(""):""}},{key:"getType",value:function(){return this._getType()}},{key:"toDict",value:function(){return{type:this._getType(),data:this.toJSON().kwargs}}},{key:"_printableFields",get:function(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}},{key:"_updateId",value:function(e){this.id=e,this.lc_kwargs.id=e}},{key:t,get:function(){return this.constructor.lc_name()}},{key:n,value:function(e){if(null===e)return this;var t,n,r=(t=this._printableFields,n=Math.max(4,e),JSON.stringify(function e(t,r){if("object"!==typeof t||null===t||void 0===t)return t;if(r>=n)return Array.isArray(t)?"[Array]":"[Object]";if(Array.isArray(t))return t.map((function(t){return e(t,r+1)}));for(var a={},i=0,u=Object.keys(t);i<u.length;i++){var o=u[i];a[o]=e(t[o],r+1)}return a}(t,0),null,2));return"".concat(this.constructor.lc_name()," ").concat(r)}}],[{key:"lc_name",value:function(){return"BaseMessage"}}]),a}(Qo,Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"));function es(e,t){for(var n=q({},e),r=0,a=Object.entries(t);r<a.length;r++){var i=w(a[r],2),u=i[0],o=i[1];if(null==n[u])n[u]=o;else{if(null==o)continue;if(typeof n[u]!==typeof o||Array.isArray(n[u])!==Array.isArray(o))throw new Error("field[".concat(u,"] already exists in the message chunk, but with a different type."));if("string"===typeof n[u]){if("type"===u)continue;n[u]+=o}else if("object"!==typeof n[u]||Array.isArray(n[u]))if(Array.isArray(n[u]))n[u]=ts(n[u],o);else{if(n[u]===o)continue;console.warn("field[".concat(u,"] already exists in this message chunk and value has unsupported type."))}else n[u]=es(n[u],o)}}return n}function ts(e,t){if(void 0!==e||void 0!==t){if(void 0===e||void 0===t)return e||t;var n,r=y(e),a=G(t);try{var i=function(){var e=n.value;if("object"===typeof e&&"index"in e&&"number"===typeof e.index){var t=r.findIndex((function(t){return t.index===e.index}));-1!==t?r[t]=es(r[t],e):r.push(e)}else{if("object"===typeof e&&"text"in e&&""===e.text)return"continue";r.push(e)}};for(a.s();!(n=a.n()).done;)i()}catch(u){a.e(u)}finally{a.f()}return r}}function ns(e,t){if(!e&&!t)throw new Error("Cannot merge two undefined objects.");if(e&&t){if(typeof e!==typeof t)throw new Error("Cannot merge objects of different types.\nLeft ".concat(typeof e,"\nRight ").concat(typeof t));if("string"===typeof e&&"string"===typeof t)return e+t;if(Array.isArray(e)&&Array.isArray(t))return ts(e,t);if("object"===typeof e&&"object"===typeof t)return es(e,t);if(e===t)return e;throw new Error("Can not merge objects of different types.\nLeft ".concat(e,"\nRight ").concat(t))}return e||t}var rs=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Yo);function as(e){return"function"===typeof(null===e||void 0===e?void 0:e._getType)}var is=function(e){B(n,e);var t=z(n);function n(e,r,a){var i;return T(this,n),"string"===typeof e&&(e={content:e,name:a,tool_call_id:r}),i=t.call(this,e),Object.defineProperty(N(i),"lc_direct_tool_output",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(N(i),"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(i),"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(i),"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),i.tool_call_id=e.tool_call_id,i.artifact=e.artifact,i.status=e.status,i}return I(n,[{key:"lc_aliases",get:function(){return{tool_call_id:"tool_call_id"}}},{key:"_getType",value:function(){return"tool"}},{key:"_printableFields",get:function(){return q(q({},kn(L(n.prototype),"_printableFields",this)),{},{tool_call_id:this.tool_call_id,artifact:this.artifact})}}],[{key:"lc_name",value:function(){return"ToolMessage"}},{key:"isInstance",value:function(e){return"tool"===e._getType()}}]),n}(Yo),us=function(e){B(n,e);var t=z(n);function n(e){var r;return T(this,n),r=t.call(this,e),Object.defineProperty(N(r),"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(r),"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(r),"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.tool_call_id=e.tool_call_id,r.artifact=e.artifact,r.status=e.status,r}return I(n,[{key:"_getType",value:function(){return"tool"}},{key:"concat",value:function(e){var t,r,a;return new n({content:Xo(this.content,e.content),additional_kwargs:es(this.additional_kwargs,e.additional_kwargs),response_metadata:es(this.response_metadata,e.response_metadata),artifact:ns(this.artifact,e.artifact),tool_call_id:this.tool_call_id,id:null!==(t=this.id)&&void 0!==t?t:e.id,status:(r=this.status,a=e.status,"error"===r||"error"===a?"error":"success")})}},{key:"_printableFields",get:function(){return q(q({},kn(L(n.prototype),"_printableFields",this)),{},{tool_call_id:this.tool_call_id,artifact:this.artifact})}}],[{key:"lc_name",value:function(){return"ToolMessageChunk"}}]),n}(rs);var os=function(e){B(n,e);var t=z(n);function n(e,r){var a,i,u,o;if(T(this,n),"string"===typeof e)i={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:null!==r&&void 0!==r?r:{}};else{var s,c=null===(s=(i=e).additional_kwargs)||void 0===s?void 0:s.tool_calls,l=i.tool_calls;null!=c&&c.length>0&&(void 0===l||0===l.length)&&console.warn(["New LangChain packages are available that more efficiently handle","tool calling.\n\nPlease upgrade your packages to versions that set","message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(null!=c&&void 0===l){var d=function(e){var t,n=[],r=[],a=G(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(i.function){var u=i.function.name;try{var o={name:u||"",args:JSON.parse(i.function.arguments)||{},id:i.id};n.push(o)}catch(s){r.push({name:u,args:i.function.arguments,id:i.id,error:"Malformed args."})}}}}catch(c){a.e(c)}finally{a.f()}return[n,r]}(c),f=w(d,2),p=f[0],h=f[1];i.tool_calls=null!==p&&void 0!==p?p:[],i.invalid_tool_calls=null!==h&&void 0!==h?h:[]}else{var v,m;i.tool_calls=null!==(v=i.tool_calls)&&void 0!==v?v:[],i.invalid_tool_calls=null!==(m=i.invalid_tool_calls)&&void 0!==m?m:[]}}catch(y){i.tool_calls=[],i.invalid_tool_calls=[]}}(a=t.call(this,i),Object.defineProperty(N(a),"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(N(a),"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(N(a),"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),"string"!==typeof i)&&(a.tool_calls=null!==(u=i.tool_calls)&&void 0!==u?u:a.tool_calls,a.invalid_tool_calls=null!==(o=i.invalid_tool_calls)&&void 0!==o?o:a.invalid_tool_calls);return a.usage_metadata=i.usage_metadata,a}return I(n,[{key:"lc_aliases",get:function(){return q(q({},kn(L(n.prototype),"lc_aliases",this)),{},{tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"})}},{key:"_getType",value:function(){return"ai"}},{key:"_printableFields",get:function(){return q(q({},kn(L(n.prototype),"_printableFields",this)),{},{tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata})}}],[{key:"lc_name",value:function(){return"AIMessage"}}]),n}(Yo);function ss(e){return"ai"===e._getType()}function cs(e){return"ai"===e._getType()}var ls=function(e){B(n,e);var t=z(n);function n(e){var r,a,i,u,o;if(T(this,n),"string"===typeof e)o={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(void 0===e.tool_call_chunks){var s;o=q(q({},e),{},{tool_calls:null!==(s=e.tool_calls)&&void 0!==s?s:[],invalid_tool_calls:[],tool_call_chunks:[],usage_metadata:void 0!==e.usage_metadata?e.usage_metadata:void 0})}else{var c,l=[],d=[],f=G(e.tool_call_chunks);try{for(f.s();!(c=f.n()).done;){var p=c.value,h={};try{var v;if(null===(h=Zo(p.args||"{}"))||"object"!==typeof h||Array.isArray(h))throw new Error("Malformed tool call chunk args.");l.push({name:null!==(v=p.name)&&void 0!==v?v:"",args:h,id:p.id,type:"tool_call"})}catch(m){d.push({name:p.name,args:p.args,id:p.id,error:"Malformed args.",type:"invalid_tool_call"})}}}catch(y){f.e(y)}finally{f.f()}o=q(q({},e),{},{tool_calls:l,invalid_tool_calls:d,usage_metadata:void 0!==e.usage_metadata?e.usage_metadata:void 0})}return u=t.call(this,o),Object.defineProperty(N(u),"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(N(u),"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(N(u),"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(N(u),"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),u.tool_call_chunks=null!==(r=o.tool_call_chunks)&&void 0!==r?r:u.tool_call_chunks,u.tool_calls=null!==(a=o.tool_calls)&&void 0!==a?a:u.tool_calls,u.invalid_tool_calls=null!==(i=o.invalid_tool_calls)&&void 0!==i?i:u.invalid_tool_calls,u.usage_metadata=o.usage_metadata,u}return I(n,[{key:"lc_aliases",get:function(){return q(q({},kn(L(n.prototype),"lc_aliases",this)),{},{tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"})}},{key:"_getType",value:function(){return"ai"}},{key:"_printableFields",get:function(){return q(q({},kn(L(n.prototype),"_printableFields",this)),{},{tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata})}},{key:"concat",value:function(e){var t,r={content:Xo(this.content,e.content),additional_kwargs:es(this.additional_kwargs,e.additional_kwargs),response_metadata:es(this.response_metadata,e.response_metadata),tool_call_chunks:[],id:null!==(t=this.id)&&void 0!==t?t:e.id};if(void 0!==this.tool_call_chunks||void 0!==e.tool_call_chunks){var a=ts(this.tool_call_chunks,e.tool_call_chunks);void 0!==a&&a.length>0&&(r.tool_call_chunks=a)}if(void 0!==this.usage_metadata||void 0!==e.usage_metadata){var i,u,o,s,c,l,d,f,p,h,v,m,y,g,b,_,k,w,x,E,A,C,D,S,O,F,P,T,j,I,N,R,B,L,M,U,z,H,Z,W,G,V,$,J,K,Q,X,Y,ee,te,ne,re,ae=q(q(q({},(void 0!==(null===(i=this.usage_metadata)||void 0===i||null===(u=i.input_token_details)||void 0===u?void 0:u.audio)||void 0!==(null===(o=e.usage_metadata)||void 0===o||null===(s=o.input_token_details)||void 0===s?void 0:s.audio))&&{audio:(null!==(c=null===(l=this.usage_metadata)||void 0===l||null===(d=l.input_token_details)||void 0===d?void 0:d.audio)&&void 0!==c?c:0)+(null!==(f=null===(p=e.usage_metadata)||void 0===p||null===(h=p.input_token_details)||void 0===h?void 0:h.audio)&&void 0!==f?f:0)}),(void 0!==(null===(v=this.usage_metadata)||void 0===v||null===(m=v.input_token_details)||void 0===m?void 0:m.cache_read)||void 0!==(null===(y=e.usage_metadata)||void 0===y||null===(g=y.input_token_details)||void 0===g?void 0:g.cache_read))&&{cache_read:(null!==(b=null===(_=this.usage_metadata)||void 0===_||null===(k=_.input_token_details)||void 0===k?void 0:k.cache_read)&&void 0!==b?b:0)+(null!==(w=null===(x=e.usage_metadata)||void 0===x||null===(E=x.input_token_details)||void 0===E?void 0:E.cache_read)&&void 0!==w?w:0)}),(void 0!==(null===(A=this.usage_metadata)||void 0===A||null===(C=A.input_token_details)||void 0===C?void 0:C.cache_creation)||void 0!==(null===(D=e.usage_metadata)||void 0===D||null===(S=D.input_token_details)||void 0===S?void 0:S.cache_creation))&&{cache_creation:(null!==(O=null===(F=this.usage_metadata)||void 0===F||null===(P=F.input_token_details)||void 0===P?void 0:P.cache_creation)&&void 0!==O?O:0)+(null!==(T=null===(j=e.usage_metadata)||void 0===j||null===(I=j.input_token_details)||void 0===I?void 0:I.cache_creation)&&void 0!==T?T:0)}),ie=q(q({},(void 0!==(null===(N=this.usage_metadata)||void 0===N||null===(R=N.output_token_details)||void 0===R?void 0:R.audio)||void 0!==(null===(B=e.usage_metadata)||void 0===B||null===(L=B.output_token_details)||void 0===L?void 0:L.audio))&&{audio:(null!==(M=null===(U=this.usage_metadata)||void 0===U||null===(z=U.output_token_details)||void 0===z?void 0:z.audio)&&void 0!==M?M:0)+(null!==(H=null===(Z=e.usage_metadata)||void 0===Z||null===(W=Z.output_token_details)||void 0===W?void 0:W.audio)&&void 0!==H?H:0)}),(void 0!==(null===(G=this.usage_metadata)||void 0===G||null===(V=G.output_token_details)||void 0===V?void 0:V.reasoning)||void 0!==(null===($=e.usage_metadata)||void 0===$||null===(J=$.output_token_details)||void 0===J?void 0:J.reasoning))&&{reasoning:(null!==(K=null===(Q=this.usage_metadata)||void 0===Q||null===(X=Q.output_token_details)||void 0===X?void 0:X.reasoning)&&void 0!==K?K:0)+(null!==(Y=null===(ee=e.usage_metadata)||void 0===ee||null===(te=ee.output_token_details)||void 0===te?void 0:te.reasoning)&&void 0!==Y?Y:0)}),ue=null!==(ne=this.usage_metadata)&&void 0!==ne?ne:{input_tokens:0,output_tokens:0,total_tokens:0},oe=null!==(re=e.usage_metadata)&&void 0!==re?re:{input_tokens:0,output_tokens:0,total_tokens:0},se=q(q({input_tokens:ue.input_tokens+oe.input_tokens,output_tokens:ue.output_tokens+oe.output_tokens,total_tokens:ue.total_tokens+oe.total_tokens},Object.keys(ae).length>0&&{input_token_details:ae}),Object.keys(ie).length>0&&{output_token_details:ie});r.usage_metadata=se}return new n(r)}}],[{key:"lc_name",value:function(){return"AIMessageChunk"}}]),n}(rs),ds=function(e){B(n,e);var t=z(n);function n(e,r){var a;return T(this,n),"string"===typeof e&&(e={content:e,role:r}),a=t.call(this,e),Object.defineProperty(N(a),"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),a.role=e.role,a}return I(n,[{key:"_getType",value:function(){return"generic"}},{key:"_printableFields",get:function(){return q(q({},kn(L(n.prototype),"_printableFields",this)),{},{role:this.role})}}],[{key:"lc_name",value:function(){return"ChatMessage"}},{key:"_chatMessageClass",value:function(){return n}},{key:"isInstance",value:function(e){return"generic"===e._getType()}}]),n}(Yo),fs=function(e){B(n,e);var t=z(n);function n(e,r){var a;return T(this,n),"string"===typeof e&&(e={content:e,role:r}),a=t.call(this,e),Object.defineProperty(N(a),"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),a.role=e.role,a}return I(n,[{key:"_getType",value:function(){return"generic"}},{key:"concat",value:function(e){var t;return new n({content:Xo(this.content,e.content),additional_kwargs:es(this.additional_kwargs,e.additional_kwargs),response_metadata:es(this.response_metadata,e.response_metadata),role:this.role,id:null!==(t=this.id)&&void 0!==t?t:e.id})}},{key:"_printableFields",get:function(){return q(q({},kn(L(n.prototype),"_printableFields",this)),{},{role:this.role})}}],[{key:"lc_name",value:function(){return"ChatMessageChunk"}}]),n}(rs);var ps=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_getType",value:function(){return"function"}},{key:"concat",value:function(e){var t,r;return new n({content:Xo(this.content,e.content),additional_kwargs:es(this.additional_kwargs,e.additional_kwargs),response_metadata:es(this.response_metadata,e.response_metadata),name:null!==(t=this.name)&&void 0!==t?t:"",id:null!==(r=this.id)&&void 0!==r?r:e.id})}}],[{key:"lc_name",value:function(){return"FunctionMessageChunk"}}]),n}(rs);var hs=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_getType",value:function(){return"human"}}],[{key:"lc_name",value:function(){return"HumanMessage"}}]),n}(Yo),vs=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_getType",value:function(){return"human"}},{key:"concat",value:function(e){var t;return new n({content:Xo(this.content,e.content),additional_kwargs:es(this.additional_kwargs,e.additional_kwargs),response_metadata:es(this.response_metadata,e.response_metadata),id:null!==(t=this.id)&&void 0!==t?t:e.id})}}],[{key:"lc_name",value:function(){return"HumanMessageChunk"}}]),n}(rs);var ms=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_getType",value:function(){return"system"}}],[{key:"lc_name",value:function(){return"SystemMessage"}}]),n}(Yo),ys=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_getType",value:function(){return"system"}},{key:"concat",value:function(e){var t;return new n({content:Xo(this.content,e.content),additional_kwargs:es(this.additional_kwargs,e.additional_kwargs),response_metadata:es(this.response_metadata,e.response_metadata),id:null!==(t=this.id)&&void 0!==t?t:e.id})}}],[{key:"lc_name",value:function(){return"SystemMessageChunk"}}]),n}(rs);function gs(e,t){return e.lc_error_code=t,e.message="".concat(e.message,"\n\nTroubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/").concat(t,"/\n"),e}function bs(e){return!(!e||"object"!==typeof e||!("type"in e)||"tool_call"!==e.type)}var _s=function(e){B(n,e);var t=z(n);function n(e,r){var a;return T(this,n),a=t.call(this,e),Object.defineProperty(N(a),"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),a.output=r,a}return I(n)}(Z(Error)),ks=["type"],ws=["tool_calls"],xs=["role"];function Es(e){return bs(e)?e:"string"===typeof e.id&&"function"===e.type&&"object"===typeof e.function&&null!==e.function&&"arguments"in e.function&&"string"===typeof e.function.arguments&&"name"in e.function&&"string"===typeof e.function.name?{id:e.id,args:JSON.parse(e.function.arguments),name:e.function.name,type:"tool_call"}:e}function As(e){var t,n,r;if("object"===typeof(r=e)&&null!=r&&1===r.lc&&Array.isArray(r.id)&&null!=r.kwargs&&"object"===typeof r.kwargs){var a=e.id.at(-1);t="HumanMessage"===a||"HumanMessageChunk"===a?"user":"AIMessage"===a||"AIMessageChunk"===a?"assistant":"SystemMessage"===a||"SystemMessageChunk"===a?"system":"FunctionMessage"===a||"FunctionMessageChunk"===a?"function":"ToolMessage"===a||"ToolMessageChunk"===a?"tool":"unknown",n=e.kwargs}else{t=e.type,n=Sn(e,ks)}if("human"===t||"user"===t)return new hs(n);if("ai"===t||"assistant"===t){var i=n,u=i.tool_calls,o=Sn(i,ws);if(!Array.isArray(u))return new os(n);var s=u.map(Es);return new os(q(q({},o),{},{tool_calls:s}))}if("system"===t)return new ms(n);if("developer"===t)return new ms(q(q({},n),{},{additional_kwargs:q(q({},n.additional_kwargs),{},{__openai_role__:"developer"})}));if("tool"===t&&"tool_call_id"in n)return new is(q(q({},n),{},{content:n.content,tool_call_id:n.tool_call_id,name:n.name}));throw gs(new Error("Unable to coerce message from array: only human, AI, system, developer, or tool message coercion is currently supported.\n\nReceived: ".concat(JSON.stringify(e,null,2))),"MESSAGE_COERCION_FAILURE")}function Cs(e){if("string"===typeof e)return new hs(e);if(as(e))return e;if(Array.isArray(e)){var t=w(e,2);return As({type:t[0],content:t[1]})}if("string"===typeof e.role){var n=e.role;return As(q(q({},Sn(e,xs)),{},{type:n}))}return As(e)}function Ds(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Human",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"AI",a=[],i=G(e);try{for(i.s();!(t=i.n()).done;){var u=t.value,o=void 0;if("human"===u._getType())o=n;else if("ai"===u._getType())o=r;else if("system"===u._getType())o="System";else if("function"===u._getType())o="Function";else if("tool"===u._getType())o="Tool";else{if("generic"!==u._getType())throw new Error("Got unsupported message type: ".concat(u._getType()));o=u.role}var s=u.name?"".concat(u.name,", "):"",c="string"===typeof u.content?u.content:JSON.stringify(u.content,null,2);a.push("".concat(o,": ").concat(s).concat(c))}}catch(l){i.e(l)}finally{i.f()}return a.join("\n")}function Ss(e){var t=e._getType();if("human"===t)return new vs(q({},e));if("ai"===t){var n,r=q({},e);if("tool_calls"in r)r=q(q({},r),{},{tool_call_chunks:null===(n=r.tool_calls)||void 0===n?void 0:n.map((function(e){return q(q({},e),{},{type:"tool_call_chunk",index:void 0,args:JSON.stringify(e.args)})}))});return new ls(q({},r))}if("system"===t)return new ys(q({},e));if("function"===t)return new ps(q({},e));if(ds.isInstance(e))return new fs(q({},e));throw new Error("Unknown message type.")}function Os(e){var t={},n=!1;function r(t,r){return n=!0,{done:!1,value:new wn(r=new Promise((function(n){n(e[t](r))})),1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return n?(n=!1,e):r("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(n)throw n=!1,e;return r("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return n?(n=!1,e):r("return",e)}),t}var Fs,Ps=n(1545),Ts={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},js=new Uint8Array(16);function Is(){if(!Fs&&!(Fs="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Fs(js)}for(var Ns=[],Rs=0;Rs<256;++Rs)Ns.push((Rs+256).toString(16).slice(1));function Bs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(Ns[e[t+0]]+Ns[e[t+1]]+Ns[e[t+2]]+Ns[e[t+3]]+"-"+Ns[e[t+4]]+Ns[e[t+5]]+"-"+Ns[e[t+6]]+Ns[e[t+7]]+"-"+Ns[e[t+8]]+Ns[e[t+9]]+"-"+Ns[e[t+10]]+Ns[e[t+11]]+Ns[e[t+12]]+Ns[e[t+13]]+Ns[e[t+14]]+Ns[e[t+15]]).toLowerCase()}var Ls,Ms=function(e,t,n){if(Ts.randomUUID&&!t&&!e)return Ts.randomUUID();var r=(e=e||{}).random||(e.rng||Is)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return Bs(r)},Us={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},zs=new Uint8Array(16);function Hs(){if(!Ls&&!(Ls="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ls(zs)}for(var Zs=[],Ws=0;Ws<256;++Ws)Zs.push((Ws+256).toString(16).slice(1));function qs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(Zs[e[t+0]]+Zs[e[t+1]]+Zs[e[t+2]]+Zs[e[t+3]]+"-"+Zs[e[t+4]]+Zs[e[t+5]]+"-"+Zs[e[t+6]]+Zs[e[t+7]]+"-"+Zs[e[t+8]]+Zs[e[t+9]]+"-"+Zs[e[t+10]]+Zs[e[t+11]]+Zs[e[t+12]]+Zs[e[t+13]]+Zs[e[t+14]]+Zs[e[t+15]]).toLowerCase()}var Gs=function(e,t,n){if(Us.randomUUID&&!t&&!e)return Us.randomUUID();var r=(e=e||{}).random||(e.rng||Hs)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return qs(r)},Vs=n(2906),$s=function(){return fetch.apply(void 0,arguments)},Js=Symbol.for("ls:fetch_implementation"),Ks=function(){var e;return null!==(e=globalThis[Js])&&void 0!==e?e:$s},Qs=[400,401,403,404,405,406,407,408],Xs=[409],Ys=function(){function e(t){var n,r;T(this,e),Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=null!==(n=t.maxConcurrency)&&void 0!==n?n:1/0,this.maxRetries=null!==(r=t.maxRetries)&&void 0!==r?r:6,this.queue=new Vs.default({concurrency:this.maxConcurrency}),this.onFailedResponseHook=null===t||void 0===t?void 0:t.onFailedResponseHook}return I(e,[{key:"call",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var i=this.onFailedResponseHook;return this.queue.add((function(){return Ps((function(){return e.apply(void 0,r).catch((function(e){throw e instanceof Error?e:new Error(e)}))}),{onFailedAttempt:function(e){return b(p().mark((function t(){var n,r;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.message.startsWith("Cancel")||e.message.startsWith("TimeoutError")||e.message.startsWith("AbortError"))){t.next=2;break}throw e;case 2:if("ECONNABORTED"!==(null===e||void 0===e?void 0:e.code)){t.next=4;break}throw e;case 4:if(n=null===e||void 0===e?void 0:e.response,!(r=null===n||void 0===n?void 0:n.status)){t.next=16;break}if(!Qs.includes(+r)){t.next=11;break}throw e;case 11:if(!Xs.includes(+r)){t.next=13;break}return t.abrupt("return");case 13:if(!i){t.next=16;break}return t.next=16,i(n);case 16:case"end":return t.stop()}}),t)})))()},retries:t.maxRetries,randomize:!0})}),{throwOnTimeout:!0})}},{key:"callWithOptions",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return e.signal?Promise.race([this.call.apply(this,[t].concat(r)),new Promise((function(t,n){var r;null===(r=e.signal)||void 0===r||r.addEventListener("abort",(function(){n(new Error("AbortError"))}))}))]):this.call.apply(this,[t].concat(r))}},{key:"fetch",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.call((function(){return Ks().apply(void 0,t).then((function(e){return e.ok?e:Promise.reject(e)}))}))}}]),e}();function ec(e){return"function"===typeof(null===e||void 0===e?void 0:e._getType)}function tc(e){var t={type:e._getType(),data:{content:e.content}};return null!==e&&void 0!==e&&e.additional_kwargs&&Object.keys(e.additional_kwargs).length>0&&(t.data.additional_kwargs=q({},e.additional_kwargs)),t}var nc=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;var rc=function(e){return"string"===typeof e&&nc.test(e)};function ac(e,t){if(!rc(e)){var n=void 0!==t?"Invalid UUID for ".concat(t,": ").concat(e):"Invalid UUID: ".concat(e);throw new Error(n)}return e}var ic={};function uc(e){ic[e]||(console.warn(e),ic[e]=!0)}n(724);function oc(e){if(!e||e.split("/").length>2||e.startsWith("/")||e.endsWith("/")||e.split(":").length>2)throw new Error("Invalid identifier format: ".concat(e));var t=w(e.split(":"),2),n=t[0],r=t[1]||"latest";if(n.includes("/")){var a=w(n.split("/",2),2),i=a[0],u=a[1];if(!i||!u)throw new Error("Invalid identifier format: ".concat(e));return[i,u,r]}if(!n)throw new Error("Invalid identifier format: ".concat(e));return["-",n,r]}var sc=function(e){B(n,e);var t=z(n);function n(e){var r;return T(this,n),(r=t.call(this,e)).name="LangSmithConflictError",r}return I(n)}(Z(Error));function cc(e,t,n){return lc.apply(this,arguments)}function lc(){return(lc=b(p().mark((function e(t,n,r){var a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=6;break}if(!r){e.next=5;break}return e.next=4,t.text();case 4:a=e.sent;case 5:return e.abrupt("return");case 6:return e.next=8,t.text();case 8:if(a=e.sent,i="Failed to ".concat(n,". Received status [").concat(t.status,"]: ").concat(t.statusText,". Server response: ").concat(a),409!==t.status){e.next=12;break}throw new sc(i);case 12:throw new Error(i);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var dc="[...]",fc={result:"[Circular]"},pc=[],hc=[],vc=new TextEncoder;function mc(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function yc(e){return vc.encode(e)}function gc(e,t,n,r){try{return yc(JSON.stringify(e,t,n))}catch(o){var a,i;if(null===(a=o.message)||void 0===a||!a.includes("Converting circular structure to JSON"))return console.warn("[WARNING]: LangSmith received unserializable value."),yc("[Unserializable]");console.warn("[WARNING]: LangSmith received circular JSON. This will decrease tracer performance."),"undefined"===typeof r&&(r=mc()),_c(e,"",0,[],void 0,0,r);try{i=0===hc.length?JSON.stringify(e,t,n):JSON.stringify(e,kc(t),n)}catch(s){return yc("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==pc.length;){var u=pc.pop();4===u.length?Object.defineProperty(u[0],u[1],u[3]):u[0][u[1]]=u[2]}}return yc(i)}}function bc(e,t,n,r){var a=Object.getOwnPropertyDescriptor(r,n);void 0!==a.get?a.configurable?(Object.defineProperty(r,n,{value:e}),pc.push([r,n,t,a])):hc.push([t,n,e]):(r[n]=e,pc.push([r,n,t]))}function _c(e,t,n,r,a,i,u){var o;if(i+=1,"object"===typeof e&&null!==e){for(o=0;o<r.length;o++)if(r[o]===e)return void bc(fc,e,t,a);if("undefined"!==typeof u.depthLimit&&i>u.depthLimit)return void bc(dc,e,t,a);if("undefined"!==typeof u.edgesLimit&&n+1>u.edgesLimit)return void bc(dc,e,t,a);if(r.push(e),Array.isArray(e))for(o=0;o<e.length;o++)_c(e[o],o,o,r,e,i,u);else{var s=Object.keys(e);for(o=0;o<s.length;o++){var c=s[o];_c(e[c],c,o,r,e,i,u)}}r.pop()}}function kc(e){return e="undefined"!==typeof e?e:function(e,t){return t},function(t,n){if(hc.length>0)for(var r=0;r<hc.length;r++){var a=hc[r];if(a[1]===t&&a[0]===n){n=a[2],hc.splice(r,1);break}}return e.call(this,t,n)}}var wc=["inputs","outputs","events","attachments"],xc=["datasetId","datasetName"],Ec=["attachment_urls"],Ac=["attachment_urls"];function Cc(e){var t,n,r=zc(),a=function(){for(var e=Hc()||{},t={},n=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION","LANGSMITH_API_KEY","LANGSMITH_ENDPOINT","LANGSMITH_TRACING_V2","LANGSMITH_PROJECT","LANGSMITH_SESSION"],r=0,a=Object.entries(e);r<a.length;r++){var i=w(a[r],2),u=i[0],o=i[1];!u.startsWith("LANGCHAIN_")&&!u.startsWith("LANGSMITH_")||"string"!==typeof o||n.includes(u)||u.toLowerCase().includes("key")||u.toLowerCase().includes("secret")||u.toLowerCase().includes("token")||("LANGCHAIN_REVISION_ID"===u?t.revision_id=o:t[u]=o)}return t}(),i=null!==(t=e.extra)&&void 0!==t?t:{},u=i.metadata;return e.extra=q(q({},i),{},{runtime:q(q({},r),null===i||void 0===i?void 0:i.runtime),metadata:q(q(q({},a),a.revision_id||e.revision_id?{revision_id:null!==(n=e.revision_id)&&void 0!==n?n:a.revision_id}:{}),u)}),e}function Dc(e){return Sc.apply(this,arguments)}function Sc(){return(Sc=b(p().mark((function e(t){var n,r,a,i,u,o,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=!1,a=!1,e.prev=3,u=Cn(t);case 5:return e.next=7,u.next();case 7:if(!(r=!(o=e.sent).done)){e.next=13;break}s=o.value,n.push(s);case 10:r=!1,e.next=5;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),a=!0,i=e.t0;case 19:if(e.prev=19,e.prev=20,!r||null==u.return){e.next=24;break}return e.next=24,u.return();case 24:if(e.prev=24,!a){e.next=27;break}throw i;case 27:return e.finish(24);case 28:return e.finish(19);case 29:return e.abrupt("return",n);case 30:case"end":return e.stop()}}),e,null,[[3,15,19,29],[20,,24,28]])})))).apply(this,arguments)}function Oc(e){if(void 0!==e)return e.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}var Fc=function(){var e=b(p().mark((function e(t){var n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(429!==(null===t||void 0===t?void 0:t.status)){e.next=6;break}if(!((r=1e3*parseInt(null!==(n=t.headers.get("retry-after"))&&void 0!==n?n:"30",10))>0)){e.next=6;break}return e.next=5,new Promise((function(e){return setTimeout(e,r)}));case 5:return e.abrupt("return",!0);case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Pc(e){return"number"===typeof e?Number(e.toFixed(4)):e}var Tc=function(){function e(){T(this,e),Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0})}return I(e,[{key:"peek",value:function(){return this.items[0]}},{key:"push",value:function(e){var t,n=new Promise((function(e){t=e})),r=gc(e.item).length;return this.items.push({action:e.action,payload:e.item,itemPromiseResolve:t,itemPromise:n,size:r}),this.sizeBytes+=r,n}},{key:"pop",value:function(e){if(e<1)throw new Error("Number of bytes to pop off may not be less than 1.");for(var t=[],n=0;n+(null!==(r=null===(a=this.peek())||void 0===a?void 0:a.size)&&void 0!==r?r:0)<e&&this.items.length>0;){var r,a,i=this.items.shift();i&&(t.push(i),n+=i.size,this.sizeBytes-=i.size)}if(0===t.length&&this.items.length>0){var u=this.items.shift();t.push(u),n+=u.size,this.sizeBytes-=u.size}return[t.map((function(e){return{action:e.action,item:e.payload}})),function(){return t.forEach((function(e){return e.itemPromiseResolve()}))}]}}]),e}(),jc=function(){function e(){var t,n,r,a,i,u,o,s,c,l,d,f,p,h,v,m,y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};T(this,e),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new Tc}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:"false"===Zc("LANGSMITH_TRACING_BACKGROUND")}),Object.defineProperty(this,"traceBatchConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"manualFlushMode",{enumerable:!0,configurable:!0,writable:!0,value:!1});var g=e.getDefaultClientConfig();if(this.tracingSampleRate=function(e){var t,n=null!==(t=null===e||void 0===e?void 0:e.toString())&&void 0!==t?t:Wc("TRACING_SAMPLING_RATE");if(void 0!==n){var r=parseFloat(n);if(r<0||r>1)throw new Error("LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ".concat(r));return r}}(y.tracingSamplingRate),this.apiUrl=null!==(t=Oc(null!==(n=y.apiUrl)&&void 0!==n?n:g.apiUrl))&&void 0!==t?t:"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=Oc(null!==(r=y.apiKey)&&void 0!==r?r:g.apiKey),this.webUrl=Oc(null!==(a=y.webUrl)&&void 0!==a?a:g.webUrl),null!==(i=this.webUrl)&&void 0!==i&&i.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.timeout_ms=null!==(u=y.timeout_ms)&&void 0!==u?u:9e4,this.caller=new Ys(null!==(o=y.callerOptions)&&void 0!==o?o:{}),this.traceBatchConcurrency=null!==(s=y.traceBatchConcurrency)&&void 0!==s?s:this.traceBatchConcurrency,this.traceBatchConcurrency<1)throw new Error("Trace batch concurrency must be positive.");this.batchIngestCaller=new Ys(q(q({maxRetries:2,maxConcurrency:this.traceBatchConcurrency},null!==(c=y.callerOptions)&&void 0!==c?c:{}),{},{onFailedResponseHook:Fc})),this.hideInputs=null!==(l=null!==(d=y.hideInputs)&&void 0!==d?d:y.anonymizer)&&void 0!==l?l:g.hideInputs,this.hideOutputs=null!==(f=null!==(p=y.hideOutputs)&&void 0!==p?p:y.anonymizer)&&void 0!==f?f:g.hideOutputs,this.autoBatchTracing=null!==(h=y.autoBatchTracing)&&void 0!==h?h:this.autoBatchTracing,this.blockOnRootRunFinalization=null!==(v=y.blockOnRootRunFinalization)&&void 0!==v?v:this.blockOnRootRunFinalization,this.batchSizeBytesLimit=y.batchSizeBytesLimit,this.fetchOptions=y.fetchOptions||{},this.manualFlushMode=null!==(m=y.manualFlushMode)&&void 0!==m?m:this.manualFlushMode}return I(e,[{key:"getHostUrl",value:function(){return this.webUrl?this.webUrl:function(e){var t=e.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return"localhost"===t||"127.0.0.1"===t||"::1"===t}(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.endsWith("/api/v1")?(this.webUrl=this.apiUrl.replace("/api/v1",""),this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("beta")?(this.webUrl="https://beta.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}},{key:"headers",get:function(){var e={"User-Agent":"langsmith-js/".concat(Lc)};return this.apiKey&&(e["x-api-key"]="".concat(this.apiKey)),e}},{key:"processInputs",value:function(e){return!1===this.hideInputs?e:!0===this.hideInputs?{}:"function"===typeof this.hideInputs?this.hideInputs(e):e}},{key:"processOutputs",value:function(e){return!1===this.hideOutputs?e:!0===this.hideOutputs?{}:"function"===typeof this.hideOutputs?this.hideOutputs(e):e}},{key:"prepareRunCreateOrUpdateInputs",value:function(e){var t=q({},e);return void 0!==t.inputs&&(t.inputs=this.processInputs(t.inputs)),void 0!==t.outputs&&(t.outputs=this.processOutputs(t.outputs)),t}},{key:"_getResponse",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=null!==(r=null===n||void 0===n?void 0:n.toString())&&void 0!==r?r:"",i="".concat(this.apiUrl).concat(t,"?").concat(a),e.next=4,this.caller.call(Ks(),i,q({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 4:return u=e.sent,e.next=7,cc(u,"Failed to fetch ".concat(t));case 7:return e.abrupt("return",u);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=b(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getResponse(t,n);case 2:return r=e.sent,e.abrupt("return",r.json());case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getPaginated",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new URLSearchParams,r=arguments.length>2?arguments[2]:void 0;return An(p().mark((function a(){var i,u,o,s,c;return p().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:i=Number(n.get("offset"))||0,u=Number(n.get("limit"))||100;case 2:return n.set("offset",String(i)),n.set("limit",String(u)),o="".concat(t.apiUrl).concat(e,"?").concat(n),a.next=8,xn(t.caller.call(Ks(),o,q({method:"GET",headers:t.headers,signal:AbortSignal.timeout(t.timeout_ms)},t.fetchOptions)));case 8:return s=a.sent,a.next=11,xn(cc(s,"Failed to fetch ".concat(e)));case 11:if(!r){a.next=19;break}return a.t1=r,a.next=15,xn(s.json());case 15:a.t2=a.sent,a.t0=(0,a.t1)(a.t2),a.next=22;break;case 19:return a.next=21,xn(s.json());case 21:a.t0=a.sent;case 22:if(0!==(c=a.t0).length){a.next=25;break}return a.abrupt("break",32);case 25:return a.next=27,c;case 27:if(!(c.length<u)){a.next=29;break}return a.abrupt("break",32);case 29:i+=c.length,a.next=2;break;case 32:case"end":return a.stop()}}),a)})))()}},{key:"_getCursorPaginatedList",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"runs";return An(p().mark((function i(){var u,o,s,c;return p().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:u=n?q({},n):{};case 1:return i.next=4,xn(t.caller.call(Ks(),"".concat(t.apiUrl).concat(e),q(q({method:r,headers:q(q({},t.headers),{},{"Content-Type":"application/json"}),signal:AbortSignal.timeout(t.timeout_ms)},t.fetchOptions),{},{body:JSON.stringify(u)})));case 4:return o=i.sent,i.next=7,xn(o.json());case 7:if(s=i.sent){i.next=10;break}return i.abrupt("break",22);case 10:if(s[a]){i.next=12;break}return i.abrupt("break",22);case 12:return i.next=14,s[a];case 14:if(c=s.cursors){i.next=17;break}return i.abrupt("break",22);case 17:if(c.next){i.next=19;break}return i.abrupt("break",22);case 19:u.cursor=c.next,i.next=1;break;case 22:case"end":return i.stop()}}),i)})))()}},{key:"_shouldSample",value:function(){return void 0===this.tracingSampleRate||Math.random()<this.tracingSampleRate}},{key:"_filterForSampling",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0===this.tracingSampleRate)return e;if(t){var n,r=[],a=G(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;this.filteredPostUuids.has(i.id)?this.filteredPostUuids.delete(i.id):r.push(i)}}catch(f){a.e(f)}finally{a.f()}return r}var u,o=[],s=G(e);try{for(s.s();!(u=s.n()).done;){var c,l=u.value,d=null!==(c=l.trace_id)&&void 0!==c?c:l.id;this.filteredPostUuids.has(d)||(l.id===d?this._shouldSample()?o.push(l):this.filteredPostUuids.add(d):o.push(l))}}catch(f){s.e(f)}finally{s.f()}return o}},{key:"_getBatchSizeLimitBytes",value:function(){var e=b(p().mark((function e(){var t,n,r,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureServerInfo();case 2:return a=e.sent,e.abrupt("return",null!==(t=null!==(n=this.batchSizeBytesLimit)&&void 0!==n?n:null===(r=a.batch_ingest_config)||void 0===r?void 0:r.size_limit_bytes)&&void 0!==t?t:20971520);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getMultiPartSupport",value:function(){var e=b(p().mark((function e(){var t,n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ensureServerInfo();case 2:return r=e.sent,e.abrupt("return",null!==(t=null===(n=r.instance_flags)||void 0===n?void 0:n.dataset_examples_multipart_enabled)&&void 0!==t&&t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"drainAutoBatchQueue",value:function(e){for(var t=[];this.autoBatchQueue.items.length>0;){var n=w(this.autoBatchQueue.pop(e),2),r=n[0],a=n[1];if(!r.length){a();break}var i=this._processBatch(r,a).catch(console.error);t.push(i)}return Promise.all(t)}},{key:"_processBatch",value:function(){var e=b(p().mark((function e(t,n){var r,a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length){e.next=3;break}return n(),e.abrupt("return");case 3:return e.prev=3,a={runCreates:t.filter((function(e){return"create"===e.action})).map((function(e){return e.item})),runUpdates:t.filter((function(e){return"update"===e.action})).map((function(e){return e.item}))},e.next=7,this._ensureServerInfo();case 7:if(null===(i=e.sent)||void 0===i||null===(r=i.batch_ingest_config)||void 0===r||!r.use_multipart_endpoint){e.next=13;break}return e.next=11,this.multipartIngestRuns(a);case 11:e.next=15;break;case 13:return e.next=15,this.batchIngestRuns(a);case 15:return e.prev=15,n(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[3,,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"processRunOperation",value:function(){var e=b(p().mark((function e(t){var n,r,a=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,"create"===t.action&&(t.item=Cc(t.item)),n=this.autoBatchQueue.push(t),!this.manualFlushMode){e.next=6;break}return e.abrupt("return",n);case 6:return e.next=8,this._getBatchSizeLimitBytes();case 8:return r=e.sent,this.autoBatchQueue.sizeBytes>r&&this.drainAutoBatchQueue(r),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout((function(){a.autoBatchTimeout=void 0,a.drainAutoBatchQueue(r)}),this.autoBatchAggregationDelayMs)),e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getServerInfo",value:function(){var e=b(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ks()("".concat(this.apiUrl,"/info"),q({method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(2500)},this.fetchOptions));case 2:return t=e.sent,e.next=5,cc(t,"get server info");case 5:return e.abrupt("return",t.json());case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_ensureServerInfo",value:function(){var e=b(p().mark((function e(){var t=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===this._getServerInfoPromise&&(this._getServerInfoPromise=b(p().mark((function e(){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t._serverInfo){e.next=10;break}return e.prev=1,e.next=4,t._getServerInfo();case 4:t._serverInfo=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.warn("[WARNING]: LangSmith failed to fetch info on supported operations. Falling back to batch operations and default limits.");case 10:return e.abrupt("return",null!==(n=t._serverInfo)&&void 0!==n?n:{});case 11:case"end":return e.stop()}}),e,null,[[1,7]])})))()),e.abrupt("return",this._getServerInfoPromise.then((function(e){return void 0===t._serverInfo&&(t._getServerInfoPromise=void 0),e})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getSettings",value:function(){var e=b(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.settings||(this.settings=this._get("/settings")),e.next=3,this.settings;case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"flush",value:function(){var e=b(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getBatchSizeLimitBytes();case 2:return t=e.sent,e.next=5,this.drainAutoBatchQueue(t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createRun",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._filterForSampling([t]).length){e.next=2;break}return e.abrupt("return");case 2:if(r=q(q({},this.headers),{},{"Content-Type":"application/json"}),a=t.project_name,delete t.project_name,i=this.prepareRunCreateOrUpdateInputs(q(q({session_name:a},t),{},{start_time:null!==(n=t.start_time)&&void 0!==n?n:Date.now()})),!this.autoBatchTracing||void 0===i.trace_id||void 0===i.dotted_order){e.next=9;break}return this.processRunOperation({action:"create",item:i}).catch(console.error),e.abrupt("return");case 9:return u=Cc(i),e.next=12,this.caller.call(Ks(),"".concat(this.apiUrl,"/runs"),q({method:"POST",headers:r,body:gc(u),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 12:return o=e.sent,e.next=15,cc(o,"create run",!0);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"batchIngestRuns",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l,d,f,h,v,m,y,g,b,_,k=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.runCreates,i=t.runUpdates,void 0!==a||void 0!==i){e.next=3;break}return e.abrupt("return");case 3:if(u=null!==(n=null===a||void 0===a?void 0:a.map((function(e){return k.prepareRunCreateOrUpdateInputs(e)})))&&void 0!==n?n:[],o=null!==(r=null===i||void 0===i?void 0:i.map((function(e){return k.prepareRunCreateOrUpdateInputs(e)})))&&void 0!==r?r:[],u.length>0&&o.length>0){s=u.reduce((function(e,t){return t.id?(e[t.id]=t,e):e}),{}),c=[],l=G(o);try{for(l.s();!(d=l.n()).done;)void 0!==(f=d.value).id&&s[f.id]?s[f.id]=q(q({},s[f.id]),f):c.push(f)}catch(p){l.e(p)}finally{l.f()}u=Object.values(s),o=c}if((h={post:u,patch:o}).post.length||h.patch.length){e.next=9;break}return e.abrupt("return");case 9:for(v={post:[],patch:[]},m=0,y=["post","patch"];m<y.length;m++)for(b=h[g=y[m]].reverse(),_=b.pop();void 0!==_;)v[g].push(_),_=b.pop();if(!(v.post.length>0||v.patch.length>0)){e.next=14;break}return e.next=14,this._postBatchIngestRuns(gc(v));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_postBatchIngestRuns",value:function(){var e=b(p().mark((function e(t){var n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=q(q({},this.headers),{},{"Content-Type":"application/json",Accept:"application/json"}),e.next=3,this.batchIngestCaller.call(Ks(),"".concat(this.apiUrl,"/runs/batch"),q({method:"POST",headers:n,body:t,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:return r=e.sent,e.next=6,cc(r,"batch create run",!0);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"multipartIngestRuns",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l,d,f,h,v,m,y,g,b,_,k,x,E,A,C,D,S,O,F,P,T,j,I,N,R,B,L,M,U,z,H,Z,W,V,$,J,K,Q,X,Y;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.runCreates,r=t.runUpdates,void 0!==n||void 0!==r){e.next=3;break}return e.abrupt("return");case 3:a={},i=[],u=G(null!==n&&void 0!==n?n:[]);try{for(u.s();!(o=u.n()).done;)s=o.value,void 0!==(c=this.prepareRunCreateOrUpdateInputs(s)).id&&void 0!==c.attachments&&(a[c.id]=c.attachments),delete c.attachments,i.push(c)}catch(p){u.e(p)}finally{u.f()}l=[],d=G(null!==r&&void 0!==r?r:[]);try{for(d.s();!(f=d.n()).done;)h=f.value,l.push(this.prepareRunCreateOrUpdateInputs(h))}catch(p){d.e(p)}finally{d.f()}if(void 0===i.find((function(e){return void 0===e.trace_id||void 0===e.dotted_order}))){e.next=13;break}throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');case 13:if(void 0===l.find((function(e){return void 0===e.trace_id||void 0===e.dotted_order}))){e.next=16;break}throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');case 16:if(i.length>0&&l.length>0){v=i.reduce((function(e,t){return t.id?(e[t.id]=t,e):e}),{}),m=[],y=G(l);try{for(y.s();!(g=y.n()).done;)void 0!==(b=g.value).id&&v[b.id]?v[b.id]=q(q({},v[b.id]),b):m.push(b)}catch(p){y.e(p)}finally{y.f()}i=Object.values(v),l=m}if(0!==i.length||0!==l.length){e.next=19;break}return e.abrupt("return");case 19:_=[],k=[],x=0,E=[["post",i],["patch",l]];case 22:if(!(x<E.length)){e.next=74;break}A=w(E[x],2),C=A[0],D=A[1],S=G(D),e.prev=25,S.s();case 27:if((O=S.n()).done){e.next=63;break}F=O.value,P=F.inputs,T=F.outputs,j=F.events,F.attachments,I=Sn(F,wc),N={inputs:P,outputs:T,events:j},R=gc(I),k.push({name:"".concat(C,".").concat(I.id),payload:new Blob([R],{type:"application/json; length=".concat(R.length)})}),B=0,L=Object.entries(N);case 34:if(!(B<L.length)){e.next=43;break}if(M=w(L[B],2),U=M[0],void 0!==(z=M[1])){e.next=38;break}return e.abrupt("continue",40);case 38:H=gc(z),k.push({name:"".concat(C,".").concat(I.id,".").concat(U),payload:new Blob([H],{type:"application/json; length=".concat(H.length)})});case 40:B++,e.next=34;break;case 43:if(void 0===I.id){e.next=60;break}if(!(Z=a[I.id])){e.next=60;break}delete a[I.id],W=0,V=Object.entries(Z);case 48:if(!(W<V.length)){e.next=60;break}if($=w(V[W],2),J=$[0],K=$[1],Q=void 0,X=void 0,Array.isArray(K)?(Y=w(K,2),Q=Y[0],X=Y[1]):(Q=K.mimeType,X=K.data),!J.includes(".")){e.next=56;break}return console.warn("Skipping attachment '".concat(J,"' for run ").concat(I.id,": Invalid attachment name. ")+"Attachment names must not contain periods ('.'). Please rename the attachment and try again."),e.abrupt("continue",57);case 56:k.push({name:"attachment.".concat(I.id,".").concat(J),payload:new Blob([X],{type:"".concat(Q,"; length=").concat(X.byteLength)})});case 57:W++,e.next=48;break;case 60:_.push("trace=".concat(I.trace_id,",id=").concat(I.id));case 61:e.next=27;break;case 63:e.next=68;break;case 65:e.prev=65,e.t0=e.catch(25),S.e(e.t0);case 68:return e.prev=68,S.f(),e.finish(68);case 71:x++,e.next=22;break;case 74:return e.next=76,this._sendMultipartRequest(k,_.join("; "));case 76:case"end":return e.stop()}}),e,this,[[25,65,68,71]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_sendMultipartRequest",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u,o,s,c,l;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r="----LangSmithFormBoundary"+Math.random().toString(36).slice(2),a=[],i=G(t);try{for(i.s();!(u=i.n()).done;)o=u.value,a.push(new Blob(["--".concat(r,"\r\n")])),a.push(new Blob(['Content-Disposition: form-data; name="'.concat(o.name,'"\r\n'),"Content-Type: ".concat(o.payload.type,"\r\n\r\n")])),a.push(o.payload),a.push(new Blob(["\r\n"]))}catch(d){i.e(d)}finally{i.f()}return a.push(new Blob(["--".concat(r,"--\r\n")])),s=new Blob(a),e.next=9,s.arrayBuffer();case 9:return c=e.sent,e.next=12,this.batchIngestCaller.call(Ks(),"".concat(this.apiUrl,"/runs/multipart"),q({method:"POST",headers:q(q({},this.headers),{},{"Content-Type":"multipart/form-data; boundary=".concat(r)}),body:c,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 12:return l=e.sent,e.next=15,cc(l,"ingest multipart runs",!0);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),console.warn("".concat(e.t0.message.trim(),"\n\nContext: ").concat(n));case 20:case"end":return e.stop()}}),e,this,[[0,17]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateRun",value:function(){var e=b(p().mark((function e(t,n){var r,a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ac(t),n.inputs&&(n.inputs=this.processInputs(n.inputs)),n.outputs&&(n.outputs=this.processOutputs(n.outputs)),r=q(q({},n),{},{id:t}),this._filterForSampling([r],!0).length){e.next=6;break}return e.abrupt("return");case 6:if(!this.autoBatchTracing||void 0===r.trace_id||void 0===r.dotted_order){e.next=15;break}if(void 0===n.end_time||void 0!==r.parent_run_id||!this.blockOnRootRunFinalization||this.manualFlushMode){e.next=13;break}return e.next=10,this.processRunOperation({action:"update",item:r}).catch(console.error);case 10:return e.abrupt("return");case 13:this.processRunOperation({action:"update",item:r}).catch(console.error);case 14:return e.abrupt("return");case 15:return a=q(q({},this.headers),{},{"Content-Type":"application/json"}),e.next=18,this.caller.call(Ks(),"".concat(this.apiUrl,"/runs/").concat(t),q({method:"PATCH",headers:a,body:gc(n),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 18:return i=e.sent,e.next=21,cc(i,"update run",!0);case 21:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"readRun",value:function(){var e=b(p().mark((function e(t){var n,r,a=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(a.length>1&&void 0!==a[1]?a[1]:{loadChildRuns:!1}).loadChildRuns,ac(t),e.next=4,this._get("/runs/".concat(t));case 4:if(r=e.sent,!n||!r.child_run_ids){e.next=9;break}return e.next=8,this._loadChildRuns(r);case 8:r=e.sent;case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getRunUrl",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.runId,r=t.run,a=t.projectOpts,void 0===r){e.next=26;break}if(!r.session_id){e.next=6;break}i=r.session_id,e.next=20;break;case 6:if(null===a||void 0===a||!a.projectName){e.next=12;break}return e.next=9,this.readProject({projectName:null===a||void 0===a?void 0:a.projectName});case 9:i=e.sent.id,e.next=20;break;case 12:if(null===a||void 0===a||!a.projectId){e.next=16;break}i=null===a||void 0===a?void 0:a.projectId,e.next=20;break;case 16:return e.next=18,this.readProject({projectName:Wc("PROJECT")||"default"});case 18:u=e.sent,i=u.id;case 20:return e.next=22,this._getTenantId();case 22:return o=e.sent,e.abrupt("return","".concat(this.getHostUrl(),"/o/").concat(o,"/projects/p/").concat(i,"/r/").concat(r.id,"?poll=true"));case 26:if(void 0===n){e.next=36;break}return e.next=29,this.readRun(n);case 29:if((s=e.sent).app_path){e.next=32;break}throw new Error("Run ".concat(n," has no app_path"));case 32:return c=this.getHostUrl(),e.abrupt("return","".concat(c).concat(s.app_path));case 36:throw new Error("Must provide either runId or run");case 37:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_loadChildRuns",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Dc(this.listRuns({id:t.child_run_ids}));case 2:n=e.sent,r={},a={},n.sort((function(e,t){var n,r;return(null!==(n=null===e||void 0===e?void 0:e.dotted_order)&&void 0!==n?n:"").localeCompare(null!==(r=null===t||void 0===t?void 0:t.dotted_order)&&void 0!==r?r:"")})),i=G(n),e.prev=7,i.s();case 9:if((u=i.n()).done){e.next=18;break}if(null!==(o=u.value).parent_run_id&&void 0!==o.parent_run_id){e.next=13;break}throw new Error("Child run ".concat(o.id," has no parent"));case 13:o.parent_run_id in r||(r[o.parent_run_id]=[]),r[o.parent_run_id].push(o),a[o.id]=o;case 16:e.next=9;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(7),i.e(e.t0);case 23:return e.prev=23,i.f(),e.finish(23);case 26:for(s in t.child_runs=r[t.id]||[],r)s!==t.id&&(a[s].child_runs=r[s]);return e.abrupt("return",t);case 29:case"end":return e.stop()}}),e,this,[[7,20,23,26]])})));return function(t){return e.apply(this,arguments)}}()},{key:"listRuns",value:function(e){var t=this;return An(p().mark((function n(){var r,a,i,u,o,s,c,l,d,f,h,v,m,g,b,_,k,w,x,E,A,C,D,S,O,F,P,T,j,I,N;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.projectId,a=e.projectName,i=e.parentRunId,u=e.traceId,o=e.referenceExampleId,s=e.startTime,c=e.executionOrder,l=e.isRoot,d=e.runType,f=e.error,h=e.id,v=e.query,m=e.filter,g=e.traceFilter,b=e.treeFilter,_=e.limit,k=e.select,w=[],r&&(w=Array.isArray(r)?r:[r]),!a){n.next=9;break}return E=Array.isArray(a)?a:[a],n.next=7,xn(Promise.all(E.map((function(e){return t.readProject({projectName:e}).then((function(e){return e.id}))}))));case 7:A=n.sent,(x=w).push.apply(x,y(A));case 9:C=["app_path","child_run_ids","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],D={session:w.length?w:null,run_type:d,reference_example:o,query:v,filter:m,trace_filter:g,tree_filter:b,execution_order:c,parent_run:i,start_time:s?s.toISOString():null,error:f,id:h,limit:_,trace:u,select:k||C,is_root:l},S=0,O=!1,F=!1,n.prev=14,T=Cn(t._getCursorPaginatedList("/runs/query",D));case 16:return n.next=18,xn(T.next());case 18:if(!(O=!(j=n.sent).done)){n.next=35;break}if(I=j.value,!_){n.next=31;break}if(!(S>=_)){n.next=23;break}return n.abrupt("break",35);case 23:if(!(I.length+S>_)){n.next=27;break}return N=I.slice(0,_-S),n.delegateYield(Os(Cn(N)),"t0",26);case 26:return n.abrupt("break",35);case 27:return S+=I.length,n.delegateYield(Os(Cn(I)),"t1",29);case 29:n.next=32;break;case 31:return n.delegateYield(Os(Cn(I)),"t2",32);case 32:O=!1,n.next=16;break;case 35:n.next=41;break;case 37:n.prev=37,n.t3=n.catch(14),F=!0,P=n.t3;case 41:if(n.prev=41,n.prev=42,!O||null==T.return){n.next=46;break}return n.next=46,xn(T.return());case 46:if(n.prev=46,!F){n.next=49;break}throw P;case 49:return n.finish(46);case 50:return n.finish(41);case 51:case"end":return n.stop()}}),n,null,[[14,37,41,51],[42,,46,50]])})))()}},{key:"getRunStats",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l,d,f,h,v,m,g,b,_,k,x,E,A,C=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,r=t.trace,a=t.parentRun,i=t.runType,u=t.projectNames,o=t.projectIds,s=t.referenceExampleIds,c=t.startTime,l=t.endTime,d=t.error,f=t.query,h=t.filter,v=t.traceFilter,m=t.treeFilter,g=t.isRoot,b=t.dataSourceType,_=o||[],!u){e.next=11;break}return e.t0=[],e.t1=y(o||[]),e.t2=y,e.next=8,Promise.all(u.map((function(e){return C.readProject({projectName:e}).then((function(e){return e.id}))})));case 8:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),_=e.t0.concat.call(e.t0,e.t1,e.t4);case 11:return k={id:n,trace:r,parent_run:a,run_type:i,session:_,reference_example:s,start_time:c,end_time:l,error:d,query:f,filter:h,trace_filter:v,tree_filter:m,is_root:g,data_source_type:b},x=Object.fromEntries(Object.entries(k).filter((function(e){var t=w(e,2);t[0];return void 0!==t[1]}))),e.next=15,this.caller.call(Ks(),"".concat(this.apiUrl,"/runs/stats"),q({method:"POST",headers:this.headers,body:JSON.stringify(x),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 15:return E=e.sent,e.next=18,E.json();case 18:return A=e.sent,e.abrupt("return",A);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"shareRun",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(u.length>1&&void 0!==u[1]?u[1]:{}).shareId,r={run_id:t,share_token:n||Gs()},ac(t),e.next=5,this.caller.call(Ks(),"".concat(this.apiUrl,"/runs/").concat(t,"/share"),q({method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 5:return a=e.sent,e.next=8,a.json();case 8:if(null!==(i=e.sent)&&"share_token"in i){e.next=11;break}throw new Error("Invalid response from server");case 11:return e.abrupt("return","".concat(this.getHostUrl(),"/public/").concat(i.share_token,"/r"));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"unshareRun",value:function(){var e=b(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ac(t),e.next=3,this.caller.call(Ks(),"".concat(this.apiUrl,"/runs/").concat(t,"/share"),q({method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:return n=e.sent,e.next=6,cc(n,"unshare run",!0);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readRunSharedLink",value:function(){var e=b(p().mark((function e(t){var n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ac(t),e.next=3,this.caller.call(Ks(),"".concat(this.apiUrl,"/runs/").concat(t,"/share"),q({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:return n=e.sent,e.next=6,n.json();case 6:if(null!==(r=e.sent)&&"share_token"in r){e.next=9;break}return e.abrupt("return",void 0);case 9:return e.abrupt("return","".concat(this.getHostUrl(),"/public/").concat(r.share_token,"/r"));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listSharedRuns",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(c.length>1&&void 0!==c[1]?c[1]:{}).runIds,r=new URLSearchParams({share_token:t}),void 0!==n){a=G(n);try{for(a.s();!(i=a.n()).done;)u=i.value,r.append("id",u)}catch(l){a.e(l)}finally{a.f()}}return ac(t),e.next=6,this.caller.call(Ks(),"".concat(this.apiUrl,"/public/").concat(t,"/runs").concat(r),q({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 6:return o=e.sent,e.next=9,o.json();case 9:return s=e.sent,e.abrupt("return",s);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readDatasetSharedSchema",value:function(){var e=b(p().mark((function e(t,n){var r,a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t||n){e.next=2;break}throw new Error("Either datasetId or datasetName must be given");case 2:if(t){e.next=7;break}return e.next=5,this.readDataset({datasetName:n});case 5:r=e.sent,t=r.id;case 7:return ac(t),e.next=10,this.caller.call(Ks(),"".concat(this.apiUrl,"/datasets/").concat(t,"/share"),q({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 10:return a=e.sent,e.next=13,a.json();case 13:return(i=e.sent).url="".concat(this.getHostUrl(),"/public/").concat(i.share_token,"/d"),e.abrupt("return",i);case 16:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"shareDataset",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t||n){e.next=2;break}throw new Error("Either datasetId or datasetName must be given");case 2:if(t){e.next=7;break}return e.next=5,this.readDataset({datasetName:n});case 5:r=e.sent,t=r.id;case 7:return a={dataset_id:t},ac(t),e.next=11,this.caller.call(Ks(),"".concat(this.apiUrl,"/datasets/").concat(t,"/share"),q({method:"PUT",headers:this.headers,body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 11:return i=e.sent,e.next=14,i.json();case 14:return(u=e.sent).url="".concat(this.getHostUrl(),"/public/").concat(u.share_token,"/d"),e.abrupt("return",u);case 17:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"unshareDataset",value:function(){var e=b(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ac(t),e.next=3,this.caller.call(Ks(),"".concat(this.apiUrl,"/datasets/").concat(t,"/share"),q({method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:return n=e.sent,e.next=6,cc(n,"unshare dataset",!0);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readSharedDataset",value:function(){var e=b(p().mark((function e(t){var n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ac(t),e.next=3,this.caller.call(Ks(),"".concat(this.apiUrl,"/public/").concat(t,"/datasets"),q({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listSharedExamples",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u,o=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={},null!==n&&void 0!==n&&n.exampleIds&&(r.id=n.exampleIds),a=new URLSearchParams,Object.entries(r).forEach((function(e){var t=w(e,2),n=t[0],r=t[1];Array.isArray(r)?r.forEach((function(e){return a.append(n,e)})):a.append(n,r)})),e.next=6,this.caller.call(Ks(),"".concat(this.apiUrl,"/public/").concat(t,"/examples?").concat(a.toString()),q({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 6:return i=e.sent,e.next=9,i.json();case 9:if(u=e.sent,i.ok){e.next=14;break}if(!("detail"in u)){e.next=13;break}throw new Error("Failed to list shared examples.\nStatus: ".concat(i.status,"\nMessage: ").concat(u.detail.join("\n")));case 13:throw new Error("Failed to list shared examples: ".concat(i.status," ").concat(i.statusText));case 14:return e.abrupt("return",u.map((function(e){return q(q({},e),{},{_hostUrl:o.getHostUrl()})})));case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createProject",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l,d,f,h,v,m,y,g,b;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.projectName,r=t.description,a=void 0===r?null:r,i=t.metadata,u=void 0===i?null:i,o=t.upsert,s=void 0!==o&&o,c=t.projectExtra,l=void 0===c?null:c,d=t.referenceDatasetId,f=void 0===d?null:d,h=s?"?upsert=true":"",v="".concat(this.apiUrl,"/sessions").concat(h),m=l||{},u&&(m.metadata=u),y={name:n,extra:m,description:a},null!==f&&(y.reference_dataset_id=f),e.next=9,this.caller.call(Ks(),v,q({method:"POST",headers:q(q({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(y),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 9:return g=e.sent,e.next=12,cc(g,"create project");case 12:return e.next=14,g.json();case 14:return b=e.sent,e.abrupt("return",b);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateProject",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u,o,s,c,l,d,f,h,v,m,y,g;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.name,a=void 0===r?null:r,i=n.description,u=void 0===i?null:i,o=n.metadata,s=void 0===o?null:o,c=n.projectExtra,l=void 0===c?null:c,d=n.endTime,f=void 0===d?null:d,h="".concat(this.apiUrl,"/sessions/").concat(t),v=l,s&&(v=q(q({},v||{}),{},{metadata:s})),m={name:a,extra:v,description:u,end_time:f?new Date(f).toISOString():null},e.next=7,this.caller.call(Ks(),h,q({method:"PATCH",headers:q(q({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(m),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 7:return y=e.sent,e.next=10,cc(y,"update project");case 10:return e.next=12,y.json();case 12:return g=e.sent,e.abrupt("return",g);case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"hasProject",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.projectId,r=t.projectName,a="/sessions",i=new URLSearchParams,void 0===n||void 0===r){e.next=7;break}throw new Error("Must provide either projectName or projectId, not both");case 7:if(void 0===n){e.next=12;break}ac(n),a+="/".concat(n),e.next=17;break;case 12:if(void 0===r){e.next=16;break}i.append("name",r),e.next=17;break;case 16:throw new Error("Must provide projectName or projectId");case 17:return e.next=19,this.caller.call(Ks(),"".concat(this.apiUrl).concat(a,"?").concat(i),q({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 19:return u=e.sent,e.prev=20,e.next=23,u.json();case 23:if(o=e.sent,u.ok){e.next=26;break}return e.abrupt("return",!1);case 26:if(!Array.isArray(o)){e.next=28;break}return e.abrupt("return",o.length>0);case 28:return e.abrupt("return",!0);case 31:return e.prev=31,e.t0=e.catch(20),e.abrupt("return",!1);case 34:case"end":return e.stop()}}),e,this,[[20,31]])})));return function(t){return e.apply(this,arguments)}}()},{key:"readProject",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.projectId,r=t.projectName,a=t.includeStats,i="/sessions",u=new URLSearchParams,void 0===n||void 0===r){e.next=7;break}throw new Error("Must provide either projectName or projectId, not both");case 7:if(void 0===n){e.next=12;break}ac(n),i+="/".concat(n),e.next=17;break;case 12:if(void 0===r){e.next=16;break}u.append("name",r),e.next=17;break;case 16:throw new Error("Must provide projectName or projectId");case 17:return void 0!==a&&u.append("include_stats",a.toString()),e.next=20,this._get(i,u);case 20:if(o=e.sent,!Array.isArray(o)){e.next=27;break}if(0!==o.length){e.next=24;break}throw new Error("Project[id=".concat(n,", name=").concat(r,"] not found"));case 24:s=o[0],e.next=28;break;case 27:s=o;case 28:return e.abrupt("return",s);case 29:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getProjectUrl",value:function(){var e=b(p().mark((function e(t){var n,r,a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.projectId,r=t.projectName,void 0!==n||void 0!==r){e.next=3;break}throw new Error("Must provide either projectName or projectId");case 3:return e.next=5,this.readProject({projectId:n,projectName:r});case 5:return a=e.sent,e.next=8,this._getTenantId();case 8:return i=e.sent,e.abrupt("return","".concat(this.getHostUrl(),"/o/").concat(i,"/projects/p/").concat(a.id));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getDatasetUrl",value:function(){var e=b(p().mark((function e(t){var n,r,a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.datasetId,r=t.datasetName,void 0!==n||void 0!==r){e.next=3;break}throw new Error("Must provide either datasetName or datasetId");case 3:return e.next=5,this.readDataset({datasetId:n,datasetName:r});case 5:return a=e.sent,e.next=8,this._getTenantId();case 8:return i=e.sent,e.abrupt("return","".concat(this.getHostUrl(),"/o/").concat(i,"/datasets/").concat(a.id));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getTenantId",value:function(){var e=b(p().mark((function e(){var t,n,r,a,i,u,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===this._tenantId){e.next=2;break}return e.abrupt("return",this._tenantId);case 2:t=new URLSearchParams({limit:"1"}),n=!1,r=!1,e.prev=5,i=Cn(this._getPaginated("/sessions",t));case 7:return e.next=9,i.next();case 9:if(!(n=!(u=e.sent).done)){e.next=16;break}return o=u.value,this._tenantId=o[0].tenant_id,e.abrupt("return",o[0].tenant_id);case 13:n=!1,e.next=7;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(5),r=!0,a=e.t0;case 22:if(e.prev=22,e.prev=23,!n||null==i.return){e.next=27;break}return e.next=27,i.return();case 27:if(e.prev=27,!r){e.next=30;break}throw a;case 30:return e.finish(27);case 31:return e.finish(22);case 32:throw new Error("No projects found to resolve tenant.");case 33:case"end":return e.stop()}}),e,this,[[5,18,22,32],[23,,27,31]])})));return function(){return e.apply(this,arguments)}}()},{key:"listProjects",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.projectIds,r=t.name,a=t.nameContains,i=t.referenceDatasetId,u=t.referenceDatasetName,o=t.referenceFree,s=t.metadata;return An(p().mark((function t(){var c,l,d,f,h,v,m,y,g,b,_;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=new URLSearchParams,void 0!==n){l=G(n);try{for(l.s();!(d=l.n()).done;)f=d.value,c.append("id",f)}catch(p){l.e(p)}finally{l.f()}}if(void 0!==r&&c.append("name",r),void 0!==a&&c.append("name_contains",a),void 0===i){t.next=8;break}c.append("reference_dataset",i),t.next=13;break;case 8:if(void 0===u){t.next=13;break}return t.next=11,xn(e.readDataset({datasetName:u}));case 11:h=t.sent,c.append("reference_dataset",h.id);case 13:void 0!==o&&c.append("reference_free",o.toString()),void 0!==s&&c.append("metadata",JSON.stringify(s)),v=!1,m=!1,t.prev=17,g=Cn(e._getPaginated("/sessions",c));case 19:return t.next=21,xn(g.next());case 21:if(!(v=!(b=t.sent).done)){t.next=27;break}return _=b.value,t.delegateYield(Os(Cn(_)),"t0",24);case 24:v=!1,t.next=19;break;case 27:t.next=33;break;case 29:t.prev=29,t.t1=t.catch(17),m=!0,y=t.t1;case 33:if(t.prev=33,t.prev=34,!v||null==g.return){t.next=38;break}return t.next=38,xn(g.return());case 38:if(t.prev=38,!m){t.next=41;break}throw y;case 41:return t.finish(38);case 42:return t.finish(33);case 43:case"end":return t.stop()}}),t,null,[[17,29,33,43],[34,,38,42]])})))()}},{key:"deleteProject",value:function(){var e=b(p().mark((function e(t){var n,r,a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.projectId,r=t.projectName,void 0!==n||void 0!==r){e.next=5;break}throw new Error("Must provide projectName or projectId");case 5:if(void 0===n||void 0===r){e.next=9;break}throw new Error("Must provide either projectName or projectId, not both");case 9:if(void 0!==n){e.next=15;break}return e.next=12,this.readProject({projectName:r});case 12:a=e.sent.id,e.next=16;break;case 15:a=n;case 16:return ac(a),e.next=19,this.caller.call(Ks(),"".concat(this.apiUrl,"/sessions/").concat(a),q({method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 19:return i=e.sent,e.next=22,cc(i,"delete session ".concat(a," (").concat(r,")"),!0);case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"uploadCsv",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l,d,f;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.csvFile,r=t.fileName,a=t.inputKeys,i=t.outputKeys,u=t.description,o=t.dataType,s=t.name,c="".concat(this.apiUrl,"/datasets/upload"),(l=new FormData).append("file",n,r),a.forEach((function(e){l.append("input_keys",e)})),i.forEach((function(e){l.append("output_keys",e)})),u&&l.append("description",u),o&&l.append("data_type",o),s&&l.append("name",s),e.next=11,this.caller.call(Ks(),c,q({method:"POST",headers:this.headers,body:l,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 11:return d=e.sent,e.next=14,cc(d,"upload CSV");case 14:return e.next=16,d.json();case 16:return f=e.sent,e.abrupt("return",f);case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createDataset",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l,d=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n=d.length>1&&void 0!==d[1]?d[1]:{}).description,a=n.dataType,i=n.inputsSchema,u=n.outputsSchema,o=n.metadata,s={name:t,description:r,extra:o?{metadata:o}:void 0},a&&(s.data_type=a),i&&(s.inputs_schema_definition=i),u&&(s.outputs_schema_definition=u),e.next=7,this.caller.call(Ks(),"".concat(this.apiUrl,"/datasets"),q({method:"POST",headers:q(q({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 7:return c=e.sent,e.next=10,cc(c,"create dataset");case 10:return e.next=12,c.json();case 12:return l=e.sent,e.abrupt("return",l);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readDataset",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.datasetId,r=t.datasetName,a="/datasets",i=new URLSearchParams({limit:"1"}),void 0===n||void 0===r){e.next=7;break}throw new Error("Must provide either datasetName or datasetId, not both");case 7:if(void 0===n){e.next=12;break}ac(n),a+="/".concat(n),e.next=17;break;case 12:if(void 0===r){e.next=16;break}i.append("name",r),e.next=17;break;case 16:throw new Error("Must provide datasetName or datasetId");case 17:return e.next=19,this._get(a,i);case 19:if(u=e.sent,!Array.isArray(u)){e.next=26;break}if(0!==u.length){e.next=23;break}throw new Error("Dataset[id=".concat(n,", name=").concat(r,"] not found"));case 23:o=u[0],e.next=27;break;case 26:o=u;case 27:return e.abrupt("return",o);case 28:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"hasDataset",value:function(){var e=b(p().mark((function e(t){var n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.datasetId,r=t.datasetName,e.prev=1,e.next=4,this.readDataset({datasetId:n,datasetName:r});case 4:return e.abrupt("return",!0);case 7:if(e.prev=7,e.t0=e.catch(1),!(e.t0 instanceof Error&&e.t0.message.toLocaleLowerCase().includes("not found"))){e.next=11;break}return e.abrupt("return",!1);case 11:throw e.t0;case 12:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"diffDatasetVersions",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.datasetId,r=t.datasetName,a=t.fromVersion,i=t.toVersion,void 0!==(u=n)||void 0!==r){e.next=6;break}throw new Error("Must provide either datasetName or datasetId");case 6:if(void 0===u||void 0===r){e.next=10;break}throw new Error("Must provide either datasetName or datasetId, not both");case 10:if(void 0!==u){e.next=15;break}return e.next=13,this.readDataset({datasetName:r});case 13:o=e.sent,u=o.id;case 15:return s=new URLSearchParams({from_version:"string"===typeof a?a:a.toISOString(),to_version:"string"===typeof i?i:i.toISOString()}),e.next=18,this._get("/datasets/".concat(u,"/versions/diff"),s);case 18:return c=e.sent,e.abrupt("return",c);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readDatasetOpenaiFinetuning",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.datasetId,r=t.datasetName,a="/datasets",void 0===n){e.next=5;break}e.next=12;break;case 5:if(void 0===r){e.next=11;break}return e.next=8,this.readDataset({datasetName:r});case 8:n=e.sent.id,e.next=12;break;case 11:throw new Error("Must provide either datasetName or datasetId");case 12:return e.next=14,this._getResponse("".concat(a,"/").concat(n,"/openai_ft"));case 14:return i=e.sent,e.next=17,i.text();case 17:return u=e.sent,o=u.trim().split("\n").map((function(e){return JSON.parse(e)})),e.abrupt("return",o);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listDatasets",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.limit,r=void 0===n?100:n,a=t.offset,i=void 0===a?0:a,u=t.datasetIds,o=t.datasetName,s=t.datasetNameContains,c=t.metadata;return An(p().mark((function t(){var n,a,l,d,f,h,v,m,y,g;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("/datasets",n=new URLSearchParams({limit:r.toString(),offset:i.toString()}),void 0!==u){a=G(u);try{for(a.s();!(l=a.n()).done;)d=l.value,n.append("id",d)}catch(p){a.e(p)}finally{a.f()}}void 0!==o&&n.append("name",o),void 0!==s&&n.append("name_contains",s),void 0!==c&&n.append("metadata",JSON.stringify(c)),f=!1,h=!1,t.prev=8,m=Cn(e._getPaginated("/datasets",n));case 10:return t.next=12,xn(m.next());case 12:if(!(f=!(y=t.sent).done)){t.next=18;break}return g=y.value,t.delegateYield(Os(Cn(g)),"t0",15);case 15:f=!1,t.next=10;break;case 18:t.next=24;break;case 20:t.prev=20,t.t1=t.catch(8),h=!0,v=t.t1;case 24:if(t.prev=24,t.prev=25,!f||null==m.return){t.next=29;break}return t.next=29,xn(m.return());case 29:if(t.prev=29,!h){t.next=32;break}throw v;case 32:return t.finish(29);case 33:return t.finish(24);case 34:case"end":return t.stop()}}),t,null,[[8,20,24,34],[25,,29,33]])})))()}},{key:"updateDataset",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.datasetId,r=t.datasetName,a=Sn(t,xc),n||r){e.next=3;break}throw new Error("Must provide either datasetName or datasetId");case 3:if(null===n||void 0===n){e.next=7;break}e.t0=n,e.next=10;break;case 7:return e.next=9,this.readDataset({datasetName:r});case 9:e.t0=e.sent.id;case 10:return ac(i=e.t0),e.next=14,this.caller.call(Ks(),"".concat(this.apiUrl,"/datasets/").concat(i),q({method:"PATCH",headers:q(q({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 14:return u=e.sent,e.next=17,cc(u,"update dataset");case 17:return e.next=19,u.json();case 19:return e.abrupt("return",e.sent);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateDatasetTag",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.datasetId,r=t.datasetName,a=t.asOf,i=t.tag,n||r){e.next=3;break}throw new Error("Must provide either datasetName or datasetId");case 3:if(null===n||void 0===n){e.next=7;break}e.t0=n,e.next=10;break;case 7:return e.next=9,this.readDataset({datasetName:r});case 9:e.t0=e.sent.id;case 10:return ac(u=e.t0),e.next=14,this.caller.call(Ks(),"".concat(this.apiUrl,"/datasets/").concat(u,"/tags"),q({method:"PUT",headers:q(q({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify({as_of:"string"===typeof a?a:a.toISOString(),tag:i}),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 14:return o=e.sent,e.next=17,cc(o,"update dataset tags");case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteDataset",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.datasetId,r=t.datasetName,a="/datasets",i=n,void 0===n||void 0===r){e.next=7;break}throw new Error("Must provide either datasetName or datasetId, not both");case 7:if(void 0===r){e.next=12;break}return e.next=10,this.readDataset({datasetName:r});case 10:u=e.sent,i=u.id;case 12:if(void 0===i){e.next=17;break}ac(i),a+="/".concat(i),e.next=18;break;case 17:throw new Error("Must provide datasetName or datasetId");case 18:return e.next=20,this.caller.call(Ks(),this.apiUrl+a,q({method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 20:return o=e.sent,e.next=23,cc(o,"delete ".concat(a));case 23:return e.next=25,o.json();case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"indexDataset",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.datasetId,r=t.datasetName,a=t.tag,(i=n)||r){e.next=6;break}throw new Error("Must provide either datasetName or datasetId");case 6:if(!i||!r){e.next=10;break}throw new Error("Must provide either datasetName or datasetId, not both");case 10:if(i){e.next=15;break}return e.next=13,this.readDataset({datasetName:r});case 13:u=e.sent,i=u.id;case 15:return ac(i),o={tag:a},e.next=19,this.caller.call(Ks(),"".concat(this.apiUrl,"/datasets/").concat(i,"/index"),q({method:"POST",headers:q(q({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 19:return s=e.sent,e.next=22,cc(s,"index dataset");case 22:return e.next=24,s.json();case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"similarExamples",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(s.length>3&&void 0!==s[3]?s[3]:{}).filter,i={limit:r,inputs:t},void 0!==a&&(i.filter=a),ac(n),e.next=6,this.caller.call(Ks(),"".concat(this.apiUrl,"/datasets/").concat(n,"/search"),q({method:"POST",headers:q(q({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 6:return u=e.sent,e.next=9,cc(u,"fetch similar examples");case 9:return e.next=11,u.json();case 11:return o=e.sent,e.abrupt("return",o.examples);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"createExample",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c,l,d,f;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ic(t)){e.next=3;break}if(void 0===n&&void 0===r){e.next=3;break}throw new Error("Cannot provide outputs or options when using ExampleCreate object");case 3:if(u=n?null===r||void 0===r?void 0:r.datasetId:t.dataset_id,o=n?null===r||void 0===r?void 0:r.datasetName:t.dataset_name,void 0!==u||void 0!==o){e.next=9;break}throw new Error("Must provide either datasetName or datasetId");case 9:if(void 0===u||void 0===o){e.next=13;break}throw new Error("Must provide either datasetName or datasetId, not both");case 13:if(void 0!==u){e.next=18;break}return e.next=16,this.readDataset({datasetName:o});case 16:s=e.sent,u=s.id;case 18:return c=(n?null===r||void 0===r?void 0:r.createdAt:t.created_at)||new Date,l=Ic(t)?t:{inputs:t,outputs:n,created_at:null===c||void 0===c?void 0:c.toISOString(),id:null===r||void 0===r?void 0:r.exampleId,metadata:null===r||void 0===r?void 0:r.metadata,split:null===r||void 0===r?void 0:r.split,source_run_id:null===r||void 0===r?void 0:r.sourceRunId,use_source_run_io:null===r||void 0===r?void 0:r.useSourceRunIO,use_source_run_attachments:null===r||void 0===r?void 0:r.useSourceRunAttachments,attachments:null===r||void 0===r?void 0:r.attachments},e.next=22,this._uploadExamplesMultipart(u,[l]);case 22:return d=e.sent,e.next=25,this.readExample(null!==(a=null===(i=d.example_ids)||void 0===i?void 0:i[0])&&void 0!==a?a:Gs());case 25:return f=e.sent,e.abrupt("return",f);case 27:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"createExamples",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l,d,f,h,v,m,y,g,b,_,k,w,x,E,A,C=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Array.isArray(t)){e.next=26;break}if(0!==t.length){e.next=3;break}return e.abrupt("return",[]);case 3:if(r=(n=t)[0].dataset_id,a=n[0].dataset_name,void 0!==r||void 0!==a){e.next=10;break}throw new Error("Must provide either datasetName or datasetId");case 10:if(void 0===r||void 0===a){e.next=14;break}throw new Error("Must provide either datasetName or datasetId, not both");case 14:if(void 0!==r){e.next=19;break}return e.next=17,this.readDataset({datasetName:a});case 17:i=e.sent,r=i.id;case 19:return e.next=21,this._uploadExamplesMultipart(r,n);case 21:return u=e.sent,e.next=24,Promise.all(u.example_ids.map((function(e){return C.readExample(e)})));case 24:return o=e.sent,e.abrupt("return",o);case 26:if(s=t.inputs,c=t.outputs,l=t.metadata,d=t.splits,f=t.sourceRunIds,h=t.useSourceRunIOs,v=t.useSourceRunAttachments,m=t.attachments,y=t.exampleIds,g=t.datasetId,b=t.datasetName,void 0!==s){e.next=29;break}throw new Error("Must provide inputs when using legacy parameters");case 29:if(k=b,void 0!==(_=g)||void 0!==k){e.next=35;break}throw new Error("Must provide either datasetName or datasetId");case 35:if(void 0===_||void 0===k){e.next=39;break}throw new Error("Must provide either datasetName or datasetId, not both");case 39:if(void 0!==_){e.next=44;break}return e.next=42,this.readDataset({datasetName:k});case 42:w=e.sent,_=w.id;case 44:return x=s.map((function(e,t){return{dataset_id:_,inputs:e,outputs:null===c||void 0===c?void 0:c[t],metadata:null===l||void 0===l?void 0:l[t],split:null===d||void 0===d?void 0:d[t],id:null===y||void 0===y?void 0:y[t],attachments:null===m||void 0===m?void 0:m[t],source_run_id:null===f||void 0===f?void 0:f[t],use_source_run_io:null===h||void 0===h?void 0:h[t],use_source_run_attachments:null===v||void 0===v?void 0:v[t]}})),e.next=47,this._uploadExamplesMultipart(_,x);case 47:return E=e.sent,e.next=50,Promise.all(E.example_ids.map((function(e){return C.readExample(e)})));case 50:return A=e.sent,e.abrupt("return",A);case 52:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createLLMExample",value:function(){var e=b(p().mark((function e(t,n,r){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.createExample({input:t},{output:n},r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"createChatExample",value:function(){var e=b(p().mark((function e(t,n,r){var a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.map((function(e){return ec(e)?tc(e):e})),i=ec(n)?tc(n):n,e.abrupt("return",this.createExample({input:a},{output:i},r));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"readExample",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ac(t),n="/examples/".concat(t),e.next=4,this._get(n);case 4:return r=e.sent,a=r.attachment_urls,i=Sn(r,Ec),u=i,a&&(u.attachments=Object.entries(a).reduce((function(e,t){var n=w(t,2),r=n[0],a=n[1];return e[r.slice(11)]={presigned_url:a.presigned_url,mime_type:a.mime_type},e}),{})),e.abrupt("return",u);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listExamples",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.datasetId,r=t.datasetName,a=t.exampleIds,i=t.asOf,u=t.splits,o=t.inlineS3Urls,s=t.metadata,c=t.limit,l=t.offset,d=t.filter,f=t.includeAttachments;return An(p().mark((function t(){var h,v,m,y,g,b,_,k,x,E,A,C,D,S,O,F,P,T,j,I,N,R,B,L,M;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===n||void 0===r){t.next=4;break}throw new Error("Must provide either datasetName or datasetId, not both");case 4:if(void 0===n){t.next=8;break}h=n,t.next=16;break;case 8:if(void 0===r){t.next=15;break}return t.next=11,xn(e.readDataset({datasetName:r}));case 11:v=t.sent,h=v.id,t.next=16;break;case 15:throw new Error("Must provide a datasetName or datasetId");case 16:if(m=new URLSearchParams({dataset:h}),(y=i?"string"===typeof i?i:null===i||void 0===i?void 0:i.toISOString():void 0)&&m.append("as_of",y),g=null===o||void 0===o||o,m.append("inline_s3_urls",g.toString()),void 0!==a){b=G(a);try{for(b.s();!(_=b.n()).done;)k=_.value,m.append("id",k)}catch(p){b.e(p)}finally{b.f()}}if(void 0!==u){x=G(u);try{for(x.s();!(E=x.n()).done;)A=E.value,m.append("splits",A)}catch(p){x.e(p)}finally{x.f()}}void 0!==s&&(C=JSON.stringify(s),m.append("metadata",C)),void 0!==c&&m.append("limit",c.toString()),void 0!==l&&m.append("offset",l.toString()),void 0!==d&&m.append("filter",d),!0===f&&["attachment_urls","outputs","metadata"].forEach((function(e){return m.append("select",e)})),D=0,S=!1,O=!1,t.prev=31,P=Cn(e._getPaginated("/examples",m));case 33:return t.next=35,xn(P.next());case 35:if(!(S=!(T=t.sent).done)){t.next=63;break}j=T.value,I=G(j),t.prev=38,I.s();case 40:if((N=I.n()).done){t.next=50;break}return R=N.value,B=R.attachment_urls,L=Sn(R,Ac),M=L,B&&(M.attachments=Object.entries(B).reduce((function(e,t){var n=w(t,2),r=n[0],a=n[1];return e[r.slice(11)]={presigned_url:a.presigned_url,mime_type:a.mime_type||void 0},e}),{})),t.next=47,M;case 47:D++;case 48:t.next=40;break;case 50:t.next=55;break;case 52:t.prev=52,t.t0=t.catch(38),I.e(t.t0);case 55:return t.prev=55,I.f(),t.finish(55);case 58:if(!(void 0!==c&&D>=c)){t.next=60;break}return t.abrupt("break",63);case 60:S=!1,t.next=33;break;case 63:t.next=69;break;case 65:t.prev=65,t.t1=t.catch(31),O=!0,F=t.t1;case 69:if(t.prev=69,t.prev=70,!S||null==P.return){t.next=74;break}return t.next=74,xn(P.return());case 74:if(t.prev=74,!O){t.next=77;break}throw F;case 77:return t.finish(74);case 78:return t.finish(69);case 79:case"end":return t.stop()}}),t,null,[[31,65,69,79],[38,52,55,58],[70,,74,78]])})))()}},{key:"deleteExample",value:function(){var e=b(p().mark((function e(t){var n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ac(t),n="/examples/".concat(t),e.next=4,this.caller.call(Ks(),this.apiUrl+n,q({method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 4:return r=e.sent,e.next=7,cc(r,"delete ".concat(n));case 7:return e.next=9,r.json();case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateExample",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ac(r=n?t:t.id),void 0===(a=n?q({id:r},n):t).dataset_id){e.next=7;break}i=a.dataset_id,e.next=11;break;case 7:return e.next=9,this.readExample(r);case 9:u=e.sent,i=u.dataset_id;case 11:return e.abrupt("return",this._updateExamplesMultipart(i,[a]));case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateExamples",value:function(){var e=b(p().mark((function e(t){var n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t[0].dataset_id){e.next=7;break}return e.next=3,this.readExample(t[0].id);case 3:r=e.sent,n=r.dataset_id,e.next=8;break;case 7:n=t[0].dataset_id;case 8:return e.abrupt("return",this._updateExamplesMultipart(n,t));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readDatasetVersion",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.datasetId,r=t.datasetName,a=t.asOf,i=t.tag,n){e.next=8;break}return e.next=4,this.readDataset({datasetName:r});case 4:o=e.sent,u=o.id,e.next=9;break;case 8:u=n;case 9:if(ac(u),!(a&&i||!a&&!i)){e.next=12;break}throw new Error("Exactly one of asOf and tag must be specified.");case 12:return s=new URLSearchParams,void 0!==a&&s.append("as_of","string"===typeof a?a:a.toISOString()),void 0!==i&&s.append("tag",i),e.next=17,this.caller.call(Ks(),"".concat(this.apiUrl,"/datasets/").concat(u,"/version?").concat(s.toString()),q({method:"GET",headers:q({},this.headers),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 17:return c=e.sent,e.next=20,cc(c,"read dataset version");case 20:return e.next=22,c.json();case 22:return e.abrupt("return",e.sent);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listDatasetSplits",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.datasetId,r=t.datasetName,a=t.asOf,void 0!==n||void 0!==r){e.next=5;break}throw new Error("Must provide dataset name or ID");case 5:if(void 0===n||void 0===r){e.next=9;break}throw new Error("Must provide either datasetName or datasetId, not both");case 9:if(void 0!==n){e.next=16;break}return e.next=12,this.readDataset({datasetName:r});case 12:u=e.sent,i=u.id,e.next=17;break;case 16:i=n;case 17:return ac(i),o=new URLSearchParams,(s=a?"string"===typeof a?a:null===a||void 0===a?void 0:a.toISOString():void 0)&&o.append("as_of",s),e.next=23,this._get("/datasets/".concat(i,"/splits"),o);case 23:return c=e.sent,e.abrupt("return",c);case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateDatasetSplits",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.datasetId,r=t.datasetName,a=t.splitName,i=t.exampleIds,u=t.remove,o=void 0!==u&&u,void 0!==n||void 0!==r){e.next=5;break}throw new Error("Must provide dataset name or ID");case 5:if(void 0===n||void 0===r){e.next=9;break}throw new Error("Must provide either datasetName or datasetId, not both");case 9:if(void 0!==n){e.next=16;break}return e.next=12,this.readDataset({datasetName:r});case 12:c=e.sent,s=c.id,e.next=17;break;case 16:s=n;case 17:return ac(s),l={split_name:a,examples:i.map((function(e){return ac(e),e})),remove:o},e.next=21,this.caller.call(Ks(),"".concat(this.apiUrl,"/datasets/").concat(s,"/splits"),q({method:"PUT",headers:q(q({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 21:return d=e.sent,e.next=24,cc(d,"update dataset splits",!0);case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"evaluateRun",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u,o,s,c,l,d,f=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(r=f.length>2&&void 0!==f[2]?f[2]:{loadChildRuns:!1}).sourceInfo,i=r.loadChildRuns,u=r.referenceExample,uc("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead."),"string"!==typeof t){e.next=8;break}return e.next=5,this.readRun(t,{loadChildRuns:i});case 5:o=e.sent,e.next=13;break;case 8:if("object"!==typeof t||!("id"in t)){e.next=12;break}o=t,e.next=13;break;case 12:throw new Error("Invalid run type: ".concat(typeof t));case 13:if(null===o.reference_example_id||void 0===o.reference_example_id){e.next=17;break}return e.next=16,this.readExample(o.reference_example_id);case 16:u=e.sent;case 17:return e.next=19,n.evaluateRun(o,u);case 19:return s=e.sent,e.next=22,this._logEvaluationFeedback(s,o,a);case 22:return c=e.sent,l=w(c,2),l[0],d=l[1],e.abrupt("return",d[0]);case 27:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createFeedback",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c,l,d,f,h,v,m,y,g,b,_,k;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.score,u=r.value,o=r.correction,s=r.comment,c=r.sourceInfo,l=r.feedbackSourceType,d=void 0===l?"api":l,f=r.sourceRunId,h=r.feedbackId,v=r.feedbackConfig,m=r.projectId,y=r.comparativeExperimentId,t||m){e.next=3;break}throw new Error("One of runId or projectId must be provided");case 3:if(!t||!m){e.next=5;break}throw new Error("Only one of runId or projectId can be provided");case 5:return g={type:null!==d&&void 0!==d?d:"api",metadata:null!==c&&void 0!==c?c:{}},void 0===f||void 0===(null===g||void 0===g?void 0:g.metadata)||g.metadata.__run||(g.metadata.__run={run_id:f}),void 0!==(null===g||void 0===g?void 0:g.metadata)&&void 0!==(null===(a=g.metadata.__run)||void 0===a?void 0:a.run_id)&&ac(g.metadata.__run.run_id),b={id:null!==h&&void 0!==h?h:Gs(),run_id:t,key:n,score:Pc(i),value:u,correction:o,comment:s,feedback_source:g,comparative_experiment_id:y,feedbackConfig:v,session_id:m},_="".concat(this.apiUrl,"/feedback"),e.next=12,this.caller.call(Ks(),_,q({method:"POST",headers:q(q({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(b),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 12:return k=e.sent,e.next=15,cc(k,"create feedback",!0);case 15:return e.abrupt("return",b);case 16:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"updateFeedback",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u,o,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.score,a=n.value,i=n.correction,u=n.comment,o={},void 0!==r&&null!==r&&(o.score=Pc(r)),void 0!==a&&null!==a&&(o.value=a),void 0!==i&&null!==i&&(o.correction=i),void 0!==u&&null!==u&&(o.comment=u),ac(t),e.next=9,this.caller.call(Ks(),"".concat(this.apiUrl,"/feedback/").concat(t),q({method:"PATCH",headers:q(q({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 9:return s=e.sent,e.next=12,cc(s,"update feedback",!0);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"readFeedback",value:function(){var e=b(p().mark((function e(t){var n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ac(t),n="/feedback/".concat(t),e.next=4,this._get(n);case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteFeedback",value:function(){var e=b(p().mark((function e(t){var n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ac(t),n="/feedback/".concat(t),e.next=4,this.caller.call(Ks(),this.apiUrl+n,q({method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 4:return r=e.sent,e.next=7,cc(r,"delete ".concat(n));case 7:return e.next=9,r.json();case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listFeedback",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.runIds,r=t.feedbackKeys,a=t.feedbackSourceTypes;return An(p().mark((function t(){var i,u,o,s,c,l,d,f,h,v,m,y,g;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=new URLSearchParams,n&&i.append("run",n.join(",")),r){u=G(r);try{for(u.s();!(o=u.n()).done;)s=o.value,i.append("key",s)}catch(p){u.e(p)}finally{u.f()}}if(a){c=G(a);try{for(c.s();!(l=c.n()).done;)d=l.value,i.append("source",d)}catch(p){c.e(p)}finally{c.f()}}f=!1,h=!1,t.prev=6,m=Cn(e._getPaginated("/feedback",i));case 8:return t.next=10,xn(m.next());case 10:if(!(f=!(y=t.sent).done)){t.next=16;break}return g=y.value,t.delegateYield(Os(Cn(g)),"t0",13);case 13:f=!1,t.next=8;break;case 16:t.next=22;break;case 18:t.prev=18,t.t1=t.catch(6),h=!0,v=t.t1;case 22:if(t.prev=22,t.prev=23,!f||null==m.return){t.next=27;break}return t.next=27,xn(m.return());case 27:if(t.prev=27,!h){t.next=30;break}throw v;case 30:return t.finish(27);case 31:return t.finish(22);case 32:case"end":return t.stop()}}),t,null,[[6,18,22,32],[23,,27,31]])})))()}},{key:"createPresignedFeedbackToken",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u,o,s,c=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(r=c.length>2&&void 0!==c[2]?c[2]:{}).expiration,i=r.feedbackConfig,u={run_id:t,feedback_key:n,feedback_config:i},a?"string"===typeof a?u.expires_at=a:(null!==a&&void 0!==a&&a.hours||null!==a&&void 0!==a&&a.minutes||null!==a&&void 0!==a&&a.days)&&(u.expires_in=a):u.expires_in={hours:3},e.next=5,this.caller.call(Ks(),"".concat(this.apiUrl,"/feedback/tokens"),q({method:"POST",headers:q(q({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 5:return o=e.sent,e.next=8,o.json();case 8:return s=e.sent,e.abrupt("return",s);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createComparativeExperiment",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.name,a=t.experimentIds,i=t.referenceDatasetId,u=t.createdAt,o=t.description,s=t.metadata,c=t.id,0!==a.length){e.next=3;break}throw new Error("At least one experiment is required");case 3:if(i){e.next=7;break}return e.next=6,this.readProject({projectId:a[0]});case 6:i=e.sent.reference_dataset_id;case 7:if(null!=!i){e.next=9;break}throw new Error("A reference dataset is required");case 9:return l={id:c,name:r,experiment_ids:a,reference_dataset_id:i,description:o,created_at:null===(n=null!==u&&void 0!==u?u:new Date)||void 0===n?void 0:n.toISOString(),extra:{}},s&&(l.extra.metadata=s),e.next=13,this.caller.call(Ks(),"".concat(this.apiUrl,"/datasets/comparative"),q({method:"POST",headers:q(q({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 13:return d=e.sent,e.next=16,d.json();case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listPresignedFeedbackTokens",value:function(e){var t=this;return An(p().mark((function n(){var r,a,i,u,o,s,c;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:ac(e),r=new URLSearchParams({run_id:e}),a=!1,i=!1,n.prev=4,o=Cn(t._getPaginated("/feedback/tokens",r));case 6:return n.next=8,xn(o.next());case 8:if(!(a=!(s=n.sent).done)){n.next=14;break}return c=s.value,n.delegateYield(Os(Cn(c)),"t0",11);case 11:a=!1,n.next=6;break;case 14:n.next=20;break;case 16:n.prev=16,n.t1=n.catch(4),i=!0,u=n.t1;case 20:if(n.prev=20,n.prev=21,!a||null==o.return){n.next=25;break}return n.next=25,xn(o.return());case 25:if(n.prev=25,!i){n.next=28;break}throw u;case 28:return n.finish(25);case 29:return n.finish(20);case 30:case"end":return n.stop()}}),n,null,[[4,16,20,30],[21,,25,29]])})))()}},{key:"_selectEvalResults",value:function(e){return"results"in e?e.results:Array.isArray(e)?e:[e]}},{key:"_logEvaluationFeedback",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c,l;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=this._selectEvalResults(t),i=[],u=G(a),e.prev=3,u.s();case 5:if((o=u.n()).done){e.next=18;break}return s=o.value,c=r||{},s.evaluatorInfo&&(c=q(q({},s.evaluatorInfo),c)),l=null,s.targetRunId?l=s.targetRunId:n&&(l=n.id),e.t0=i,e.next=14,this.createFeedback(l,s.key,{score:s.score,value:s.value,comment:s.comment,correction:s.correction,sourceInfo:c,sourceRunId:s.sourceRunId,feedbackConfig:s.feedbackConfig,feedbackSourceType:"model"});case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 16:e.next=5;break;case 18:e.next=23;break;case 20:e.prev=20,e.t2=e.catch(3),u.e(e.t2);case 23:return e.prev=23,u.f(),e.finish(23);case 26:return e.abrupt("return",[a,i]);case 27:case"end":return e.stop()}}),e,this,[[3,20,23,26]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"logEvaluationFeedback",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._logEvaluationFeedback(t,n,r);case 2:return a=e.sent,i=w(a,1),u=i[0],e.abrupt("return",u);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"listAnnotationQueues",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return An(p().mark((function n(){var r,a,i,u,o,s,c,l,d,f,h,v;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=t.queueIds,a=t.name,i=t.nameContains,u=t.limit,o=new URLSearchParams,r&&r.forEach((function(e,t){ac(e,"queueIds[".concat(t,"]")),o.append("ids",e)})),a&&o.append("name",a),i&&o.append("name_contains",i),o.append("limit",(void 0!==u?Math.min(u,100):100).toString()),s=0,c=!1,l=!1,n.prev=9,f=Cn(e._getPaginated("/annotation-queues",o));case 11:return n.next=13,xn(f.next());case 13:if(!(c=!(h=n.sent).done)){n.next=22;break}return v=h.value,n.delegateYield(Os(Cn(v)),"t0",16);case 16:if(s++,!(void 0!==u&&s>=u)){n.next=19;break}return n.abrupt("break",22);case 19:c=!1,n.next=11;break;case 22:n.next=28;break;case 24:n.prev=24,n.t1=n.catch(9),l=!0,d=n.t1;case 28:if(n.prev=28,n.prev=29,!c||null==f.return){n.next=33;break}return n.next=33,xn(f.return());case 33:if(n.prev=33,!l){n.next=36;break}throw d;case 36:return n.finish(33);case 37:return n.finish(28);case 38:case"end":return n.stop()}}),n,null,[[9,24,28,38],[29,,33,37]])})))()}},{key:"createAnnotationQueue",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,r=t.description,a=t.queueId,i={name:n,description:r,id:a||Gs()},e.next=4,this.caller.call(Ks(),"".concat(this.apiUrl,"/annotation-queues"),q({method:"POST",headers:q(q({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(Object.fromEntries(Object.entries(i).filter((function(e){var t=w(e,2);t[0];return void 0!==t[1]})))),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 4:return u=e.sent,e.next=7,cc(u,"create annotation queue");case 7:return e.next=9,u.json();case 9:return o=e.sent,e.abrupt("return",o);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readAnnotationQueue",value:function(){var e=b(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.listAnnotationQueues({queueIds:[t]}).next();case 2:if(!(n=e.sent).done){e.next=5;break}throw new Error("Annotation queue with ID ".concat(t," not found"));case 5:return e.abrupt("return",n.value);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateAnnotationQueue",value:function(){var e=b(p().mark((function e(t,n){var r,a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.name,a=n.description,e.next=3,this.caller.call(Ks(),"".concat(this.apiUrl,"/annotation-queues/").concat(ac(t,"queueId")),q({method:"PATCH",headers:q(q({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify({name:r,description:a}),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:return i=e.sent,e.next=6,cc(i,"update annotation queue");case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteAnnotationQueue",value:function(){var e=b(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.caller.call(Ks(),"".concat(this.apiUrl,"/annotation-queues/").concat(ac(t,"queueId")),q({method:"DELETE",headers:q(q({},this.headers),{},{Accept:"application/json"}),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 2:return n=e.sent,e.next=5,cc(n,"delete annotation queue");case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addRunsToAnnotationQueue",value:function(){var e=b(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.caller.call(Ks(),"".concat(this.apiUrl,"/annotation-queues/").concat(ac(t,"queueId"),"/runs"),q({method:"POST",headers:q(q({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(n.map((function(e,t){return ac(e,"runIds[".concat(t,"]")).toString()}))),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 2:return r=e.sent,e.next=5,cc(r,"add runs to annotation queue");case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getRunFromAnnotationQueue",value:function(){var e=b(p().mark((function e(t,n){var r,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="/annotation-queues/".concat(ac(t,"queueId"),"/run"),e.next=3,this.caller.call(Ks(),"".concat(this.apiUrl).concat(r,"/").concat(n),q({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:return a=e.sent,e.next=6,cc(a,"get run from annotation queue");case 6:return e.next=8,a.json();case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteRunFromAnnotationQueue",value:function(){var e=b(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.caller.call(Ks(),"".concat(this.apiUrl,"/annotation-queues/").concat(ac(t,"queueId"),"/runs/").concat(ac(n,"queueRunId")),q({method:"DELETE",headers:q(q({},this.headers),{},{Accept:"application/json"}),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 2:return r=e.sent,e.next=5,cc(r,"delete run from annotation queue");case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSizeFromAnnotationQueue",value:function(){var e=b(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.caller.call(Ks(),"".concat(this.apiUrl,"/annotation-queues/").concat(ac(t,"queueId"),"/size"),q({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 2:return n=e.sent,e.next=5,cc(n,"get size from annotation queue");case 5:return e.next=7,n.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_currentTenantIsOwner",value:function(){var e=b(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getSettings();case 2:return n=e.sent,e.abrupt("return","-"==t||n.tenant_handle===t);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_ownerConflictError",value:function(){var e=b(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getSettings();case 2:return r=e.sent,e.abrupt("return",new Error("Cannot ".concat(t," for another tenant.\n\n      Current tenant: ").concat(r.tenant_handle,"\n\n      Requested tenant: ").concat(n)));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getLatestCommitHash",value:function(){var e=b(p().mark((function e(t){var n,r,a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.caller.call(Ks(),"".concat(this.apiUrl,"/commits/").concat(t,"/?limit=",1,"&offset=",0),q({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 2:return n=e.sent,e.next=5,n.json();case 5:if(r=e.sent,n.ok){e.next=11;break}throw a="string"===typeof r.detail?r.detail:JSON.stringify(r.detail),(i=new Error("Error ".concat(n.status,": ").concat(n.statusText,"\n").concat(a))).statusCode=n.status,i;case 11:if(0!==r.commits.length){e.next=13;break}return e.abrupt("return",void 0);case 13:return e.abrupt("return",r.commits[0].commit_hash);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_likeOrUnlikePrompt",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=oc(t),a=w(r,3),i=a[0],u=a[1],a[2],e.next=3,this.caller.call(Ks(),"".concat(this.apiUrl,"/likes/").concat(i,"/").concat(u),q({method:"POST",body:JSON.stringify({like:n}),headers:q(q({},this.headers),{},{"Content-Type":"application/json"}),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:return o=e.sent,e.next=6,cc(o,"".concat(n?"like":"unlike"," prompt"));case 6:return e.next=8,o.json();case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getPromptUrl",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=oc(t),r=w(n,3),a=r[0],i=r[1],u=r[2],e.next=3,this._currentTenantIsOwner(a);case 3:if(e.sent){e.next=11;break}if("latest"===u){e.next=8;break}return e.abrupt("return","".concat(this.getHostUrl(),"/hub/").concat(a,"/").concat(i,"/").concat(u.substring(0,8)));case 8:return e.abrupt("return","".concat(this.getHostUrl(),"/hub/").concat(a,"/").concat(i));case 9:e.next=19;break;case 11:return e.next=13,this._getSettings();case 13:if(o=e.sent,"latest"===u){e.next=18;break}return e.abrupt("return","".concat(this.getHostUrl(),"/prompts/").concat(i,"/").concat(u.substring(0,8),"?organizationId=").concat(o.id));case 18:return e.abrupt("return","".concat(this.getHostUrl(),"/prompts/").concat(i,"?organizationId=").concat(o.id));case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"promptExists",value:function(){var e=b(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPrompt(t);case 2:return n=e.sent,e.abrupt("return",!!n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"likePrompt",value:function(){var e=b(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._likeOrUnlikePrompt(t,!0));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"unlikePrompt",value:function(){var e=b(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._likeOrUnlikePrompt(t,!1));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listCommits",value:function(e){var t=this;return An(p().mark((function n(){var r,a,i,u,o,s;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=!1,a=!1,n.prev=2,u=Cn(t._getPaginated("/commits/".concat(e,"/"),new URLSearchParams,(function(e){return e.commits})));case 4:return n.next=6,xn(u.next());case 6:if(!(r=!(o=n.sent).done)){n.next=12;break}return s=o.value,n.delegateYield(Os(Cn(s)),"t0",9);case 9:r=!1,n.next=4;break;case 12:n.next=18;break;case 14:n.prev=14,n.t1=n.catch(2),a=!0,i=n.t1;case 18:if(n.prev=18,n.prev=19,!r||null==u.return){n.next=23;break}return n.next=23,xn(u.return());case 23:if(n.prev=23,!a){n.next=26;break}throw i;case 26:return n.finish(23);case 27:return n.finish(18);case 28:case"end":return n.stop()}}),n,null,[[2,14,18,28],[19,,23,27]])})))()}},{key:"listPrompts",value:function(e){var t=this;return An(p().mark((function n(){var r,a,i,u,o,s,c,l;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:(a=new URLSearchParams).append("sort_field",null!==(r=null===e||void 0===e?void 0:e.sortField)&&void 0!==r?r:"updated_at"),a.append("sort_direction","desc"),a.append("is_archived",(!(null===e||void 0===e||!e.isArchived)).toString()),void 0!==(null===e||void 0===e?void 0:e.isPublic)&&a.append("is_public",e.isPublic.toString()),null!==e&&void 0!==e&&e.query&&a.append("query",e.query),i=!1,u=!1,n.prev=8,s=Cn(t._getPaginated("/repos",a,(function(e){return e.repos})));case 10:return n.next=12,xn(s.next());case 12:if(!(i=!(c=n.sent).done)){n.next=18;break}return l=c.value,n.delegateYield(Os(Cn(l)),"t0",15);case 15:i=!1,n.next=10;break;case 18:n.next=24;break;case 20:n.prev=20,n.t1=n.catch(8),u=!0,o=n.t1;case 24:if(n.prev=24,n.prev=25,!i||null==s.return){n.next=29;break}return n.next=29,xn(s.return());case 29:if(n.prev=29,!u){n.next=32;break}throw o;case 32:return n.finish(29);case 33:return n.finish(24);case 34:case"end":return n.stop()}}),n,null,[[8,20,24,34],[25,,29,33]])})))()}},{key:"getPrompt",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=oc(t),r=w(n,3),a=r[0],i=r[1],r[2],e.next=3,this.caller.call(Ks(),"".concat(this.apiUrl,"/repos/").concat(a,"/").concat(i),q({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:if(404!==(u=e.sent).status){e.next=6;break}return e.abrupt("return",null);case 6:return e.next=8,cc(u,"get prompt");case 8:return e.next=10,u.json();case 10:if(!(o=e.sent).repo){e.next=15;break}return e.abrupt("return",o.repo);case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createPrompt",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u,o,s,c,l,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getSettings();case 2:if(r=e.sent,null===n||void 0===n||!n.isPublic||r.tenant_handle){e.next=5;break}throw new Error("Cannot create a public prompt without first\n\n        creating a LangChain Hub handle. \n        You can add a handle by creating a public prompt at:\n\n        https://smith.langchain.com/prompts");case 5:return a=oc(t),i=w(a,3),u=i[0],o=i[1],i[2],e.next=8,this._currentTenantIsOwner(u);case 8:if(e.sent){e.next=12;break}return e.next=11,this._ownerConflictError("create a prompt",u);case 11:throw e.sent;case 12:return s=q(q(q(q({repo_handle:o},(null===n||void 0===n?void 0:n.description)&&{description:n.description}),(null===n||void 0===n?void 0:n.readme)&&{readme:n.readme}),(null===n||void 0===n?void 0:n.tags)&&{tags:n.tags}),{},{is_public:!(null===n||void 0===n||!n.isPublic)}),e.next=15,this.caller.call(Ks(),"".concat(this.apiUrl,"/repos/"),q({method:"POST",headers:q(q({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 15:return c=e.sent,e.next=18,cc(c,"create prompt");case 18:return e.next=20,c.json();case 20:return l=e.sent,d=l.repo,e.abrupt("return",d);case 23:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createCommit",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c,l,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.promptExists(t);case 2:if(e.sent){e.next=4;break}throw new Error("Prompt does not exist, you must create it first.");case 4:if(a=oc(t),i=w(a,3),u=i[0],o=i[1],i[2],"latest"!==(null===r||void 0===r?void 0:r.parentCommitHash)&&null!==r&&void 0!==r&&r.parentCommitHash){e.next=11;break}return e.next=8,this._getLatestCommitHash("".concat(u,"/").concat(o));case 8:e.t0=e.sent,e.next=12;break;case 11:e.t0=null===r||void 0===r?void 0:r.parentCommitHash;case 12:return s=e.t0,c={manifest:JSON.parse(JSON.stringify(n)),parent_commit:s},e.next=16,this.caller.call(Ks(),"".concat(this.apiUrl,"/commits/").concat(u,"/").concat(o),q({method:"POST",headers:q(q({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 16:return l=e.sent,e.next=19,cc(l,"create commit");case 19:return e.next=21,l.json();case 21:return d=e.sent,e.abrupt("return",this._getPromptUrl("".concat(u,"/").concat(o).concat(d.commit_hash?":".concat(d.commit_hash):"")));case 23:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"updateExamplesMultipart",value:function(){var e=b(p().mark((function e(t){var n,r=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:[],e.abrupt("return",this._updateExamplesMultipart(t,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateExamplesMultipart",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l,d,f,h,v,m,y,g,b,_,k,x,E,A,C,D,S,O,F,P,T=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=T.length>1&&void 0!==T[1]?T[1]:[],e.next=3,this._getMultiPartSupport();case 3:if(e.sent){e.next=5;break}throw new Error("Your LangSmith version does not allow using the multipart examples endpoint, please update to the latest version.");case 5:a=new FormData,i=G(r);try{for(i.s();!(u=i.n()).done;){if(o=u.value,s=o.id,c=q(q({},o.metadata&&{metadata:o.metadata}),o.split&&{split:o.split}),l=gc(c),d=new Blob([l],{type:"application/json"}),a.append(s,d),o.inputs&&(f=gc(o.inputs),h=new Blob([f],{type:"application/json"}),a.append("".concat(s,".inputs"),h)),o.outputs&&(v=gc(o.outputs),m=new Blob([v],{type:"application/json"}),a.append("".concat(s,".outputs"),m)),o.attachments)for(y=0,g=Object.entries(o.attachments);y<g.length;y++)b=w(g[y],2),_=b[0],k=b[1],x=void 0,E=void 0,Array.isArray(k)?(A=w(k,2),x=A[0],E=A[1]):(x=k.mimeType,E=k.data),C=new Blob([E],{type:"".concat(x,"; length=").concat(E.byteLength)}),a.append("".concat(s,".attachment.").concat(_),C);o.attachments_operations&&(D=gc(o.attachments_operations),S=new Blob([D],{type:"application/json"}),a.append("".concat(s,".attachments_operations"),S))}}catch(p){i.e(p)}finally{i.f()}return O=null!==t&&void 0!==t?t:null===(n=r[0])||void 0===n?void 0:n.dataset_id,e.next=11,this.caller.call(Ks(),"".concat(this.apiUrl,"/v1/platform/datasets/").concat(O,"/examples"),{method:"PATCH",headers:this.headers,body:a});case 11:return F=e.sent,e.next=14,F.json();case 14:return P=e.sent,e.abrupt("return",P);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"uploadExamplesMultipart",value:function(){var e=b(p().mark((function e(t){var n,r=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:[],e.abrupt("return",this._uploadExamplesMultipart(t,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_uploadExamplesMultipart",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l,d,f,h,v,m,y,g,b,_,k,x,E,A,C,D,S,O=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=O.length>1&&void 0!==O[1]?O[1]:[],e.next=3,this._getMultiPartSupport();case 3:if(e.sent){e.next=5;break}throw new Error("Your LangSmith version does not allow using the multipart examples endpoint, please update to the latest version.");case 5:r=new FormData,a=G(n);try{for(a.s();!(i=a.n()).done;)if(o=i.value,s=(null!==(u=o.id)&&void 0!==u?u:Gs()).toString(),c=q(q(q(q(q({created_at:o.created_at},o.metadata&&{metadata:o.metadata}),o.split&&{split:o.split}),o.source_run_id&&{source_run_id:o.source_run_id}),o.use_source_run_io&&{use_source_run_io:o.use_source_run_io}),o.use_source_run_attachments&&{use_source_run_attachments:o.use_source_run_attachments}),l=gc(c),d=new Blob([l],{type:"application/json"}),r.append(s,d),o.inputs&&(f=gc(o.inputs),h=new Blob([f],{type:"application/json"}),r.append("".concat(s,".inputs"),h)),o.outputs&&(v=gc(o.outputs),m=new Blob([v],{type:"application/json"}),r.append("".concat(s,".outputs"),m)),o.attachments)for(y=0,g=Object.entries(o.attachments);y<g.length;y++)b=w(g[y],2),_=b[0],k=b[1],x=void 0,E=void 0,Array.isArray(k)?(A=w(k,2),x=A[0],E=A[1]):(x=k.mimeType,E=k.data),C=new Blob([E],{type:"".concat(x,"; length=").concat(E.byteLength)}),r.append("".concat(s,".attachment.").concat(_),C)}catch(p){a.e(p)}finally{a.f()}return e.next=10,this.caller.call(Ks(),"".concat(this.apiUrl,"/v1/platform/datasets/").concat(t,"/examples"),{method:"POST",headers:this.headers,body:r});case 10:return D=e.sent,e.next=13,D.json();case 13:return S=e.sent,e.abrupt("return",S);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updatePrompt",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u,o,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.promptExists(t);case 2:if(e.sent){e.next=4;break}throw new Error("Prompt does not exist, you must create it first.");case 4:return r=oc(t),a=w(r,2),i=a[0],u=a[1],e.next=7,this._currentTenantIsOwner(i);case 7:if(e.sent){e.next=11;break}return e.next=10,this._ownerConflictError("update a prompt",i);case 10:throw e.sent;case 11:if(o={},void 0!==(null===n||void 0===n?void 0:n.description)&&(o.description=n.description),void 0!==(null===n||void 0===n?void 0:n.readme)&&(o.readme=n.readme),void 0!==(null===n||void 0===n?void 0:n.tags)&&(o.tags=n.tags),void 0!==(null===n||void 0===n?void 0:n.isPublic)&&(o.is_public=n.isPublic),void 0!==(null===n||void 0===n?void 0:n.isArchived)&&(o.is_archived=n.isArchived),0!==Object.keys(o).length){e.next=19;break}throw new Error("No valid update options provided");case 19:return e.next=21,this.caller.call(Ks(),"".concat(this.apiUrl,"/repos/").concat(i,"/").concat(u),q({method:"PATCH",body:JSON.stringify(o),headers:q(q({},this.headers),{},{"Content-Type":"application/json"}),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 21:return s=e.sent,e.next=24,cc(s,"update prompt");case 24:return e.abrupt("return",s.json());case 25:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deletePrompt",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.promptExists(t);case 2:if(e.sent){e.next=4;break}throw new Error("Prompt does not exist, you must create it first.");case 4:return n=oc(t),r=w(n,3),a=r[0],i=r[1],r[2],e.next=7,this._currentTenantIsOwner(a);case 7:if(e.sent){e.next=11;break}return e.next=10,this._ownerConflictError("delete a prompt",a);case 10:throw e.sent;case 11:return e.next=13,this.caller.call(Ks(),"".concat(this.apiUrl,"/repos/").concat(a,"/").concat(i),q({method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 13:return u=e.sent,e.next=16,u.json();case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pullPromptCommit",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u,o,s,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=oc(t),a=w(r,3),i=a[0],u=a[1],o=a[2],e.next=3,this.caller.call(Ks(),"".concat(this.apiUrl,"/commits/").concat(i,"/").concat(u,"/").concat(o).concat(null!==n&&void 0!==n&&n.includeModel?"?include_model=true":""),q({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:return s=e.sent,e.next=6,cc(s,"pull prompt commit");case 6:return e.next=8,s.json();case 8:return c=e.sent,e.abrupt("return",{owner:i,repo:u,commit_hash:c.commit_hash,manifest:c.manifest,examples:c.examples});case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_pullPrompt",value:function(){var e=b(p().mark((function e(t,n){var r,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.pullPromptCommit(t,{includeModel:null===n||void 0===n?void 0:n.includeModel});case 2:return r=e.sent,a=JSON.stringify(r.manifest),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"pushPrompt",value:function(){var e=b(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.promptExists(t);case 2:if(!e.sent){e.next=8;break}if(!n||!Object.keys(n).some((function(e){return"object"!==e}))){e.next=6;break}return e.next=6,this.updatePrompt(t,{description:null===n||void 0===n?void 0:n.description,readme:null===n||void 0===n?void 0:n.readme,tags:null===n||void 0===n?void 0:n.tags,isPublic:null===n||void 0===n?void 0:n.isPublic});case 6:e.next=10;break;case 8:return e.next=10,this.createPrompt(t,{description:null===n||void 0===n?void 0:n.description,readme:null===n||void 0===n?void 0:n.readme,tags:null===n||void 0===n?void 0:n.tags,isPublic:null===n||void 0===n?void 0:n.isPublic});case 10:if(null!==n&&void 0!==n&&n.object){e.next=14;break}return e.next=13,this._getPromptUrl(t);case 13:return e.abrupt("return",e.sent);case 14:return e.next=16,this.createCommit(t,null===n||void 0===n?void 0:n.object,{parentCommitHash:null===n||void 0===n?void 0:n.parentCommitHash});case 16:return r=e.sent,e.abrupt("return",r);case 18:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"clonePublicDataset",value:function(){var t=b(p().mark((function t(n){var r,a,i,u,o,s,c,l,d,f,h,v,m,y,g,b=arguments;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=(i=b.length>1&&void 0!==b[1]?b[1]:{}).sourceApiUrl,o=void 0===u?this.apiUrl:u,s=i.datasetName,c=this.parseTokenOrUrl(n,o),l=w(c,2),d=l[0],f=l[1],h=new e({apiUrl:d,apiKey:"placeholder"}),t.next=6,h.readSharedDataset(f);case 6:return v=t.sent,m=s||v.name,t.prev=8,t.next=11,this.hasDataset({datasetId:m});case 11:if(!t.sent){t.next=14;break}return console.log("Dataset ".concat(m," already exists in your tenant. Skipping.")),t.abrupt("return");case 14:t.next=18;break;case 16:t.prev=16,t.t0=t.catch(8);case 18:return t.next=20,h.listSharedExamples(f);case 20:return y=t.sent,t.next=23,this.createDataset(m,{description:v.description,dataType:v.data_type||"kv",inputsSchema:null!==(r=v.inputs_schema_definition)&&void 0!==r?r:void 0,outputsSchema:null!==(a=v.outputs_schema_definition)&&void 0!==a?a:void 0});case 23:return g=t.sent,t.prev=24,t.next=27,this.createExamples({inputs:y.map((function(e){return e.inputs})),outputs:y.flatMap((function(e){return e.outputs?[e.outputs]:[]})),datasetId:g.id});case 27:t.next=33;break;case 29:throw t.prev=29,t.t1=t.catch(24),console.error("An error occurred while creating dataset ".concat(m,". ")+"You should delete it manually."),t.t1;case 33:case"end":return t.stop()}}),t,this,[[8,16],[24,29]])})));return function(e){return t.apply(this,arguments)}}()},{key:"parseTokenOrUrl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"dataset";try{return ac(e),[t,e]}catch(i){}try{var a=new URL(e).pathname.split("/").filter((function(e){return""!==e}));if(a.length>=n)return[t,a[a.length-n]];throw new Error("Invalid public ".concat(r," URL: ").concat(e))}catch(u){throw new Error("Invalid public ".concat(r," URL or token: ").concat(e))}}},{key:"awaitPendingTraceBatches",value:function(){return this.manualFlushMode?(console.warn("[WARNING]: When tracing in manual flush mode, you must call `await client.flush()` manually to submit trace batches."),Promise.resolve()):Promise.all([].concat(y(this.autoBatchQueue.items.map((function(e){return e.itemPromise}))),[this.batchIngestCaller.queue.onIdle()]))}}],[{key:"getDefaultClientConfig",value:function(){var e,t=Wc("API_KEY");return{apiUrl:null!==(e=Wc("ENDPOINT"))&&void 0!==e?e:"https://api.smith.langchain.com",apiKey:t,webUrl:void 0,hideInputs:"true"===Wc("HIDE_INPUTS"),hideOutputs:"true"===Wc("HIDE_OUTPUTS")}}}]),e}();function Ic(e){return"dataset_id"in e||"dataset_name"in e}var Nc,Rc,Bc,Lc="0.3.15",Mc=function(){return"undefined"!==typeof Deno},Uc=function(){return Nc||(Nc="undefined"!==typeof window&&"undefined"!==typeof window.document?"browser":"undefined"===typeof process||"undefined"===typeof process.versions||"undefined"===typeof process.versions.node||Mc()?"object"===typeof globalThis&&globalThis.constructor&&"DedicatedWorkerGlobalScope"===globalThis.constructor.name?"webworker":"undefined"!==typeof window&&"nodejs"===window.name||"undefined"!==typeof navigator&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom"))?"jsdom":Mc()?"deno":"other":"node")};function zc(){if(void 0===Rc){var e=Uc(),t=function(){if(void 0!==Bc)return Bc;for(var e={},t=0,n=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"];t<n.length;t++){var r=n[t],a=Zc(r);void 0!==a&&(e[r]=a)}return Bc=e,e}();Rc=q({library:"langsmith",runtime:e,sdk:"langsmith-js",sdk_version:Lc},t)}return Rc}function Hc(){try{return"undefined"!==typeof process?Object.entries({NODE_ENV:"production",PUBLIC_URL:"/detective-infinity",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).reduce((function(e,t){var n=w(t,2),r=n[0],a=n[1];return e[r]=String(a),e}),{}):void 0}catch(e){return}}function Zc(e){try{var t;return"undefined"!==typeof process?null===(t={NODE_ENV:"production",PUBLIC_URL:"/detective-infinity",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})||void 0===t?void 0:t[e]:void 0}catch(n){return}}function Wc(e){return Zc("LANGSMITH_".concat(e))||Zc("LANGCHAIN_".concat(e))}var qc=Symbol.for("lc:context_variables"),Gc=["metadata"];var Vc=function(){function e(t,n){T(this,e),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=t,this.tags=n}return I(e,[{key:"toHeader",value:function(){var e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push("langsmith-metadata=".concat(encodeURIComponent(JSON.stringify(this.metadata)))),this.tags&&this.tags.length>0&&e.push("langsmith-tags=".concat(encodeURIComponent(this.tags.join(",")))),e.join(",")}}],[{key:"fromHeader",value:function(t){var n,r={},a=[],i=G(t.split(","));try{for(i.s();!(n=i.n()).done;){var u=w(n.value.split("="),2),o=u[0],s=u[1],c=decodeURIComponent(s);"langsmith-metadata"===o?r=JSON.parse(c):"langsmith-tags"===o&&(a=c.split(","))}}catch(l){i.e(l)}finally{i.f()}return new e(r,a)}}]),e}(),$c=function(){function e(t){var n,r,a,i;if(T(this,e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"attachments",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Jc(t))Object.assign(this,q({},t));else{var u,o=e.getDefaultConfig(),s=t.metadata,c=Sn(t,Gc),l=null!==(n=c.client)&&void 0!==n?n:e.getSharedClient(),d=q(q({},s),null===c||void 0===c||null===(r=c.extra)||void 0===r?void 0:r.metadata);if(c.extra=q(q({},c.extra),{},{metadata:d}),Object.assign(this,q(q(q({},o),c),{},{client:l})),!this.trace_id)if(this.parent_run)this.trace_id=null!==(u=this.parent_run.trace_id)&&void 0!==u?u:this.id;else this.trace_id=this.id;if(null!==(a=this.execution_order)&&void 0!==a||(this.execution_order=1),null!==(i=this.child_execution_order)&&void 0!==i||(this.child_execution_order=1),!this.dotted_order){var f=function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:1).toFixed(0).slice(0,3).padStart(3,"0");return"".concat(new Date(e).toISOString().slice(0,-1)).concat(n,"Z").replace(/[-:.]/g,"")+t}(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+f:this.dotted_order=f}}}return I(e,[{key:"createChild",value:function(t){var n,r,a=this.child_execution_order+1,i=new e(q(q({},t),{},{parent_run:this,project_name:this.project_name,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:a,child_execution_order:a}));qc in this&&(i[qc]=this[qc]);var u,o=Symbol.for("lc:child_config"),s=null!==(n=null===(r=t.extra)||void 0===r?void 0:r[o])&&void 0!==n?n:this.extra[o];if(function(e){var t;return void 0!==e&&"object"===typeof e.callbacks&&(Qc(null===(t=e.callbacks)||void 0===t?void 0:t.handlers)||Qc(e.callbacks))}(s)){var c,l,d,f,p,h=q({},s),v="object"===typeof(u=h.callbacks)&&null!=u&&Array.isArray(u.handlers)?null===(c=(l=h.callbacks).copy)||void 0===c?void 0:c.call(l):void 0;if(v)Object.assign(v,{_parentRunId:i.id}),null===(d=v.handlers)||void 0===d||null===(f=d.find(Kc))||void 0===f||null===(p=f.updateFromRunTree)||void 0===p||p.call(f,i),h.callbacks=v;i.extra[o]=h}for(var m=new Set,y=this;null!=y&&!m.has(y.id);)m.add(y.id),y.child_execution_order=Math.max(y.child_execution_order,a),y=y.parent_run;return this.child_runs.push(i),i}},{key:"end",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u,o,s=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=s.length>2&&void 0!==s[2]?s[2]:Date.now(),o=s.length>3?s[3]:void 0,this.outputs=null!==(r=this.outputs)&&void 0!==r?r:t,this.error=null!==(a=this.error)&&void 0!==a?a:n,this.end_time=null!==(i=this.end_time)&&void 0!==i?i:u,o&&Object.keys(o).length>0&&(this.extra=this.extra?q(q({},this.extra),{},{metadata:q(q({},this.extra.metadata),o)}):{metadata:o});case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_convertToCreate",value:function(e,t){var n,r,a,i,u=this,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=null!==(n=e.extra)&&void 0!==n?n:{};if(s.runtime||(s.runtime={}),t)for(var c=0,l=Object.entries(t);c<l.length;c++){var d=w(l[c],2),f=d[0],p=d[1];s.runtime[f]||(s.runtime[f]=p)}o?(a=null===(i=e.parent_run)||void 0===i?void 0:i.id,r=[]):(r=e.child_runs.map((function(e){return u._convertToCreate(e,t,o)})),a=void 0);return{id:e.id,name:e.name,start_time:e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:s,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:r,parent_run_id:a,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags,attachments:e.attachments}}},{key:"postRun",value:function(){var e=b(p().mark((function e(){var t,n,r,a,i,u,o=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(o.length>0&&void 0!==o[0])||o[0],e.prev=1,n=zc(),e.next=5,this._convertToCreate(this,n,!0);case 5:return r=e.sent,e.next=8,this.client.createRun(r);case 8:if(t){e.next=27;break}uc("Posting with excludeChildRuns=false is deprecated and will be removed in a future version."),a=G(this.child_runs),e.prev=11,a.s();case 13:if((i=a.n()).done){e.next=19;break}return u=i.value,e.next=17,u.postRun(!1);case 17:e.next=13;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(11),a.e(e.t0);case 24:return e.prev=24,a.f(),e.finish(24);case 27:e.next=32;break;case 29:e.prev=29,e.t1=e.catch(1),console.error("Error in postRun for run ".concat(this.id,":"),e.t1);case 32:case"end":return e.stop()}}),e,this,[[1,29],[11,21,24,27]])})));return function(){return e.apply(this,arguments)}}()},{key:"patchRun",value:function(){var e=b(p().mark((function e(){var t,n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={end_time:this.end_time,error:this.error,inputs:this.inputs,outputs:this.outputs,parent_run_id:null===(t=this.parent_run)||void 0===t?void 0:t.id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags,attachments:this.attachments},e.next=4,this.client.updateRun(this.id,n);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("Error in patchRun for run ".concat(this.id),e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"toJSON",value:function(){return this._convertToCreate(this,void 0,!1)}},{key:"addEvent",value:function(e){var t;(this.events||(this.events=[]),"string"===typeof e)?this.events.push({name:"event",time:(new Date).toISOString(),message:e}):this.events.push(q(q({},e),{},{time:null!==(t=e.time)&&void 0!==t?t:(new Date).toISOString()}))}},{key:"toHeaders",value:function(e){var t,n={"langsmith-trace":this.dotted_order,baggage:new Vc(null===(t=this.extra)||void 0===t?void 0:t.metadata,this.tags).toHeader()};if(e)for(var r=0,a=Object.entries(n);r<a.length;r++){var i=w(a[r],2),u=i[0],o=i[1];e.set(u,o)}return n}}],[{key:"getDefaultConfig",value:function(){var e,t,n;return{id:Gs(),run_type:"chain",project_name:null!==(e=null!==(t=Wc("PROJECT"))&&void 0!==t?t:Zc("LANGCHAIN_SESSION"))&&void 0!==e?e:"default",child_runs:[],api_url:null!==(n=Zc("LANGCHAIN_ENDPOINT"))&&void 0!==n?n:"http://localhost:1984",api_key:Zc("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}},{key:"getSharedClient",value:function(){return e.sharedClient||(e.sharedClient=new jc),e.sharedClient}},{key:"fromRunnableConfig",value:function(t,n){var r,a,i,u,o,s,c,l,d=null===t||void 0===t?void 0:t.callbacks,f=function(e){return void 0!==e?e:!!["TRACING_V2","TRACING"].find((function(e){return"true"===Wc(e)}))}();if(d){var p,h,v,m,g=null!==(p=null===d||void 0===d||null===(h=d.getParentRunId)||void 0===h?void 0:h.call(d))&&void 0!==p?p:"",b=null===d||void 0===d||null===(v=d.handlers)||void 0===v?void 0:v.find((function(e){return"langchain_tracer"==(null===e||void 0===e?void 0:e.name)}));s=null===b||void 0===b||null===(m=b.getRun)||void 0===m?void 0:m.call(b,g),c=null===b||void 0===b?void 0:b.projectName,l=null===b||void 0===b?void 0:b.client,f=f||!!b}return s?new e({name:s.name,id:s.id,trace_id:s.trace_id,dotted_order:s.dotted_order,client:l,tracingEnabled:f,project_name:c,tags:y(new Set((null!==(r=null===(a=s)||void 0===a?void 0:a.tags)&&void 0!==r?r:[]).concat(null!==(i=null===t||void 0===t?void 0:t.tags)&&void 0!==i?i:[]))),extra:{metadata:q(q({},null===(u=s)||void 0===u||null===(o=u.extra)||void 0===o?void 0:o.metadata),null===t||void 0===t?void 0:t.metadata)}}).createChild(n):new e(q(q({},n),{},{client:l,tracingEnabled:f,project_name:c}))}},{key:"fromDottedOrder",value:function(e){return this.fromHeaders({"langsmith-trace":e})}},{key:"fromHeaders",value:function(t,n){var r,a,i,u,o="get"in t&&"function"===typeof t.get?{"langsmith-trace":t.get("langsmith-trace"),baggage:t.get("baggage")}:t,s=o["langsmith-trace"];if(s&&"string"===typeof s){var c=s.trim(),l=c.split(".").map((function(e){var t=w(e.split("Z"),2),n=t[0],r=t[1];return{strTime:n,time:Date.parse(n+"Z"),uuid:r}})),d=l[0].uuid,f=q(q({},n),{},{name:null!==(r=null===n||void 0===n?void 0:n.name)&&void 0!==r?r:"parent",run_type:null!==(a=null===n||void 0===n?void 0:n.run_type)&&void 0!==a?a:"chain",start_time:null!==(i=null===n||void 0===n?void 0:n.start_time)&&void 0!==i?i:Date.now(),id:null===(u=l.at(-1))||void 0===u?void 0:u.uuid,trace_id:d,dotted_order:c});if(o.baggage&&"string"===typeof o.baggage){var p=Vc.fromHeader(o.baggage);f.metadata=p.metadata,f.tags=p.tags}return new e(f)}}}]),e}();function Jc(e){return void 0!==e&&"function"===typeof e.createChild&&"function"===typeof e.postRun}function Kc(e){return"object"===typeof e&&null!=e&&"string"===typeof e.name&&"langchain_tracer"===e.name}function Qc(e){return Array.isArray(e)&&e.some((function(e){return Kc(e)}))}Object.defineProperty($c,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null});var Xc=function(){function e(){T(this,e)}return I(e,[{key:"getStore",value:function(){}},{key:"run",value:function(e,t){return t()}}]),e}(),Yc=Symbol.for("ls:tracing_async_local_storage"),el=new Xc,tl=new(function(){function e(){T(this,e)}return I(e,[{key:"getInstance",value:function(){var e;return null!==(e=globalThis[Yc])&&void 0!==e?e:el}},{key:"initializeGlobalInstance",value:function(e){void 0===globalThis[Yc]&&(globalThis[Yc]=e)}}]),e}());Symbol.for("langsmith:traceable:root");function nl(e){return"function"===typeof e&&"langsmith:traceable"in e}var rl=Object.prototype.hasOwnProperty;function al(e,t){return rl.call(e,t)}function il(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var a in e)al(e,a)&&r.push(a);return r}function ul(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function ol(e){for(var t,n=0,r=e.length;n<r;){if(!((t=e.charCodeAt(n))>=48&&t<=57))return!1;n++}return!0}function sl(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function cl(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function ll(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(ll(e[t]))return!0}else if("object"===typeof e)for(var r=il(e),a=r.length,i=0;i<a;i++)if(ll(e[r[i]]))return!0;return!1}function dl(e,t){var n=[e];for(var r in t){var a="object"===typeof t[r]?JSON.stringify(t[r],null,2):t[r];"undefined"!==typeof a&&n.push("".concat(r,": ").concat(a))}return n.join("\n")}var fl=function(e){B(n,e);var t=z(n);function n(e,r,a,i,u){var o;return T(this,n),o=t.call(this,dl(e,{name:r,index:a,operation:i,tree:u})),Object.defineProperty(N(o),"name",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(N(o),"index",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(N(o),"operation",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(N(o),"tree",{enumerable:!0,configurable:!0,writable:!0,value:u}),Object.setPrototypeOf(N(o),(this instanceof n?this.constructor:void 0).prototype),o.message=dl(e,{name:r,index:a,operation:i,tree:u}),o}return I(n)}(Z(Error)),pl=fl,hl=ul,vl={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=yl(n,this.path);r&&(r=ul(r));var a=gl(n,{op:"remove",path:this.from}).removed;return gl(n,{op:"add",path:this.path,value:a}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=yl(n,this.from);return gl(n,{op:"add",path:this.path,value:ul(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:xl(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},ml={add:function(e,t,n){return ol(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:vl.move,copy:vl.copy,test:vl.test,_get:vl._get};function yl(e,t){if(""==t)return e;var n={op:"_get",path:t};return gl(e,n),n.value}function gl(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(n&&("function"==typeof n?n(t,0,e,t.path):kl(t,0)),""===t.path){var u={newDocument:e};if("add"===t.op)return u.newDocument=t.value,u;if("replace"===t.op)return u.newDocument=t.value,u.removed=e,u;if("move"===t.op||"copy"===t.op)return u.newDocument=yl(e,t.from),"move"===t.op&&(u.removed=e),u;if("test"===t.op){if(u.test=xl(e,t.value),!1===u.test)throw new pl("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return u.newDocument=e,u}if("remove"===t.op)return u.removed=e,u.newDocument=null,u;if("_get"===t.op)return t.value=e,u;if(n)throw new pl("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",i,t,e);return u}r||(e=ul(e));var o,s,c=(t.path||"").split("/"),l=e,d=1,f=c.length,p=void 0;for(s="function"==typeof n?n:kl;;){if((o=c[d])&&-1!=o.indexOf("~")&&(o=cl(o)),a&&("__proto__"==o||"prototype"==o&&d>0&&"constructor"==c[d-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===p&&(void 0===l[o]?p=c.slice(0,d).join("/"):d==f-1&&(p=t.path),void 0!==p&&s(t,0,e,p)),d++,Array.isArray(l)){if("-"===o)o=l.length;else{if(n&&!ol(o))throw new pl("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",i,t,e);ol(o)&&(o=~~o)}if(d>=f){if(n&&"add"===t.op&&o>l.length)throw new pl("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",i,t,e);var h=ml[t.op].call(t,l,o,e);if(!1===h.test)throw new pl("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return h}}else if(d>=f){var v=vl[t.op].call(t,l,o,e);if(!1===v.test)throw new pl("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return v}if(l=l[o],n&&d<f&&(!l||"object"!==typeof l))throw new pl("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",i,t,e)}}function bl(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(n&&!Array.isArray(t))throw new pl("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=ul(e));for(var i=new Array(t.length),u=0,o=t.length;u<o;u++)i[u]=gl(e,t[u],n,!0,a,u),e=i[u].newDocument;return i.newDocument=e,i}function _l(e,t,n){var r=gl(e,t);if(!1===r.test)throw new pl("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function kl(e,t,n,r){if("object"!==typeof e||null===e||Array.isArray(e))throw new pl("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!vl[e.op])throw new pl("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!==typeof e.path)throw new pl("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new pl('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!==typeof e.from)throw new pl("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new pl("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&ll(e.value))throw new pl("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var a=e.path.split("/").length,i=r.split("/").length;if(a!==i+1&&a!==i)throw new pl("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==r)throw new pl("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var u=wl([{op:"_get",path:e.from,value:void 0}],n);if(u&&"OPERATION_PATH_UNRESOLVABLE"===u.name)throw new pl("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function wl(e,t,n){try{if(!Array.isArray(e))throw new pl("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)bl(ul(t),ul(e),n||!0);else{n=n||kl;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(a){if(a instanceof pl)return a;throw a}}function xl(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,r,a,i=Array.isArray(e),u=Array.isArray(t);if(i&&u){if((r=e.length)!=t.length)return!1;for(n=r;0!==n--;)if(!xl(e[n],t[n]))return!1;return!0}if(i!=u)return!1;var o=Object.keys(e);if((r=o.length)!==Object.keys(t).length)return!1;for(n=r;0!==n--;)if(!t.hasOwnProperty(o[n]))return!1;for(n=r;0!==n--;)if(!xl(e[a=o[n]],t[a]))return!1;return!0}return e!==e&&t!==t}new WeakMap;function El(e,t,n,r,a){if(t!==e){"function"===typeof t.toJSON&&(t=t.toJSON());for(var i=il(t),u=il(e),o=!1,s=u.length-1;s>=0;s--){var c=e[d=u[s]];if(!al(t,d)||void 0===t[d]&&void 0!==c&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(a&&n.push({op:"test",path:r+"/"+sl(d),value:ul(c)}),n.push({op:"remove",path:r+"/"+sl(d)}),o=!0):(a&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}),!0);else{var l=t[d];"object"==typeof c&&null!=c&&"object"==typeof l&&null!=l&&Array.isArray(c)===Array.isArray(l)?El(c,l,n,r+"/"+sl(d),a):c!==l&&(!0,a&&n.push({op:"test",path:r+"/"+sl(d),value:ul(c)}),n.push({op:"replace",path:r+"/"+sl(d),value:ul(l)}))}}if(o||i.length!=u.length)for(s=0;s<i.length;s++){var d;al(e,d=i[s])||void 0===t[d]||n.push({op:"add",path:r+"/"+sl(d),value:ul(t[d])})}}}q(q({},e),{},{JsonPatchError:fl,deepClone:ul,escapePathComponent:sl,unescapePathComponent:cl});var Al,Cl=function(){return"undefined"!==typeof Deno},Dl=function(){return"undefined"!==typeof window&&"undefined"!==typeof window.document?"browser":"undefined"===typeof process||"undefined"===typeof process.versions||"undefined"===typeof process.versions.node||Cl()?"object"===typeof globalThis&&globalThis.constructor&&"DedicatedWorkerGlobalScope"===globalThis.constructor.name?"webworker":"undefined"!==typeof window&&"nodejs"===window.name||"undefined"!==typeof navigator&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom"))?"jsdom":Cl()?"deno":"other":"node"};function Sl(){return Ol.apply(this,arguments)}function Ol(){return(Ol=b(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===Al&&(t=Dl(),Al={library:"langchain-js",runtime:t}),e.abrupt("return",Al);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fl(e){try{var t,n;return"undefined"!==typeof process?null===(t={NODE_ENV:"production",PUBLIC_URL:"/detective-infinity",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})||void 0===t?void 0:t[e]:Cl()?null===(n=Deno)||void 0===n?void 0:n.env.get(e):void 0}catch(r){return}}function Pl(e){return"lc_prefer_streaming"in e&&e.lc_prefer_streaming}var Tl=function(e){B(n,e);var t=z(n);function n(e){var r,a,i,u,o,s,c,l;(T(this,n),r=t.call(this),Object.defineProperty(N(r),"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(N(r),"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(r),"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(N(r),"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(N(r),"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(N(r),"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(N(r),"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(N(r),"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(N(r),"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:"false"===Fl("LANGCHAIN_CALLBACKS_BACKGROUND")}),r.lc_kwargs=e||{},e)&&(r.ignoreLLM=null!==(a=e.ignoreLLM)&&void 0!==a?a:r.ignoreLLM,r.ignoreChain=null!==(i=e.ignoreChain)&&void 0!==i?i:r.ignoreChain,r.ignoreAgent=null!==(u=e.ignoreAgent)&&void 0!==u?u:r.ignoreAgent,r.ignoreRetriever=null!==(o=e.ignoreRetriever)&&void 0!==o?o:r.ignoreRetriever,r.ignoreCustomEvent=null!==(s=e.ignoreCustomEvent)&&void 0!==s?s:r.ignoreCustomEvent,r.raiseError=null!==(c=e.raiseError)&&void 0!==c?c:r.raiseError,r.awaitHandlers=r.raiseError||(null!==(l=e._awaitHandler)&&void 0!==l?l:r.awaitHandlers));return r}return I(n,[{key:"lc_namespace",get:function(){return["langchain_core","callbacks",this.name]}},{key:"lc_secrets",get:function(){}},{key:"lc_attributes",get:function(){}},{key:"lc_aliases",get:function(){}},{key:"lc_serializable_keys",get:function(){}},{key:"lc_id",get:function(){return[].concat(y(this.lc_namespace),[Ko(this.constructor)])}},{key:"copy",value:function(){return new this.constructor(this)}},{key:"toJSON",value:function(){return Qo.prototype.toJSON.call(this)}},{key:"toJSONNotImplemented",value:function(){return Qo.prototype.toJSONNotImplemented.call(this)}}],[{key:"lc_name",value:function(){return this.name}},{key:"fromMethods",value:function(e){return new(function(t){B(r,t);var n=z(r);function r(){var t;return T(this,r),t=n.call(this),Object.defineProperty(N(t),"name",{enumerable:!0,configurable:!0,writable:!0,value:Ms()}),Object.assign(N(t),e),t}return I(r)}(n))}}]),n}(I((function e(){T(this,e)})));function jl(e,t){return e&&!Array.isArray(e)&&"object"===typeof e?e:P({},t,e)}function Il(e){return"function"===typeof e._addRunToRunMap}var Nl=function(e){B(n,e);var t=z(n);function n(e){var r;return T(this,n),r=t.apply(this,arguments),Object.defineProperty(N(r),"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),r}return I(n,[{key:"copy",value:function(){return this}},{key:"stringifyError",value:function(e){return e instanceof Error?e.message+(null!==e&&void 0!==e&&e.stack?"\n\n".concat(e.stack):""):"string"===typeof e?e:"".concat(e)}},{key:"_addChildRun",value:function(e,t){e.child_runs.push(t)}},{key:"_addRunToRunMap",value:function(e){var t=function(e,t,n){var r=n.toFixed(0).slice(0,3).padStart(3,"0");return"".concat(new Date(e).toISOString().slice(0,-1)).concat(r,"Z").replace(/[-:.]/g,"")+t}(e.start_time,e.id,e.execution_order),n=q({},e);if(void 0!==n.parent_run_id){var r=this.runMap.get(n.parent_run_id);r&&(this._addChildRun(r,n),r.child_execution_order=Math.max(r.child_execution_order,n.child_execution_order),n.trace_id=r.trace_id,void 0!==r.dotted_order&&(n.dotted_order=[r.dotted_order,t].join(".")))}else n.trace_id=n.id,n.dotted_order=t;return this.runMap.set(n.id,n),n}},{key:"_endTrace",value:function(){var e=b(p().mark((function e(t){var n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=void 0!==t.parent_run_id&&this.runMap.get(t.parent_run_id))){e.next=5;break}r.child_execution_order=Math.max(r.child_execution_order,t.child_execution_order),e.next=7;break;case 5:return e.next=7,this.persistRun(t);case 7:return this.runMap.delete(t.id),e.next=10,null===(n=this.onRunUpdate)||void 0===n?void 0:n.call(this,t);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getExecutionOrder",value:function(e){var t=void 0!==e&&this.runMap.get(e);return t?t.child_execution_order+1:1}},{key:"_createRunForLLMStart",value:function(e,t,n,r,a,i,u,o){var s=this._getExecutionOrder(r),c=Date.now(),l=u?q(q({},a),{},{metadata:u}):a,d={id:n,name:null!==o&&void 0!==o?o:e.id[e.id.length-1],parent_run_id:r,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{prompts:t},execution_order:s,child_runs:[],child_execution_order:s,run_type:"llm",extra:null!==l&&void 0!==l?l:{},tags:i||[]};return this._addRunToRunMap(d)}},{key:"handleLLMStart",value:function(){var e=b(p().mark((function e(t,n,r,a,i,u,o,s){var c,l,d,f;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f=null!==(c=this.runMap.get(r))&&void 0!==c?c:this._createRunForLLMStart(t,n,r,a,i,u,o,s),e.next=3,null===(l=this.onRunCreate)||void 0===l?void 0:l.call(this,f);case 3:return e.next=5,null===(d=this.onLLMStart)||void 0===d?void 0:d.call(this,f);case 5:return e.abrupt("return",f);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i,u,o,s){return e.apply(this,arguments)}}()},{key:"_createRunForChatModelStart",value:function(e,t,n,r,a,i,u,o){var s=this._getExecutionOrder(r),c=Date.now(),l=u?q(q({},a),{},{metadata:u}):a,d={id:n,name:null!==o&&void 0!==o?o:e.id[e.id.length-1],parent_run_id:r,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{messages:t},execution_order:s,child_runs:[],child_execution_order:s,run_type:"llm",extra:null!==l&&void 0!==l?l:{},tags:i||[]};return this._addRunToRunMap(d)}},{key:"handleChatModelStart",value:function(){var e=b(p().mark((function e(t,n,r,a,i,u,o,s){var c,l,d,f;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f=null!==(c=this.runMap.get(r))&&void 0!==c?c:this._createRunForChatModelStart(t,n,r,a,i,u,o,s),e.next=3,null===(l=this.onRunCreate)||void 0===l?void 0:l.call(this,f);case 3:return e.next=5,null===(d=this.onLLMStart)||void 0===d?void 0:d.call(this,f);case 5:return e.abrupt("return",f);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i,u,o,s){return e.apply(this,arguments)}}()},{key:"handleLLMEnd",value:function(){var e=b(p().mark((function e(t,n,r,a,i){var u,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o=this.runMap.get(n))&&"llm"===(null===o||void 0===o?void 0:o.run_type)){e.next=3;break}throw new Error("No LLM run to end.");case 3:return o.end_time=Date.now(),o.outputs=t,o.events.push({name:"end",time:new Date(o.end_time).toISOString()}),o.extra=q(q({},o.extra),i),e.next=9,null===(u=this.onLLMEnd)||void 0===u?void 0:u.call(this,o);case 9:return e.next=11,this._endTrace(o);case 11:return e.abrupt("return",o);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()},{key:"handleLLMError",value:function(){var e=b(p().mark((function e(t,n,r,a,i){var u,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o=this.runMap.get(n))&&"llm"===(null===o||void 0===o?void 0:o.run_type)){e.next=3;break}throw new Error("No LLM run to end.");case 3:return o.end_time=Date.now(),o.error=this.stringifyError(t),o.events.push({name:"error",time:new Date(o.end_time).toISOString()}),o.extra=q(q({},o.extra),i),e.next=9,null===(u=this.onLLMError)||void 0===u?void 0:u.call(this,o);case 9:return e.next=11,this._endTrace(o);case 11:return e.abrupt("return",o);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()},{key:"_createRunForChainStart",value:function(e,t,n,r,a,i,u,o){var s=this._getExecutionOrder(r),c=Date.now(),l={id:n,name:null!==o&&void 0!==o?o:e.id[e.id.length-1],parent_run_id:r,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:t,execution_order:s,child_execution_order:s,run_type:null!==u&&void 0!==u?u:"chain",child_runs:[],extra:i?{metadata:i}:{},tags:a||[]};return this._addRunToRunMap(l)}},{key:"handleChainStart",value:function(){var e=b(p().mark((function e(t,n,r,a,i,u,o,s){var c,l,d,f;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f=null!==(c=this.runMap.get(r))&&void 0!==c?c:this._createRunForChainStart(t,n,r,a,i,u,o,s),e.next=3,null===(l=this.onRunCreate)||void 0===l?void 0:l.call(this,f);case 3:return e.next=5,null===(d=this.onChainStart)||void 0===d?void 0:d.call(this,f);case 5:return e.abrupt("return",f);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i,u,o,s){return e.apply(this,arguments)}}()},{key:"handleChainEnd",value:function(){var e=b(p().mark((function e(t,n,r,a,i){var u,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.runMap.get(n)){e.next=3;break}throw new Error("No chain run to end.");case 3:return o.end_time=Date.now(),o.outputs=jl(t,"output"),o.events.push({name:"end",time:new Date(o.end_time).toISOString()}),void 0!==(null===i||void 0===i?void 0:i.inputs)&&(o.inputs=jl(i.inputs,"input")),e.next=9,null===(u=this.onChainEnd)||void 0===u?void 0:u.call(this,o);case 9:return e.next=11,this._endTrace(o);case 11:return e.abrupt("return",o);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()},{key:"handleChainError",value:function(){var e=b(p().mark((function e(t,n,r,a,i){var u,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.runMap.get(n)){e.next=3;break}throw new Error("No chain run to end.");case 3:return o.end_time=Date.now(),o.error=this.stringifyError(t),o.events.push({name:"error",time:new Date(o.end_time).toISOString()}),void 0!==(null===i||void 0===i?void 0:i.inputs)&&(o.inputs=jl(i.inputs,"input")),e.next=9,null===(u=this.onChainError)||void 0===u?void 0:u.call(this,o);case 9:return e.next=11,this._endTrace(o);case 11:return e.abrupt("return",o);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()},{key:"_createRunForToolStart",value:function(e,t,n,r,a,i,u){var o=this._getExecutionOrder(r),s=Date.now(),c={id:n,name:null!==u&&void 0!==u?u:e.id[e.id.length-1],parent_run_id:r,start_time:s,serialized:e,events:[{name:"start",time:new Date(s).toISOString()}],inputs:{input:t},execution_order:o,child_execution_order:o,run_type:"tool",child_runs:[],extra:i?{metadata:i}:{},tags:a||[]};return this._addRunToRunMap(c)}},{key:"handleToolStart",value:function(){var e=b(p().mark((function e(t,n,r,a,i,u,o){var s,c,l,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=null!==(s=this.runMap.get(r))&&void 0!==s?s:this._createRunForToolStart(t,n,r,a,i,u,o),e.next=3,null===(c=this.onRunCreate)||void 0===c?void 0:c.call(this,d);case 3:return e.next=5,null===(l=this.onToolStart)||void 0===l?void 0:l.call(this,d);case 5:return e.abrupt("return",d);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i,u,o){return e.apply(this,arguments)}}()},{key:"handleToolEnd",value:function(){var e=b(p().mark((function e(t,n){var r,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=this.runMap.get(n))&&"tool"===(null===a||void 0===a?void 0:a.run_type)){e.next=3;break}throw new Error("No tool run to end");case 3:return a.end_time=Date.now(),a.outputs={output:t},a.events.push({name:"end",time:new Date(a.end_time).toISOString()}),e.next=8,null===(r=this.onToolEnd)||void 0===r?void 0:r.call(this,a);case 8:return e.next=10,this._endTrace(a);case 10:return e.abrupt("return",a);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleToolError",value:function(){var e=b(p().mark((function e(t,n){var r,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=this.runMap.get(n))&&"tool"===(null===a||void 0===a?void 0:a.run_type)){e.next=3;break}throw new Error("No tool run to end");case 3:return a.end_time=Date.now(),a.error=this.stringifyError(t),a.events.push({name:"error",time:new Date(a.end_time).toISOString()}),e.next=8,null===(r=this.onToolError)||void 0===r?void 0:r.call(this,a);case 8:return e.next=10,this._endTrace(a);case 10:return e.abrupt("return",a);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleAgentAction",value:function(){var e=b(p().mark((function e(t,n){var r,a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=this.runMap.get(n))&&"chain"===(null===a||void 0===a?void 0:a.run_type)){e.next=3;break}return e.abrupt("return");case 3:return(i=a).actions=i.actions||[],i.actions.push(t),i.events.push({name:"agent_action",time:(new Date).toISOString(),kwargs:{action:t}}),e.next=9,null===(r=this.onAgentAction)||void 0===r?void 0:r.call(this,a);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleAgentEnd",value:function(){var e=b(p().mark((function e(t,n){var r,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=this.runMap.get(n))&&"chain"===(null===a||void 0===a?void 0:a.run_type)){e.next=3;break}return e.abrupt("return");case 3:return a.events.push({name:"agent_end",time:(new Date).toISOString(),kwargs:{action:t}}),e.next=6,null===(r=this.onAgentEnd)||void 0===r?void 0:r.call(this,a);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_createRunForRetrieverStart",value:function(e,t,n,r,a,i,u){var o=this._getExecutionOrder(r),s=Date.now(),c={id:n,name:null!==u&&void 0!==u?u:e.id[e.id.length-1],parent_run_id:r,start_time:s,serialized:e,events:[{name:"start",time:new Date(s).toISOString()}],inputs:{query:t},execution_order:o,child_execution_order:o,run_type:"retriever",child_runs:[],extra:i?{metadata:i}:{},tags:a||[]};return this._addRunToRunMap(c)}},{key:"handleRetrieverStart",value:function(){var e=b(p().mark((function e(t,n,r,a,i,u,o){var s,c,l,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=null!==(s=this.runMap.get(r))&&void 0!==s?s:this._createRunForRetrieverStart(t,n,r,a,i,u,o),e.next=3,null===(c=this.onRunCreate)||void 0===c?void 0:c.call(this,d);case 3:return e.next=5,null===(l=this.onRetrieverStart)||void 0===l?void 0:l.call(this,d);case 5:return e.abrupt("return",d);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i,u,o){return e.apply(this,arguments)}}()},{key:"handleRetrieverEnd",value:function(){var e=b(p().mark((function e(t,n){var r,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=this.runMap.get(n))&&"retriever"===(null===a||void 0===a?void 0:a.run_type)){e.next=3;break}throw new Error("No retriever run to end");case 3:return a.end_time=Date.now(),a.outputs={documents:t},a.events.push({name:"end",time:new Date(a.end_time).toISOString()}),e.next=8,null===(r=this.onRetrieverEnd)||void 0===r?void 0:r.call(this,a);case 8:return e.next=10,this._endTrace(a);case 10:return e.abrupt("return",a);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleRetrieverError",value:function(){var e=b(p().mark((function e(t,n){var r,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=this.runMap.get(n))&&"retriever"===(null===a||void 0===a?void 0:a.run_type)){e.next=3;break}throw new Error("No retriever run to end");case 3:return a.end_time=Date.now(),a.error=this.stringifyError(t),a.events.push({name:"error",time:new Date(a.end_time).toISOString()}),e.next=8,null===(r=this.onRetrieverError)||void 0===r?void 0:r.call(this,a);case 8:return e.next=10,this._endTrace(a);case 10:return e.abrupt("return",a);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleText",value:function(){var e=b(p().mark((function e(t,n){var r,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=this.runMap.get(n))&&"chain"===(null===a||void 0===a?void 0:a.run_type)){e.next=3;break}return e.abrupt("return");case 3:return a.events.push({name:"text",time:(new Date).toISOString(),kwargs:{text:t}}),e.next=6,null===(r=this.onText)||void 0===r?void 0:r.call(this,a);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleLLMNewToken",value:function(){var e=b(p().mark((function e(t,n,r,a,i,u){var o,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((s=this.runMap.get(r))&&"llm"===(null===s||void 0===s?void 0:s.run_type)){e.next=3;break}throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');case 3:return s.events.push({name:"new_token",time:(new Date).toISOString(),kwargs:{token:t,idx:n,chunk:null===u||void 0===u?void 0:u.chunk}}),e.next=6,null===(o=this.onLLMNewToken)||void 0===o?void 0:o.call(this,s,t,{chunk:null===u||void 0===u?void 0:u.chunk});case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i,u){return e.apply(this,arguments)}}()}]),n}(Tl),Rl=n(7290);function Bl(e,t){return"".concat(e.open).concat(t).concat(e.close)}function Ll(e,t){try{return JSON.stringify(e,null,2)}catch(n){return t}}function Ml(e){return"string"===typeof e?e.trim():null===e||void 0===e?e:Ll(e,e.toString())}function Ul(e){if(!e.end_time)return"";var t=e.end_time-e.start_time;return t<1e3?"".concat(t,"ms"):"".concat((t/1e3).toFixed(2),"s")}var zl,Hl,Zl=Rl.color,Wl=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),e=t.apply(this,arguments),Object.defineProperty(N(e),"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"}),e}return I(n,[{key:"persistRun",value:function(e){return Promise.resolve()}},{key:"getParents",value:function(e){for(var t=[],n=e;n.parent_run_id;){var r=this.runMap.get(n.parent_run_id);if(!r)break;t.push(r),n=r}return t}},{key:"getBreadcrumbs",value:function(e){var t=this.getParents(e).reverse(),n=[].concat(y(t),[e]).map((function(e,t,n){var r="".concat(e.execution_order,":").concat(e.run_type,":").concat(e.name);return t===n.length-1?Bl(Rl.bold,r):r})).join(" > ");return Bl(Zl.grey,n)}},{key:"onChainStart",value:function(e){var t=this.getBreadcrumbs(e);console.log("".concat(Bl(Zl.green,"[chain/start]")," [").concat(t,"] Entering Chain run with input: ").concat(Ll(e.inputs,"[inputs]")))}},{key:"onChainEnd",value:function(e){var t=this.getBreadcrumbs(e);console.log("".concat(Bl(Zl.cyan,"[chain/end]")," [").concat(t,"] [").concat(Ul(e),"] Exiting Chain run with output: ").concat(Ll(e.outputs,"[outputs]")))}},{key:"onChainError",value:function(e){var t=this.getBreadcrumbs(e);console.log("".concat(Bl(Zl.red,"[chain/error]")," [").concat(t,"] [").concat(Ul(e),"] Chain run errored with error: ").concat(Ll(e.error,"[error]")))}},{key:"onLLMStart",value:function(e){var t=this.getBreadcrumbs(e),n="prompts"in e.inputs?{prompts:e.inputs.prompts.map((function(e){return e.trim()}))}:e.inputs;console.log("".concat(Bl(Zl.green,"[llm/start]")," [").concat(t,"] Entering LLM run with input: ").concat(Ll(n,"[inputs]")))}},{key:"onLLMEnd",value:function(e){var t=this.getBreadcrumbs(e);console.log("".concat(Bl(Zl.cyan,"[llm/end]")," [").concat(t,"] [").concat(Ul(e),"] Exiting LLM run with output: ").concat(Ll(e.outputs,"[response]")))}},{key:"onLLMError",value:function(e){var t=this.getBreadcrumbs(e);console.log("".concat(Bl(Zl.red,"[llm/error]")," [").concat(t,"] [").concat(Ul(e),"] LLM run errored with error: ").concat(Ll(e.error,"[error]")))}},{key:"onToolStart",value:function(e){var t=this.getBreadcrumbs(e);console.log("".concat(Bl(Zl.green,"[tool/start]")," [").concat(t,'] Entering Tool run with input: "').concat(Ml(e.inputs.input),'"'))}},{key:"onToolEnd",value:function(e){var t,n=this.getBreadcrumbs(e);console.log("".concat(Bl(Zl.cyan,"[tool/end]")," [").concat(n,"] [").concat(Ul(e),'] Exiting Tool run with output: "').concat(Ml(null===(t=e.outputs)||void 0===t?void 0:t.output),'"'))}},{key:"onToolError",value:function(e){var t=this.getBreadcrumbs(e);console.log("".concat(Bl(Zl.red,"[tool/error]")," [").concat(t,"] [").concat(Ul(e),"] Tool run errored with error: ").concat(Ll(e.error,"[error]")))}},{key:"onRetrieverStart",value:function(e){var t=this.getBreadcrumbs(e);console.log("".concat(Bl(Zl.green,"[retriever/start]")," [").concat(t,"] Entering Retriever run with input: ").concat(Ll(e.inputs,"[inputs]")))}},{key:"onRetrieverEnd",value:function(e){var t=this.getBreadcrumbs(e);console.log("".concat(Bl(Zl.cyan,"[retriever/end]")," [").concat(t,"] [").concat(Ul(e),"] Exiting Retriever run with output: ").concat(Ll(e.outputs,"[outputs]")))}},{key:"onRetrieverError",value:function(e){var t=this.getBreadcrumbs(e);console.log("".concat(Bl(Zl.red,"[retriever/error]")," [").concat(t,"] [").concat(Ul(e),"] Retriever run errored with error: ").concat(Ll(e.error,"[error]")))}},{key:"onAgentAction",value:function(e){var t=e,n=this.getBreadcrumbs(e);console.log("".concat(Bl(Zl.blue,"[agent/action]")," [").concat(n,"] Agent selected action: ").concat(Ll(t.actions[t.actions.length-1],"[action]")))}}]),n}(Nl),ql=function(e){B(n,e);var t=z(n);function n(){var e,r,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};T(this,n),r=t.call(this,a),Object.defineProperty(N(r),"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(N(r),"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(r),"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(r),"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});var i=a.exampleId,u=a.projectName,o=a.client;r.projectName=null!==(e=null!==u&&void 0!==u?u:Fl("LANGCHAIN_PROJECT"))&&void 0!==e?e:Fl("LANGCHAIN_SESSION"),r.exampleId=i,r.client=null!==o&&void 0!==o?o:function(){if(void 0===zl){var e="false"===Fl("LANGCHAIN_CALLBACKS_BACKGROUND")?{blockOnRootRunFinalization:!0}:{};zl=new jc(e)}return zl}();var s=n.getTraceableRunTree();return s&&r.updateFromRunTree(s),r}return I(n,[{key:"_convertToCreate",value:function(){var e=b(p().mark((function e(t){var n,r=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:void 0,e.t0=q,e.t1=q({},t),e.t2={},e.t3=q,e.t4=q({},t.extra),e.t5={},e.next=9,Sl();case 9:return e.t6=e.sent,e.t7={runtime:e.t6},e.t8=(0,e.t3)(e.t4,e.t5,e.t7),e.t9=void 0,e.t10=this.projectName,e.t11=t.parent_run_id?void 0:n,e.t12={extra:e.t8,child_runs:e.t9,session_name:e.t10,reference_example_id:e.t11},e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t12));case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"persistRun",value:function(){var e=b(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"onRunCreate",value:function(){var e=b(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._convertToCreate(t,this.exampleId);case 2:return n=e.sent,e.next=5,this.client.createRun(n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onRunUpdate",value:function(){var e=b(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={end_time:t.end_time,error:t.error,outputs:t.outputs,events:t.events,inputs:t.inputs,trace_id:t.trace_id,dotted_order:t.dotted_order,parent_run_id:t.parent_run_id,extra:t.extra},e.next=3,this.client.updateRun(t.id,n);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getRun",value:function(e){return this.runMap.get(e)}},{key:"updateFromRunTree",value:function(e){for(var t,n,r,a=e,i=new Set;a.parent_run&&!i.has(a.id)&&(i.add(a.id),a.parent_run);)a=a.parent_run;i.clear();for(var u=[a];u.length>0;){var o=u.shift();o&&!i.has(o.id)&&(i.add(o.id),this.runMap.set(o.id,o),o.child_runs&&u.push.apply(u,y(o.child_runs)))}this.client=null!==(t=e.client)&&void 0!==t?t:this.client,this.projectName=null!==(n=e.project_name)&&void 0!==n?n:this.projectName,this.exampleId=null!==(r=e.reference_example_id)&&void 0!==r?r:this.exampleId}},{key:"convertToRunTree",value:function(e){var t,n={},r=[],a=G(this.runMap);try{for(a.s();!(t=a.n()).done;){var i=w(t.value,2),u=i[0],o=i[1],s=new $c(q(q({},o),{},{child_runs:[],parent_run:void 0,client:this.client,project_name:this.projectName,reference_example_id:this.exampleId,tracingEnabled:!0}));n[u]=s,r.push([u,o.dotted_order])}}catch(v){a.e(v)}finally{a.f()}r.sort((function(e,t){return e[1]&&t[1]?e[1].localeCompare(t[1]):0}));for(var c=0,l=r;c<l.length;c++){var d=w(l[c],1)[0],f=this.runMap.get(d),p=n[d];if(f&&p&&f.parent_run_id){var h=n[f.parent_run_id];h&&(h.child_runs.push(p),p.parent_run=h)}}return n[e]}}],[{key:"getTraceableRunTree",value:function(){try{return function(){var e=tl.getInstance().getStore();if(!Jc(e))throw new Error(["Could not get the current run tree.","","Please make sure you are calling this method within a traceable function and that tracing is enabled."].join("\n"));return e}()}catch(e){return}}}]),n}(Nl),Gl=Symbol.for("ls:tracing_async_local_storage"),Vl=Symbol.for("lc:context_variables"),$l=function(){return globalThis[Gl]};function Jl(){return"undefined"===typeof Hl&&(Hl=new(0,Vs.default)({autoStart:!0,concurrency:1})),Hl}function Kl(e,t){return Ql.apply(this,arguments)}function Ql(){return(Ql=b(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==n){e.next=11;break}if(void 0===(r=$l())){e.next=7;break}return e.next=5,r.run(void 0,b(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t());case 1:case"end":return e.stop()}}),e)}))));case 5:e.next=9;break;case 7:return e.next=9,t();case 9:e.next=13;break;case 11:(Hl=Jl()).add(b(p().mark((function e(){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(n=$l())){e.next=6;break}return e.next=4,n.run(void 0,b(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t());case 1:case"end":return e.stop()}}),e)}))));case 4:e.next=8;break;case 6:return e.next=8,t();case 8:case"end":return e.stop()}}),e)}))));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xl(e){var t,n=$l();if(void 0!==n){var r=n.getStore();return null===r||void 0===r||null===(t=r[Vl])||void 0===t?void 0:t[e]}}var Yl=Symbol("lc:configure_hooks"),ed=function(){return Xl(Yl)||[]};function td(e){return e?Array.isArray(e)||"name"in e?{callbacks:e}:e:{}}var nd=function(){function e(){T(this,e)}return I(e,[{key:"setHandler",value:function(e){return this.setHandlers([e])}}]),e}(),rd=function(){function e(t,n,r,a,i,u,o,s){T(this,e),Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:u}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:s})}return I(e,[{key:"parentRunId",get:function(){return this._parentRunId}},{key:"handleText",value:function(){var e=b(p().mark((function e(t){var n=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.handlers.map((function(e){return Kl(b(p().mark((function r(){var a;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,null===(a=e.handleText)||void 0===a?void 0:a.call(e,t,n.runId,n._parentRunId,n.tags);case 3:r.next=11;break;case 5:if(r.prev=5,r.t0=r.catch(0),(e.raiseError?console.error:console.warn)("Error in handler ".concat(e.constructor.name,", handleText: ").concat(r.t0)),!e.raiseError){r.next=11;break}throw r.t0;case 11:case"end":return r.stop()}}),r,null,[[0,5]])}))),e.awaitHandlers)})));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleCustomEvent",value:function(){var e=b(p().mark((function e(t,n,r,a,i){var u=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.handlers.map((function(e){return Kl(b(p().mark((function r(){var a;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,null===(a=e.handleCustomEvent)||void 0===a?void 0:a.call(e,t,n,u.runId,u.tags,u.metadata);case 3:r.next=11;break;case 5:if(r.prev=5,r.t0=r.catch(0),(e.raiseError?console.error:console.warn)("Error in handler ".concat(e.constructor.name,", handleCustomEvent: ").concat(r.t0)),!e.raiseError){r.next=11;break}throw r.t0;case 11:case"end":return r.stop()}}),r,null,[[0,5]])}))),e.awaitHandlers)})));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()}]),e}(),ad=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"getChild",value:function(e){var t=new sd(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}},{key:"handleRetrieverEnd",value:function(){var e=b(p().mark((function e(t){var n=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.handlers.map((function(e){return Kl(b(p().mark((function r(){var a;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.ignoreRetriever){r.next=12;break}return r.prev=1,r.next=4,null===(a=e.handleRetrieverEnd)||void 0===a?void 0:a.call(e,t,n.runId,n._parentRunId,n.tags);case 4:r.next=12;break;case 6:if(r.prev=6,r.t0=r.catch(1),(e.raiseError?console.error:console.warn)("Error in handler ".concat(e.constructor.name,", handleRetriever")),!e.raiseError){r.next=12;break}throw r.t0;case 12:case"end":return r.stop()}}),r,null,[[1,6]])}))),e.awaitHandlers)})));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleRetrieverError",value:function(){var e=b(p().mark((function e(t){var n=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.handlers.map((function(e){return Kl(b(p().mark((function r(){var a;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.ignoreRetriever){r.next=12;break}return r.prev=1,r.next=4,null===(a=e.handleRetrieverError)||void 0===a?void 0:a.call(e,t,n.runId,n._parentRunId,n.tags);case 4:r.next=12;break;case 6:if(r.prev=6,r.t0=r.catch(1),(e.raiseError?console.error:console.warn)("Error in handler ".concat(e.constructor.name,", handleRetrieverError: ").concat(r.t0)),!e.raiseError){r.next=12;break}throw t;case 12:case"end":return r.stop()}}),r,null,[[1,6]])}))),e.awaitHandlers)})));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(rd),id=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"handleLLMNewToken",value:function(){var e=b(p().mark((function e(t,n,r,a,i,u){var o=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.handlers.map((function(e){return Kl(b(p().mark((function r(){var a;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.ignoreLLM){r.next=12;break}return r.prev=1,r.next=4,null===(a=e.handleLLMNewToken)||void 0===a?void 0:a.call(e,t,null!==n&&void 0!==n?n:{prompt:0,completion:0},o.runId,o._parentRunId,o.tags,u);case 4:r.next=12;break;case 6:if(r.prev=6,r.t0=r.catch(1),(e.raiseError?console.error:console.warn)("Error in handler ".concat(e.constructor.name,", handleLLMNewToken: ").concat(r.t0)),!e.raiseError){r.next=12;break}throw r.t0;case 12:case"end":return r.stop()}}),r,null,[[1,6]])}))),e.awaitHandlers)})));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i,u){return e.apply(this,arguments)}}()},{key:"handleLLMError",value:function(){var e=b(p().mark((function e(t,n,r,a,i){var u=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.handlers.map((function(e){return Kl(b(p().mark((function n(){var r;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.ignoreLLM){n.next=12;break}return n.prev=1,n.next=4,null===(r=e.handleLLMError)||void 0===r?void 0:r.call(e,t,u.runId,u._parentRunId,u.tags,i);case 4:n.next=12;break;case 6:if(n.prev=6,n.t0=n.catch(1),(e.raiseError?console.error:console.warn)("Error in handler ".concat(e.constructor.name,", handleLLMError: ").concat(n.t0)),!e.raiseError){n.next=12;break}throw n.t0;case 12:case"end":return n.stop()}}),n,null,[[1,6]])}))),e.awaitHandlers)})));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()},{key:"handleLLMEnd",value:function(){var e=b(p().mark((function e(t,n,r,a,i){var u=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.handlers.map((function(e){return Kl(b(p().mark((function n(){var r;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.ignoreLLM){n.next=12;break}return n.prev=1,n.next=4,null===(r=e.handleLLMEnd)||void 0===r?void 0:r.call(e,t,u.runId,u._parentRunId,u.tags,i);case 4:n.next=12;break;case 6:if(n.prev=6,n.t0=n.catch(1),(e.raiseError?console.error:console.warn)("Error in handler ".concat(e.constructor.name,", handleLLMEnd: ").concat(n.t0)),!e.raiseError){n.next=12;break}throw n.t0;case 12:case"end":return n.stop()}}),n,null,[[1,6]])}))),e.awaitHandlers)})));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()}]),n}(rd),ud=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"getChild",value:function(e){var t=new sd(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}},{key:"handleChainError",value:function(){var e=b(p().mark((function e(t,n,r,a,i){var u=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.handlers.map((function(e){return Kl(b(p().mark((function n(){var r;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.ignoreChain){n.next=12;break}return n.prev=1,n.next=4,null===(r=e.handleChainError)||void 0===r?void 0:r.call(e,t,u.runId,u._parentRunId,u.tags,i);case 4:n.next=12;break;case 6:if(n.prev=6,n.t0=n.catch(1),(e.raiseError?console.error:console.warn)("Error in handler ".concat(e.constructor.name,", handleChainError: ").concat(n.t0)),!e.raiseError){n.next=12;break}throw n.t0;case 12:case"end":return n.stop()}}),n,null,[[1,6]])}))),e.awaitHandlers)})));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()},{key:"handleChainEnd",value:function(){var e=b(p().mark((function e(t,n,r,a,i){var u=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.handlers.map((function(e){return Kl(b(p().mark((function n(){var r;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.ignoreChain){n.next=12;break}return n.prev=1,n.next=4,null===(r=e.handleChainEnd)||void 0===r?void 0:r.call(e,t,u.runId,u._parentRunId,u.tags,i);case 4:n.next=12;break;case 6:if(n.prev=6,n.t0=n.catch(1),(e.raiseError?console.error:console.warn)("Error in handler ".concat(e.constructor.name,", handleChainEnd: ").concat(n.t0)),!e.raiseError){n.next=12;break}throw n.t0;case 12:case"end":return n.stop()}}),n,null,[[1,6]])}))),e.awaitHandlers)})));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()},{key:"handleAgentAction",value:function(){var e=b(p().mark((function e(t){var n=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.handlers.map((function(e){return Kl(b(p().mark((function r(){var a;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.ignoreAgent){r.next=12;break}return r.prev=1,r.next=4,null===(a=e.handleAgentAction)||void 0===a?void 0:a.call(e,t,n.runId,n._parentRunId,n.tags);case 4:r.next=12;break;case 6:if(r.prev=6,r.t0=r.catch(1),(e.raiseError?console.error:console.warn)("Error in handler ".concat(e.constructor.name,", handleAgentAction: ").concat(r.t0)),!e.raiseError){r.next=12;break}throw r.t0;case 12:case"end":return r.stop()}}),r,null,[[1,6]])}))),e.awaitHandlers)})));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleAgentEnd",value:function(){var e=b(p().mark((function e(t){var n=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.handlers.map((function(e){return Kl(b(p().mark((function r(){var a;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.ignoreAgent){r.next=12;break}return r.prev=1,r.next=4,null===(a=e.handleAgentEnd)||void 0===a?void 0:a.call(e,t,n.runId,n._parentRunId,n.tags);case 4:r.next=12;break;case 6:if(r.prev=6,r.t0=r.catch(1),(e.raiseError?console.error:console.warn)("Error in handler ".concat(e.constructor.name,", handleAgentEnd: ").concat(r.t0)),!e.raiseError){r.next=12;break}throw r.t0;case 12:case"end":return r.stop()}}),r,null,[[1,6]])}))),e.awaitHandlers)})));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(rd),od=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"getChild",value:function(e){var t=new sd(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}},{key:"handleToolError",value:function(){var e=b(p().mark((function e(t){var n=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.handlers.map((function(e){return Kl(b(p().mark((function r(){var a;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.ignoreAgent){r.next=12;break}return r.prev=1,r.next=4,null===(a=e.handleToolError)||void 0===a?void 0:a.call(e,t,n.runId,n._parentRunId,n.tags);case 4:r.next=12;break;case 6:if(r.prev=6,r.t0=r.catch(1),(e.raiseError?console.error:console.warn)("Error in handler ".concat(e.constructor.name,", handleToolError: ").concat(r.t0)),!e.raiseError){r.next=12;break}throw r.t0;case 12:case"end":return r.stop()}}),r,null,[[1,6]])}))),e.awaitHandlers)})));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleToolEnd",value:function(){var e=b(p().mark((function e(t){var n=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.handlers.map((function(e){return Kl(b(p().mark((function r(){var a;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.ignoreAgent){r.next=12;break}return r.prev=1,r.next=4,null===(a=e.handleToolEnd)||void 0===a?void 0:a.call(e,t,n.runId,n._parentRunId,n.tags);case 4:r.next=12;break;case 6:if(r.prev=6,r.t0=r.catch(1),(e.raiseError?console.error:console.warn)("Error in handler ".concat(e.constructor.name,", handleToolEnd: ").concat(r.t0)),!e.raiseError){r.next=12;break}throw r.t0;case 12:case"end":return r.stop()}}),r,null,[[1,6]])}))),e.awaitHandlers)})));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(rd),sd=function(e){B(n,e);var t=z(n);function n(e,r){var a,i,u,o,s,c,l;return T(this,n),l=t.call(this),Object.defineProperty(N(l),"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(N(l),"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(N(l),"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(N(l),"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(N(l),"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(N(l),"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(N(l),"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(N(l),"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),l.handlers=null!==(a=null===r||void 0===r?void 0:r.handlers)&&void 0!==a?a:l.handlers,l.inheritableHandlers=null!==(i=null===r||void 0===r?void 0:r.inheritableHandlers)&&void 0!==i?i:l.inheritableHandlers,l.tags=null!==(u=null===r||void 0===r?void 0:r.tags)&&void 0!==u?u:l.tags,l.inheritableTags=null!==(o=null===r||void 0===r?void 0:r.inheritableTags)&&void 0!==o?o:l.inheritableTags,l.metadata=null!==(s=null===r||void 0===r?void 0:r.metadata)&&void 0!==s?s:l.metadata,l.inheritableMetadata=null!==(c=null===r||void 0===r?void 0:r.inheritableMetadata)&&void 0!==c?c:l.inheritableMetadata,l._parentRunId=e,l}return I(n,[{key:"getParentRunId",value:function(){return this._parentRunId}},{key:"handleLLMStart",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u=this,o=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]?o[2]:void 0,o.length>3&&void 0!==o[3]?o[3]:void 0,a=o.length>4&&void 0!==o[4]?o[4]:void 0,o.length>5&&void 0!==o[5]?o[5]:void 0,o.length>6&&void 0!==o[6]?o[6]:void 0,i=o.length>7&&void 0!==o[7]?o[7]:void 0,e.abrupt("return",Promise.all(n.map(function(){var e=b(p().mark((function e(n,o){var s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=0===o&&r?r:Ms(),e.next=3,Promise.all(u.handlers.map((function(e){if(!e.ignoreLLM)return Il(e)&&e._createRunForLLMStart(t,[n],s,u._parentRunId,a,u.tags,u.metadata,i),Kl(b(p().mark((function r(){var o;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,null===(o=e.handleLLMStart)||void 0===o?void 0:o.call(e,t,[n],s,u._parentRunId,a,u.tags,u.metadata,i);case 3:r.next=11;break;case 5:if(r.prev=5,r.t0=r.catch(0),(e.raiseError?console.error:console.warn)("Error in handler ".concat(e.constructor.name,", handleLLMStart: ").concat(r.t0)),!e.raiseError){r.next=11;break}throw r.t0;case 11:case"end":return r.stop()}}),r,null,[[0,5]])}))),e.awaitHandlers)})));case 3:return e.abrupt("return",new id(s,u.handlers,u.inheritableHandlers,u.tags,u.inheritableTags,u.metadata,u.inheritableMetadata,u._parentRunId));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleChatModelStart",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u=this,o=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]?o[2]:void 0,o.length>3&&void 0!==o[3]?o[3]:void 0,a=o.length>4&&void 0!==o[4]?o[4]:void 0,o.length>5&&void 0!==o[5]?o[5]:void 0,o.length>6&&void 0!==o[6]?o[6]:void 0,i=o.length>7&&void 0!==o[7]?o[7]:void 0,e.abrupt("return",Promise.all(n.map(function(){var e=b(p().mark((function e(n,o){var s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=0===o&&r?r:Ms(),e.next=3,Promise.all(u.handlers.map((function(e){if(!e.ignoreLLM)return Il(e)&&e._createRunForChatModelStart(t,[n],s,u._parentRunId,a,u.tags,u.metadata,i),Kl(b(p().mark((function r(){var o,c,l;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,!e.handleChatModelStart){r.next=6;break}return r.next=4,null===(o=e.handleChatModelStart)||void 0===o?void 0:o.call(e,t,[n],s,u._parentRunId,a,u.tags,u.metadata,i);case 4:r.next=10;break;case 6:if(!e.handleLLMStart){r.next=10;break}return l=Ds(n),r.next=10,null===(c=e.handleLLMStart)||void 0===c?void 0:c.call(e,t,[l],s,u._parentRunId,a,u.tags,u.metadata,i);case 10:r.next=18;break;case 12:if(r.prev=12,r.t0=r.catch(0),(e.raiseError?console.error:console.warn)("Error in handler ".concat(e.constructor.name,", handleLLMStart: ").concat(r.t0)),!e.raiseError){r.next=18;break}throw r.t0;case 18:case"end":return r.stop()}}),r,null,[[0,12]])}))),e.awaitHandlers)})));case 3:return e.abrupt("return",new id(s,u.handlers,u.inheritableHandlers,u.tags,u.inheritableTags,u.metadata,u.inheritableMetadata,u._parentRunId));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleChainStart",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u=this,o=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]?o[2]:Ms(),a=o.length>3&&void 0!==o[3]?o[3]:void 0,o.length>4&&void 0!==o[4]?o[4]:void 0,o.length>5&&void 0!==o[5]?o[5]:void 0,i=o.length>6&&void 0!==o[6]?o[6]:void 0,e.next=7,Promise.all(this.handlers.map((function(e){if(!e.ignoreChain)return Il(e)&&e._createRunForChainStart(t,n,r,u._parentRunId,u.tags,u.metadata,a,i),Kl(b(p().mark((function o(){var s;return p().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,null===(s=e.handleChainStart)||void 0===s?void 0:s.call(e,t,n,r,u._parentRunId,u.tags,u.metadata,a,i);case 3:o.next=11;break;case 5:if(o.prev=5,o.t0=o.catch(0),(e.raiseError?console.error:console.warn)("Error in handler ".concat(e.constructor.name,", handleChainStart: ").concat(o.t0)),!e.raiseError){o.next=11;break}throw o.t0;case 11:case"end":return o.stop()}}),o,null,[[0,5]])}))),e.awaitHandlers)})));case 7:return e.abrupt("return",new ud(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleToolStart",value:function(){var e=b(p().mark((function e(t,n){var r,a,i=this,u=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>2&&void 0!==u[2]?u[2]:Ms(),u.length>3&&void 0!==u[3]?u[3]:void 0,u.length>4&&void 0!==u[4]?u[4]:void 0,u.length>5&&void 0!==u[5]?u[5]:void 0,a=u.length>6&&void 0!==u[6]?u[6]:void 0,e.next=7,Promise.all(this.handlers.map((function(e){if(!e.ignoreAgent)return Il(e)&&e._createRunForToolStart(t,n,r,i._parentRunId,i.tags,i.metadata,a),Kl(b(p().mark((function u(){var o;return p().wrap((function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,null===(o=e.handleToolStart)||void 0===o?void 0:o.call(e,t,n,r,i._parentRunId,i.tags,i.metadata,a);case 3:u.next=11;break;case 5:if(u.prev=5,u.t0=u.catch(0),(e.raiseError?console.error:console.warn)("Error in handler ".concat(e.constructor.name,", handleToolStart: ").concat(u.t0)),!e.raiseError){u.next=11;break}throw u.t0;case 11:case"end":return u.stop()}}),u,null,[[0,5]])}))),e.awaitHandlers)})));case 7:return e.abrupt("return",new od(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleRetrieverStart",value:function(){var e=b(p().mark((function e(t,n){var r,a,i=this,u=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>2&&void 0!==u[2]?u[2]:Ms(),u.length>3&&void 0!==u[3]?u[3]:void 0,u.length>4&&void 0!==u[4]?u[4]:void 0,u.length>5&&void 0!==u[5]?u[5]:void 0,a=u.length>6&&void 0!==u[6]?u[6]:void 0,e.next=7,Promise.all(this.handlers.map((function(e){if(!e.ignoreRetriever)return Il(e)&&e._createRunForRetrieverStart(t,n,r,i._parentRunId,i.tags,i.metadata,a),Kl(b(p().mark((function u(){var o;return p().wrap((function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,null===(o=e.handleRetrieverStart)||void 0===o?void 0:o.call(e,t,n,r,i._parentRunId,i.tags,i.metadata,a);case 3:u.next=11;break;case 5:if(u.prev=5,u.t0=u.catch(0),(e.raiseError?console.error:console.warn)("Error in handler ".concat(e.constructor.name,", handleRetrieverStart: ").concat(u.t0)),!e.raiseError){u.next=11;break}throw u.t0;case 11:case"end":return u.stop()}}),u,null,[[0,5]])}))),e.awaitHandlers)})));case 7:return e.abrupt("return",new ad(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"handleCustomEvent",value:function(){var e=b(p().mark((function e(t,n,r,a,i){var u=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.handlers.map((function(e){return Kl(b(p().mark((function a(){var i;return p().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.ignoreCustomEvent){a.next=12;break}return a.prev=1,a.next=4,null===(i=e.handleCustomEvent)||void 0===i?void 0:i.call(e,t,n,r,u.tags,u.metadata);case 4:a.next=12;break;case 6:if(a.prev=6,a.t0=a.catch(1),(e.raiseError?console.error:console.warn)("Error in handler ".concat(e.constructor.name,", handleCustomEvent: ").concat(a.t0)),!e.raiseError){a.next=12;break}throw a.t0;case 12:case"end":return a.stop()}}),a,null,[[1,6]])}))),e.awaitHandlers)})));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()},{key:"addHandler",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.handlers.push(e),t&&this.inheritableHandlers.push(e)}},{key:"removeHandler",value:function(e){this.handlers=this.handlers.filter((function(t){return t!==e})),this.inheritableHandlers=this.inheritableHandlers.filter((function(t){return t!==e}))}},{key:"setHandlers",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.handlers=[],this.inheritableHandlers=[];var n,r=G(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;this.addHandler(a,t)}}catch(i){r.e(i)}finally{r.f()}}},{key:"addTags",value:function(e){var t,n,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(this.removeTags(e),(t=this.tags).push.apply(t,y(e)),r)&&(n=this.inheritableTags).push.apply(n,y(e))}},{key:"removeTags",value:function(e){this.tags=this.tags.filter((function(t){return!e.includes(t)})),this.inheritableTags=this.inheritableTags.filter((function(t){return!e.includes(t)}))}},{key:"addMetadata",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.metadata=q(q({},this.metadata),e),t&&(this.inheritableMetadata=q(q({},this.inheritableMetadata),e))}},{key:"removeMetadata",value:function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];delete this.metadata[r],delete this.inheritableMetadata[r]}}},{key:"copy",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=new n(this._parentRunId),i=G(this.handlers);try{for(i.s();!(e=i.n()).done;){var u=e.value,o=this.inheritableHandlers.includes(u);a.addHandler(u,o)}}catch(b){i.e(b)}finally{i.f()}var s,c=G(this.tags);try{for(c.s();!(s=c.n()).done;){var l=s.value,d=this.inheritableTags.includes(l);a.addTags([l],d)}}catch(b){c.e(b)}finally{c.f()}for(var f=0,p=Object.keys(this.metadata);f<p.length;f++){var h=p[f],v=Object.keys(this.inheritableMetadata).includes(h);a.addMetadata(P({},h,this.metadata[h]),v)}var m,y=G(t);try{var g=function(){var e=m.value;if(a.handlers.filter((function(e){return"console_callback_handler"===e.name})).some((function(t){return t.name===e.name})))return"continue";a.addHandler(e,r)};for(y.s();!(m=y.n()).done;)g()}catch(b){y.e(b)}finally{y.f()}return a}}],[{key:"fromHandlers",value:function(e){var t=function(t){B(r,t);var n=z(r);function r(){var t;return T(this,r),t=n.call(this),Object.defineProperty(N(t),"name",{enumerable:!0,configurable:!0,writable:!0,value:Ms()}),Object.assign(N(t),e),t}return I(r)}(Tl),n=new this;return n.addHandler(new t),n}},{key:"configure",value:function(e,t,n,r,a,i,u){return this._configureSync(e,t,n,r,a,i,u)}},{key:"_configureSync",value:function(e,t,r,a,i,u,o){var s,c,l;if(e||t){var d;if(Array.isArray(e)||!e)(l=new n).setHandlers(null!==(d=null===e||void 0===e?void 0:e.map(cd))&&void 0!==d?d:[],!0);else l=e;l=l.copy(Array.isArray(t)?t.map(cd):null===t||void 0===t?void 0:t.handlers,!1)}var f="true"===Fl("LANGCHAIN_VERBOSE")||(null===o||void 0===o?void 0:o.verbose),p=(null===(s=ql.getTraceableRunTree())||void 0===s?void 0:s.tracingEnabled)||function(e){return void 0!==e?e:!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find((function(e){return"true"===Fl(e)}))}(),h=p||null!==(c=Fl("LANGCHAIN_TRACING"))&&void 0!==c&&c;if(f||h){if(l||(l=new n),f&&!l.handlers.some((function(e){return e.name===Wl.prototype.name}))){var v=new Wl;l.addHandler(v,!0)}if(h&&!l.handlers.some((function(e){return"langchain_tracer"===e.name}))&&p){var m,y,g=new ql;l.addHandler(g,!0),l._parentRunId=null!==(m=null===(y=ql.getTraceableRunTree())||void 0===y?void 0:y.id)&&void 0!==m?m:l._parentRunId}}var b,_=G(ed());try{var k=function(){var e,t=b.value,r=t.contextVar,a=t.inheritable,i=void 0===a||a,u=t.handlerClass,o=t.envVar,s=o&&"true"===Fl(o)&&u,c=void 0!==r?Xl(r):void 0;c&&function(e){var t=e;return void 0!==t&&"function"===typeof t.copy&&"string"===typeof t.name&&"boolean"===typeof t.awaitHandlers}(c)?e=c:s&&(e=new u({})),void 0!==e&&(l||(l=new n),l.handlers.some((function(t){return t.name===e.name}))||l.addHandler(e,i))};for(_.s();!(b=_.n()).done;)k()}catch(w){_.e(w)}finally{_.f()}return(r||a)&&l&&(l.addTags(null!==r&&void 0!==r?r:[]),l.addTags(null!==a&&void 0!==a?a:[],!1)),(i||u)&&l&&(l.addMetadata(null!==i&&void 0!==i?i:{}),l.addMetadata(null!==u&&void 0!==u?u:{},!1)),l}}]),n}(nd);function cd(e){return"name"in e?e:Tl.fromMethods(e)}var ld=function(){function e(){T(this,e)}return I(e,[{key:"getStore",value:function(){}},{key:"run",value:function(e,t){return t()}},{key:"enterWith",value:function(e){}}]),e}(),dd=new ld,fd=Symbol.for("lc:child_config"),pd=function(){function e(){T(this,e)}return I(e,[{key:"getInstance",value:function(){var e;return null!==(e=$l())&&void 0!==e?e:dd}},{key:"getRunnableConfig",value:function(){var e,t;return null===(e=this.getInstance().getStore())||void 0===e||null===(t=e.extra)||void 0===t?void 0:t[fd]}},{key:"runWithConfig",value:function(e,t,n){var r,a,i=sd._configureSync(null===e||void 0===e?void 0:e.callbacks,void 0,null===e||void 0===e?void 0:e.tags,void 0,null===e||void 0===e?void 0:e.metadata),u=this.getInstance(),o=u.getStore(),s=null===i||void 0===i?void 0:i.getParentRunId(),c=null===i||void 0===i||null===(r=i.handlers)||void 0===r?void 0:r.find((function(e){return"langchain_tracer"===(null===e||void 0===e?void 0:e.name)}));return c&&s?a=c.convertToRunTree(s):n||(a=new $c({name:"<runnable_lambda>",tracingEnabled:!1})),a&&(a.extra=q(q({},a.extra),{},P({},fd,e))),void 0!==o&&void 0!==o[Vl]&&(void 0===a&&(a={}),a[Vl]=o[Vl]),u.run(a,t)}},{key:"initializeGlobalInstance",value:function(e){void 0===$l()&&function(e){globalThis[Gl]=e}(e)}}]),e}(),hd=new pd,vd=["runId","runName"];function md(e){return yd.apply(this,arguments)}function yd(){return(yd=b(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",sd._configureSync(null===t||void 0===t?void 0:t.callbacks,void 0,null===t||void 0===t?void 0:t.tags,void 0,null===t||void 0===t?void 0:t.metadata));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gd(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a,i=G(n.filter((function(e){return!!e})));try{for(i.s();!(a=i.n()).done;)for(var u=a.value,o=0,s=Object.keys(u);o<s.length;o++){var c=s[o];if("metadata"===c)e[c]=q(q({},e[c]),u[c]);else if("tags"===c){var l,d,f=null!==(l=e[c])&&void 0!==l?l:[];e[c]=y(new Set(f.concat(null!==(d=u[c])&&void 0!==d?d:[])))}else if("configurable"===c)e[c]=q(q({},e[c]),u[c]);else if("timeout"===c)void 0===e.timeout?e.timeout=u.timeout:void 0!==u.timeout&&(e.timeout=Math.min(e.timeout,u.timeout));else if("signal"===c)void 0===e.signal?e.signal=u.signal:void 0!==u.signal&&("any"in AbortSignal?e.signal=AbortSignal.any([e.signal,u.signal]):e.signal=u.signal);else if("callbacks"===c){var p=e.callbacks,h=u.callbacks;if(Array.isArray(h))if(p)if(Array.isArray(p))e.callbacks=p.concat(h);else{var v,m=p.copy(),g=G(h);try{for(g.s();!(v=g.n()).done;){var b=v.value;m.addHandler(cd(b),!0)}}catch(C){g.e(C)}finally{g.f()}e.callbacks=m}else e.callbacks=h;else if(h)if(p)if(Array.isArray(p)){var _,k=h.copy(),w=G(p);try{for(w.s();!(_=w.n()).done;){var x=_.value;k.addHandler(cd(x),!0)}}catch(C){w.e(C)}finally{w.f()}e.callbacks=k}else e.callbacks=new sd(h._parentRunId,{handlers:p.handlers.concat(h.handlers),inheritableHandlers:p.inheritableHandlers.concat(h.inheritableHandlers),tags:Array.from(new Set(p.tags.concat(h.tags))),inheritableTags:Array.from(new Set(p.inheritableTags.concat(h.inheritableTags))),metadata:q(q({},p.metadata),h.metadata)});else e.callbacks=h}else{var E,A=c;e[A]=null!==(E=u[A])&&void 0!==E?E:e[A]}}}catch(C){i.e(C)}finally{i.f()}return e}var bd=new Set(["string","number","boolean"]);function _d(e){var t,n=hd.getRunnableConfig(),r={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(n){n.runId,n.runName;var a=Sn(n,vd);r=Object.entries(a).reduce((function(e,t){var n=w(t,2),r=n[0],a=n[1];return void 0!==a&&(e[r]=a),e}),r)}if(e&&(r=Object.entries(e).reduce((function(e,t){var n=w(t,2),r=n[0],a=n[1];return void 0!==a&&(e[r]=a),e}),r)),null!==(t=r)&&void 0!==t&&t.configurable)for(var i=0,u=Object.keys(r.configurable);i<u.length;i++){var o,s=u[i];!bd.has(typeof r.configurable[s])||null!==(o=r.metadata)&&void 0!==o&&o[s]||(r.metadata||(r.metadata={}),r.metadata[s]=r.configurable[s])}if(void 0!==r.timeout){if(r.timeout<=0)throw new Error("Timeout must be a positive number");var c=AbortSignal.timeout(r.timeout);void 0!==r.signal?"any"in AbortSignal&&(r.signal=AbortSignal.any([r.signal,c])):r.signal=c,delete r.timeout}return r}function kd(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.callbacks,r=t.maxConcurrency,a=t.recursionLimit,i=t.runName,u=t.configurable,o=t.runId,s=_d(e);return void 0!==n&&(delete s.runName,s.callbacks=n),void 0!==a&&(s.recursionLimit=a),void 0!==r&&(s.maxConcurrency=r),void 0!==i&&(s.runName=i),void 0!==u&&(s.configurable=q(q({},s.configurable),u)),void 0!==o&&delete s.runId,s}function wd(e){return e?{configurable:e.configurable,recursionLimit:e.recursionLimit,callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,maxConcurrency:e.maxConcurrency,timeout:e.timeout,signal:e.signal}:void 0}function xd(e,t){return Ed.apply(this,arguments)}function Ed(){return(Ed=b(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==n){e.next=2;break}return e.abrupt("return",t);case 2:return e.abrupt("return",Promise.race([t.catch((function(e){if(null===n||void 0===n||!n.aborted)throw e})),new Promise((function(e,t){r=function(){t(new Error("Aborted"))},n.addEventListener("abort",r),n.aborted&&t(new Error("Aborted"))}))]).finally((function(){return n.removeEventListener("abort",r)})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ad=function(e,t,n){B(a,e);var r=z(a);function a(){var e;return T(this,a),e=r.apply(this,arguments),Object.defineProperty(N(e),"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e}return I(a,[{key:"ensureReader",value:function(){this.reader||(this.reader=this.getReader())}},{key:"next",value:function(){var e=b(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ensureReader(),e.prev=1,e.next=4,this.reader.read();case 4:if(!(t=e.sent).done){e.next=10;break}return this.reader.releaseLock(),e.abrupt("return",{done:!0,value:void 0});case 10:return e.abrupt("return",{done:!1,value:t.value});case 11:e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(1),this.reader.releaseLock(),e.t0;case 17:case"end":return e.stop()}}),e,this,[[1,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"return",value:function(){var e=b(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureReader(),!this.locked){e.next=6;break}return t=this.reader.cancel(),this.reader.releaseLock(),e.next=6,t;case 6:return e.abrupt("return",{done:!0,value:void 0});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"throw",value:function(){var e=b(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureReader(),!this.locked){e.next=6;break}return n=this.reader.cancel(),this.reader.releaseLock(),e.next=6,n;case 6:throw t;case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:t,value:function(){return this}},{key:n,value:function(){var e=b(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.return();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"fromReadableStream",value:function(e){var t=e.getReader();return new a({start:function(e){return function n(){return t.read().then((function(t){var r=t.done,a=t.value;if(!r)return e.enqueue(a),n();e.close()}))}()},cancel:function(){t.releaseLock()}})}},{key:"fromAsyncGenerator",value:function(e){return new a({pull:function(t){return b(p().mark((function n(){var r,a;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.next();case 2:r=n.sent,a=r.value,r.done&&t.close(),t.enqueue(a);case 7:case"end":return n.stop()}}),n)})))()},cancel:function(t){return b(p().mark((function n(){return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.return(t);case 2:case"end":return n.stop()}}),n)})))()}})}}]),a}(Z(ReadableStream),Symbol.asyncIterator,Symbol.asyncDispose);function Cd(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=Array.from({length:t},(function(){return[]}));return n.map(function(){var t=An(p().mark((function t(r){var a,i,u;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==r.length){t.next=8;break}return t.next=4,xn(e.next());case 4:for(a=t.sent,i=0,u=n;i<u.length;i++)u[i].push(a);t.next=14;break;case 8:if(!r[0].done){t.next=12;break}return t.abrupt("return");case 12:return t.next=14,r.shift().value;case 14:t.next=0;break;case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}function Dd(e,t){if(Array.isArray(e)&&Array.isArray(t))return e.concat(t);if("string"===typeof e&&"string"===typeof t)return e+t;if("number"===typeof e&&"number"===typeof t)return e+t;if("concat"in e&&"function"===typeof e.concat)return e.concat(t);if("object"===typeof e&&"object"===typeof t){for(var n=q({},e),r=0,a=Object.entries(t);r<a.length;r++){var i=w(a[r],2),u=i[0],o=i[1];u in n&&!Array.isArray(n[u])?n[u]=Dd(n[u],o):n[u]=o}return n}throw new Error("Cannot concat ".concat(typeof e," and ").concat(typeof t))}var Sd=function(e,t){function n(e){var t,r,a=this;T(this,n),Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=null!==(t=e.signal)&&void 0!==t?t:null===(r=this.config)||void 0===r?void 0:r.signal,this.setup=new Promise((function(t,n){hd.runWithConfig(wd(e.config),b(p().mark((function r(){return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:a.firstResult=e.generator.next(),e.startSetup?a.firstResult.then(e.startSetup).then(t,n):a.firstResult.then((function(e){return t(void 0)}),n);case 2:case"end":return r.stop()}}),r)}))),!0)}))}return I(n,[{key:"next",value:function(){var e=b(p().mark((function e(){var t,n,r,a,i=this,u=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=u.length,r=new Array(n),a=0;a<n;a++)r[a]=u[a];if(null===(t=this.signal)||void 0===t||t.throwIfAborted(),this.firstResultUsed){e.next=5;break}return this.firstResultUsed=!0,e.abrupt("return",this.firstResult);case 5:return e.abrupt("return",hd.runWithConfig(wd(this.config),this.signal?b(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",xd((t=i.generator).next.apply(t,r),i.signal));case 1:case"end":return e.stop()}}),e)}))):b(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(t=i.generator).next.apply(t,r));case 1:case"end":return e.stop()}}),e)}))),!0));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"return",value:function(){var e=b(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.generator.return(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"throw",value:function(){var e=b(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.generator.throw(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:e,value:function(){return this}},{key:t,value:function(){var e=b(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.return();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Symbol.asyncIterator,Symbol.asyncDispose);function Od(e,t,n,r){return Fd.apply(this,arguments)}function Fd(){return Fd=b(p().mark((function e(t,n,r,a){var i,u,o,s,c,l=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new Sd({generator:n,startSetup:r,signal:a}),e.next=3,i.setup;case 3:for(u=e.sent,o=l.length,s=new Array(o>4?o-4:0),c=4;c<o;c++)s[c-4]=l[c];return e.abrupt("return",{output:t.apply(void 0,[i,u].concat(s)),setup:u});case 6:case"end":return e.stop()}}),e)}))),Fd.apply(this,arguments)}var Pd=function(){function e(t){var n;T(this,e),Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=null!==(n=t.ops)&&void 0!==n?n:[]}return I(e,[{key:"concat",value:function(e){var t=this.ops.concat(e.ops),n=bl({},t);return new Td({ops:t,state:n[n.length-1].newDocument})}}]),e}(),Td=function(e){B(n,e);var t=z(n);function n(e){var r;return T(this,n),r=t.call(this,e),Object.defineProperty(N(r),"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.state=e.state,r}return I(n,[{key:"concat",value:function(e){var t=this.ops.concat(e.ops),r=bl(this.state,e.ops);return new n({ops:t,state:r[r.length-1].newDocument})}}],[{key:"fromRunLogPatch",value:function(e){var t=bl({},e.ops);return new n({ops:e.ops,state:t[t.length-1].newDocument})}}]),n}(Pd),jd=function(e){return"log_stream_tracer"===e.name};function Id(e,t){return Nd.apply(this,arguments)}function Nd(){return(Nd=b(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("original"!==n){e.next=2;break}throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");case 2:if(r=t.inputs,!["retriever","llm","prompt"].includes(t.run_type)){e.next=5;break}return e.abrupt("return",r);case 5:if(1!==Object.keys(r).length||""!==(null===r||void 0===r?void 0:r.input)){e.next=7;break}return e.abrupt("return",void 0);case 7:return e.abrupt("return",r.input);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Rd(e,t){return Bd.apply(this,arguments)}function Bd(){return(Bd=b(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.outputs,"original"!==n){e.next=3;break}return e.abrupt("return",r);case 3:if(!["retriever","llm","prompt"].includes(t.run_type)){e.next=5;break}return e.abrupt("return",r);case 5:if(void 0===r||1!==Object.keys(r).length||void 0===(null===r||void 0===r?void 0:r.output)){e.next=7;break}return e.abrupt("return",r.output);case 7:return e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ld=function(e,t){B(r,e);var n=z(r);function r(e){var t,a,i;return T(this,r),i=n.call(this,q({_awaitHandler:!0},e)),Object.defineProperty(N(i),"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(N(i),"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(i),"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(i),"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(i),"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(i),"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(i),"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(i),"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(N(i),"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(i),"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(N(i),"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(N(i),"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(i),"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(i),"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(i),"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),Object.defineProperty(N(i),"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),i.autoClose=null===(t=null===e||void 0===e?void 0:e.autoClose)||void 0===t||t,i.includeNames=null===e||void 0===e?void 0:e.includeNames,i.includeTypes=null===e||void 0===e?void 0:e.includeTypes,i.includeTags=null===e||void 0===e?void 0:e.includeTags,i.excludeNames=null===e||void 0===e?void 0:e.excludeNames,i.excludeTypes=null===e||void 0===e?void 0:e.excludeTypes,i.excludeTags=null===e||void 0===e?void 0:e.excludeTags,i._schemaFormat=null!==(a=null===e||void 0===e?void 0:e._schemaFormat)&&void 0!==a?a:i._schemaFormat,i.transformStream=new TransformStream,i.writer=i.transformStream.writable.getWriter(),i.receiveStream=Ad.fromReadableStream(i.transformStream.readable),i}return I(r,[{key:t,value:function(){return this.receiveStream}},{key:"persistRun",value:function(){var e=b(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"_includeRun",value:function(e){var t,n=this;if(e.id===this.rootId)return!1;var r=null!==(t=e.tags)&&void 0!==t?t:[],a=void 0===this.includeNames&&void 0===this.includeTags&&void 0===this.includeTypes;return void 0!==this.includeNames&&(a=a||this.includeNames.includes(e.name)),void 0!==this.includeTypes&&(a=a||this.includeTypes.includes(e.run_type)),void 0!==this.includeTags&&(a=a||void 0!==r.find((function(e){var t;return null===(t=n.includeTags)||void 0===t?void 0:t.includes(e)}))),void 0!==this.excludeNames&&(a=a&&!this.excludeNames.includes(e.name)),void 0!==this.excludeTypes&&(a=a&&!this.excludeTypes.includes(e.run_type)),void 0!==this.excludeTags&&(a=a&&r.every((function(e){var t;return!(null!==(t=n.excludeTags)&&void 0!==t&&t.includes(e))}))),a}},{key:"tapOutputIterable",value:function(e,t){var n=this;return An(p().mark((function r(){var a,i,u,o,s,c,l;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:a=!1,i=!1,r.prev=2,o=Cn(t);case 4:return r.next=6,xn(o.next());case 6:if(!(a=!(s=r.sent).done)){r.next=18;break}if(c=s.value,e===n.rootId){r.next=13;break}if(!(l=n.keyMapByRunId[e])){r.next=13;break}return r.next=13,xn(n.writer.write(new Pd({ops:[{op:"add",path:"/logs/".concat(l,"/streamed_output/-"),value:c}]})));case 13:return r.next=15,c;case 15:a=!1,r.next=4;break;case 18:r.next=24;break;case 20:r.prev=20,r.t0=r.catch(2),i=!0,u=r.t0;case 24:if(r.prev=24,r.prev=25,!a||null==o.return){r.next=29;break}return r.next=29,xn(o.return());case 29:if(r.prev=29,!i){r.next=32;break}throw u;case 32:return r.finish(29);case 33:return r.finish(24);case 34:case"end":return r.stop()}}),r,null,[[2,20,24,34],[25,,29,33]])})))()}},{key:"onRunCreate",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.rootId){e.next=4;break}return this.rootId=t.id,e.next=4,this.writer.write(new Pd({ops:[{op:"replace",path:"",value:{id:t.id,name:t.name,type:t.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}));case 4:if(this._includeRun(t)){e.next=6;break}return e.abrupt("return");case 6:if(void 0===this.counterMapByRunName[t.name]&&(this.counterMapByRunName[t.name]=0),this.counterMapByRunName[t.name]+=1,i=this.counterMapByRunName[t.name],this.keyMapByRunId[t.id]=1===i?t.name:"".concat(t.name,":").concat(i),u={id:t.id,name:t.name,type:t.run_type,tags:null!==(n=t.tags)&&void 0!==n?n:[],metadata:null!==(r=null===(a=t.extra)||void 0===a?void 0:a.metadata)&&void 0!==r?r:{},start_time:new Date(t.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0},"streaming_events"!==this._schemaFormat){e.next=15;break}return e.next=14,Id(t,this._schemaFormat);case 14:u.inputs=e.sent;case 15:return e.next=17,this.writer.write(new Pd({ops:[{op:"add",path:"/logs/".concat(this.keyMapByRunId[t.id]),value:u}]}));case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onRunUpdate",value:function(){var e=b(p().mark((function e(t){var n,r,a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,void 0!==(n=this.keyMapByRunId[t.id])){e.next=4;break}return e.abrupt("return");case 4:if(r=[],"streaming_events"!==this._schemaFormat){e.next=13;break}return e.t0=r,e.t1="/logs/".concat(n,"/inputs"),e.next=10,Id(t,this._schemaFormat);case 10:e.t2=e.sent,e.t3={op:"replace",path:e.t1,value:e.t2},e.t0.push.call(e.t0,e.t3);case 13:return e.t4=r,e.t5="/logs/".concat(n,"/final_output"),e.next=17,Rd(t,this._schemaFormat);case 17:return e.t6=e.sent,e.t7={op:"add",path:e.t5,value:e.t6},e.t4.push.call(e.t4,e.t7),void 0!==t.end_time&&r.push({op:"add",path:"/logs/".concat(n,"/end_time"),value:new Date(t.end_time).toISOString()}),a=new Pd({ops:r}),e.next=24,this.writer.write(a);case 24:if(e.prev=24,t.id!==this.rootId){e.next=39;break}return e.t8=Pd,e.next=29,Rd(t,this._schemaFormat);case 29:return e.t9=e.sent,e.t10={op:"replace",path:"/final_output",value:e.t9},e.t11=[e.t10],e.t12={ops:e.t11},i=new e.t8(e.t12),e.next=36,this.writer.write(i);case 36:if(!this.autoClose){e.next=39;break}return e.next=39,this.writer.close();case 39:return e.finish(24);case 40:case"end":return e.stop()}}),e,this,[[0,,24,40]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onLLMNewToken",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(a=this.keyMapByRunId[t.id])){e.next=3;break}return e.abrupt("return");case 3:return void 0!==t.inputs.messages?(o=null===r||void 0===r?void 0:r.chunk,i=void 0!==o&&void 0!==o.message?null===r||void 0===r?void 0:r.chunk:new ls({id:"run-".concat(t.id),content:n})):i=n,u=new Pd({ops:[{op:"add",path:"/logs/".concat(a,"/streamed_output_str/-"),value:n},{op:"add",path:"/logs/".concat(a,"/streamed_output/-"),value:i}]}),e.next=8,this.writer.write(u);case 8:case"end":return e.stop()}var o}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),r}(Nl,Symbol.asyncIterator),Md="__run",Ud=function(){function e(t){T(this,e),Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=t.text,this.generationInfo=t.generationInfo}return I(e,[{key:"concat",value:function(t){return new e({text:this.text+t.text,generationInfo:q(q({},this.generationInfo),t.generationInfo)})}}]),e}(),zd=function(e){B(n,e);var t=z(n);function n(e){var r;return T(this,n),r=t.call(this,e),Object.defineProperty(N(r),"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.message=e.message,r}return I(n,[{key:"concat",value:function(e){return new n({text:this.text+e.text,generationInfo:q(q({},this.generationInfo),e.generationInfo),message:this.message.concat(e.message)})}}]),n}(Ud);function Hd(e){var t=e.name,n=e.serialized;return void 0!==t?t:void 0!==(null===n||void 0===n?void 0:n.name)?n.name:void 0!==(null===n||void 0===n?void 0:n.id)&&Array.isArray(null===n||void 0===n?void 0:n.id)?n.id[n.id.length-1]:"Unnamed"}var Zd=function(e){return"event_stream_tracer"===e.name},Wd=function(e,t){B(r,e);var n=z(r);function r(e){var t,a;return T(this,r),a=n.call(this,q({_awaitHandler:!0},e)),Object.defineProperty(N(a),"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(N(a),"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(a),"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(a),"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(a),"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(a),"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(a),"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(a),"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(N(a),"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(N(a),"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(a),"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(a),"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(a),"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),Object.defineProperty(N(a),"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),a.autoClose=null===(t=null===e||void 0===e?void 0:e.autoClose)||void 0===t||t,a.includeNames=null===e||void 0===e?void 0:e.includeNames,a.includeTypes=null===e||void 0===e?void 0:e.includeTypes,a.includeTags=null===e||void 0===e?void 0:e.includeTags,a.excludeNames=null===e||void 0===e?void 0:e.excludeNames,a.excludeTypes=null===e||void 0===e?void 0:e.excludeTypes,a.excludeTags=null===e||void 0===e?void 0:e.excludeTags,a.transformStream=new TransformStream,a.writer=a.transformStream.writable.getWriter(),a.receiveStream=Ad.fromReadableStream(a.transformStream.readable),a}return I(r,[{key:t,value:function(){return this.receiveStream}},{key:"persistRun",value:function(){var e=b(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"_includeRun",value:function(e){var t,n=this,r=null!==(t=e.tags)&&void 0!==t?t:[],a=void 0===this.includeNames&&void 0===this.includeTags&&void 0===this.includeTypes;return void 0!==this.includeNames&&(a=a||this.includeNames.includes(e.name)),void 0!==this.includeTypes&&(a=a||this.includeTypes.includes(e.runType)),void 0!==this.includeTags&&(a=a||void 0!==r.find((function(e){var t;return null===(t=n.includeTags)||void 0===t?void 0:t.includes(e)}))),void 0!==this.excludeNames&&(a=a&&!this.excludeNames.includes(e.name)),void 0!==this.excludeTypes&&(a=a&&!this.excludeTypes.includes(e.runType)),void 0!==this.excludeTags&&(a=a&&r.every((function(e){var t;return!(null!==(t=n.excludeTags)&&void 0!==t&&t.includes(e))}))),a}},{key:"tapOutputIterable",value:function(e,t){var n=this;return An(p().mark((function r(){var a,i,u,o,s,c,l,d,f,h,v,m,y,g,b,_,k,w;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return u=function(e,t){return"llm"===e&&"string"===typeof t?new Ud({text:t}):t},r.next=3,xn(t.next());case 3:if(!(a=r.sent).done){r.next=6;break}return r.abrupt("return");case 6:if(void 0!==(i=n.runInfoMap.get(e))){r.next=11;break}return r.next=10,a.value;case 10:return r.abrupt("return");case 11:if(void 0!==(o=n.tappedPromises.get(e))){r.next=58;break}return o=new Promise((function(e){s=e})),n.tappedPromises.set(e,o),r.prev=15,c={event:"on_".concat(i.runType,"_stream"),run_id:e,name:i.name,tags:i.tags,metadata:i.metadata,data:{}},r.next=19,xn(n.send(q(q({},c),{},{data:{chunk:u(i.runType,a.value)}}),i));case 19:return r.next=21,a.value;case 21:l=!1,d=!1,r.prev=23,h=Cn(t);case 25:return r.next=27,xn(h.next());case 27:if(!(l=!(v=r.sent).done)){r.next=37;break}if(m=v.value,"tool"===i.runType||"retriever"===i.runType){r.next=32;break}return r.next=32,xn(n.send(q(q({},c),{},{data:{chunk:u(i.runType,m)}}),i));case 32:return r.next=34,m;case 34:l=!1,r.next=25;break;case 37:r.next=43;break;case 39:r.prev=39,r.t0=r.catch(23),d=!0,f=r.t0;case 43:if(r.prev=43,r.prev=44,!l||null==h.return){r.next=48;break}return r.next=48,xn(h.return());case 48:if(r.prev=48,!d){r.next=51;break}throw f;case 51:return r.finish(48);case 52:return r.finish(43);case 53:return r.prev=53,s(),r.finish(53);case 56:r.next=89;break;case 58:return r.next=60,a.value;case 60:y=!1,g=!1,r.prev=62,_=Cn(t);case 64:return r.next=66,xn(_.next());case 66:if(!(y=!(k=r.sent).done)){r.next=73;break}return w=k.value,r.next=70,w;case 70:y=!1,r.next=64;break;case 73:r.next=79;break;case 75:r.prev=75,r.t1=r.catch(62),g=!0,b=r.t1;case 79:if(r.prev=79,r.prev=80,!y||null==_.return){r.next=84;break}return r.next=84,xn(_.return());case 84:if(r.prev=84,!g){r.next=87;break}throw b;case 87:return r.finish(84);case 88:return r.finish(79);case 89:case"end":return r.stop()}}),r,null,[[15,,53,56],[23,39,43,53],[44,,48,52],[62,75,79,89],[80,,84,88]])})))()}},{key:"send",value:function(){var e=b(p().mark((function e(t,n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._includeRun(n)){e.next=3;break}return e.next=3,this.writer.write(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"sendEndEvent",value:function(){var e=b(p().mark((function e(t,n){var r,a=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(r=this.tappedPromises.get(t.run_id))){e.next=5;break}r.then((function(){a.send(t,n)})),e.next=7;break;case 5:return e.next=7,this.send(t,n);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onLLMStart",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=Hd(t),c=void 0!==t.inputs.messages?"chat_model":"llm",l={tags:null!==(n=t.tags)&&void 0!==n?n:[],metadata:null!==(r=null===(a=t.extra)||void 0===a?void 0:a.metadata)&&void 0!==r?r:{},name:s,runType:c,inputs:t.inputs},this.runInfoMap.set(t.id,l),d="on_".concat(c,"_start"),e.next=7,this.send({event:d,data:{input:t.inputs},name:s,tags:null!==(i=t.tags)&&void 0!==i?i:[],run_id:t.id,metadata:null!==(u=null===(o=t.extra)||void 0===o?void 0:o.metadata)&&void 0!==u?u:{}},l);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onLLMNewToken",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(a=this.runInfoMap.get(t.id))){e.next=3;break}throw new Error("onLLMNewToken: Run ID ".concat(t.id," not found in run map."));case 3:if(1!==this.runInfoMap.size){e.next=5;break}return e.abrupt("return");case 5:if("chat_model"!==a.runType){e.next=10;break}u="on_chat_model_stream",i=void 0===(null===r||void 0===r?void 0:r.chunk)?new ls({content:n,id:"run-".concat(t.id)}):r.chunk.message,e.next=16;break;case 10:if("llm"!==a.runType){e.next=15;break}u="on_llm_stream",i=void 0===(null===r||void 0===r?void 0:r.chunk)?new Ud({text:n}):r.chunk,e.next=16;break;case 15:throw new Error("Unexpected run type ".concat(a.runType));case 16:return e.next=18,this.send({event:u,data:{chunk:i},run_id:t.id,name:a.name,tags:a.tags,metadata:a.metadata},a);case 18:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"onLLMEnd",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l,d,f;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.runInfoMap.get(t.id),this.runInfoMap.delete(t.id),void 0!==r){e.next=4;break}throw new Error("onLLMEnd: Run ID ".concat(t.id," not found in run map."));case 4:if(i=null===(n=t.outputs)||void 0===n?void 0:n.generations,"chat_model"!==r.runType){e.next=27;break}o=G(null!==i&&void 0!==i?i:[]),e.prev=7,o.s();case 9:if((s=o.n()).done){e.next=16;break}if(l=s.value,void 0===u){e.next=13;break}return e.abrupt("break",16);case 13:u=null===(c=l[0])||void 0===c?void 0:c.message;case 14:e.next=9;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(7),o.e(e.t0);case 21:return e.prev=21,o.f(),e.finish(21);case 24:a="on_chat_model_end",e.next=33;break;case 27:if("llm"!==r.runType){e.next=32;break}u={generations:null===i||void 0===i?void 0:i.map((function(e){return e.map((function(e){return{text:e.text,generationInfo:e.generationInfo}}))})),llmOutput:null!==(d=null===(f=t.outputs)||void 0===f?void 0:f.llmOutput)&&void 0!==d?d:{}},a="on_llm_end",e.next=33;break;case 32:throw new Error("onLLMEnd: Unexpected run type: ".concat(r.runType));case 33:return e.next=35,this.sendEndEvent({event:a,data:{output:u,input:r.inputs},run_id:t.id,name:r.name,tags:r.tags,metadata:r.metadata},r);case 35:case"end":return e.stop()}}),e,this,[[7,18,21,24]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onChainStart",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l,d,f;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=Hd(t),l=null!==(n=t.run_type)&&void 0!==n?n:"chain",d={tags:null!==(r=t.tags)&&void 0!==r?r:[],metadata:null!==(a=null===(i=t.extra)||void 0===i?void 0:i.metadata)&&void 0!==a?a:{},name:c,runType:t.run_type},f={},""===t.inputs.input&&1===Object.keys(t.inputs).length?(f={},d.inputs={}):void 0!==t.inputs.input?(f.input=t.inputs.input,d.inputs=t.inputs.input):(f.input=t.inputs,d.inputs=t.inputs),this.runInfoMap.set(t.id,d),e.next=8,this.send({event:"on_".concat(l,"_start"),data:f,name:c,tags:null!==(u=t.tags)&&void 0!==u?u:[],run_id:t.id,metadata:null!==(o=null===(s=t.extra)||void 0===s?void 0:s.metadata)&&void 0!==o?o:{}},d);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onChainEnd",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.runInfoMap.get(t.id),this.runInfoMap.delete(t.id),void 0!==o){e.next=4;break}throw new Error("onChainEnd: Run ID ".concat(t.id," not found in run map."));case 4:return s="on_".concat(t.run_type,"_end"),c=null!==(n=null!==(r=t.inputs)&&void 0!==r?r:o.inputs)&&void 0!==n?n:{},l=null!==(a=null===(i=t.outputs)||void 0===i?void 0:i.output)&&void 0!==a?a:t.outputs,d={output:l,input:c},c.input&&1===Object.keys(c).length&&(d.input=c.input,o.inputs=c.input),e.next=11,this.sendEndEvent({event:s,data:d,run_id:t.id,name:o.name,tags:o.tags,metadata:null!==(u=o.metadata)&&void 0!==u?u:{}},o);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onToolStart",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=Hd(t),d={tags:null!==(n=t.tags)&&void 0!==n?n:[],metadata:null!==(r=null===(a=t.extra)||void 0===a?void 0:a.metadata)&&void 0!==r?r:{},name:l,runType:"tool",inputs:null!==(i=t.inputs)&&void 0!==i?i:{}},this.runInfoMap.set(t.id,d),e.next=5,this.send({event:"on_tool_start",data:{input:null!==(u=t.inputs)&&void 0!==u?u:{}},name:l,run_id:t.id,tags:null!==(o=t.tags)&&void 0!==o?o:[],metadata:null!==(s=null===(c=t.extra)||void 0===c?void 0:c.metadata)&&void 0!==s?s:{}},d);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onToolEnd",value:function(){var e=b(p().mark((function e(t){var n,r,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.runInfoMap.get(t.id),this.runInfoMap.delete(t.id),void 0!==r){e.next=4;break}throw new Error("onToolEnd: Run ID ".concat(t.id," not found in run map."));case 4:if(void 0!==r.inputs){e.next=6;break}throw new Error("onToolEnd: Run ID ".concat(t.id," is a tool call, and is expected to have traced inputs."));case 6:return a=void 0===(null===(n=t.outputs)||void 0===n?void 0:n.output)?t.outputs:t.outputs.output,e.next=9,this.sendEndEvent({event:"on_tool_end",data:{output:a,input:r.inputs},run_id:t.id,name:r.name,tags:r.tags,metadata:r.metadata},r);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onRetrieverStart",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=Hd(t),"retriever",c={tags:null!==(n=t.tags)&&void 0!==n?n:[],metadata:null!==(r=null===(a=t.extra)||void 0===a?void 0:a.metadata)&&void 0!==r?r:{},name:s,runType:"retriever",inputs:{query:t.inputs.query}},this.runInfoMap.set(t.id,c),e.next=6,this.send({event:"on_retriever_start",data:{input:{query:t.inputs.query}},name:s,tags:null!==(i=t.tags)&&void 0!==i?i:[],run_id:t.id,metadata:null!==(u=null===(o=t.extra)||void 0===o?void 0:o.metadata)&&void 0!==u?u:{}},c);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onRetrieverEnd",value:function(){var e=b(p().mark((function e(t){var n,r,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.runInfoMap.get(t.id),this.runInfoMap.delete(t.id),void 0!==a){e.next=4;break}throw new Error("onRetrieverEnd: Run ID ".concat(t.id," not found in run map."));case 4:return e.next=6,this.sendEndEvent({event:"on_retriever_end",data:{output:null!==(n=null===(r=t.outputs)||void 0===r?void 0:r.documents)&&void 0!==n?n:t.outputs,input:a.inputs},run_id:t.id,name:a.name,tags:a.tags,metadata:a.metadata},a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleCustomEvent",value:function(){var e=b(p().mark((function e(t,n,r){var a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(a=this.runInfoMap.get(r))){e.next=3;break}throw new Error("handleCustomEvent: Run ID ".concat(r," not found in run map."));case 3:return e.next=5,this.send({event:"on_custom_event",run_id:r,name:t,tags:a.tags,metadata:a.metadata,data:n},a);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"finish",value:function(){var e=b(p().mark((function e(){var t,n=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=y(this.tappedPromises.values()),Promise.all(t).finally((function(){n.writer.close()}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),r}(Nl,Symbol.asyncIterator),qd=[400,401,402,403,404,405,406,407,409],Gd=function(e){var t,n,r;if(e.message.startsWith("Cancel")||e.message.startsWith("AbortError")||"AbortError"===e.name)throw e;if("ECONNABORTED"===(null===e||void 0===e?void 0:e.code))throw e;var a=null!==(t=null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.status)&&void 0!==t?t:null===e||void 0===e?void 0:e.status;if(a&&qd.includes(+a))throw e;if("insufficient_quota"===(null===e||void 0===e||null===(r=e.error)||void 0===r?void 0:r.code)){var i=new Error(null===e||void 0===e?void 0:e.message);throw i.name="InsufficientQuotaError",i}},Vd=function(){function e(t){var n,r,a;T(this,e),Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=null!==(n=t.maxConcurrency)&&void 0!==n?n:1/0,this.maxRetries=null!==(r=t.maxRetries)&&void 0!==r?r:6,this.onFailedAttempt=null!==(a=t.onFailedAttempt)&&void 0!==a?a:Gd;var i=Vs.default;this.queue=new i({concurrency:this.maxConcurrency})}return I(e,[{key:"call",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return this.queue.add((function(){return Ps((function(){return e.apply(void 0,r).catch((function(e){throw e instanceof Error?e:new Error(e)}))}),{onFailedAttempt:t.onFailedAttempt,retries:t.maxRetries,randomize:!0})}),{throwOnTimeout:!0})}},{key:"callWithOptions",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return e.signal?Promise.race([this.call.apply(this,[t].concat(r)),new Promise((function(t,n){var r;null===(r=e.signal)||void 0===r||r.addEventListener("abort",(function(){n(new Error("AbortError"))}))}))]):this.call.apply(this,[t].concat(r))}},{key:"fetch",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.call((function(){return fetch.apply(void 0,t).then((function(e){return e.ok?e:Promise.reject(e)}))}))}))}]),e}(),$d=function(e){B(n,e);var t=z(n);function n(e){var r,a=e.config,i=e.onStart,u=e.onEnd,o=e.onError;return T(this,n),r=t.call(this,{_awaitHandler:!0}),Object.defineProperty(N(r),"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(N(r),"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(r),"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(r),"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(r),"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(r),"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.config=a,r.argOnStart=i,r.argOnEnd=u,r.argOnError=o,r}return I(n,[{key:"persistRun",value:function(e){return Promise.resolve()}},{key:"onRunCreate",value:function(){var e=b(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.rootId){e.next=2;break}return e.abrupt("return");case 2:if(this.rootId=t.id,!this.argOnStart){e.next=6;break}return e.next=6,this.argOnStart(t,this.config);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onRunUpdate",value:function(){var e=b(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id===this.rootId){e.next=2;break}return e.abrupt("return");case 2:if(t.error){e.next=8;break}if(!this.argOnEnd){e.next=6;break}return e.next=6,this.argOnEnd(t,this.config);case 6:e.next=11;break;case 8:if(!this.argOnError){e.next=11;break}return e.next=11,this.argOnError(t,this.config);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Nl);function Jd(e){return!!e&&e.lc_runnable}var Kd=function(){function e(t){T(this,e),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=t.includeNames,this.includeTypes=t.includeTypes,this.includeTags=t.includeTags,this.excludeNames=t.excludeNames,this.excludeTypes=t.excludeTypes,this.excludeTags=t.excludeTags}return I(e,[{key:"includeEvent",value:function(e,t){var n,r=this,a=void 0===this.includeNames&&void 0===this.includeTypes&&void 0===this.includeTags,i=null!==(n=e.tags)&&void 0!==n?n:[];return void 0!==this.includeNames&&(a=a||this.includeNames.includes(e.name)),void 0!==this.includeTypes&&(a=a||this.includeTypes.includes(t)),void 0!==this.includeTags&&(a=a||i.some((function(e){var t;return null===(t=r.includeTags)||void 0===t?void 0:t.includes(e)}))),void 0!==this.excludeNames&&(a=a&&!this.excludeNames.includes(e.name)),void 0!==this.excludeTypes&&(a=a&&!this.excludeTypes.includes(t)),void 0!==this.excludeTags&&(a=a&&i.every((function(e){var t;return!(null!==(t=r.excludeTags)&&void 0!==t&&t.includes(e))}))),a}}]),e}(),Qd=Symbol("Let zodToJsonSchema decide on which parser to use"),Xd={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},Yd=function(e){var t=function(e){return"string"===typeof e?q(q({},Xd),{},{name:e}):q(q({},Xd),e)}(e),n=void 0!==t.name?[].concat(y(t.basePath),[t.definitionPath,t.name]):t.basePath;return q(q({},t),{},{currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map((function(e){var n=w(e,2),r=n[0],a=n[1];return[a._def,{def:a._def,path:[].concat(y(t.basePath),[t.definitionPath,r]),jsonSchema:void 0}]})))})};function ef(e,t,n,r){null!==r&&void 0!==r&&r.errorMessages&&n&&(e.errorMessage=q(q({},e.errorMessage),{},P({},t,n)))}function tf(e,t,n,r,a){e[t]=n,ef(e,t,r,a)}function nf(e,t){return xf(e.type._def,t)}function rf(e,t,n){var r=null!==n&&void 0!==n?n:t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((function(n,r){return rf(e,t,n)}))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return af(e,t)}}var af=function(e,t){var n={type:"integer",format:"unix-time"};if("openApi3"===t.target)return n;var r,a=G(e.checks);try{for(a.s();!(r=a.n()).done;){var i=r.value;switch(i.kind){case"min":tf(n,"minimum",i.value,i.message,t);break;case"max":tf(n,"maximum",i.value,i.message,t)}}}catch(u){a.e(u)}finally{a.f()}return n};var uf=["additionalProperties"];var of=void 0,sf={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:function(){return void 0===of&&(of=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),of},uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function cf(e,t){var n={type:"string"};if(e.checks){var r,a=G(e.checks);try{for(a.s();!(r=a.n()).done;){var i=r.value;switch(i.kind){case"min":tf(n,"minLength","number"===typeof n.minLength?Math.max(n.minLength,i.value):i.value,i.message,t);break;case"max":tf(n,"maxLength","number"===typeof n.maxLength?Math.min(n.maxLength,i.value):i.value,i.message,t);break;case"email":switch(t.emailStrategy){case"format:email":ff(n,"email",i.message,t);break;case"format:idn-email":ff(n,"idn-email",i.message,t);break;case"pattern:zod":pf(n,sf.email,i.message,t)}break;case"url":ff(n,"uri",i.message,t);break;case"uuid":ff(n,"uuid",i.message,t);break;case"regex":pf(n,i.regex,i.message,t);break;case"cuid":pf(n,sf.cuid,i.message,t);break;case"cuid2":pf(n,sf.cuid2,i.message,t);break;case"startsWith":pf(n,RegExp("^".concat(lf(i.value,t))),i.message,t);break;case"endsWith":pf(n,RegExp("".concat(lf(i.value,t),"$")),i.message,t);break;case"datetime":ff(n,"date-time",i.message,t);break;case"date":ff(n,"date",i.message,t);break;case"time":ff(n,"time",i.message,t);break;case"duration":ff(n,"duration",i.message,t);break;case"length":tf(n,"minLength","number"===typeof n.minLength?Math.max(n.minLength,i.value):i.value,i.message,t),tf(n,"maxLength","number"===typeof n.maxLength?Math.min(n.maxLength,i.value):i.value,i.message,t);break;case"includes":pf(n,RegExp(lf(i.value,t)),i.message,t);break;case"ip":"v6"!==i.version&&ff(n,"ipv4",i.message,t),"v4"!==i.version&&ff(n,"ipv6",i.message,t);break;case"base64url":pf(n,sf.base64url,i.message,t);break;case"jwt":pf(n,sf.jwt,i.message,t);break;case"cidr":"v6"!==i.version&&pf(n,sf.ipv4Cidr,i.message,t),"v4"!==i.version&&pf(n,sf.ipv6Cidr,i.message,t);break;case"emoji":pf(n,sf.emoji(),i.message,t);break;case"ulid":pf(n,sf.ulid,i.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":ff(n,"binary",i.message,t);break;case"contentEncoding:base64":tf(n,"contentEncoding","base64",i.message,t);break;case"pattern:zod":pf(n,sf.base64,i.message,t)}break;case"nanoid":pf(n,sf.nanoid,i.message,t)}}}catch(u){a.e(u)}finally{a.f()}}return n}function lf(e,t){return"escape"===t.patternStrategy?function(e){for(var t="",n=0;n<e.length;n++)df.has(e[n])||(t+="\\"),t+=e[n];return t}(e):e}var df=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function ff(e,t,n,r){var a;e.format||null!==(a=e.anyOf)&&void 0!==a&&a.some((function(e){return e.format}))?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push(q({format:e.format},e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}})),delete e.format,e.errorMessage&&(delete e.errorMessage.format,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.anyOf.push(q({format:t},n&&r.errorMessages&&{errorMessage:{format:n}}))):tf(e,"format",t,n,r)}function pf(e,t,n,r){var a;e.pattern||null!==(a=e.allOf)&&void 0!==a&&a.some((function(e){return e.pattern}))?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push(q({pattern:e.pattern},e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}})),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.allOf.push(q({pattern:hf(t,r)},n&&r.errorMessages&&{errorMessage:{pattern:n}}))):tf(e,"pattern",hf(t,r),n,r)}function hf(e,t){if(!t.applyRegexFlags||!e.flags)return e.source;for(var n=e.flags.includes("i"),r=e.flags.includes("m"),a=e.flags.includes("s"),i=n?e.source.toLowerCase():e.source,u="",o=!1,s=!1,c=!1,l=0;l<i.length;l++)if(o)u+=i[l],o=!1;else{if(n)if(s){if(i[l].match(/[a-z]/)){var d;c?(u+=i[l],u+="".concat(i[l-2],"-").concat(i[l]).toUpperCase(),c=!1):"-"===i[l+1]&&null!==(d=i[l+2])&&void 0!==d&&d.match(/[a-z]/)?(u+=i[l],c=!0):u+="".concat(i[l]).concat(i[l].toUpperCase());continue}}else if(i[l].match(/[a-z]/)){u+="[".concat(i[l]).concat(i[l].toUpperCase(),"]");continue}if(r){if("^"===i[l]){u+="(^|(?<=[\r\n]))";continue}if("$"===i[l]){u+="($|(?=[\r\n]))";continue}}a&&"."===i[l]?u+=s?"".concat(i[l],"\r\n"):"[".concat(i[l],"\r\n]"):(u+=i[l],"\\"===i[l]?o=!0:s&&"]"===i[l]?s=!1:s||"["!==i[l]||(s=!0))}try{new RegExp(u)}catch(f){return console.warn("Could not convert regex pattern at ".concat(t.currentPath.join("/")," to a flag-independent form! Falling back to the flag-ignorant source")),e.source}return u}var vf=["type"],mf=["type"];function yf(e,t){var n,r,a,i,u,o,s;if("openAi"===t.target&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),"openApi3"===t.target&&(null===(n=e.keyType)||void 0===n?void 0:n._def.typeName)===Ft.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((function(n,r){var a;return q(q({},n),{},P({},r,null!==(a=xf(e.valueType._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["properties",r])})))&&void 0!==a?a:{}))}),{}),additionalProperties:t.rejectedAdditionalProperties};var c={type:"object",additionalProperties:null!==(r=xf(e.valueType._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["additionalProperties"])})))&&void 0!==r?r:t.allowedAdditionalProperties};if("openApi3"===t.target)return c;if((null===(a=e.keyType)||void 0===a?void 0:a._def.typeName)===Ft.ZodString&&null!==(i=e.keyType._def.checks)&&void 0!==i&&i.length){var l=cf(e.keyType._def,t),d=(l.type,Sn(l,vf));return q(q({},c),{},{propertyNames:d})}if((null===(u=e.keyType)||void 0===u?void 0:u._def.typeName)===Ft.ZodEnum)return q(q({},c),{},{propertyNames:{enum:e.keyType._def.values}});if((null===(o=e.keyType)||void 0===o?void 0:o._def.typeName)===Ft.ZodBranded&&e.keyType._def.type._def.typeName===Ft.ZodString&&null!==(s=e.keyType._def.type._def.checks)&&void 0!==s&&s.length){var f=nf(e.keyType._def,t),p=(f.type,Sn(f,mf));return q(q({},c),{},{propertyNames:p})}return c}var gf={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};var bf=function(e,t){var n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((function(e,n){return xf(e._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["anyOf","".concat(n)])}))})).filter((function(e){return!!e&&(!t.strictUnions||"object"===typeof e&&Object.keys(e).length>0)}));return n.length?{anyOf:n}:void 0};function _f(e,t){var n="openAi"===t.target,r={type:"object",properties:{}},a=[],i=e.shape();for(var u in i){var o=i[u];if(void 0!==o&&void 0!==o._def){var s=kf(o);s&&n&&(o instanceof bt&&(o=o._def.innerType),o.isNullable()||(o=o.nullable()),s=!1);var c=xf(o._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["properties",u]),propertyPath:[].concat(y(t.currentPath),["properties",u])}));void 0!==c&&(r.properties[u]=c,s||a.push(u))}}a.length&&(r.required=a);var l=function(e,t){if("ZodNever"!==e.catchall._def.typeName)return xf(e.catchall._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["additionalProperties"])}));switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return"strict"===t.removeAdditionalStrategy?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}(e,t);return void 0!==l&&(r.additionalProperties=l),r}function kf(e){try{return e.isOptional()}catch(t){return!0}}var wf=function(e,t,n){switch(t){case Ft.ZodString:return cf(e,n);case Ft.ZodNumber:return function(e,t){var n={type:"number"};if(!e.checks)return n;var r,a=G(e.checks);try{for(a.s();!(r=a.n()).done;){var i=r.value;switch(i.kind){case"int":n.type="integer",ef(n,"type",i.message,t);break;case"min":"jsonSchema7"===t.target?i.inclusive?tf(n,"minimum",i.value,i.message,t):tf(n,"exclusiveMinimum",i.value,i.message,t):(i.inclusive||(n.exclusiveMinimum=!0),tf(n,"minimum",i.value,i.message,t));break;case"max":"jsonSchema7"===t.target?i.inclusive?tf(n,"maximum",i.value,i.message,t):tf(n,"exclusiveMaximum",i.value,i.message,t):(i.inclusive||(n.exclusiveMaximum=!0),tf(n,"maximum",i.value,i.message,t));break;case"multipleOf":tf(n,"multipleOf",i.value,i.message,t)}}}catch(u){a.e(u)}finally{a.f()}return n}(e,n);case Ft.ZodObject:return _f(e,n);case Ft.ZodBigInt:return function(e,t){var n={type:"integer",format:"int64"};if(!e.checks)return n;var r,a=G(e.checks);try{for(a.s();!(r=a.n()).done;){var i=r.value;switch(i.kind){case"min":"jsonSchema7"===t.target?i.inclusive?tf(n,"minimum",i.value,i.message,t):tf(n,"exclusiveMinimum",i.value,i.message,t):(i.inclusive||(n.exclusiveMinimum=!0),tf(n,"minimum",i.value,i.message,t));break;case"max":"jsonSchema7"===t.target?i.inclusive?tf(n,"maximum",i.value,i.message,t):tf(n,"exclusiveMaximum",i.value,i.message,t):(i.inclusive||(n.exclusiveMaximum=!0),tf(n,"maximum",i.value,i.message,t));break;case"multipleOf":tf(n,"multipleOf",i.value,i.message,t)}}}catch(u){a.e(u)}finally{a.f()}return n}(e,n);case Ft.ZodBoolean:return{type:"boolean"};case Ft.ZodDate:return rf(e,n);case Ft.ZodUndefined:return{not:{}};case Ft.ZodNull:return function(e){return"openApi3"===e.target?{enum:["null"],nullable:!0}:{type:"null"}}(n);case Ft.ZodArray:return function(e,t){var n,r,a,i={type:"array"};return null!==(n=e.type)&&void 0!==n&&n._def&&(null===(r=e.type)||void 0===r||null===(a=r._def)||void 0===a?void 0:a.typeName)!==Ft.ZodAny&&(i.items=xf(e.type._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["items"])}))),e.minLength&&tf(i,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&tf(i,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(tf(i,"minItems",e.exactLength.value,e.exactLength.message,t),tf(i,"maxItems",e.exactLength.value,e.exactLength.message,t)),i}(e,n);case Ft.ZodUnion:case Ft.ZodDiscriminatedUnion:return function(e,t){if("openApi3"===t.target)return bf(e,t);var n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every((function(e){return e._def.typeName in gf&&(!e._def.checks||!e._def.checks.length)}))){var r=n.reduce((function(e,t){var n=gf[t._def.typeName];return n&&!e.includes(n)?[].concat(y(e),[n]):e}),[]);return{type:r.length>1?r:r[0]}}if(n.every((function(e){return"ZodLiteral"===e._def.typeName&&!e.description}))){var a=n.reduce((function(e,t){var n=typeof t._def.value;switch(n){case"string":case"number":case"boolean":return[].concat(y(e),[n]);case"bigint":return[].concat(y(e),["integer"]);case"object":if(null===t._def.value)return[].concat(y(e),["null"]);default:return e}}),[]);if(a.length===n.length){var i=a.filter((function(e,t,n){return n.indexOf(e)===t}));return{type:i.length>1?i:i[0],enum:n.reduce((function(e,t){return e.includes(t._def.value)?e:[].concat(y(e),[t._def.value])}),[])}}}else if(n.every((function(e){return"ZodEnum"===e._def.typeName})))return{type:"string",enum:n.reduce((function(e,t){return[].concat(y(e),y(t._def.values.filter((function(t){return!e.includes(t)}))))}),[])};return bf(e,t)}(e,n);case Ft.ZodIntersection:return function(e,t){var n=[xf(e.left._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["allOf","0"])})),xf(e.right._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["allOf","1"])}))].filter((function(e){return!!e})),r="jsonSchema2019-09"===t.target?{unevaluatedProperties:!1}:void 0,a=[];return n.forEach((function(e){if("type"in(n=e)&&"string"===n.type||!("allOf"in n)){var t=e;"additionalProperties"in e&&!1===e.additionalProperties?(e.additionalProperties,t=Sn(e,uf)):r=void 0,a.push(t)}else a.push.apply(a,y(e.allOf)),void 0===e.unevaluatedProperties&&(r=void 0);var n})),a.length?q({allOf:a},r):void 0}(e,n);case Ft.ZodTuple:return function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((function(e,n){return xf(e._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["items","".concat(n)])}))})).reduce((function(e,t){return void 0===t?e:[].concat(y(e),[t])}),[]),additionalItems:xf(e.rest._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["additionalItems"])}))}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((function(e,n){return xf(e._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["items","".concat(n)])}))})).reduce((function(e,t){return void 0===t?e:[].concat(y(e),[t])}),[])}}(e,n);case Ft.ZodRecord:return yf(e,n);case Ft.ZodLiteral:return function(e,t){var n=typeof e.value;return"bigint"!==n&&"number"!==n&&"boolean"!==n&&"string"!==n?{type:Array.isArray(e.value)?"array":"object"}:"openApi3"===t.target?{type:"bigint"===n?"integer":n,enum:[e.value]}:{type:"bigint"===n?"integer":n,const:e.value}}(e,n);case Ft.ZodEnum:return function(e){return{type:"string",enum:Array.from(e.values)}}(e);case Ft.ZodNativeEnum:return function(e){var t=e.values,n=Object.keys(e.values).filter((function(e){return"number"!==typeof t[t[e]]})).map((function(e){return t[e]})),r=Array.from(new Set(n.map((function(e){return typeof e}))));return{type:1===r.length?"string"===r[0]?"string":"number":["string","number"],enum:n}}(e);case Ft.ZodNullable:return function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return"openApi3"===t.target?{type:gf[e.innerType._def.typeName],nullable:!0}:{type:[gf[e.innerType._def.typeName],"null"]};if("openApi3"===t.target){var n=xf(e.innerType._def,q(q({},t),{},{currentPath:y(t.currentPath)}));return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&q(q({},n),{},{nullable:!0})}var r=xf(e.innerType._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["anyOf","0"])}));return r&&{anyOf:[r,{type:"null"}]}}(e,n);case Ft.ZodOptional:return function(e,t){var n;if(t.currentPath.toString()===(null===(n=t.propertyPath)||void 0===n?void 0:n.toString()))return xf(e.innerType._def,t);var r=xf(e.innerType._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["anyOf","1"])}));return r?{anyOf:[{not:{}},r]}:{}}(e,n);case Ft.ZodMap:return function(e,t){return"record"===t.mapStrategy?yf(e,t):{type:"array",maxItems:125,items:{type:"array",items:[xf(e.keyType._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["items","items","0"])}))||{},xf(e.valueType._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["items","items","1"])}))||{}],minItems:2,maxItems:2}}}(e,n);case Ft.ZodSet:return function(e,t){var n={type:"array",uniqueItems:!0,items:xf(e.valueType._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["items"])}))};return e.minSize&&tf(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&tf(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}(e,n);case Ft.ZodLazy:return function(){return e.getter()._def};case Ft.ZodPromise:return function(e,t){return xf(e.type._def,t)}(e,n);case Ft.ZodNaN:case Ft.ZodNever:return{not:{}};case Ft.ZodEffects:return function(e,t){return"input"===t.effectStrategy?xf(e.schema._def,t):{}}(e,n);case Ft.ZodAny:case Ft.ZodUnknown:return{};case Ft.ZodDefault:return function(e,t){return q(q({},xf(e.innerType._def,t)),{},{default:e.defaultValue()})}(e,n);case Ft.ZodBranded:return nf(e,n);case Ft.ZodReadonly:case Ft.ZodCatch:return function(e,t){return xf(e.innerType._def,t)}(e,n);case Ft.ZodPipeline:return function(e,t){if("input"===t.pipeStrategy)return xf(e.in._def,t);if("output"===t.pipeStrategy)return xf(e.out._def,t);var n=xf(e.in._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["allOf","0"])}));return{allOf:[n,xf(e.out._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["allOf",n?"1":"0"])}))].filter((function(e){return void 0!==e}))}}(e,n);case Ft.ZodFunction:case Ft.ZodVoid:case Ft.ZodSymbol:default:return}};function xf(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.seen.get(e);if(t.override){var a,i=null===(a=t.override)||void 0===a?void 0:a.call(t,e,t,r,n);if(i!==Qd)return i}if(r&&!n){var u=Ef(r,t);if(void 0!==u)return u}var o={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,o);var s=wf(e,e.typeName,t),c="function"===typeof s?xf(s(),t):s;if(c&&Cf(e,t,c),t.postProcess){var l=t.postProcess(c,e,t);return o.jsonSchema=c,l}return o.jsonSchema=c,c}var Ef=function(e,t){switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:Af(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((function(e,n){return t.currentPath[n]===e}))?(console.warn("Recursive reference detected at ".concat(t.currentPath.join("/"),"! Defaulting to any")),{}):"seen"===t.$refStrategy?{}:void 0}},Af=function(e,t){for(var n=0;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString()].concat(y(t.slice(n))).join("/")},Cf=function(e,t,n){return e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n},Df=function(e,t){var n,r=Yd(t),a="object"===typeof t&&t.definitions?Object.entries(t.definitions).reduce((function(e,t){var n,a=w(t,2),i=a[0],u=a[1];return q(q({},e),{},P({},i,null!==(n=xf(u._def,q(q({},r),{},{currentPath:[].concat(y(r.basePath),[r.definitionPath,i])}),!0))&&void 0!==n?n:{}))}),{}):void 0,i="string"===typeof t?t:"title"===(null===t||void 0===t?void 0:t.nameStrategy)||null===t||void 0===t?void 0:t.name,u=null!==(n=xf(e._def,void 0===i?r:q(q({},r),{},{currentPath:[].concat(y(r.basePath),[r.definitionPath,i])}),!1))&&void 0!==n?n:{},o="object"===typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==o&&(u.title=o);var s=void 0===i?a?q(q({},u),{},P({},r.definitionPath,a)):u:P({$ref:[].concat(y("relative"===r.$refStrategy?[]:r.basePath),[r.definitionPath,i]).join("/")},r.definitionPath,q(q({},a),{},P({},i,u)));return"jsonSchema7"===r.target?s.$schema="http://json-schema.org/draft-07/schema#":"jsonSchema2019-09"!==r.target&&"openAi"!==r.target||(s.$schema="https://json-schema.org/draft/2019-09/schema#"),"openAi"===r.target&&("anyOf"in s||"oneOf"in s||"allOf"in s||"type"in s&&Array.isArray(s.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),s},Sf=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;var Of=function(e){return"string"===typeof e&&Sf.test(e)};function Ff(e){return e.replace(/[^a-zA-Z-_0-9]/g,"_")}var Pf=["*","_","`"];function Tf(e,t,n){var r,a=null!==n&&void 0!==n?n:{},i=a.firstNode,u=a.lastNode,o=a.nodeColors,s=a.withStyles,c=void 0===s||s,l=a.curveStyle,d=void 0===l?"linear":l,f=a.wrapLabelNWords,p=void 0===f?9:f,h=c?"%%{init: {'flowchart': {'curve': '".concat(d,"'}}}%%\ngraph TD;\n"):"graph TD;\n";if(c){var v="default",m=P({},v,"{0}({1})");void 0!==i&&(m[i]="{0}([{1}]):::first"),void 0!==u&&(m[u]="{0}([{1}]):::last");for(var y=function(){var e,t,n,r,a=w(b[g],2),i=a[0],u=a[1],o=null!==(e=u.name.split(":").pop())&&void 0!==e?e:"",s=Pf.some((function(e){return o.startsWith(e)&&o.endsWith(e)}))?"<p>".concat(o,"</p>"):o;Object.keys(null!==(t=u.metadata)&&void 0!==t?t:{}).length&&(s+="<hr/><small><em>".concat(Object.entries(null!==(r=u.metadata)&&void 0!==r?r:{}).map((function(e){var t=w(e,2),n=t[0],r=t[1];return"".concat(n," = ").concat(r)})).join("\n"),"</em></small>"));var c=(null!==(n=m[i])&&void 0!==n?n:m[v]).replace("{0}",Ff(i)).replace("{1}",s);h+="\t".concat(c,"\n")},g=0,b=Object.entries(e);g<b.length;g++)y()}var _,k={},x=G(t);try{var E=function(){var e=_.value,t=e.source.split(":"),n=e.target.split(":"),r=t.filter((function(e,t){return e===n[t]})).join(":");k[r]||(k[r]=[]),k[r].push(e)};for(x.s();!(_=x.n()).done;)E()}catch(S){x.e(S)}finally{x.f()}var A=new Set;function C(e,t){var n=1===e.length&&e[0].source===e[0].target;if(t&&!n){var r=t.split(":").pop();if(A.has(r))throw new Error("Found duplicate subgraph '".concat(r,"' -- this likely means that ")+"you're reusing a subgraph node with the same name. Please adjust your graph to have subgraph nodes with unique names.");A.add(r),h+="\tsubgraph ".concat(r,"\n")}var a,i=G(e);try{var u=function(){var e=a.value,t=e.source,n=e.target,r=e.data,i=e.conditional,u="";if(void 0!==r){var o=r,s=o.split(" ");s.length>p&&(o=Array.from({length:Math.ceil(s.length/p)},(function(e,t){return s.slice(t*p,(t+1)*p).join(" ")})).join("&nbsp;<br>&nbsp;")),u=i?" -. &nbsp;".concat(o,"&nbsp; .-> "):" -- &nbsp;".concat(o,"&nbsp; --\x3e ")}else u=i?" -.-> ":" --\x3e ";h+="\t".concat(Ff(t)).concat(u).concat(Ff(n),";\n")};for(i.s();!(a=i.n()).done;)u()}catch(S){i.e(S)}finally{i.f()}for(var o in k)o.startsWith("".concat(t,":"))&&o!==t&&C(k[o],o);t&&!n&&(h+="\tend\n")}for(var D in C(null!==(r=k[""])&&void 0!==r?r:[],""),k)D.includes(":")||""===D||C(k[D],D);return c&&(h+=function(e){for(var t="",n=0,r=Object.entries(e);n<r.length;n++){var a=w(r[n],2),i=a[0],u=a[1];t+="\tclassDef ".concat(i," ").concat(u,";\n")}return t}(null!==o&&void 0!==o?o:{})),h}function jf(e,t){return If.apply(this,arguments)}function If(){return(If=b(p().mark((function e(t,n){var r,a,i,u,o,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(null!==n&&void 0!==n?n:{}).backgroundColor,a=void 0===r?"white":r,i=btoa(t),void 0!==a&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(a)||(a="!".concat(a))),u="https://mermaid.ink/img/".concat(i,"?bgColor=").concat(a),e.next=6,fetch(u);case 6:if((o=e.sent).ok){e.next=9;break}throw new Error(["Failed to render the graph using the Mermaid.INK API.","Status code: ".concat(o.status),"Status text: ".concat(o.statusText)].join("\n"));case 9:return e.next=11,o.blob();case 11:return s=e.sent,e.abrupt("return",s);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Nf(e,t){if(void 0!==e&&!Of(e))return e;var n;if(!Jd(t))return null!==(n=t.name)&&void 0!==n?n:"UnknownSchema";try{var r=t.getName();return r=r.startsWith("Runnable")?r.slice(8):r}catch(a){return t.getName()}}var Rf=function(){function e(t){var n,r;T(this,e),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.nodes=null!==(n=null===t||void 0===t?void 0:t.nodes)&&void 0!==n?n:this.nodes,this.edges=null!==(r=null===t||void 0===t?void 0:t.edges)&&void 0!==r?r:this.edges}return I(e,[{key:"toJSON",value:function(){var e={};return Object.values(this.nodes).forEach((function(t,n){e[t.id]=Of(t.id)?n:t.id})),{nodes:Object.values(this.nodes).map((function(t){return q({id:e[t.id]},function(e){return Jd(e.data)?{type:"runnable",data:{id:e.data.lc_id,name:e.data.getName()}}:{type:"schema",data:q(q({},Df(e.data.schema)),{},{title:e.data.name})}}(t))})),edges:this.edges.map((function(t){var n={source:e[t.source],target:e[t.target]};return"undefined"!==typeof t.data&&(n.data=t.data),"undefined"!==typeof t.conditional&&(n.conditional=t.conditional),n}))}}},{key:"addNode",value:function(e,t,n){if(void 0!==t&&void 0!==this.nodes[t])throw new Error("Node with id ".concat(t," already exists"));var r=null!==t&&void 0!==t?t:Ms(),a={id:r,data:e,name:Nf(t,e),metadata:n};return this.nodes[r]=a,a}},{key:"removeNode",value:function(e){delete this.nodes[e.id],this.edges=this.edges.filter((function(t){return t.source!==e.id&&t.target!==e.id}))}},{key:"addEdge",value:function(e,t,n,r){if(void 0===this.nodes[e.id])throw new Error("Source node ".concat(e.id," not in graph"));if(void 0===this.nodes[t.id])throw new Error("Target node ".concat(t.id," not in graph"));var a={source:e.id,target:t.id,data:n,conditional:r};return this.edges.push(a),a}},{key:"firstNode",value:function(){return Bf(this)}},{key:"lastNode",value:function(){return Lf(this)}},{key:"extend",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Object.values(e.nodes).map((function(e){return e.id})).every(Of)&&(n="");var r=function(e){return n?"".concat(n,":").concat(e):e};Object.entries(e.nodes).forEach((function(e){var n=w(e,2),a=n[0],i=n[1];t.nodes[r(a)]=q(q({},i),{},{id:r(a)})}));var a=e.edges.map((function(e){return q(q({},e),{},{source:r(e.source),target:r(e.target)})}));this.edges=[].concat(y(this.edges),y(a));var i=e.firstNode(),u=e.lastNode();return[i?{id:r(i.id),data:i.data}:void 0,u?{id:r(u.id),data:u.data}:void 0]}},{key:"trimFirstNode",value:function(){var e=this.firstNode();e&&Bf(this,[e.id])&&this.removeNode(e)}},{key:"trimLastNode",value:function(){var e=this.lastNode();e&&Lf(this,[e.id])&&this.removeNode(e)}},{key:"reid",value:function(){var t=Object.fromEntries(Object.values(this.nodes).map((function(e){return[e.id,e.name]}))),n=new Map;Object.values(t).forEach((function(e){n.set(e,(n.get(e)||0)+1)}));var r=function(e){var r=t[e];return Of(e)&&1===n.get(r)?r:e};return new e({nodes:Object.fromEntries(Object.entries(this.nodes).map((function(e){var t=w(e,2),n=t[0],a=t[1];return[r(n),q(q({},a),{},{id:r(n)})]}))),edges:this.edges.map((function(e){return q(q({},e),{},{source:r(e.source),target:r(e.target)})}))})}},{key:"drawMermaid",value:function(e){var t=null!==e&&void 0!==e?e:{},n=t.withStyles,r=t.curveStyle,a=t.nodeColors,i=void 0===a?{default:"fill:#f2f0ff,line-height:1.2",first:"fill-opacity:0",last:"fill:#bfb6fc"}:a,u=t.wrapLabelNWords,o=this.reid(),s=o.firstNode(),c=o.lastNode();return Tf(o.nodes,o.edges,{firstNode:null===s||void 0===s?void 0:s.id,lastNode:null===c||void 0===c?void 0:c.id,withStyles:n,curveStyle:r,nodeColors:i,wrapLabelNWords:u})}},{key:"drawMermaidPng",value:function(){var e=b(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.drawMermaid(t),e.abrupt("return",jf(n,{backgroundColor:null===t||void 0===t?void 0:t.backgroundColor}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Bf(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=new Set(e.edges.filter((function(e){return!t.includes(e.source)})).map((function(e){return e.target}))),r=[],a=0,i=Object.values(e.nodes);a<i.length;a++){var u=i[a];t.includes(u.id)||n.has(u.id)||r.push(u)}return 1===r.length?r[0]:void 0}function Lf(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=new Set(e.edges.filter((function(e){return!t.includes(e.target)})).map((function(e){return e.source}))),r=[],a=0,i=Object.values(e.nodes);a<i.length;a++){var u=i[a];t.includes(u.id)||n.has(u.id)||r.push(u)}return 1===r.length?r[0]:void 0}var Mf=p().mark(Hf);function Uf(e){return"object"===typeof e&&null!==e&&"function"===typeof e[Symbol.iterator]&&"function"===typeof e.next}function zf(e){return"object"===typeof e&&null!==e&&"function"===typeof e[Symbol.asyncIterator]}function Hf(e,t){var n,r;return p().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=hd.runWithConfig(wd(e),t.next.bind(t),!0),r=n.value,!n.done){a.next=6;break}return a.abrupt("break",10);case 6:return a.next=8,r;case 8:a.next=0;break;case 10:case"end":return a.stop()}}),Mf)}function Zf(e,t){return Wf.apply(this,arguments)}function Wf(){return(Wf=An(p().mark((function e(t,n){var r,a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n[Symbol.asyncIterator]();case 1:return e.next=4,xn(hd.runWithConfig(wd(t),r.next.bind(n),!0));case 4:if(a=e.sent,i=a.value,!a.done){e.next=11;break}return e.abrupt("break",15);case 11:return e.next=13,i;case 13:e.next=1;break;case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var qf=["runId"],Gf=["runId"],Vf=["runId"];function $f(e,t){return!e||Array.isArray(e)||e instanceof Date||"object"!==typeof e?P({},t,e):e}var Jf=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),e=t.apply(this,arguments),Object.defineProperty(N(e),"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(N(e),"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e}return I(n,[{key:"getName",value:function(e){var t,n,r=null!==(t=null!==(n=this.name)&&void 0!==n?n:this.constructor.lc_name())&&void 0!==t?t:this.constructor.name;return e?"".concat(r).concat(e):r}},{key:"bind",value:function(e){return new Kf({bound:this,kwargs:e,config:{}})}},{key:"map",value:function(){return new Qf({bound:this})}},{key:"withRetry",value:function(e){return new Xf(q({bound:this,kwargs:{},config:{},maxAttemptNumber:null===e||void 0===e?void 0:e.stopAfterAttempt},e))}},{key:"withConfig",value:function(e){return new Kf({bound:this,config:e,kwargs:{}})}},{key:"withFallbacks",value:function(e){var t=Array.isArray(e)?e:e.fallbacks;return new rp({runnable:this,fallbacks:t})}},{key:"_getOptionsList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(Array.isArray(e)&&e.length!==t)throw new Error('Passed "options" must be an array with the same length as the inputs, but got '.concat(e.length," options for ").concat(t," inputs"));if(Array.isArray(e))return e.map(_d);if(t>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");var n=Object.fromEntries(Object.entries(e).filter((function(e){return"runId"!==w(e,1)[0]})));return Array.from({length:t},(function(t,r){return _d(0===r?e:n)}))}return Array.from({length:t},(function(){return _d(e)}))}},{key:"batch",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c,l=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=this._getOptionsList(null!==n&&void 0!==n?n:{},t.length),o=null!==(a=null===(i=u[0])||void 0===i?void 0:i.maxConcurrency)&&void 0!==a?a:null===r||void 0===r?void 0:r.maxConcurrency,s=new Vd({maxConcurrency:o,onFailedAttempt:function(e){throw e}}),c=t.map((function(e,t){return s.call(b(p().mark((function n(){var a;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,l.invoke(e,u[t]);case 3:return a=n.sent,n.abrupt("return",a);case 7:if(n.prev=7,n.t0=n.catch(0),null===r||void 0===r||!r.returnExceptions){n.next=11;break}return n.abrupt("return",n.t0);case 11:throw n.t0;case 12:case"end":return n.stop()}}),n,null,[[0,7]])}))))})),e.abrupt("return",Promise.all(c));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_streamIterator",value:function(e,t){var n=this;return An(p().mark((function r(){return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.invoke(e,t);case 2:case"end":return r.stop()}}),r)})))()}},{key:"stream",value:function(){var e=b(p().mark((function e(t,n){var r,a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=_d(n),a=new Sd({generator:this._streamIterator(t,r),config:r}),e.next=4,a.setup;case 4:return e.abrupt("return",Ad.fromAsyncGenerator(a));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_separateRunnableConfigFromCallOptions",value:function(e){var t;t=_d(void 0===e?e:{callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});var n=q({},e);return delete n.callbacks,delete n.tags,delete n.metadata,delete n.runName,delete n.configurable,delete n.recursionLimit,delete n.maxConcurrency,delete n.runId,delete n.timeout,delete n.signal,[t,n]}},{key:"_callWithConfig",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=_d(r),e.next=3,md(i);case 3:return u=e.sent,e.next=6,null===u||void 0===u?void 0:u.handleChainStart(this.toJSON(),$f(n,"input"),i.runId,null===i||void 0===i?void 0:i.runType,void 0,void 0,null!==(a=null===i||void 0===i?void 0:i.runName)&&void 0!==a?a:this.getName());case 6:return o=e.sent,delete i.runId,e.prev=8,c=t.call(this,n,i,o),e.next=12,xd(c,null===r||void 0===r?void 0:r.signal);case 12:s=e.sent,e.next=20;break;case 15:return e.prev=15,e.t0=e.catch(8),e.next=19,null===o||void 0===o?void 0:o.handleChainError(e.t0);case 19:throw e.t0;case 20:return e.next=22,null===o||void 0===o?void 0:o.handleChainEnd($f(s,"output"));case 22:return e.abrupt("return",s);case 23:case"end":return e.stop()}}),e,this,[[8,15]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_batchWithConfig",value:function(){var e=b(p().mark((function e(t,n,r,a){var i,u,o,s,c,l,d=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this._getOptionsList(null!==r&&void 0!==r?r:{},n.length),e.next=3,Promise.all(i.map(md));case 3:return u=e.sent,e.next=6,Promise.all(u.map(function(){var e=b(p().mark((function e(t,r){var a,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===t||void 0===t?void 0:t.handleChainStart(d.toJSON(),$f(n[r],"input"),i[r].runId,i[r].runType,void 0,void 0,null!==(a=i[r].runName)&&void 0!==a?a:d.getName());case 2:return u=e.sent,delete i[r].runId,e.abrupt("return",u);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 6:return o=e.sent,e.prev=7,l=t.call(this,n,i,o,a),e.next=11,xd(l,null===i||void 0===i||null===(c=i[0])||void 0===c?void 0:c.signal);case 11:s=e.sent,e.next=19;break;case 14:return e.prev=14,e.t0=e.catch(7),e.next=18,Promise.all(o.map((function(t){return null===t||void 0===t?void 0:t.handleChainError(e.t0)})));case 18:throw e.t0;case 19:return e.next=21,Promise.all(o.map((function(e){return null===e||void 0===e?void 0:e.handleChainEnd($f(s,"output"))})));case 21:return e.abrupt("return",s);case 22:case"end":return e.stop()}}),e,this,[[7,14]])})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"_transformStreamWithConfig",value:function(e,t,n){var r=this;return An(p().mark((function a(){var i,u,o,s,c,l,d,f,h,v,m,y,g,_,k,w,x,E,A,C,D,S,O,F;return p().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return v=function(){return v=An(p().mark((function t(){var n,r,a,i,u,c;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=!1,r=!1,t.prev=2,i=Cn(e);case 4:return t.next=6,xn(i.next());case 6:if(!(n=!(u=t.sent).done)){t.next=14;break}if(c=u.value,s)if(void 0===o)o=c;else try{o=Dd(o,c)}catch(l){o=void 0,s=!1}return t.next=11,c;case 11:n=!1,t.next=4;break;case 14:t.next=20;break;case 16:t.prev=16,t.t0=t.catch(2),r=!0,a=t.t0;case 20:if(t.prev=20,t.prev=21,!n||null==i.return){t.next=25;break}return t.next=25,xn(i.return());case 25:if(t.prev=25,!r){t.next=28;break}throw a;case 28:return t.finish(25);case 29:return t.finish(20);case 30:case"end":return t.stop()}}),t,null,[[2,16,20,30],[21,,25,29]])}))),v.apply(this,arguments)},h=function(){return v.apply(this,arguments)},s=!0,l=!0,d=_d(n),a.next=7,xn(md(d));case 7:return f=a.sent,a.prev=8,a.next=11,xn(Od(t.bind(r),h(),b(p().mark((function e(){var t;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===f||void 0===f?void 0:f.handleChainStart(r.toJSON(),{input:""},d.runId,d.runType,void 0,void 0,null!==(t=d.runName)&&void 0!==t?t:r.getName()));case 1:case"end":return e.stop()}}),e)}))),null===n||void 0===n?void 0:n.signal,d));case 11:_=a.sent,delete d.runId,m=_.setup,k=null===(y=m)||void 0===y?void 0:y.handlers.find(Zd),w=_.output,void 0!==k&&void 0!==m&&(w=k.tapOutputIterable(m.runId,w)),void 0!==(x=null===(g=m)||void 0===g?void 0:g.handlers.find(jd))&&void 0!==m&&(w=x.tapOutputIterable(m.runId,w)),E=!1,A=!1,a.prev=21,D=Cn(w);case 23:return a.next=25,xn(D.next());case 25:if(!(E=!(S=a.sent).done)){a.next=33;break}return O=S.value,a.next=29,O;case 29:if(l)if(void 0===c)c=O;else try{c=Dd(c,O)}catch(P){c=void 0,l=!1}case 30:E=!1,a.next=23;break;case 33:a.next=39;break;case 35:a.prev=35,a.t0=a.catch(21),A=!0,C=a.t0;case 39:if(a.prev=39,a.prev=40,!E||null==D.return){a.next=44;break}return a.next=44,xn(D.return());case 44:if(a.prev=44,!A){a.next=47;break}throw C;case 47:return a.finish(44);case 48:return a.finish(39);case 49:a.next=56;break;case 51:return a.prev=51,a.t1=a.catch(8),a.next=55,xn(null===(F=m)||void 0===F?void 0:F.handleChainError(a.t1,void 0,void 0,void 0,{inputs:$f(o,"input")}));case 55:throw a.t1;case 56:return a.next=58,xn(null===(i=m)||void 0===i?void 0:i.handleChainEnd(null!==(u=c)&&void 0!==u?u:{},void 0,void 0,void 0,{inputs:$f(o,"input")}));case 58:case"end":return a.stop()}}),a,null,[[8,51],[21,35,39,49],[40,,44,48]])})))()}},{key:"getGraph",value:function(e){var t=new Rf,n=t.addNode({name:"".concat(this.getName(),"Input"),schema:vn.any()}),r=t.addNode(this),a=t.addNode({name:"".concat(this.getName(),"Output"),schema:vn.any()});return t.addEdge(n,r),t.addEdge(r,a),t}},{key:"pipe",value:function(e){return new Yf({first:this,last:ap(e)})}},{key:"pick",value:function(e){return this.pipe(new up(e))}},{key:"assign",value:function(e){return this.pipe(new ip(new ep({steps:e})))}},{key:"transform",value:function(e,t){var n=this;return An(p().mark((function r(){var a,i,u,o,s,c,l;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i=!1,u=!1,r.prev=2,s=Cn(e);case 4:return r.next=6,xn(s.next());case 6:if(!(i=!(c=r.sent).done)){r.next=12;break}l=c.value,a=void 0===a?l:Dd(a,l);case 9:i=!1,r.next=4;break;case 12:r.next=18;break;case 14:r.prev=14,r.t0=r.catch(2),u=!0,o=r.t0;case 18:if(r.prev=18,r.prev=19,!i||null==s.return){r.next=23;break}return r.next=23,xn(s.return());case 23:if(r.prev=23,!u){r.next=26;break}throw o;case 26:return r.finish(23);case 27:return r.finish(18);case 28:return r.delegateYield(Os(Cn(n._streamIterator(a,_d(t)))),"t1",29);case 29:case"end":return r.stop()}}),r,null,[[2,14,18,28],[19,,23,27]])})))()}},{key:"streamLog",value:function(e,t,n){var r=this;return An(p().mark((function a(){var i,u;return p().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i=new Ld(q(q({},n),{},{autoClose:!1,_schemaFormat:"original"})),u=_d(t),a.delegateYield(Os(Cn(r._streamLog(e,i,u))),"t0",3);case 3:case"end":return a.stop()}}),a)})))()}},{key:"_streamLog",value:function(e,t,n){var r=this;return An(p().mark((function a(){var i,u,o,s,c,l,d,f,h,v,m,y;return p().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:c=function(){return(c=b(p().mark((function e(){var n,r,a,i,u,s,c,l;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o;case 3:n=e.sent,r=!1,a=!1,e.prev=6,u=Cn(n);case 8:return e.next=10,u.next();case 10:if(!(r=!(s=e.sent).done)){e.next=18;break}return c=s.value,l=new Pd({ops:[{op:"add",path:"/streamed_output/-",value:c}]}),e.next=15,t.writer.write(l);case 15:r=!1,e.next=8;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(6),a=!0,i=e.t0;case 24:if(e.prev=24,e.prev=25,!r||null==u.return){e.next=29;break}return e.next=29,u.return();case 29:if(e.prev=29,!a){e.next=32;break}throw i;case 32:return e.finish(29);case 33:return e.finish(24);case 34:return e.prev=34,e.next=37,t.writer.close();case 37:return e.finish(34);case 38:case"end":return e.stop()}}),e,null,[[0,,34,38],[6,20,24,34],[25,,29,33]])})))).apply(this,arguments)},s=function(){return c.apply(this,arguments)},void 0===(i=n.callbacks)?n.callbacks=[t]:Array.isArray(i)?n.callbacks=i.concat([t]):((u=i.copy()).addHandler(t,!0),n.callbacks=u),o=r.stream(e,n),l=s(),a.prev=6,d=!1,f=!1,a.prev=9,v=Cn(t);case 11:return a.next=13,xn(v.next());case 13:if(!(d=!(m=a.sent).done)){a.next=20;break}return y=m.value,a.next=17,y;case 17:d=!1,a.next=11;break;case 20:a.next=26;break;case 22:a.prev=22,a.t0=a.catch(9),f=!0,h=a.t0;case 26:if(a.prev=26,a.prev=27,!d||null==v.return){a.next=31;break}return a.next=31,xn(v.return());case 31:if(a.prev=31,!f){a.next=34;break}throw h;case 34:return a.finish(31);case 35:return a.finish(26);case 36:return a.prev=36,a.next=39,xn(l);case 39:return a.finish(36);case 40:case"end":return a.stop()}}),a,null,[[6,,36,40],[9,22,26,36],[27,,31,35]])})))()}},{key:"streamEvents",value:function(e,t,n){var r;if("v1"===t.version)r=this._streamEventsV1(e,t,n);else{if("v2"!==t.version)throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');r=this._streamEventsV2(e,t,n)}return"text/event-stream"===t.encoding?function(e){var t=new TextEncoder,n=new ReadableStream({start:function(n){return b(p().mark((function r(){var a,i,u,o,s,c;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:a=!1,i=!1,r.prev=2,o=Cn(e);case 4:return r.next=6,o.next();case 6:if(!(a=!(s=r.sent).done)){r.next=12;break}c=s.value,n.enqueue(t.encode("event: data\ndata: ".concat(JSON.stringify(c),"\n\n")));case 9:a=!1,r.next=4;break;case 12:r.next=18;break;case 14:r.prev=14,r.t0=r.catch(2),i=!0,u=r.t0;case 18:if(r.prev=18,r.prev=19,!a||null==o.return){r.next=23;break}return r.next=23,o.return();case 23:if(r.prev=23,!i){r.next=26;break}throw u;case 26:return r.finish(23);case 27:return r.finish(18);case 28:n.enqueue(t.encode("event: end\n\n")),n.close();case 30:case"end":return r.stop()}}),r,null,[[2,14,18,28],[19,,23,27]])})))()}});return Ad.fromReadableStream(n)}(r):Ad.fromAsyncGenerator(r)}},{key:"_streamEventsV2",value:function(e,t,n){var r=this;return An(p().mark((function a(){var i,u,o,s,c,l,d,f,h,v,m,y,g,_,k,w,x,E,A,C;return p().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:v=function(){return(v=b(p().mark((function n(){var r,a,i,c,l,h,v,m;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,null!==t&&void 0!==t&&t.signal?"any"in AbortSignal?r=AbortSignal.any([d.signal,t.signal]):(r=t.signal,t.signal.addEventListener("abort",(function(){d.abort()}),{once:!0})):r=d.signal,n.next=4,f.stream(e,q(q({},o),{},{signal:r}));case 4:a=n.sent,i=u.tapOutputIterable(s,a),c=!1,l=!1,n.prev=8,v=Cn(i);case 10:return n.next=12,v.next();case 12:if(!(c=!(m=n.sent).done)){n.next=19;break}if(m.value,!d.signal.aborted){n.next=16;break}return n.abrupt("break",19);case 16:c=!1,n.next=10;break;case 19:n.next=25;break;case 21:n.prev=21,n.t0=n.catch(8),l=!0,h=n.t0;case 25:if(n.prev=25,n.prev=26,!c||null==v.return){n.next=30;break}return n.next=30,v.return();case 30:if(n.prev=30,!l){n.next=33;break}throw h;case 33:return n.finish(30);case 34:return n.finish(25);case 35:return n.prev=35,n.next=38,u.finish();case 38:return n.finish(35);case 39:case"end":return n.stop()}}),n,null,[[0,,35,39],[8,21,25,35],[26,,30,34]])})))).apply(this,arguments)},h=function(){return v.apply(this,arguments)},u=new Wd(q(q({},n),{},{autoClose:!1})),o=_d(t),s=null!==(i=o.runId)&&void 0!==i?i:Ms(),o.runId=s,void 0===(c=o.callbacks)?o.callbacks=[u]:Array.isArray(c)?o.callbacks=c.concat(u):((l=c.copy()).addHandler(u,!0),o.callbacks=l),d=new AbortController,f=r,m=h(),y=!1,a.prev=12,_=!1,k=!1,a.prev=15,x=Cn(u);case 17:return a.next=19,xn(x.next());case 19:if(!(_=!(E=a.sent).done)){a.next=34;break}if(A=E.value,y){a.next=28;break}return A.data.input=e,y=!0,g=A.run_id,a.next=27,A;case 27:return a.abrupt("continue",31);case 28:return A.run_id===g&&A.event.endsWith("_end")&&null!==(C=A.data)&&void 0!==C&&C.input&&delete A.data.input,a.next=31,A;case 31:_=!1,a.next=17;break;case 34:a.next=40;break;case 36:a.prev=36,a.t0=a.catch(15),k=!0,w=a.t0;case 40:if(a.prev=40,a.prev=41,!_||null==x.return){a.next=45;break}return a.next=45,xn(x.return());case 45:if(a.prev=45,!k){a.next=48;break}throw w;case 48:return a.finish(45);case 49:return a.finish(40);case 50:return a.prev=50,d.abort(),a.next=54,xn(m);case 54:return a.finish(50);case 55:case"end":return a.stop()}}),a,null,[[12,,50,55],[15,36,40,50],[41,,45,49]])})))()}},{key:"_streamEventsV1",value:function(e,t,n){var r=this;return An(p().mark((function a(){var i,u,o,s,c,l,d,f,h,v,m,g,b,_,k,w,x,E,A,C,D,S,O,F,P,T,j,I,N,R,B,L,M,U,z,H;return p().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:l=!1,d=_d(t),f=null!==(i=d.tags)&&void 0!==i?i:[],h=null!==(u=d.metadata)&&void 0!==u?u:{},v=null!==(o=d.runName)&&void 0!==o?o:r.getName(),m=new Ld(q(q({},n),{},{autoClose:!1,_schemaFormat:"streaming_events"})),g=new Kd(q({},n)),b=r._streamLog(e,m,d),_=!1,k=!1,a.prev=10,x=Cn(b);case 12:return a.next=14,xn(x.next());case 14:if(!(_=!(E=a.sent).done)){a.next=78;break}if(A=E.value,void 0!==(c=c?c.concat(A):Td.fromRunLogPatch(A)).state){a.next=19;break}throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');case 19:if(l){a.next=26;break}if(l=!0,C=q({},c.state),D={run_id:C.id,event:"on_".concat(C.type,"_start"),name:v,tags:f,metadata:h,data:{input:e}},!g.includeEvent(D,C.type)){a.next=26;break}return a.next=26,D;case 26:S=A.ops.filter((function(e){return e.path.startsWith("/logs/")})).map((function(e){return e.path.split("/")[2]})),O=y(new Set(S)),F=G(O),a.prev=29,F.s();case 31:if((P=F.n()).done){a.next=56;break}if(T=P.value,j=void 0,I={},N=c.state.logs[T],"start"!==(j=void 0===N.end_time?N.streamed_output.length>0?"stream":"start":"end")){a.next=41;break}void 0!==N.inputs&&(I.input=N.inputs),a.next=52;break;case 41:if("end"!==j){a.next=46;break}void 0!==N.inputs&&(I.input=N.inputs),I.output=N.final_output,a.next=52;break;case 46:if("stream"!==j){a.next=52;break}if(1===(R=N.streamed_output.length)){a.next=50;break}throw new Error("Expected exactly one chunk of streamed output, got ".concat(R,' instead. Encountered in: "').concat(N.name,'"'));case 50:I={chunk:N.streamed_output[0]},N.streamed_output=[];case 52:return a.next=54,{event:"on_".concat(N.type,"_").concat(j),name:N.name,run_id:N.id,tags:N.tags,metadata:N.metadata,data:I};case 54:a.next=31;break;case 56:a.next=61;break;case 58:a.prev=58,a.t0=a.catch(29),F.e(a.t0);case 61:return a.prev=61,F.f(),a.finish(61);case 64:if(!((B=c.state).streamed_output.length>0)){a.next=75;break}if(1===(L=B.streamed_output.length)){a.next=69;break}throw new Error("Expected exactly one chunk of streamed output, got ".concat(L,' instead. Encountered in: "').concat(B.name,'"'));case 69:if(M={chunk:B.streamed_output[0]},B.streamed_output=[],U={event:"on_".concat(B.type,"_stream"),run_id:B.id,tags:f,metadata:h,name:v,data:M},!g.includeEvent(U,B.type)){a.next=75;break}return a.next=75,U;case 75:_=!1,a.next=12;break;case 78:a.next=84;break;case 80:a.prev=80,a.t1=a.catch(10),k=!0,w=a.t1;case 84:if(a.prev=84,a.prev=85,!_||null==x.return){a.next=89;break}return a.next=89,xn(x.return());case 89:if(a.prev=89,!k){a.next=92;break}throw w;case 92:return a.finish(89);case 93:return a.finish(84);case 94:if(void 0===(z=null===(s=c)||void 0===s?void 0:s.state)){a.next=100;break}if(H={event:"on_".concat(z.type,"_end"),name:v,run_id:z.id,tags:f,metadata:h,data:{output:z.final_output}},!g.includeEvent(H,z.type)){a.next=100;break}return a.next=100,H;case 100:case"end":return a.stop()}}),a,null,[[10,80,84,94],[29,58,61,64],[85,,89,93]])})))()}},{key:"withListeners",value:function(e){var t=e.onStart,n=e.onEnd,r=e.onError;return new Kf({bound:this,config:{},configFactories:[function(e){return{callbacks:[new $d({config:e,onStart:t,onEnd:n,onError:r})]}}]})}},{key:"asTool",value:function(e){return function(e,t){var n,r,a,i=null!==(n=t.name)&&void 0!==n?n:e.getName(),u=null!==(r=t.description)&&void 0!==r?r:null===(a=t.schema)||void 0===a?void 0:a.description;if(t.schema.constructor===vn.ZodString)return new op({name:i,description:u,schema:vn.object({input:vn.string()}).transform((function(e){return e.input})),bound:e});return new op({name:i,description:u,schema:t.schema,bound:e})}(this,e)}}],[{key:"isRunnable",value:function(e){return Jd(e)}}]),n}(Qo),Kf=function(e){B(n,e);var t=z(n);function n(e){var r;return T(this,n),r=t.call(this,e),Object.defineProperty(N(r),"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(N(r),"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(N(r),"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(r),"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(r),"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(r),"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.bound=e.bound,r.kwargs=e.kwargs,r.config=e.config,r.configFactories=e.configFactories,r}return I(n,[{key:"getName",value:function(e){return this.bound.getName(e)}},{key:"_mergeConfig",value:function(){var e=b(p().mark((function e(){var t,n,r,a,i=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=i.length,n=new Array(t),r=0;r<t;r++)n[r]=i[r];if(a=gd.apply(void 0,[this.config].concat(n)),e.t0=gd,e.t1=void 0,e.t2=[a],e.t3=y,!this.configFactories){e.next=12;break}return e.next=9,Promise.all(this.configFactories.map(function(){var e=b(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 9:e.t4=e.sent,e.next=13;break;case 12:e.t4=[];case 13:return e.t5=e.t4,e.t6=(0,e.t3)(e.t5),e.t7=e.t2.concat.call(e.t2,e.t6),e.abrupt("return",e.t0.apply.call(e.t0,e.t1,e.t7));case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"bind",value:function(e){return new this.constructor({bound:this.bound,kwargs:q(q({},this.kwargs),e),config:this.config})}},{key:"withConfig",value:function(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:q(q({},this.config),e)})}},{key:"withRetry",value:function(e){return new this.constructor({bound:this.bound.withRetry(e),kwargs:this.kwargs,config:this.config})}},{key:"invoke",value:function(){var e=b(p().mark((function e(t,n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this.bound,e.t1=t,e.next=4,this._mergeConfig(_d(n),this.kwargs);case 4:return e.t2=e.sent,e.abrupt("return",e.t0.invoke.call(e.t0,e.t1,e.t2));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"batch",value:function(){var e=b(p().mark((function e(t,n,r){var a,i=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Array.isArray(n)){e.next=6;break}return e.next=3,Promise.all(n.map(function(){var e=b(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i._mergeConfig(_d(t),i.kwargs));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,this._mergeConfig(_d(n),this.kwargs);case 8:e.t0=e.sent;case 9:return a=e.t0,e.abrupt("return",this.bound.batch(t,a,r));case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_streamIterator",value:function(e,t){var n=this;return An(p().mark((function r(){return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=Os,r.t1=Cn,r.t2=n.bound,r.t3=e,r.next=6,xn(n._mergeConfig(_d(t),n.kwargs));case 6:return r.t4=r.sent,r.t5=r.t2._streamIterator.call(r.t2,r.t3,r.t4),r.t6=(0,r.t1)(r.t5),r.t7=xn,r.delegateYield((0,r.t0)(r.t6,r.t7),"t8",11);case 11:case"end":return r.stop()}}),r)})))()}},{key:"stream",value:function(){var e=b(p().mark((function e(t,n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this.bound,e.t1=t,e.next=4,this._mergeConfig(_d(n),this.kwargs);case 4:return e.t2=e.sent,e.abrupt("return",e.t0.stream.call(e.t0,e.t1,e.t2));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"transform",value:function(e,t){var n=this;return An(p().mark((function r(){return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=Os,r.t1=Cn,r.t2=n.bound,r.t3=e,r.next=6,xn(n._mergeConfig(_d(t),n.kwargs));case 6:return r.t4=r.sent,r.t5=r.t2.transform.call(r.t2,r.t3,r.t4),r.t6=(0,r.t1)(r.t5),r.t7=xn,r.delegateYield((0,r.t0)(r.t6,r.t7),"t8",11);case 11:case"end":return r.stop()}}),r)})))()}},{key:"streamEvents",value:function(e,t,n){var r=this,a=function(){var a=An(p().mark((function a(){return p().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.t0=Os,a.t1=Cn,a.t2=r.bound,a.t3=e,a.t4=q,a.t5=q,a.t6={},a.next=9,xn(r._mergeConfig(_d(t),r.kwargs));case 9:return a.t7=a.sent,a.t8=(0,a.t5)(a.t6,a.t7),a.t9={},a.t10={version:t.version},a.t11=(0,a.t4)(a.t8,a.t9,a.t10),a.t12=n,a.t13=a.t2.streamEvents.call(a.t2,a.t3,a.t11,a.t12),a.t14=(0,a.t1)(a.t13),a.t15=xn,a.delegateYield((0,a.t0)(a.t14,a.t15),"t16",19);case 19:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}();return Ad.fromAsyncGenerator(a())}},{key:"withListeners",value:function(e){var t=e.onStart,r=e.onEnd,a=e.onError;return new n({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[function(e){return{callbacks:[new $d({config:e,onStart:t,onEnd:r,onError:a})]}}]})}}],[{key:"lc_name",value:function(){return"RunnableBinding"}},{key:"isRunnableBinding",value:function(e){return e.bound&&Jf.isRunnable(e.bound)}}]),n}(Jf),Qf=function(e){B(n,e);var t=z(n);function n(e){var r;return T(this,n),r=t.call(this,e),Object.defineProperty(N(r),"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(N(r),"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(N(r),"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.bound=e.bound,r}return I(n,[{key:"bind",value:function(e){return new n({bound:this.bound.bind(e)})}},{key:"invoke",value:function(){var e=b(p().mark((function e(t,n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._callWithConfig(this._invoke.bind(this),t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_invoke",value:function(){var e=b(p().mark((function e(t,n,r){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.bound.batch(t,kd(n,{callbacks:null===r||void 0===r?void 0:r.getChild()})));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"withListeners",value:function(e){var t=e.onStart,r=e.onEnd,a=e.onError;return new n({bound:this.bound.withListeners({onStart:t,onEnd:r,onError:a})})}}],[{key:"lc_name",value:function(){return"RunnableEach"}}]),n}(Jf),Xf=function(e){B(n,e);var t=z(n);function n(e){var r,a,i;return T(this,n),i=t.call(this,e),Object.defineProperty(N(i),"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(N(i),"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(N(i),"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:function(){}}),i.maxAttemptNumber=null!==(r=e.maxAttemptNumber)&&void 0!==r?r:i.maxAttemptNumber,i.onFailedAttempt=null!==(a=e.onFailedAttempt)&&void 0!==a?a:i.onFailedAttempt,i}return I(n,[{key:"_patchConfigForRetry",value:function(e,t,n){var r=e>1?"retry:attempt:".concat(e):void 0;return kd(t,{callbacks:null===n||void 0===n?void 0:n.getChild(r)})}},{key:"_invoke",value:function(){var e=b(p().mark((function e(t,r,a){var i=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ps((function(e){return kn(L(n.prototype),"invoke",i).call(i,t,i._patchConfigForRetry(e,r,a))}),{onFailedAttempt:function(e){return i.onFailedAttempt(e,t)},retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"invoke",value:function(){var e=b(p().mark((function e(t,n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._callWithConfig(this._invoke.bind(this),t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_batch",value:function(){var e=b(p().mark((function e(t,r,a,i){var u,o=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u={},e.prev=1,e.next=4,Ps(function(){var e=b(p().mark((function e(s){var c,l,d,f,h,v,m,y;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.map((function(e,t){return t})).filter((function(e){return void 0===u[e.toString()]||u[e.toString()]instanceof Error})),l=c.map((function(e){return t[e]})),d=c.map((function(e){return o._patchConfigForRetry(s,null===r||void 0===r?void 0:r[e],null===a||void 0===a?void 0:a[e])})),e.next=5,kn(L(n.prototype),"batch",o).call(o,l,d,q(q({},i),{},{returnExceptions:!0}));case 5:for(f=e.sent,v=0;v<f.length;v+=1)m=f[v],y=c[v],m instanceof Error&&void 0===h&&((h=m).input=l[v]),u[y.toString()]=m;if(!h){e.next=9;break}throw h;case 9:return e.abrupt("return",f);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onFailedAttempt:function(e){return o.onFailedAttempt(e,e.input)},retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0});case 4:e.next=10;break;case 6:if(e.prev=6,e.t0=e.catch(1),!0===(null===i||void 0===i?void 0:i.returnExceptions)){e.next=10;break}throw e.t0;case 10:return e.abrupt("return",Object.keys(u).sort((function(e,t){return parseInt(e,10)-parseInt(t,10)})).map((function(e){return u[parseInt(e,10)]})));case 11:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"batch",value:function(){var e=b(p().mark((function e(t,n,r){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._batchWithConfig(this._batch.bind(this),t,n,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}],[{key:"lc_name",value:function(){return"RunnableRetry"}}]),n}(Kf),Yf=function(e){B(n,e);var t=z(n);function n(e){var r,a,i;return T(this,n),i=t.call(this,e),Object.defineProperty(N(i),"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(i),"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(N(i),"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(i),"omitSequenceTags",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(N(i),"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(N(i),"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),i.first=e.first,i.middle=null!==(r=e.middle)&&void 0!==r?r:i.middle,i.last=e.last,i.name=e.name,i.omitSequenceTags=null!==(a=e.omitSequenceTags)&&void 0!==a?a:i.omitSequenceTags,i}return I(n,[{key:"steps",get:function(){return[this.first].concat(y(this.middle),[this.last])}},{key:"invoke",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u,o,s,c,l,d,f;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=_d(n),e.next=3,md(r);case 3:return a=e.sent,e.next=6,null===a||void 0===a?void 0:a.handleChainStart(this.toJSON(),$f(t,"input"),r.runId,void 0,void 0,void 0,null===r||void 0===r?void 0:r.runName);case 6:i=e.sent,delete r.runId,u=t,e.prev=9,c=[this.first].concat(y(this.middle)),l=0;case 12:if(!(l<c.length)){e.next=21;break}return d=c[l],f=d.invoke(u,kd(r,{callbacks:null===i||void 0===i?void 0:i.getChild(this.omitSequenceTags?void 0:"seq:step:".concat(l+1))})),e.next=17,xd(f,null===n||void 0===n?void 0:n.signal);case 17:u=e.sent;case 18:l+=1,e.next=12;break;case 21:if(null===n||void 0===n||null===(s=n.signal)||void 0===s||!s.aborted){e.next=23;break}throw new Error("Aborted");case 23:return e.next=25,this.last.invoke(u,kd(r,{callbacks:null===i||void 0===i?void 0:i.getChild(this.omitSequenceTags?void 0:"seq:step:".concat(this.steps.length))}));case 25:o=e.sent,e.next=33;break;case 28:return e.prev=28,e.t0=e.catch(9),e.next=32,null===i||void 0===i?void 0:i.handleChainError(e.t0);case 32:throw e.t0;case 33:return e.next=35,null===i||void 0===i?void 0:i.handleChainEnd($f(o,"output"));case 35:return e.abrupt("return",o);case 36:case"end":return e.stop()}}),e,this,[[9,28]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"batch",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c,l=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this._getOptionsList(null!==n&&void 0!==n?n:{},t.length),e.next=3,Promise.all(a.map(md));case 3:return i=e.sent,e.next=6,Promise.all(i.map(function(){var e=b(p().mark((function e(n,r){var i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===n||void 0===n?void 0:n.handleChainStart(l.toJSON(),$f(t[r],"input"),a[r].runId,void 0,void 0,void 0,a[r].runName);case 2:return i=e.sent,delete a[r].runId,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 6:u=e.sent,o=t,e.prev=8,s=p().mark((function e(t){var n,i,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=l.steps[t],s=i.batch(o,u.map((function(e,n){var r=null===e||void 0===e?void 0:e.getChild(l.omitSequenceTags?void 0:"seq:step:".concat(t+1));return kd(a[n],{callbacks:r})})),r),e.next=4,xd(s,null===(n=a[0])||void 0===n?void 0:n.signal);case 4:o=e.sent;case 5:case"end":return e.stop()}}),e)})),c=0;case 11:if(!(c<this.steps.length)){e.next=16;break}return e.delegateYield(s(c),"t0",13);case 13:c+=1,e.next=11;break;case 16:e.next=23;break;case 18:return e.prev=18,e.t1=e.catch(8),e.next=22,Promise.all(u.map((function(t){return null===t||void 0===t?void 0:t.handleChainError(e.t1)})));case 22:throw e.t1;case 23:return e.next=25,Promise.all(u.map((function(e){return null===e||void 0===e?void 0:e.handleChainEnd($f(o,"output"))})));case 25:return e.abrupt("return",o);case 26:case"end":return e.stop()}}),e,this,[[8,18]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_streamIterator",value:function(e,t){var n=this;return An(p().mark((function r(){var a,i,u,o,s,c,l,d,f,h,v,m,g,b,_,k,w,x,E,A;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return h=function(){return(h=An(p().mark((function t(){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)},f=function(){return h.apply(this,arguments)},r.next=4,xn(md(t));case 4:return a=r.sent,u=(i=null!==t&&void 0!==t?t:{}).runId,o=Sn(i,qf),r.next=8,xn(null===a||void 0===a?void 0:a.handleChainStart(n.toJSON(),$f(e,"input"),u,void 0,void 0,void 0,null===o||void 0===o?void 0:o.runName));case 8:s=r.sent,c=[n.first].concat(y(n.middle),[n.last]),l=!0,r.prev=11,v=c[0].transform(f(),kd(o,{callbacks:null===s||void 0===s?void 0:s.getChild(n.omitSequenceTags?void 0:"seq:step:1")})),m=1;case 14:if(!(m<c.length)){r.next=22;break}return g=c[m],r.next=18,xn(g.transform(v,kd(o,{callbacks:null===s||void 0===s?void 0:s.getChild(n.omitSequenceTags?void 0:"seq:step:".concat(m+1))})));case 18:v=r.sent;case 19:m+=1,r.next=14;break;case 22:b=!1,_=!1,r.prev=24,w=Cn(v);case 26:return r.next=28,xn(w.next());case 28:if(!(b=!(x=r.sent).done)){r.next=37;break}return E=x.value,null===t||void 0===t||null===(A=t.signal)||void 0===A||A.throwIfAborted(),r.next=33,E;case 33:if(l)if(void 0===d)d=E;else try{d=Dd(d,E)}catch(C){d=void 0,l=!1}case 34:b=!1,r.next=26;break;case 37:r.next=43;break;case 39:r.prev=39,r.t0=r.catch(24),_=!0,k=r.t0;case 43:if(r.prev=43,r.prev=44,!b||null==w.return){r.next=48;break}return r.next=48,xn(w.return());case 48:if(r.prev=48,!_){r.next=51;break}throw k;case 51:return r.finish(48);case 52:return r.finish(43);case 53:r.next=60;break;case 55:return r.prev=55,r.t1=r.catch(11),r.next=59,xn(null===s||void 0===s?void 0:s.handleChainError(r.t1));case 59:throw r.t1;case 60:return r.next=62,xn(null===s||void 0===s?void 0:s.handleChainEnd($f(d,"output")));case 62:case"end":return r.stop()}}),r,null,[[11,55],[24,39,43,53],[44,,48,52]])})))()}},{key:"getGraph",value:function(e){var t=this,n=new Rf,r=null;return this.steps.forEach((function(a,i){var u=a.getGraph(e);0!==i&&u.trimFirstNode(),i!==t.steps.length-1&&u.trimLastNode(),n.extend(u);var o=u.firstNode();if(!o)throw new Error("Runnable ".concat(a," has no first node"));r&&n.addEdge(r,o),r=u.lastNode()})),n}},{key:"pipe",value:function(e){var t;return n.isRunnableSequence(e)?new n({first:this.first,middle:this.middle.concat([this.last,e.first].concat(y(e.middle))),last:e.last,name:null!==(t=this.name)&&void 0!==t?t:e.name}):new n({first:this.first,middle:[].concat(y(this.middle),[this.last]),last:ap(e),name:this.name})}}],[{key:"lc_name",value:function(){return"RunnableSequence"}},{key:"isRunnableSequence",value:function(e){return Array.isArray(e.middle)&&Jf.isRunnable(e)}},{key:"from",value:function(e,t){var r=Wo(e),a=r[0],i=r.slice(1),u={};return"string"===typeof t?u.name=t:void 0!==t&&(u=t),new n(q(q({},u),{},{first:ap(a),middle:i.slice(0,-1).map(ap),last:ap(i[i.length-1])}))}}]),n}(Jf),ep=function(e){B(n,e);var t=z(n);function n(e){var r;T(this,n),r=t.call(this,e),Object.defineProperty(N(r),"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(N(r),"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(N(r),"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.steps={};for(var a=0,i=Object.entries(e.steps);a<i.length;a++){var u=w(i[a],2),o=u[0],s=u[1];r.steps[o]=ap(s)}return r}return I(n,[{key:"getStepsKeys",value:function(){return Object.keys(this.steps)}},{key:"invoke",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=_d(n),e.next=3,md(r);case 3:return a=e.sent,e.next=6,null===a||void 0===a?void 0:a.handleChainStart(this.toJSON(),{input:t},r.runId,void 0,void 0,void 0,null===r||void 0===r?void 0:r.runName);case 6:return i=e.sent,delete r.runId,u={},e.prev=9,o=Object.entries(this.steps).map(function(){var e=b(p().mark((function e(n){var a,o,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=w(n,2),o=a[0],s=a[1],e.next=3,s.invoke(t,kd(r,{callbacks:null===i||void 0===i?void 0:i.getChild("map:key:".concat(o))}));case 3:u[o]=e.sent;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=13,xd(Promise.all(o),null===n||void 0===n?void 0:n.signal);case 13:e.next=20;break;case 15:return e.prev=15,e.t0=e.catch(9),e.next=19,null===i||void 0===i?void 0:i.handleChainError(e.t0);case 19:throw e.t0;case 20:return e.next=22,null===i||void 0===i?void 0:i.handleChainEnd(u);case 22:return e.abrupt("return",u);case 23:case"end":return e.stop()}}),e,this,[[9,15]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_transform",value:function(e,t,n){var r=this;return An(p().mark((function a(){var i,u,o,s;return p().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:i=q({},r.steps),u=Cd(e,Object.keys(i).length),o=new Map(Object.entries(i).map((function(e,r){var a=w(e,2),i=a[0],o=a[1].transform(u[r],kd(n,{callbacks:null===t||void 0===t?void 0:t.getChild("map:key:".concat(i))}));return[i,o.next().then((function(e){return{key:i,gen:o,result:e}}))]}))),s=p().mark((function e(){var t,r,a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Promise.race(o.values()),e.next=3,xn(xd(t,null===n||void 0===n?void 0:n.signal));case 3:if(r=e.sent,a=r.key,i=r.result,u=r.gen,o.delete(a),i.done){e.next=12;break}return e.next=11,P({},a,i.value);case 11:o.set(a,u.next().then((function(e){return{key:a,gen:u,result:e}})));case 12:case"end":return e.stop()}}),e)}));case 4:if(!o.size){a.next=8;break}return a.delegateYield(s(),"t0",6);case 6:a.next=4;break;case 8:case"end":return a.stop()}}),a)})))()}},{key:"transform",value:function(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}},{key:"stream",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(){return(a=An(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)},r=function(){return a.apply(this,arguments)},i=_d(n),u=new Sd({generator:this.transform(r(),i),config:i}),e.next=6,u.setup;case 6:return e.abrupt("return",Ad.fromAsyncGenerator(u));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"lc_name",value:function(){return"RunnableMap"}},{key:"from",value:function(e){return new n({steps:e})}}]),n}(Jf),tp=function(e){B(n,e);var t=z(n);function n(e){var r;if(T(this,n),r=t.call(this,e),Object.defineProperty(N(r),"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(N(r),"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(N(r),"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!nl(e.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");return r.func=e.func,r}return I(n,[{key:"invoke",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._getOptionsList(null!==n&&void 0!==n?n:{},1),a=w(r,1),i=a[0],e.next=3,md(i);case 3:return u=e.sent,o=this.func(kd(i,{callbacks:u}),t),e.abrupt("return",xd(o,null===i||void 0===i?void 0:i.signal));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_streamIterator",value:function(e,t){var n=this;return An(p().mark((function r(){var a,i,u,o,s,c,l,d,f,h,v,m,y;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=n._getOptionsList(null!==t&&void 0!==t?t:{},1),i=w(a,1),u=i[0],r.next=3,xn(n.invoke(e,t));case 3:if(!zf(o=r.sent)){r.next=36;break}s=!1,c=!1,r.prev=7,d=Cn(o);case 9:return r.next=11,xn(d.next());case 11:if(!(s=!(f=r.sent).done)){r.next=19;break}return h=f.value,null===u||void 0===u||null===(v=u.signal)||void 0===v||v.throwIfAborted(),r.next=16,h;case 16:s=!1,r.next=9;break;case 19:r.next=25;break;case 21:r.prev=21,r.t0=r.catch(7),c=!0,l=r.t0;case 25:if(r.prev=25,r.prev=26,!s||null==d.return){r.next=30;break}return r.next=30,xn(d.return());case 30:if(r.prev=30,!c){r.next=33;break}throw l;case 33:return r.finish(30);case 34:return r.finish(25);case 35:return r.abrupt("return");case 36:if(null==(p=o)||"object"!==typeof p||!("next"in p)||"function"!==typeof p.next){r.next=47;break}case 37:if(null===u||void 0===u||null===(m=u.signal)||void 0===m||m.throwIfAborted(),!(y=o.next()).done){r.next=42;break}return r.abrupt("break",46);case 42:return r.next=44,y.value;case 44:r.next=37;break;case 46:return r.abrupt("return");case 47:return r.next=49,o;case 49:case"end":return r.stop()}var p}),r,null,[[7,21,25,35],[26,,30,34]])})))()}}],[{key:"from",value:function(e){return new n({func:e})}}]),n}(Jf);var np=function(e){B(n,e);var t=z(n);function n(e){var r;return T(this,n),nl(e.func)?U(r,tp.from(e.func)):(r=t.call(this,e),Object.defineProperty(N(r),"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(N(r),"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),function(e){if(nl(e))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}(e.func),r.func=e.func,r)}return I(n,[{key:"_invoke",value:function(){var e=b(p().mark((function e(t,n,r){var a=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){var u,o=kd(n,{callbacks:null===r||void 0===r?void 0:r.getChild(),recursionLimit:(null!==(u=null===n||void 0===n?void 0:n.recursionLimit)&&void 0!==u?u:25)-1});hd.runWithConfig(wd(o),b(p().mark((function r(){var u,s,c,l,d,f,h,v,m,y,g,b,_,k,w;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,a.func(t,q({},o));case 3:if(!(u=r.sent)||!Jf.isRunnable(u)){r.next=12;break}if(0!==(null===n||void 0===n?void 0:n.recursionLimit)){r.next=7;break}throw new Error("Recursion limit reached.");case 7:return r.next=9,u.invoke(t,q(q({},o),{},{recursionLimit:(null!==(s=o.recursionLimit)&&void 0!==s?s:25)-1}));case 9:u=r.sent,r.next=46;break;case 12:if(!zf(u)){r.next=45;break}l=!1,d=!1,r.prev=15,h=Cn(Zf(o,u));case 17:return r.next=19,h.next();case 19:if(!(l=!(v=r.sent).done)){r.next=26;break}if(m=v.value,null===n||void 0===n||null===(y=n.signal)||void 0===y||y.throwIfAborted(),void 0===c)c=m;else try{c=Dd(c,m)}catch(p){c=m}case 23:l=!1,r.next=17;break;case 26:r.next=32;break;case 28:r.prev=28,r.t0=r.catch(15),d=!0,f=r.t0;case 32:if(r.prev=32,r.prev=33,!l||null==h.return){r.next=37;break}return r.next=37,h.return();case 37:if(r.prev=37,!d){r.next=40;break}throw f;case 40:return r.finish(37);case 41:return r.finish(32);case 42:u=c,r.next=46;break;case 45:if(Uf(u)){b=G(Hf(o,u));try{for(b.s();!(_=b.n()).done;)if(w=_.value,null===n||void 0===n||null===(k=n.signal)||void 0===k||k.throwIfAborted(),void 0===g)g=w;else try{g=Dd(g,w)}catch(p){g=w}}catch(x){b.e(x)}finally{b.f()}u=g}case 46:e(u),r.next=52;break;case 49:r.prev=49,r.t1=r.catch(0),i(r.t1);case 52:case"end":return r.stop()}}),r,null,[[0,49],[15,28,32,42],[33,,37,41]])}))))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"invoke",value:function(){var e=b(p().mark((function e(t,n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._callWithConfig(this._invoke.bind(this),t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_transform",value:function(e,t,n){var r=this;return An(p().mark((function a(){var i,u,o,s,c,l,d,f,h,v,m,y,g,_,k,w,x,E,A,C,D,S,O,F,P,T,j,I;return p().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:o=!1,s=!1,a.prev=2,l=Cn(e);case 4:return a.next=6,xn(l.next());case 6:if(!(o=!(d=a.sent).done)){a.next=12;break}if(f=d.value,void 0===u)u=f;else try{u=Dd(u,f)}catch(N){u=f}case 9:o=!1,a.next=4;break;case 12:a.next=18;break;case 14:a.prev=14,a.t0=a.catch(2),s=!0,c=a.t0;case 18:if(a.prev=18,a.prev=19,!o||null==l.return){a.next=23;break}return a.next=23,xn(l.return());case 23:if(a.prev=23,!s){a.next=26;break}throw c;case 26:return a.finish(23);case 27:return a.finish(18);case 28:return h=kd(n,{callbacks:null===t||void 0===t?void 0:t.getChild(),recursionLimit:(null!==(i=null===n||void 0===n?void 0:n.recursionLimit)&&void 0!==i?i:25)-1}),a.next=31,xn(new Promise((function(e,t){hd.runWithConfig(wd(h),b(p().mark((function n(){var a;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,r.func(u,q(q({},h),{},{config:h}));case 3:a=n.sent,e(a),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),t(n.t0);case 10:case"end":return n.stop()}}),n,null,[[0,7]])}))))})));case 31:if(!(v=a.sent)||!Jf.isRunnable(v)){a.next=69;break}if(0!==(null===n||void 0===n?void 0:n.recursionLimit)){a.next=35;break}throw new Error("Recursion limit reached.");case 35:return a.next=37,xn(v.stream(u,h));case 37:m=a.sent,y=!1,g=!1,a.prev=40,k=Cn(m);case 42:return a.next=44,xn(k.next());case 44:if(!(y=!(w=a.sent).done)){a.next=51;break}return x=w.value,a.next=48,x;case 48:y=!1,a.next=42;break;case 51:a.next=57;break;case 53:a.prev=53,a.t1=a.catch(40),g=!0,_=a.t1;case 57:if(a.prev=57,a.prev=58,!y||null==k.return){a.next=62;break}return a.next=62,xn(k.return());case 62:if(a.prev=62,!g){a.next=65;break}throw _;case 65:return a.finish(62);case 66:return a.finish(57);case 67:a.next=125;break;case 69:if(!zf(v)){a.next=102;break}E=!1,A=!1,a.prev=72,D=Cn(Zf(h,v));case 74:return a.next=76,xn(D.next());case 76:if(!(E=!(S=a.sent).done)){a.next=84;break}return O=S.value,null===n||void 0===n||null===(F=n.signal)||void 0===F||F.throwIfAborted(),a.next=81,O;case 81:E=!1,a.next=74;break;case 84:a.next=90;break;case 86:a.prev=86,a.t2=a.catch(72),A=!0,C=a.t2;case 90:if(a.prev=90,a.prev=91,!E||null==D.return){a.next=95;break}return a.next=95,xn(D.return());case 95:if(a.prev=95,!A){a.next=98;break}throw C;case 98:return a.finish(95);case 99:return a.finish(90);case 100:a.next=125;break;case 102:if(!Uf(v)){a.next=123;break}P=G(Hf(h,v)),a.prev=104,P.s();case 106:if((T=P.n()).done){a.next=113;break}return I=T.value,null===n||void 0===n||null===(j=n.signal)||void 0===j||j.throwIfAborted(),a.next=111,I;case 111:a.next=106;break;case 113:a.next=118;break;case 115:a.prev=115,a.t3=a.catch(104),P.e(a.t3);case 118:return a.prev=118,P.f(),a.finish(118);case 121:a.next=125;break;case 123:return a.next=125,v;case 125:case"end":return a.stop()}}),a,null,[[2,14,18,28],[19,,23,27],[40,53,57,67],[58,,62,66],[72,86,90,100],[91,,95,99],[104,115,118,121]])})))()}},{key:"transform",value:function(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}},{key:"stream",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(){return(a=An(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)},r=function(){return a.apply(this,arguments)},i=_d(n),u=new Sd({generator:this.transform(r(),i),config:i}),e.next=6,u.setup;case 6:return e.abrupt("return",Ad.fromAsyncGenerator(u));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"lc_name",value:function(){return"RunnableLambda"}},{key:"from",value:function(e){return new n({func:e})}}]),n}(Jf),rp=function(e){B(n,e);var t=z(n);function n(e){var r;return T(this,n),r=t.call(this,e),Object.defineProperty(N(r),"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(N(r),"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(N(r),"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(r),"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.runnable=e.runnable,r.fallbacks=e.fallbacks,r}return I(n,[{key:"runnables",value:p().mark((function e(){var t,n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runnable;case 2:t=G(this.fallbacks),e.prev=3,t.s();case 5:if((n=t.n()).done){e.next=11;break}return r=n.value,e.next=9,r;case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),t.e(e.t0);case 16:return e.prev=16,t.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[3,13,16,19]])}))},{key:"invoke",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u,o,s,c,l=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=_d(n),e.next=3,md(r);case 3:return a=e.sent,i=r.runId,u=Sn(r,Gf),e.next=7,null===a||void 0===a?void 0:a.handleChainStart(this.toJSON(),$f(t,"input"),i,void 0,void 0,void 0,null===u||void 0===u?void 0:u.runName);case 7:return o=e.sent,s=kd(u,{callbacks:null===o||void 0===o?void 0:o.getChild()}),e.next=11,hd.runWithConfig(s,b(p().mark((function e(){var n,a,i,u,c,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=G(l.runnables()),e.prev=1,a.s();case 3:if((i=a.n()).done){e.next=20;break}return c=i.value,null===r||void 0===r||null===(u=r.signal)||void 0===u||u.throwIfAborted(),e.prev=6,e.next=9,c.invoke(t,s);case 9:return d=e.sent,e.next=12,null===o||void 0===o?void 0:o.handleChainEnd($f(d,"output"));case 12:return e.abrupt("return",d);case 15:e.prev=15,e.t0=e.catch(6),void 0===n&&(n=e.t0);case 18:e.next=3;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(1),a.e(e.t1);case 25:return e.prev=25,a.f(),e.finish(25);case 28:if(void 0!==n){e.next=30;break}throw new Error("No error stored at end of fallback.");case 30:return e.next=32,null===o||void 0===o?void 0:o.handleChainError(n);case 32:throw n;case 33:case"end":return e.stop()}}),e,null,[[1,22,25,28],[6,15]])}))));case 11:return c=e.sent,e.abrupt("return",c);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_streamIterator",value:function(e,t){var n=this;return An(p().mark((function r(){var a,i,u,o,s,c,l,d,f,h,v,m,y,g,b,_,k,w,x,E,A,C;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=_d(t),r.next=3,xn(md(a));case 3:return i=r.sent,u=a.runId,o=Sn(a,Vf),r.next=7,xn(null===i||void 0===i?void 0:i.handleChainStart(n.toJSON(),$f(e,"input"),u,void 0,void 0,void 0,null===o||void 0===o?void 0:o.runName));case 7:s=r.sent,d=G(n.runnables()),r.prev=9,d.s();case 11:if((f=d.n()).done){r.next=28;break}return v=f.value,null===a||void 0===a||null===(h=a.signal)||void 0===h||h.throwIfAborted(),m=kd(o,{callbacks:null===s||void 0===s?void 0:s.getChild()}),r.prev=15,r.next=18,xn(v.stream(e,m));case 18:return y=r.sent,l=Zf(m,y),r.abrupt("break",28);case 23:r.prev=23,r.t0=r.catch(15),void 0===c&&(c=r.t0);case 26:r.next=11;break;case 28:r.next=33;break;case 30:r.prev=30,r.t1=r.catch(9),d.e(r.t1);case 33:return r.prev=33,d.f(),r.finish(33);case 36:if(void 0!==l){r.next=41;break}return b=null!==(g=c)&&void 0!==g?g:new Error("No error stored at end of fallback."),r.next=40,xn(null===s||void 0===s?void 0:s.handleChainError(b));case 40:throw b;case 41:r.prev=41,k=!1,w=!1,r.prev=44,E=Cn(l);case 46:return r.next=48,xn(E.next());case 48:if(!(k=!(A=r.sent).done)){r.next=56;break}return C=A.value,r.next=52,C;case 52:try{_=void 0===_?_:Dd(_,C)}catch(p){_=void 0}case 53:k=!1,r.next=46;break;case 56:r.next=62;break;case 58:r.prev=58,r.t2=r.catch(44),w=!0,x=r.t2;case 62:if(r.prev=62,r.prev=63,!k||null==E.return){r.next=67;break}return r.next=67,xn(E.return());case 67:if(r.prev=67,!w){r.next=70;break}throw x;case 70:return r.finish(67);case 71:return r.finish(62);case 72:r.next=79;break;case 74:return r.prev=74,r.t3=r.catch(41),r.next=78,xn(null===s||void 0===s?void 0:s.handleChainError(r.t3));case 78:throw r.t3;case 79:return r.next=81,xn(null===s||void 0===s?void 0:s.handleChainEnd($f(_,"output")));case 81:case"end":return r.stop()}}),r,null,[[9,30,33,36],[15,23],[41,74],[44,58,62,72],[63,,67,71]])})))()}},{key:"batch",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c,l,d,f=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===r||void 0===r||!r.returnExceptions){e.next=2;break}throw new Error("Not implemented.");case 2:return a=this._getOptionsList(null!==n&&void 0!==n?n:{},t.length),e.next=5,Promise.all(a.map((function(e){return md(e)})));case 5:return i=e.sent,e.next=8,Promise.all(i.map(function(){var e=b(p().mark((function e(n,r){var i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===n||void 0===n?void 0:n.handleChainStart(f.toJSON(),$f(t[r],"input"),a[r].runId,void 0,void 0,void 0,a[r].runName);case 2:return i=e.sent,delete a[r].runId,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 8:u=e.sent,s=G(this.runnables()),e.prev=10,l=p().mark((function e(){var n,i,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=c.value,null===(n=a[0].signal)||void 0===n||n.throwIfAborted(),e.prev=2,e.next=5,i.batch(t,u.map((function(e,t){return kd(a[t],{callbacks:null===e||void 0===e?void 0:e.getChild()})})),r);case 5:return s=e.sent,e.next=8,Promise.all(u.map((function(e,t){return null===e||void 0===e?void 0:e.handleChainEnd($f(s[t],"output"))})));case 8:return e.abrupt("return",{v:s});case 11:e.prev=11,e.t0=e.catch(2),void 0===o&&(o=e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})),s.s();case 13:if((c=s.n()).done){e.next=20;break}return e.delegateYield(l(),"t0",15);case 15:if("object"!==typeof(d=e.t0)){e.next=18;break}return e.abrupt("return",d.v);case 18:e.next=13;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(10),s.e(e.t1);case 25:return e.prev=25,s.f(),e.finish(25);case 28:if(o){e.next=30;break}throw new Error("No error stored at end of fallbacks.");case 30:return e.next=32,Promise.all(u.map((function(e){return null===e||void 0===e?void 0:e.handleChainError(o)})));case 32:throw o;case 33:case"end":return e.stop()}}),e,this,[[10,22,25,28]])})));return function(t,n,r){return e.apply(this,arguments)}}()}],[{key:"lc_name",value:function(){return"RunnableWithFallbacks"}}]),n}(Jf);function ap(e){if("function"===typeof e)return new np({func:e});if(Jf.isRunnable(e))return e;if(Array.isArray(e)||"object"!==typeof e)throw new Error("Expected a Runnable, function or object.\nInstead got an unsupported type.");for(var t={},n=0,r=Object.entries(e);n<r.length;n++){var a=w(r[n],2),i=a[0],u=a[1];t[i]=ap(u)}return new ep({steps:t})}var ip=function(e){B(n,e);var t=z(n);function n(e){var r;return T(this,n),e instanceof ep&&(e={mapper:e}),r=t.call(this,e),Object.defineProperty(N(r),"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(N(r),"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(N(r),"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.mapper=e.mapper,r}return I(n,[{key:"invoke",value:function(){var e=b(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.mapper.invoke(t,n);case 2:return r=e.sent,e.abrupt("return",q(q({},t),r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_transform",value:function(e,t,n){var r=this;return An(p().mark((function a(){var i,u,o,s,c,l,d,f,h,v,m,y,g,b,_,k,x,E,A,C;return p().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:i=r.mapper.getStepsKeys(),u=Cd(e),o=w(u,2),s=o[0],c=o[1],l=r.mapper.transform(c,kd(n,{callbacks:null===t||void 0===t?void 0:t.getChild()})),d=l.next(),f=!1,h=!1,a.prev=6,m=Cn(s);case 8:return a.next=10,xn(m.next());case 10:if(!(f=!(y=a.sent).done)){a.next=21;break}if("object"===typeof(g=y.value)&&!Array.isArray(g)){a.next=14;break}throw new Error("RunnableAssign can only be used with objects as input, got ".concat(typeof g));case 14:if(b=Object.fromEntries(Object.entries(g).filter((function(e){var t=w(e,1)[0];return!i.includes(t)}))),!(Object.keys(b).length>0)){a.next=18;break}return a.next=18,b;case 18:f=!1,a.next=8;break;case 21:a.next=27;break;case 23:a.prev=23,a.t0=a.catch(6),h=!0,v=a.t0;case 27:if(a.prev=27,a.prev=28,!f||null==m.return){a.next=32;break}return a.next=32,xn(m.return());case 32:if(a.prev=32,!h){a.next=35;break}throw v;case 35:return a.finish(32);case 36:return a.finish(27);case 37:return a.next=39,xn(d);case 39:return a.next=41,a.sent.value;case 41:_=!1,k=!1,a.prev=43,E=Cn(l);case 45:return a.next=47,xn(E.next());case 47:if(!(_=!(A=a.sent).done)){a.next=54;break}return C=A.value,a.next=51,C;case 51:_=!1,a.next=45;break;case 54:a.next=60;break;case 56:a.prev=56,a.t1=a.catch(43),k=!0,x=a.t1;case 60:if(a.prev=60,a.prev=61,!_||null==E.return){a.next=65;break}return a.next=65,xn(E.return());case 65:if(a.prev=65,!k){a.next=68;break}throw x;case 68:return a.finish(65);case 69:return a.finish(60);case 70:case"end":return a.stop()}}),a,null,[[6,23,27,37],[28,,32,36],[43,56,60,70],[61,,65,69]])})))()}},{key:"transform",value:function(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}},{key:"stream",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(){return(a=An(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)},r=function(){return a.apply(this,arguments)},i=_d(n),u=new Sd({generator:this.transform(r(),i),config:i}),e.next=6,u.setup;case 6:return e.abrupt("return",Ad.fromAsyncGenerator(u));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"lc_name",value:function(){return"RunnableAssign"}}]),n}(Jf),up=function(e){B(n,e);var t=z(n);function n(e){var r;return T(this,n),("string"===typeof e||Array.isArray(e))&&(e={keys:e}),r=t.call(this,e),Object.defineProperty(N(r),"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(N(r),"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(N(r),"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.keys=e.keys,r}return I(n,[{key:"_pick",value:function(){var e=b(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof this.keys){e.next=4;break}return e.abrupt("return",t[this.keys]);case 4:return n=this.keys.map((function(e){return[e,t[e]]})).filter((function(e){return void 0!==e[1]})),e.abrupt("return",0===n.length?void 0:Object.fromEntries(n));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"invoke",value:function(){var e=b(p().mark((function e(t,n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._callWithConfig(this._pick.bind(this),t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_transform",value:function(e){var t=this;return An(p().mark((function n(){var r,a,i,u,o,s,c;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=!1,a=!1,n.prev=2,u=Cn(e);case 4:return n.next=6,xn(u.next());case 6:if(!(r=!(o=n.sent).done)){n.next=17;break}return s=o.value,n.next=10,xn(t._pick(s));case 10:if(void 0===(c=n.sent)){n.next=14;break}return n.next=14,c;case 14:r=!1,n.next=4;break;case 17:n.next=23;break;case 19:n.prev=19,n.t0=n.catch(2),a=!0,i=n.t0;case 23:if(n.prev=23,n.prev=24,!r||null==u.return){n.next=28;break}return n.next=28,xn(u.return());case 28:if(n.prev=28,!a){n.next=31;break}throw i;case 31:return n.finish(28);case 32:return n.finish(23);case 33:case"end":return n.stop()}}),n,null,[[2,19,23,33],[24,,28,32]])})))()}},{key:"transform",value:function(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}},{key:"stream",value:function(){var e=b(p().mark((function e(t,n){var r,a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(){return(a=An(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)},r=function(){return a.apply(this,arguments)},i=_d(n),u=new Sd({generator:this.transform(r(),i),config:i}),e.next=6,u.setup;case 6:return e.abrupt("return",Ad.fromAsyncGenerator(u));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"lc_name",value:function(){return"RunnablePick"}}]),n}(Jf),op=function(e){B(n,e);var t=z(n);function n(e){var r,a;T(this,n);var i=Yf.from([np.from(function(){var e=b(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!bs(t)){e.next=12;break}return e.prev=1,e.next=4,a.schema.parseAsync(t.args);case 4:n=e.sent,e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(1),new _s("Received tool input did not match expected schema",JSON.stringify(t.args));case 10:e.next=13;break;case 12:n=t;case 13:return e.abrupt("return",n);case 14:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()).withConfig({runName:"".concat(e.name,":parse_input")}),e.bound]).withConfig({runName:e.name});return a=t.call(this,{bound:i,config:null!==(r=e.config)&&void 0!==r?r:{}}),Object.defineProperty(N(a),"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(a),"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(a),"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),a.name=e.name,a.description=e.description,a.schema=e.schema,a}return I(n,null,[{key:"lc_name",value:function(){return"RunnableToolLike"}}]),n}(Kf);var sp="object"===typeof window?window:{},cp="0123456789abcdef".split(""),lp=[-2147483648,8388608,32768,128],dp=[24,16,8,0],fp=[];function pp(e){e?(fp[0]=fp[16]=fp[1]=fp[2]=fp[3]=fp[4]=fp[5]=fp[6]=fp[7]=fp[8]=fp[9]=fp[10]=fp[11]=fp[12]=fp[13]=fp[14]=fp[15]=0,this.blocks=fp):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}pp.prototype.update=function(e){if(!this.finalized){var t="string"!==typeof e;t&&e.constructor===sp.ArrayBuffer&&(e=new Uint8Array(e));for(var n,r,a=0,i=e.length||0,u=this.blocks;a<i;){if(this.hashed&&(this.hashed=!1,u[0]=this.block,u[16]=u[1]=u[2]=u[3]=u[4]=u[5]=u[6]=u[7]=u[8]=u[9]=u[10]=u[11]=u[12]=u[13]=u[14]=u[15]=0),t)for(r=this.start;a<i&&r<64;++a)u[r>>2]|=e[a]<<dp[3&r++];else for(r=this.start;a<i&&r<64;++a)(n=e.charCodeAt(a))<128?u[r>>2]|=n<<dp[3&r++]:n<2048?(u[r>>2]|=(192|n>>6)<<dp[3&r++],u[r>>2]|=(128|63&n)<<dp[3&r++]):n<55296||n>=57344?(u[r>>2]|=(224|n>>12)<<dp[3&r++],u[r>>2]|=(128|n>>6&63)<<dp[3&r++],u[r>>2]|=(128|63&n)<<dp[3&r++]):(n=65536+((1023&n)<<10|1023&e.charCodeAt(++a)),u[r>>2]|=(240|n>>18)<<dp[3&r++],u[r>>2]|=(128|n>>12&63)<<dp[3&r++],u[r>>2]|=(128|n>>6&63)<<dp[3&r++],u[r>>2]|=(128|63&n)<<dp[3&r++]);this.lastByteIndex=r,this.bytes+=r-this.start,r>=64?(this.block=u[16],this.start=r-64,this.hash(),this.hashed=!0):this.start=r}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},pp.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=lp[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},pp.prototype.hash=function(){var e,t,n=this.h0,r=this.h1,a=this.h2,i=this.h3,u=this.h4,o=this.blocks;for(e=16;e<80;++e)t=o[e-3]^o[e-8]^o[e-14]^o[e-16],o[e]=t<<1|t>>>31;for(e=0;e<20;e+=5)n=(t=(r=(t=(a=(t=(i=(t=(u=(t=n<<5|n>>>27)+(r&a|~r&i)+u+1518500249+o[e]<<0)<<5|u>>>27)+(n&(r=r<<30|r>>>2)|~n&a)+i+1518500249+o[e+1]<<0)<<5|i>>>27)+(u&(n=n<<30|n>>>2)|~u&r)+a+1518500249+o[e+2]<<0)<<5|a>>>27)+(i&(u=u<<30|u>>>2)|~i&n)+r+1518500249+o[e+3]<<0)<<5|r>>>27)+(a&(i=i<<30|i>>>2)|~a&u)+n+1518500249+o[e+4]<<0,a=a<<30|a>>>2;for(;e<40;e+=5)n=(t=(r=(t=(a=(t=(i=(t=(u=(t=n<<5|n>>>27)+(r^a^i)+u+1859775393+o[e]<<0)<<5|u>>>27)+(n^(r=r<<30|r>>>2)^a)+i+1859775393+o[e+1]<<0)<<5|i>>>27)+(u^(n=n<<30|n>>>2)^r)+a+1859775393+o[e+2]<<0)<<5|a>>>27)+(i^(u=u<<30|u>>>2)^n)+r+1859775393+o[e+3]<<0)<<5|r>>>27)+(a^(i=i<<30|i>>>2)^u)+n+1859775393+o[e+4]<<0,a=a<<30|a>>>2;for(;e<60;e+=5)n=(t=(r=(t=(a=(t=(i=(t=(u=(t=n<<5|n>>>27)+(r&a|r&i|a&i)+u-1894007588+o[e]<<0)<<5|u>>>27)+(n&(r=r<<30|r>>>2)|n&a|r&a)+i-1894007588+o[e+1]<<0)<<5|i>>>27)+(u&(n=n<<30|n>>>2)|u&r|n&r)+a-1894007588+o[e+2]<<0)<<5|a>>>27)+(i&(u=u<<30|u>>>2)|i&n|u&n)+r-1894007588+o[e+3]<<0)<<5|r>>>27)+(a&(i=i<<30|i>>>2)|a&u|i&u)+n-1894007588+o[e+4]<<0,a=a<<30|a>>>2;for(;e<80;e+=5)n=(t=(r=(t=(a=(t=(i=(t=(u=(t=n<<5|n>>>27)+(r^a^i)+u-899497514+o[e]<<0)<<5|u>>>27)+(n^(r=r<<30|r>>>2)^a)+i-899497514+o[e+1]<<0)<<5|i>>>27)+(u^(n=n<<30|n>>>2)^r)+a-899497514+o[e+2]<<0)<<5|a>>>27)+(i^(u=u<<30|u>>>2)^n)+r-899497514+o[e+3]<<0)<<5|r>>>27)+(a^(i=i<<30|i>>>2)^u)+n-899497514+o[e+4]<<0,a=a<<30|a>>>2;this.h0=this.h0+n<<0,this.h1=this.h1+r<<0,this.h2=this.h2+a<<0,this.h3=this.h3+i<<0,this.h4=this.h4+u<<0},pp.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4;return cp[e>>28&15]+cp[e>>24&15]+cp[e>>20&15]+cp[e>>16&15]+cp[e>>12&15]+cp[e>>8&15]+cp[e>>4&15]+cp[15&e]+cp[t>>28&15]+cp[t>>24&15]+cp[t>>20&15]+cp[t>>16&15]+cp[t>>12&15]+cp[t>>8&15]+cp[t>>4&15]+cp[15&t]+cp[n>>28&15]+cp[n>>24&15]+cp[n>>20&15]+cp[n>>16&15]+cp[n>>12&15]+cp[n>>8&15]+cp[n>>4&15]+cp[15&n]+cp[r>>28&15]+cp[r>>24&15]+cp[r>>20&15]+cp[r>>16&15]+cp[r>>12&15]+cp[r>>8&15]+cp[r>>4&15]+cp[15&r]+cp[a>>28&15]+cp[a>>24&15]+cp[a>>20&15]+cp[a>>16&15]+cp[a>>12&15]+cp[a>>8&15]+cp[a>>4&15]+cp[15&a]},pp.prototype.toString=pp.prototype.hex,pp.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,a=this.h4;return[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24&255,n>>16&255,n>>8&255,255&n,r>>24&255,r>>16&255,r>>8&255,255&r,a>>24&255,a>>16&255,a>>8&255,255&a]},pp.prototype.array=pp.prototype.digest,pp.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(20),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),e};var hp=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r=t.join("_"),new pp(!0).update(r).hex();var r};var vp=I((function e(){T(this,e)})),mp=new Map,yp=function(e){B(n,e);var t=z(n);function n(e){var r;return T(this,n),r=t.call(this),Object.defineProperty(N(r),"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.cache=null!==e&&void 0!==e?e:new Map,r}return I(n,[{key:"lookup",value:function(e,t){var n;return Promise.resolve(null!==(n=this.cache.get(hp(e,t)))&&void 0!==n?n:null)}},{key:"update",value:function(){var e=b(p().mark((function e(t,n,r){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.cache.set(hp(t,n),r);case 1:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}],[{key:"global",value:function(){return new n(mp)}}]),n}(vp),gp=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n)}(Qo),bp=function(e){B(n,e);var t=z(n);function n(e){var r;return T(this,n),r=t.call(this,{value:e}),Object.defineProperty(N(r),"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(N(r),"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(N(r),"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.value=e,r}return I(n,[{key:"toString",value:function(){return this.value}},{key:"toChatMessages",value:function(){return[new hs(this.value)]}}],[{key:"lc_name",value:function(){return"StringPromptValue"}}]),n}(gp),_p=function(e){B(n,e);var t=z(n);function n(e){var r;return T(this,n),Array.isArray(e)&&(e={messages:e}),r=t.call(this,e),Object.defineProperty(N(r),"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(N(r),"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(N(r),"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.messages=e.messages,r}return I(n,[{key:"toString",value:function(){return Ds(this.messages)}},{key:"toChatMessages",value:function(){return this.messages}}],[{key:"lc_name",value:function(){return"ChatPromptValue"}}]),n}(gp),kp=n(2009),wp=Object.defineProperty;function xp(e,t){return 1===e.length?[t.get(e.join(","))]:function(e,t){for(var n=Array.from({length:e.length},(function(e,t){return{start:t,end:t+1}}));n.length>1;){for(var r=null,a=0;a<n.length-1;a++){var i=e.slice(n[a].start,n[a+1].end),u=t.get(i.join(","));null!=u&&(null==r||u<r[0])&&(r=[u,a])}if(null==r)break;var o=r[1];n[o]={start:n[o].start,end:n[o+1].end},n.splice(o+1,1)}return n}(e,t).map((function(n){return t.get(e.slice(n.start,n.end).join(","))})).filter((function(e){return null!=e}))}var Ep,Ap,Cp=function(){function e(t,n){var r=this;T(this,e),P(this,"specialTokens",void 0),P(this,"inverseSpecialTokens",void 0),P(this,"patStr",void 0),P(this,"textEncoder",new TextEncoder),P(this,"textDecoder",new TextDecoder("utf-8")),P(this,"rankMap",new Map),P(this,"textMap",new Map),this.patStr=t.pat_str;for(var a=t.bpe_ranks.split("\n").filter(Boolean).reduce((function(e,t){var n=Wo(t.split(" ")),r=(n[0],n[1]),a=n.slice(2),i=Number.parseInt(r,10);return a.forEach((function(t,n){return e[t]=i+n})),e}),{}),i=0,u=Object.entries(a);i<u.length;i++){var o=w(u[i],2),s=o[0],c=o[1],l=kp.toByteArray(s);this.rankMap.set(l.join(","),c),this.textMap.set(c,l)}this.specialTokens=q(q({},t.special_tokens),n),this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((function(e,t){var n=w(t,2),a=n[0];return e[n[1]]=r.textEncoder.encode(a),e}),{})}return I(e,[{key:"encode",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",a=new RegExp(this.patStr,"ug"),i=e.specialTokenRegex(Object.keys(this.specialTokens)),u=[],o=new Set("all"===n?Object.keys(this.specialTokens):n),s=new Set("all"===r?Object.keys(this.specialTokens).filter((function(e){return!o.has(e)})):r);if(s.size>0){var c=e.specialTokenRegex(y(s)),l=t.match(c);if(null!=l)throw new Error("The text contains a special token that is not allowed: ".concat(l[0]))}for(var d=0;;){for(var f,p,h=null,v=d;i.lastIndex=v,null!=(h=i.exec(t))&&!o.has(h[0]);)v=h.index+1;var m,g=null!==(f=null===(p=h)||void 0===p?void 0:p.index)&&void 0!==f?f:t.length,b=G(t.substring(d,g).matchAll(a));try{for(b.s();!(m=b.n()).done;){var _=m.value,k=this.textEncoder.encode(_[0]),w=this.rankMap.get(k.join(","));null==w?u.push.apply(u,y(xp(k,this.rankMap))):u.push(w)}}catch(E){b.e(E)}finally{b.f()}if(null==h)break;var x=this.specialTokens[h[0]];u.push(x),d=h.index+h[0].length}return u}},{key:"decode",value:function(e){for(var t=[],n=0,r=0;r<e.length;++r){var a,i=e[r],u=null!==(a=this.textMap.get(i))&&void 0!==a?a:this.inverseSpecialTokens[i];null!=u&&(t.push(u),n+=u.length)}for(var o=new Uint8Array(n),s=0,c=0,l=t;c<l.length;c++){var d=l[c];o.set(d,s),s+=d.length}return this.textDecoder.decode(o)}}]),e}(),Dp=Cp;function Sp(e){switch(e){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-2024-11-20":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"o1":case"o1-2024-12-17":case"o1-mini":case"o1-preview":case"o1-preview-2024-09-12":case"o1-mini-2024-09-12":case"o3-mini":case"o3-mini-2025-01-31":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":return"o200k_base";default:throw new Error("Unknown model")}}Ap=function(e){return new RegExp(e.map((function(e){return function(e){return e.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}(e)})).join("|"),"g")},function(e,t,n){t in e?wp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(Dp,"symbol"!==typeof(Ep="specialTokenRegex")?Ep+"":Ep,Ap);var Op={},Fp=new Vd({});function Pp(e){return Tp.apply(this,arguments)}function Tp(){return(Tp=b(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t in Op||(Op[t]=Fp.fetch("https://tiktoken.pages.dev/js/".concat(t,".json")).then((function(e){return e.json()})).then((function(e){return new Dp(e)})).catch((function(e){throw delete Op[t],e}))),e.next=3,Op[t];case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function jp(e){return Ip.apply(this,arguments)}function Ip(){return(Ip=b(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Pp(Sp(t)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Np=["callbacks","callbackManager"],Rp=["cache"],Bp=["config"],Lp=function(e){return e.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":e.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":e.startsWith("gpt-4-32k")?"gpt-4-32k":e.startsWith("gpt-4-")?"gpt-4":e.startsWith("gpt-4o")?"gpt-4o":e};function Mp(e){return!("object"!==typeof e||!e)&&!!("type"in e&&"function"===e.type&&"function"in e&&"object"===typeof e.function&&e.function&&"name"in e.function&&"parameters"in e.function)}var Up=function(e){B(n,e);var t=z(n);function n(e){var r,a,i,u;return T(this,n),u=t.call(this,e),Object.defineProperty(N(u),"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(u),"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(u),"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(u),"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),u.verbose=null!==(r=e.verbose)&&void 0!==r&&r,u.callbacks=e.callbacks,u.tags=null!==(a=e.tags)&&void 0!==a?a:[],u.metadata=null!==(i=e.metadata)&&void 0!==i?i:{},u}return I(n,[{key:"lc_attributes",get:function(){return{callbacks:void 0,verbose:void 0}}}]),n}(Jf),zp=function(e){B(n,e);var t=z(n);function n(e){var r,a=e.callbacks,i=e.callbackManager,u=Sn(e,Np);T(this,n);var o=u.cache,s=Sn(u,Rp);return r=t.call(this,q({callbacks:null!==a&&void 0!==a?a:i},s)),Object.defineProperty(N(r),"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(r),"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(r),"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.cache="object"===typeof o?o:o?yp.global():void 0,r.caller=new Vd(null!==u&&void 0!==u?u:{}),r}return I(n,[{key:"callKeys",get:function(){return["stop","timeout","signal","tags","metadata","callbacks"]}},{key:"getNumTokens",value:function(){var e=b(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"===typeof t){e.next=2;break}return e.abrupt("return",0);case 2:if(n=Math.ceil(t.length/4),this._encoding){e.next=13;break}return e.prev=4,e.next=7,jp("modelName"in this?Lp(this.modelName):"gpt2");case 7:this._encoding=e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),console.warn("Failed to calculate number of tokens, falling back to approximate count",e.t0);case 13:if(this._encoding)try{n=this._encoding.encode(t).length}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return e.abrupt("return",n);case 15:case"end":return e.stop()}}),e,this,[[4,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_identifyingParams",value:function(){return{}}},{key:"_getSerializedCacheKeyParametersForCall",value:function(e){e.config;var t=Sn(e,Bp),n=q(q(q({},this._identifyingParams()),t),{},{_type:this._llmType(),_model:this._modelType()}),r=Object.entries(n).filter((function(e){var t=w(e,2);t[0];return void 0!==t[1]})).map((function(e){var t=w(e,2),n=t[0],r=t[1];return"".concat(n,":").concat(JSON.stringify(r))})).sort().join(",");return r}},{key:"serialize",value:function(){return q(q({},this._identifyingParams()),{},{_type:this._llmType(),_model:this._modelType()})}}],[{key:"_convertInputToPromptValue",value:function(e){return"string"===typeof e?new bp(e):Array.isArray(e)?new _p(e.map(Cs)):e}},{key:"deserialize",value:function(){var e=b(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Use .toJSON() instead");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Up),Hp=function(e){B(n,e);var t=z(n);function n(e){var r;return T(this,n),r=t.call(this,e),Object.defineProperty(N(r),"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(N(r),"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(N(r),"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e&&(r.func=e.func),r}return I(n,[{key:"invoke",value:function(){var e=b(p().mark((function e(t,n){var r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=_d(n),!this.func){e.next=4;break}return e.next=4,this.func(t,r);case 4:return e.abrupt("return",this._callWithConfig((function(e){return Promise.resolve(e)}),t,r));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"transform",value:function(e,t){var n=this;return An(p().mark((function r(){var a,i,u,o,s,c,l,d,f;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:a=_d(t),u=!0,o=!1,s=!1,r.prev=4,l=Cn(n._transformStreamWithConfig(e,(function(e){return e}),a));case 6:return r.next=8,xn(l.next());case 8:if(!(o=!(d=r.sent).done)){r.next=16;break}return f=d.value,r.next=12,f;case 12:if(u)if(void 0===i)i=f;else try{i=Dd(i,f)}catch(p){i=void 0,u=!1}case 13:o=!1,r.next=6;break;case 16:r.next=22;break;case 18:r.prev=18,r.t0=r.catch(4),s=!0,c=r.t0;case 22:if(r.prev=22,r.prev=23,!o||null==l.return){r.next=27;break}return r.next=27,xn(l.return());case 27:if(r.prev=27,!s){r.next=30;break}throw c;case 30:return r.finish(27);case 31:return r.finish(22);case 32:if(!n.func||void 0===i){r.next=35;break}return r.next=35,xn(n.func(i,a));case 35:case"end":return r.stop()}}),r,null,[[4,18,22,32],[23,,27,31]])})))()}}],[{key:"lc_name",value:function(){return"RunnablePassthrough"}},{key:"assign",value:function(e){return new ip(new ep({steps:e}))}}]),n}(Jf);function Zp(e){return"function"===typeof(null===e||void 0===e?void 0:e.parse)}var Wp=function(e){B(n,e);var t=z(n);function n(e){var r;return T(this,n),r=t.call(this,e),Object.defineProperty(N(r),"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",r._llmType()]}),Object.defineProperty(N(r),"disableStreaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),r}return I(n,[{key:"_separateRunnableConfigFromCallOptionsCompat",value:function(e){var t=w(kn(L(n.prototype),"_separateRunnableConfigFromCallOptions",this).call(this,e),2),r=t[0],a=t[1];return a.signal=r.signal,[r,a]}},{key:"invoke",value:function(){var e=b(p().mark((function e(t,r){var a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n._convertInputToPromptValue(t),e.next=3,this.generatePrompt([a],r,null===r||void 0===r?void 0:r.callbacks);case 3:return i=e.sent,u=i.generations[0][0],e.abrupt("return",u.message);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_streamResponseChunks",value:function(e,t,n){return An(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})))()}},{key:"_streamIterator",value:function(e,t){var r=this;return An(p().mark((function a(){var i,u,o,s,c,l,d,f,h,v,m,y,g,b,_,k,x,E,A,C;return p().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r._streamResponseChunks!==n.prototype._streamResponseChunks&&!r.disableStreaming){a.next=5;break}return a.next=3,r.invoke(e,t);case 3:a.next=59;break;case 5:return i=n._convertInputToPromptValue(e),u=i.toChatMessages(),o=r._separateRunnableConfigFromCallOptionsCompat(t),s=w(o,2),c=s[0],l=s[1],d=q(q({},c.metadata),r.getLsParams(l)),a.next=11,xn(sd.configure(c.callbacks,r.callbacks,c.tags,r.tags,d,r.metadata,{verbose:r.verbose}));case 11:return f=a.sent,h={options:l,invocation_params:null===r||void 0===r?void 0:r.invocationParams(l),batch_size:1},a.next=15,xn(null===f||void 0===f?void 0:f.handleChatModelStart(r.toJSON(),[u],c.runId,void 0,h,void 0,void 0,c.runName));case 15:v=a.sent,a.prev=16,g=!1,b=!1,a.prev=19,k=Cn(r._streamResponseChunks(u,l,null===v||void 0===v?void 0:v[0]));case 21:return a.next=23,xn(k.next());case 23:if(!(g=!(x=a.sent).done)){a.next=34;break}return null==(E=x.value).message.id&&null!=(C=null===v||void 0===v||null===(A=v.at(0))||void 0===A?void 0:A.runId)&&E.message._updateId("run-".concat(C)),E.message.response_metadata=q(q({},E.generationInfo),E.message.response_metadata),a.next=29,E.message;case 29:m=m?m.concat(E):E,cs(E.message)&&void 0!==E.message.usage_metadata&&(y={tokenUsage:{promptTokens:E.message.usage_metadata.input_tokens,completionTokens:E.message.usage_metadata.output_tokens,totalTokens:E.message.usage_metadata.total_tokens}});case 31:g=!1,a.next=21;break;case 34:a.next=40;break;case 36:a.prev=36,a.t0=a.catch(19),b=!0,_=a.t0;case 40:if(a.prev=40,a.prev=41,!g||null==k.return){a.next=45;break}return a.next=45,xn(k.return());case 45:if(a.prev=45,!b){a.next=48;break}throw _;case 48:return a.finish(45);case 49:return a.finish(40);case 50:a.next=57;break;case 52:return a.prev=52,a.t1=a.catch(16),a.next=56,xn(Promise.all((null!==v&&void 0!==v?v:[]).map((function(e){return null===e||void 0===e?void 0:e.handleLLMError(a.t1)}))));case 56:throw a.t1;case 57:return a.next=59,xn(Promise.all((null!==v&&void 0!==v?v:[]).map((function(e){return null===e||void 0===e?void 0:e.handleLLMEnd({generations:[[m]],llmOutput:y})}))));case 59:case"end":return a.stop()}}),a,null,[[16,52],[19,36,40,50],[41,,45,49]])})))()}},{key:"getLsParams",value:function(e){var t=this.getName().startsWith("Chat")?this.getName().replace("Chat",""):this.getName();return{ls_model_type:"chat",ls_stop:e.stop,ls_provider:t}}},{key:"_generateUncached",value:function(){var e=b(p().mark((function e(t,r,a,i){var u,o,s,c,l,d,f,h,v,m,y,g,_,k,w,x,E,A,C,D,S,O,F,P,T,j,I,N=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=t.map((function(e){return e.map(Cs)})),void 0===i||i.length!==c.length){e.next=5;break}l=i,e.next=13;break;case 5:return d=q(q({},a.metadata),this.getLsParams(r)),e.next=8,sd.configure(a.callbacks,this.callbacks,a.tags,this.tags,d,this.metadata,{verbose:this.verbose});case 8:return f=e.sent,h={options:r,invocation_params:null===this||void 0===this?void 0:this.invocationParams(r),batch_size:1},e.next=12,null===f||void 0===f?void 0:f.handleChatModelStart(this.toJSON(),c,a.runId,void 0,h,void 0,void 0,a.runName);case 12:l=e.sent;case 13:if(v=[],m=[],!!(null===(u=l)||void 0===u||!u[0].handlers.find(Pl))||this.disableStreaming||1!==c.length||this._streamResponseChunks===n.prototype._streamResponseChunks){e.next=65;break}return e.prev=17,e.next=20,this._streamResponseChunks(c[0],r,null===(y=l)||void 0===y?void 0:y[0]);case 20:_=e.sent,x=!1,E=!1,e.prev=23,C=Cn(_);case 25:return e.next=27,C.next();case 27:if(!(x=!(D=e.sent).done)){e.next=35;break}null==(S=D.value).message.id&&null!=(P=null===(O=l)||void 0===O||null===(F=O.at(0))||void 0===F?void 0:F.runId)&&S.message._updateId("run-".concat(P)),k=void 0===k?S:Dd(k,S),cs(S.message)&&void 0!==S.message.usage_metadata&&(w={tokenUsage:{promptTokens:S.message.usage_metadata.input_tokens,completionTokens:S.message.usage_metadata.output_tokens,totalTokens:S.message.usage_metadata.total_tokens}});case 32:x=!1,e.next=25;break;case 35:e.next=41;break;case 37:e.prev=37,e.t0=e.catch(23),E=!0,A=e.t0;case 41:if(e.prev=41,e.prev=42,!x||null==C.return){e.next=46;break}return e.next=46,C.return();case 46:if(e.prev=46,!E){e.next=49;break}throw A;case 49:return e.finish(46);case 50:return e.finish(41);case 51:if(void 0!==k){e.next=53;break}throw new Error("Received empty response from chat model call.");case 53:return v.push([k]),e.next=56,null===(g=l)||void 0===g?void 0:g[0].handleLLMEnd({generations:v,llmOutput:w});case 56:e.next=63;break;case 58:return e.prev=58,e.t1=e.catch(17),e.next=62,null===(T=l)||void 0===T?void 0:T[0].handleLLMError(e.t1);case 62:throw e.t1;case 63:e.next=70;break;case 65:return e.next=67,Promise.allSettled(c.map((function(e,t){var n;return N._generate(e,q(q({},r),{},{promptIndex:t}),null===(n=l)||void 0===n?void 0:n[t])})));case 67:return j=e.sent,e.next=70,Promise.all(j.map(function(){var e=b(p().mark((function e(t,n){var r,a,i,u,o,s,c,d,f,h,y;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("fulfilled"!==t.status){e.next=10;break}i=t.value,u=G(i.generations);try{for(u.s();!(o=u.n()).done;)null==(s=o.value).message.id&&null!=(f=null===(c=l)||void 0===c||null===(d=c.at(0))||void 0===d?void 0:d.runId)&&s.message._updateId("run-".concat(f)),s.message.response_metadata=q(q({},s.generationInfo),s.message.response_metadata)}catch(p){u.e(p)}finally{u.f()}return 1===i.generations.length&&(i.generations[0].message.response_metadata=q(q({},i.llmOutput),i.generations[0].message.response_metadata)),v[n]=i.generations,m[n]=i.llmOutput,e.abrupt("return",null===(r=l)||void 0===r||null===(a=r[n])||void 0===a?void 0:a.handleLLMEnd({generations:[i.generations],llmOutput:i.llmOutput}));case 10:return e.next=12,null===(h=l)||void 0===h||null===(y=h[n])||void 0===y?void 0:y.handleLLMError(t.reason);case 12:return e.abrupt("return",Promise.reject(t.reason));case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 70:return I={generations:v,llmOutput:m.length?null===(o=this._combineLLMOutput)||void 0===o?void 0:o.call.apply(o,[this].concat(m)):void 0},Object.defineProperty(I,Md,{value:l?{runIds:null===(s=l)||void 0===s?void 0:s.map((function(e){return e.runId}))}:void 0,configurable:!0}),e.abrupt("return",I);case 73:case"end":return e.stop()}}),e,this,[[17,58],[23,37,41,51],[42,,46,50]])})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"_generateCached",value:function(){var e=b(p().mark((function e(t){var r,a,i,u,o,s,c,l,d,f,h,v,m,y,g;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.messages,a=t.cache,i=t.llmStringKey,u=t.parsedOptions,o=t.handledOptions,s=r.map((function(e){return e.map(Cs)})),c=q(q({},o.metadata),this.getLsParams(u)),e.next=5,sd.configure(o.callbacks,this.callbacks,o.tags,this.tags,c,this.metadata,{verbose:this.verbose});case 5:return l=e.sent,d={options:u,invocation_params:null===this||void 0===this?void 0:this.invocationParams(u),batch_size:1},e.next=9,null===l||void 0===l?void 0:l.handleChatModelStart(this.toJSON(),s,o.runId,void 0,d,void 0,void 0,o.runName);case 9:return f=e.sent,h=[],e.next=13,Promise.allSettled(s.map(function(){var e=b(p().mark((function e(t,r){var u,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=n._convertInputToPromptValue(t).toString(),e.next=3,a.lookup(u,i);case 3:return null==(o=e.sent)&&h.push(r),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 13:return v=e.sent,m=v.map((function(e,t){return{result:e,runManager:null===f||void 0===f?void 0:f[t]}})).filter((function(e){var t=e.result;return"fulfilled"===t.status&&null!=t.value||"rejected"===t.status})),y=[],e.next=18,Promise.all(m.map(function(){var e=b(p().mark((function e(t,n){var r,a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.result,a=t.runManager,"fulfilled"!==r.status){e.next=10;break}if(i=r.value,y[n]=i.map((function(e){return"message"in e&&as(e.message)&&ss(e.message)&&(e.message.usage_metadata={input_tokens:0,output_tokens:0,total_tokens:0}),e.generationInfo=q(q({},e.generationInfo),{},{tokenUsage:{}}),e})),!i.length){e.next=7;break}return e.next=7,null===a||void 0===a?void 0:a.handleLLMNewToken(i[0].text);case 7:return e.abrupt("return",null===a||void 0===a?void 0:a.handleLLMEnd({generations:[i]},void 0,void 0,void 0,{cached:!0}));case 10:return e.next=12,null===a||void 0===a?void 0:a.handleLLMError(r.reason,void 0,void 0,void 0,{cached:!0});case 12:return e.abrupt("return",Promise.reject(r.reason));case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 18:return g={generations:y,missingPromptIndices:h,startedRunManagers:f},Object.defineProperty(g,Md,{value:f?{runIds:null===f||void 0===f?void 0:f.map((function(e){return e.runId}))}:void 0,configurable:!0}),e.abrupt("return",g);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"generate",value:function(){var e=b(p().mark((function e(t,r,a){var i,u,o,s,c,l,d,f,h,v,m,y,g,_,k,x;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=Array.isArray(r)?{stop:r}:r,o=t.map((function(e){return e.map(Cs)})),s=this._separateRunnableConfigFromCallOptionsCompat(u),c=w(s,2),l=c[0],d=c[1],l.callbacks=null!==(i=l.callbacks)&&void 0!==i?i:a,this.cache){e.next=6;break}return e.abrupt("return",this._generateUncached(o,d,l));case 6:return f=this.cache,h=this._getSerializedCacheKeyParametersForCall(d),e.next=10,this._generateCached({messages:o,cache:f,llmStringKey:h,parsedOptions:d,handledOptions:l});case 10:if(v=e.sent,m=v.generations,y=v.missingPromptIndices,g=v.startedRunManagers,_={},!(y.length>0)){e.next=22;break}return e.next=18,this._generateUncached(y.map((function(e){return o[e]})),d,l,void 0!==g?y.map((function(e){return null===g||void 0===g?void 0:g[e]})):void 0);case 18:return x=e.sent,e.next=21,Promise.all(x.generations.map(function(){var e=b(p().mark((function e(t,r){var a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=y[r],m[a]=t,i=n._convertInputToPromptValue(o[a]).toString(),e.abrupt("return",f.update(i,h,t));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 21:_=null!==(k=x.llmOutput)&&void 0!==k?k:{};case 22:return e.abrupt("return",{generations:m,llmOutput:_});case 23:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"invocationParams",value:function(e){return{}}},{key:"_modelType",value:function(){return"base_chat_model"}},{key:"serialize",value:function(){return q(q({},this.invocationParams()),{},{_type:this._llmType(),_model:this._modelType()})}},{key:"generatePrompt",value:function(){var e=b(p().mark((function e(t,n,r){var a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.map((function(e){return e.toChatMessages()})),e.abrupt("return",this.generate(a,n,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"call",value:function(){var e=b(p().mark((function e(t,n,r){var a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.generate([t.map(Cs)],n,r);case 2:return a=e.sent,i=a.generations,e.abrupt("return",i[0][0].message);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"callPrompt",value:function(){var e=b(p().mark((function e(t,n,r){var a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.toChatMessages(),e.abrupt("return",this.call(a,n,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"predictMessages",value:function(){var e=b(p().mark((function e(t,n,r){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.call(t,n,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"predict",value:function(){var e=b(p().mark((function e(t,n,r){var a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new hs(t),e.next=3,this.call([a],n,r);case 3:if("string"===typeof(i=e.sent).content){e.next=6;break}throw new Error("Cannot use predict when output is not a string.");case 6:return e.abrupt("return",i.content);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"withStructuredOutput",value:function(e,t){var n;if("function"!==typeof this.bindTools)throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');if(null!==t&&void 0!==t&&t.strict)throw new Error('"strict" mode is not supported for this model by default.');var r=e,a=null===t||void 0===t?void 0:t.name,i=null!==(n=r.description)&&void 0!==n?n:"A function available to call.",u=null===t||void 0===t?void 0:t.method,o=null===t||void 0===t?void 0:t.includeRaw;if("jsonMode"===u)throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');var s,c=null!==a&&void 0!==a?a:"extract";Zp(r)?s=[{type:"function",function:{name:c,description:i,parameters:Df(r)}}]:("name"in r&&(c=r.name),s=[{type:"function",function:{name:c,description:i,parameters:r}}]);var l=this.bindTools(s),d=np.from((function(e){if(!e.tool_calls||0===e.tool_calls.length)throw new Error("No tool calls found in the response.");var t=e.tool_calls.find((function(e){return e.name===c}));if(!t)throw new Error("No tool call found with name ".concat(c,"."));return t.args}));if(!o)return l.pipe(d).withConfig({runName:"StructuredOutput"});var f=Hp.assign({parsed:function(e,t){return d.invoke(e.raw,t)}}),p=Hp.assign({parsed:function(){return null}}),h=f.withFallbacks({fallbacks:[p]});return Yf.from([{raw:l},h]).withConfig({runName:"StructuredOutputRunnable"})}}]),n}(zp),qp=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"parseResultWithPrompt",value:function(e,t,n){return this.parseResult(e,n)}},{key:"_baseMessageToString",value:function(e){return"string"===typeof e.content?e.content:this._baseMessageContentToString(e.content)}},{key:"_baseMessageContentToString",value:function(e){return JSON.stringify(e)}},{key:"invoke",value:function(){var e=b(p().mark((function e(t,n){var r=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof t){e.next=4;break}return e.abrupt("return",this._callWithConfig(function(){var e=b(p().mark((function e(t,n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.parseResult([{text:t}],null===n||void 0===n?void 0:n.callbacks));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t,q(q({},n),{},{runType:"parser"})));case 4:return e.abrupt("return",this._callWithConfig(function(){var e=b(p().mark((function e(t,n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.parseResult([{message:t,text:r._baseMessageToString(t)}],null===n||void 0===n?void 0:n.callbacks));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t,q(q({},n),{},{runType:"parser"})));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(Jf),Gp=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"parseResult",value:function(e,t){return this.parse(e[0].text,t)}},{key:"parseWithPrompt",value:function(){var e=b(p().mark((function e(t,n,r){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.parse(t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_type",value:function(){throw new Error("_type not implemented")}}]),n}(qp),Vp=function(e){B(n,e);var t=z(n);function n(e,r,a){var i,u=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(T(this,n),i=t.call(this,e),Object.defineProperty(N(i),"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(i),"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(i),"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),i.llmOutput=r,i.observation=a,i.sendToLLM=u,u&&(void 0===a||void 0===r))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true");return gs(N(i),"OUTPUT_PARSING_FAILURE"),i}return I(n)}(Z(Error));function $p(e,t){var n=typeof e;if(n!==typeof t)return!1;if(Array.isArray(e)){if(!Array.isArray(t))return!1;var r=e.length;if(r!==t.length)return!1;for(var a=0;a<r;a++)if(!$p(e[a],t[a]))return!1;return!0}if("object"===n){if(!e||!t)return e===t;var i=Object.keys(e),u=Object.keys(t);if(i.length!==u.length)return!1;for(var o=0,s=i;o<s.length;o++){var c=s[o];if(!$p(e[c],t[c]))return!1}return!0}return e===t}"undefined"!==typeof self&&self.location&&"null"!==self.location.origin?new URL(self.location.origin+self.location.pathname+location.search):new URL("https://github.com/cfworker");var Jp=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i;function Kp(e){return e.test.bind(e)}Qp.bind(void 0,!1),Kp(/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i),Kp(/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i),Kp(/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+\x2D?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+\x2D?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:(?![\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[\s\S]|[\uD800-\uDBFF][\uDC00-\uDFFF])*)?$/i),Kp(/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i),Kp(/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/),Kp(/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i),Kp(/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i),Kp(/^(?:\/(?:[^~/]|~0|~1)*)*$/),Kp(/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i),Kp(/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/);function Qp(e,t){var n=t.match(Jp);if(!n)return!1;var r=+n[1],a=+n[2],i=+n[3],u=!!n[5];return(r<=23&&a<=59&&i<=59||23==r&&59==a&&60==i)&&(!e||u)}var Xp;!function(e){e[e.Flag=1]="Flag",e[e.Basic=2]="Basic",e[e.Detailed=4]="Detailed"}(Xp||(Xp={}));var Yp=function(e){B(n,e);var t=z(n);function n(){return T(this,n),t.apply(this,arguments)}return I(n,[{key:"_transform",value:function(e){var t=this;return An(p().mark((function n(){var r,a,i,u,o,s;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=!1,a=!1,n.prev=2,u=Cn(e);case 4:return n.next=6,xn(u.next());case 6:if(!(r=!(o=n.sent).done)){n.next=18;break}if("string"!==typeof(s=o.value)){n.next=13;break}return n.next=11,t.parseResult([{text:s}]);case 11:n.next=15;break;case 13:return n.next=15,t.parseResult([{message:s,text:t._baseMessageToString(s)}]);case 15:r=!1,n.next=4;break;case 18:n.next=24;break;case 20:n.prev=20,n.t0=n.catch(2),a=!0,i=n.t0;case 24:if(n.prev=24,n.prev=25,!r||null==u.return){n.next=29;break}return n.next=29,xn(u.return());case 29:if(n.prev=29,!a){n.next=32;break}throw i;case 32:return n.finish(29);case 33:return n.finish(24);case 34:case"end":return n.stop()}}),n,null,[[2,20,24,34],[25,,29,33]])})))()}},{key:"transform",value:function(e,t){var n=this;return An(p().mark((function r(){return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.delegateYield(Os(Cn(n._transformStreamWithConfig(e,n._transform.bind(n),q(q({},t),{},{runType:"parser"})))),"t0",1);case 1:case"end":return r.stop()}}),r)})))()}}]),n}(Gp),eh=function(e){B(n,e);var t=z(n);function n(e){var r,a;return T(this,n),a=t.call(this,e),Object.defineProperty(N(a),"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),a.diff=null!==(r=null===e||void 0===e?void 0:e.diff)&&void 0!==r?r:a.diff,a}return I(n,[{key:"_transform",value:function(e){var t=this;return An(p().mark((function n(){var r,a,i,u,o,s,c,l,d,f;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=!1,u=!1,n.prev=2,s=Cn(e);case 4:return n.next=6,xn(s.next());case 6:if(!(i=!(c=n.sent).done)){n.next=40;break}if("string"===typeof(l=c.value)||"string"===typeof l.content){n.next=10;break}throw new Error("Cannot handle non-string output.");case 10:if(d=void 0,!as(p=l)||"function"!==typeof p.concat){n.next=17;break}if("string"===typeof l.content){n.next=14;break}throw new Error("Cannot handle non-string message output.");case 14:d=new zd({message:l,text:l.content}),n.next=24;break;case 17:if(!as(l)){n.next=23;break}if("string"===typeof l.content){n.next=20;break}throw new Error("Cannot handle non-string message output.");case 20:d=new zd({message:Ss(l),text:l.content}),n.next=24;break;case 23:d=new Ud({text:l});case 24:return a=void 0===a?d:a.concat(d),n.next=27,xn(t.parsePartialResult([a]));case 27:if(void 0===(f=n.sent)||null===f||$p(f,r)){n.next=37;break}if(!t.diff){n.next=34;break}return n.next=32,t._diff(r,f);case 32:n.next=36;break;case 34:return n.next=36,f;case 36:r=f;case 37:i=!1,n.next=4;break;case 40:n.next=46;break;case 42:n.prev=42,n.t0=n.catch(2),u=!0,o=n.t0;case 46:if(n.prev=46,n.prev=47,!i||null==s.return){n.next=51;break}return n.next=51,xn(s.return());case 51:if(n.prev=51,!u){n.next=54;break}throw o;case 54:return n.finish(51);case 55:return n.finish(46);case 56:case"end":return n.stop()}var p}),n,null,[[2,42,46,56],[47,,51,55]])})))()}},{key:"getFormatInstructions",value:function(){return""}}]),n}(Yp),th=function(e){B(n,e);var t=z(n);function n(e){var r;return T(this,n),r=t.call(this,e),Object.defineProperty(N(r),"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(N(r),"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]}),r}return I(n,[{key:"toJSON",value:function(){return this.toJSONNotImplemented()}},{key:"getFormatInstructions",value:function(){return'You must format your output as a JSON value that adheres to a given "JSON Schema" instance.\n\n"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.\n\nFor example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}\nwould match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.\nThus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.\n\nYour output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!\n\nHere is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:\n```json\n'.concat(JSON.stringify(Df(this.schema)),"\n```\n")}},{key:"parse",value:function(){var e=b(p().mark((function e(t){var n,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.includes("```")?t.trim().split(/```(?:json)?/)[1]:t.trim(),r=n.replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(function(e,t){var n=t.replace(/\n/g,"\\n");return'"'.concat(n,'"')})).replace(/\n/g,""),e.next=5,this.schema.parseAsync(JSON.parse(r));case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(0),new Vp('Failed to parse. Text: "'.concat(t,'". Error: ').concat(e.t0),t);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()}],[{key:"lc_name",value:function(){return"StructuredOutputParser"}},{key:"fromZodSchema",value:function(e){return new this(e)}},{key:"fromNamesAndDescriptions",value:function(e){return new this(vn.object(Object.fromEntries(Object.entries(e).map((function(e){var t=w(e,2),n=t[0],r=t[1];return[n,vn.string().describe(r)]})))))}}]),n}(Gp),nh=function(e){B(n,e);var t=z(n);function n(){var e;return T(this,n),e=t.apply(this,arguments),Object.defineProperty(N(e),"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(N(e),"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),e}return I(n,[{key:"_diff",value:function(e,t){if(t)return e?function(e,t){var n=[];return El(e,t,n,"",arguments.length>2&&void 0!==arguments[2]&&arguments[2]),n}(e,t):[{op:"replace",path:"",value:t}]}},{key:"parsePartialResult",value:function(){var e=b(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ho(t[0].text));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"parse",value:function(){var e=b(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ho(t,JSON.parse));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getFormatInstructions",value:function(){return""}}],[{key:"lc_name",value:function(){return"JsonOutputParser"}}]),n}(eh);var rh=["id"];function ah(e,t){if(void 0!==e.function){var n;if(null!==t&&void 0!==t&&t.partial)try{var r;n=Zo(null!==(r=e.function.arguments)&&void 0!==r?r:"{}")}catch(i){return}else try{n=JSON.parse(e.function.arguments)}catch(i){throw new Vp(['Function "'.concat(e.function.name,'" arguments:'),"",e.function.arguments,"","are not valid JSON.","Error: ".concat(i.message)].join("\n"))}var a={name:e.function.name,args:n,type:"tool_call"};return null!==t&&void 0!==t&&t.returnId&&(a.id=e.id),a}}function ih(e){if(void 0===e.id)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:e.id,type:"function",function:{name:e.name,arguments:JSON.stringify(e.args)}}}function uh(e,t){var n,r;return{name:null===(n=e.function)||void 0===n?void 0:n.name,args:null===(r=e.function)||void 0===r?void 0:r.arguments,id:e.id,error:t,type:"invalid_tool_call"}}var oh=function(e){B(n,e);var t=z(n);function n(e){var r,a;return T(this,n),a=t.call(this,e),Object.defineProperty(N(a),"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(N(a),"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(N(a),"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),a.returnId=null!==(r=null===e||void 0===e?void 0:e.returnId)&&void 0!==r?r:a.returnId,a}return I(n,[{key:"_diff",value:function(){throw new Error("Not supported.")}},{key:"parse",value:function(){var e=b(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"parseResult",value:function(){var e=b(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.parsePartialResult(t,!1);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"parsePartialResult",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l,d,f=this,h=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!(h.length>1&&void 0!==h[1])||h[1],ss(a=t[0].message)&&null!==(n=a.tool_calls)&&void 0!==n&&n.length?i=a.tool_calls.map((function(e){var t=e.id,n=Sn(e,rh);return f.returnId?q({id:t},n):n})):void 0!==a.additional_kwargs.tool_calls&&(u=JSON.parse(JSON.stringify(a.additional_kwargs.tool_calls)),i=u.map((function(e){return ah(e,{returnId:f.returnId,partial:r})}))),i){e.next=5;break}return e.abrupt("return",[]);case 5:o=[],s=G(i);try{for(s.s();!(c=s.n()).done;)void 0!==(l=c.value)&&(d={type:l.name,args:l.args,id:l.id},o.push(d))}catch(p){s.e(p)}finally{s.f()}return e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"lc_name",value:function(){return"JsonOutputToolsParser"}}]),n}(eh),sh=function(e){B(n,e);var t=z(n);function n(e){var r,a;return T(this,n),a=t.call(this,e),Object.defineProperty(N(a),"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(N(a),"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(N(a),"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(N(a),"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(a),"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(N(a),"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),a.keyName=e.keyName,a.returnSingle=null!==(r=e.returnSingle)&&void 0!==r?r:a.returnSingle,a.zodSchema=e.zodSchema,a}return I(n,[{key:"_validateResult",value:function(){var e=b(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.zodSchema){e.next=2;break}return e.abrupt("return",t);case 2:return e.next=4,this.zodSchema.safeParseAsync(t);case 4:if(!(n=e.sent).success){e.next=9;break}return e.abrupt("return",n.data);case 9:throw new Vp('Failed to parse. Text: "'.concat(JSON.stringify(t,null,2),'". Error: ').concat(JSON.stringify(n.error.errors)),JSON.stringify(t,null,2));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"parsePartialResult",value:function(){var e=b(p().mark((function e(t){var r,a,i,u=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kn(L(n.prototype),"parsePartialResult",this).call(this,t);case 2:if(r=e.sent,a=r.filter((function(e){return e.type===u.keyName})),i=a,a.length){e.next=7;break}return e.abrupt("return",void 0);case 7:if(this.returnId||(i=a.map((function(e){return e.args}))),!this.returnSingle){e.next=10;break}return e.abrupt("return",i[0]);case 10:return e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"parseResult",value:function(){var e=b(p().mark((function e(t){var r,a,i,u,o=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kn(L(n.prototype),"parsePartialResult",this).call(this,t,!1);case 2:if(r=e.sent,a=r.filter((function(e){return e.type===o.keyName})),i=a,a.length){e.next=7;break}return e.abrupt("return",void 0);case 7:if(this.returnId||(i=a.map((function(e){return e.args}))),!this.returnSingle){e.next=10;break}return e.abrupt("return",this._validateResult(i[0]));case 10:return e.next=12,Promise.all(i.map((function(e){return o._validateResult(e)})));case 12:return u=e.sent,e.abrupt("return",u);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"lc_name",value:function(){return"JsonOutputKeyToolsParser"}}]),n}(oh);function ch(e,t,n,r){null!==r&&void 0!==r&&r.errorMessages&&n&&(e.errorMessage=q(q({},e.errorMessage),{},P({},t,n)))}function lh(e,t,n,r,a){e[t]=n,ch(e,t,r,a)}function dh(e,t,n){var r=null!==n&&void 0!==n?n:t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((function(n,r){return dh(e,t,n)}))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return fh(e,t)}}var fh=function(e,t){var n={type:"integer",format:"unix-time"};if("openApi3"===t.target)return n;var r,a=G(e.checks);try{for(a.s();!(r=a.n()).done;){var i=r.value;switch(i.kind){case"min":lh(n,"minimum",i.value,i.message,t);break;case"max":lh(n,"maximum",i.value,i.message,t)}}}catch(u){a.e(u)}finally{a.f()}return n};var ph,hh=["additionalProperties"];var vh={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:function(){return void 0===ph&&(ph=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),ph},uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function mh(e,t){var n={type:"string"};function r(e){return"escape"===t.patternStrategy?yh(e):e}if(e.checks){var a,i=G(e.checks);try{for(i.s();!(a=i.n()).done;){var u=a.value;switch(u.kind){case"min":lh(n,"minLength","number"===typeof n.minLength?Math.max(n.minLength,u.value):u.value,u.message,t);break;case"max":lh(n,"maxLength","number"===typeof n.maxLength?Math.min(n.maxLength,u.value):u.value,u.message,t);break;case"email":switch(t.emailStrategy){case"format:email":gh(n,"email",u.message,t);break;case"format:idn-email":gh(n,"idn-email",u.message,t);break;case"pattern:zod":bh(n,vh.email,u.message,t)}break;case"url":gh(n,"uri",u.message,t);break;case"uuid":gh(n,"uuid",u.message,t);break;case"regex":bh(n,u.regex,u.message,t);break;case"cuid":bh(n,vh.cuid,u.message,t);break;case"cuid2":bh(n,vh.cuid2,u.message,t);break;case"startsWith":bh(n,RegExp("^".concat(r(u.value))),u.message,t);break;case"endsWith":bh(n,RegExp("".concat(r(u.value),"$")),u.message,t);break;case"datetime":gh(n,"date-time",u.message,t);break;case"date":gh(n,"date",u.message,t);break;case"time":gh(n,"time",u.message,t);break;case"duration":gh(n,"duration",u.message,t);break;case"length":lh(n,"minLength","number"===typeof n.minLength?Math.max(n.minLength,u.value):u.value,u.message,t),lh(n,"maxLength","number"===typeof n.maxLength?Math.min(n.maxLength,u.value):u.value,u.message,t);break;case"includes":bh(n,RegExp(r(u.value)),u.message,t);break;case"ip":"v6"!==u.version&&gh(n,"ipv4",u.message,t),"v4"!==u.version&&gh(n,"ipv6",u.message,t);break;case"emoji":bh(n,vh.emoji,u.message,t);break;case"ulid":bh(n,vh.ulid,u.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":gh(n,"binary",u.message,t);break;case"contentEncoding:base64":lh(n,"contentEncoding","base64",u.message,t);break;case"pattern:zod":bh(n,vh.base64,u.message,t)}break;case"nanoid":bh(n,vh.nanoid,u.message,t)}}}catch(o){i.e(o)}finally{i.f()}}return n}var yh=function(e){return Array.from(e).map((function(e){return/[a-zA-Z0-9]/.test(e)?e:"\\".concat(e)})).join("")},gh=function(e,t,n,r){var a;e.format||null!==(a=e.anyOf)&&void 0!==a&&a.some((function(e){return e.format}))?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push(q({format:e.format},e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}})),delete e.format,e.errorMessage&&(delete e.errorMessage.format,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.anyOf.push(q({format:t},n&&r.errorMessages&&{errorMessage:{format:n}}))):lh(e,"format",t,n,r)},bh=function(e,t,n,r){var a;e.pattern||null!==(a=e.allOf)&&void 0!==a&&a.some((function(e){return e.pattern}))?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push(q({pattern:e.pattern},e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}})),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.allOf.push(q({pattern:_h(t,r)},n&&r.errorMessages&&{errorMessage:{pattern:n}}))):lh(e,"pattern",_h(t,r),n,r)},_h=function(e,t){var n="function"===typeof e?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;for(var r=n.flags.includes("i"),a=n.flags.includes("m"),i=n.flags.includes("s"),u=r?n.source.toLowerCase():n.source,o="",s=!1,c=!1,l=!1,d=0;d<u.length;d++)if(s)o+=u[d],s=!1;else{if(r)if(c){if(u[d].match(/[a-z]/)){var f;l?(o+=u[d],o+="".concat(u[d-2],"-").concat(u[d]).toUpperCase(),l=!1):"-"===u[d+1]&&null!==(f=u[d+2])&&void 0!==f&&f.match(/[a-z]/)?(o+=u[d],l=!0):o+="".concat(u[d]).concat(u[d].toUpperCase());continue}}else if(u[d].match(/[a-z]/)){o+="[".concat(u[d]).concat(u[d].toUpperCase(),"]");continue}if(a){if("^"===u[d]){o+="(^|(?<=[\r\n]))";continue}if("$"===u[d]){o+="($|(?=[\r\n]))";continue}}i&&"."===u[d]?o+=c?"".concat(u[d],"\r\n"):"[".concat(u[d],"\r\n]"):(o+=u[d],"\\"===u[d]?s=!0:c&&"]"===u[d]?c=!1:c||"["!==u[d]||(c=!0))}try{new RegExp(o)}catch(p){return console.warn("Could not convert regex pattern at ".concat(t.currentPath.join("/")," to a flag-independent form! Falling back to the flag-ignorant source")),n.source}return o};function kh(e,t){var n,r,a,i,u;if("openApi3"===t.target&&(null===(n=e.keyType)||void 0===n?void 0:n._def.typeName)===Ft.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((function(n,r){var a;return q(q({},n),{},P({},r,null!==(a=Dh(e.valueType._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["properties",r])})))&&void 0!==a?a:{}))}),{}),additionalProperties:!1};var o={type:"object",additionalProperties:null!==(r=Dh(e.valueType._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["additionalProperties"])})))&&void 0!==r?r:{}};if("openApi3"===t.target)return o;if((null===(a=e.keyType)||void 0===a?void 0:a._def.typeName)===Ft.ZodString&&null!==(i=e.keyType._def.checks)&&void 0!==i&&i.length){var s=Object.entries(mh(e.keyType._def,t)).reduce((function(e,t){var n=w(t,2),r=n[0],a=n[1];return"type"===r?e:q(q({},e),{},P({},r,a))}),{});return q(q({},o),{},{propertyNames:s})}return(null===(u=e.keyType)||void 0===u?void 0:u._def.typeName)===Ft.ZodEnum?q(q({},o),{},{propertyNames:{enum:e.keyType._def.values}}):o}var wh={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};var xh=function(e,t){var n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((function(e,n){return Dh(e._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["anyOf","".concat(n)])}))})).filter((function(e){return!!e&&(!t.strictUnions||"object"===typeof e&&Object.keys(e).length>0)}));return n.length?{anyOf:n}:void 0};function Eh(e,t){var n,r;return"strict"===t.removeAdditionalStrategy?"ZodNever"===e.catchall._def.typeName?"strict"!==e.unknownKeys:null===(n=Dh(e.catchall._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["additionalProperties"])})))||void 0===n||n:"ZodNever"===e.catchall._def.typeName?"passthrough"===e.unknownKeys:null===(r=Dh(e.catchall._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["additionalProperties"])})))||void 0===r||r}var Ah=Symbol("Let zodToJsonSchema decide on which parser to use"),Ch={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"};function Dh(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.seen.get(e);if(t.override){var a,i=null===(a=t.override)||void 0===a?void 0:a.call(t,e,t,r,n);if(i!==Ah)return i}if(r&&!n){var u=Sh(r,t);if(void 0!==u)return"$ref"in u&&t.seenRefs.add(u.$ref),u}var o={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,o);var s=Fh(e,e.typeName,t,n);return s&&Ph(e,t,s),o.jsonSchema=s,s}var Sh=function(e,t){switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"extract-to-root":var n=e.path.slice(t.basePath.length+1).join("_");return n!==t.name&&"duplicate-ref"===t.nameStrategy&&(t.definitions[n]=e.def),{$ref:[].concat(y(t.basePath),[t.definitionPath,n]).join("/")};case"relative":return{$ref:Oh(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((function(e,n){return t.currentPath[n]===e}))?(console.warn("Recursive reference detected at ".concat(t.currentPath.join("/"),"! Defaulting to any")),{}):"seen"===t.$refStrategy?{}:void 0}},Oh=function(e,t){for(var n=0;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString()].concat(y(t.slice(n))).join("/")},Fh=function(e,t,n,r){switch(t){case Ft.ZodString:return mh(e,n);case Ft.ZodNumber:return function(e,t){var n={type:"number"};if(!e.checks)return n;var r,a=G(e.checks);try{for(a.s();!(r=a.n()).done;){var i=r.value;switch(i.kind){case"int":n.type="integer",ch(n,"type",i.message,t);break;case"min":"jsonSchema7"===t.target?i.inclusive?lh(n,"minimum",i.value,i.message,t):lh(n,"exclusiveMinimum",i.value,i.message,t):(i.inclusive||(n.exclusiveMinimum=!0),lh(n,"minimum",i.value,i.message,t));break;case"max":"jsonSchema7"===t.target?i.inclusive?lh(n,"maximum",i.value,i.message,t):lh(n,"exclusiveMaximum",i.value,i.message,t):(i.inclusive||(n.exclusiveMaximum=!0),lh(n,"maximum",i.value,i.message,t));break;case"multipleOf":lh(n,"multipleOf",i.value,i.message,t)}}}catch(u){a.e(u)}finally{a.f()}return n}(e,n);case Ft.ZodObject:return function(e,t){var n=q(q({type:"object"},Object.entries(e.shape()).reduce((function(e,n){var r=w(n,2),a=r[0],i=r[1];if(void 0===i||void 0===i._def)return e;var u=Dh(i._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["properties",a]),propertyPath:[].concat(y(t.currentPath),["properties",a])}));return void 0===u?e:{properties:q(q({},e.properties),{},P({},a,u)),required:i.isOptional()&&!t.openaiStrictMode?e.required:[].concat(y(e.required),[a])}}),{properties:{},required:[]})),{},{additionalProperties:Eh(e,t)});return n.required.length||delete n.required,n}(e,n);case Ft.ZodBigInt:return function(e,t){var n={type:"integer",format:"int64"};if(!e.checks)return n;var r,a=G(e.checks);try{for(a.s();!(r=a.n()).done;){var i=r.value;switch(i.kind){case"min":"jsonSchema7"===t.target?i.inclusive?lh(n,"minimum",i.value,i.message,t):lh(n,"exclusiveMinimum",i.value,i.message,t):(i.inclusive||(n.exclusiveMinimum=!0),lh(n,"minimum",i.value,i.message,t));break;case"max":"jsonSchema7"===t.target?i.inclusive?lh(n,"maximum",i.value,i.message,t):lh(n,"exclusiveMaximum",i.value,i.message,t):(i.inclusive||(n.exclusiveMaximum=!0),lh(n,"maximum",i.value,i.message,t));break;case"multipleOf":lh(n,"multipleOf",i.value,i.message,t)}}}catch(u){a.e(u)}finally{a.f()}return n}(e,n);case Ft.ZodBoolean:return{type:"boolean"};case Ft.ZodDate:return dh(e,n);case Ft.ZodUndefined:return{not:{}};case Ft.ZodNull:return function(e){return"openApi3"===e.target?{enum:["null"],nullable:!0}:{type:"null"}}(n);case Ft.ZodArray:return function(e,t){var n,r,a={type:"array"};return(null===(n=e.type)||void 0===n||null===(r=n._def)||void 0===r?void 0:r.typeName)!==Ft.ZodAny&&(a.items=Dh(e.type._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["items"])}))),e.minLength&&lh(a,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&lh(a,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(lh(a,"minItems",e.exactLength.value,e.exactLength.message,t),lh(a,"maxItems",e.exactLength.value,e.exactLength.message,t)),a}(e,n);case Ft.ZodUnion:case Ft.ZodDiscriminatedUnion:return function(e,t){if("openApi3"===t.target)return xh(e,t);var n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every((function(e){return e._def.typeName in wh&&(!e._def.checks||!e._def.checks.length)}))){var r=n.reduce((function(e,t){var n=wh[t._def.typeName];return n&&!e.includes(n)?[].concat(y(e),[n]):e}),[]);return{type:r.length>1?r:r[0]}}if(n.every((function(e){return"ZodLiteral"===e._def.typeName&&!e.description}))){var a=n.reduce((function(e,t){var n=typeof t._def.value;switch(n){case"string":case"number":case"boolean":return[].concat(y(e),[n]);case"bigint":return[].concat(y(e),["integer"]);case"object":if(null===t._def.value)return[].concat(y(e),["null"]);default:return e}}),[]);if(a.length===n.length){var i=a.filter((function(e,t,n){return n.indexOf(e)===t}));return{type:i.length>1?i:i[0],enum:n.reduce((function(e,t){return e.includes(t._def.value)?e:[].concat(y(e),[t._def.value])}),[])}}}else if(n.every((function(e){return"ZodEnum"===e._def.typeName})))return{type:"string",enum:n.reduce((function(e,t){return[].concat(y(e),y(t._def.values.filter((function(t){return!e.includes(t)}))))}),[])};return xh(e,t)}(e,n);case Ft.ZodIntersection:return function(e,t){var n=[Dh(e.left._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["allOf","0"])})),Dh(e.right._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["allOf","1"])}))].filter((function(e){return!!e})),r="jsonSchema2019-09"===t.target?{unevaluatedProperties:!1}:void 0,a=[];return n.forEach((function(e){if("type"in(n=e)&&"string"===n.type||!("allOf"in n)){var t=e;"additionalProperties"in e&&!1===e.additionalProperties?(e.additionalProperties,t=Sn(e,hh)):r=void 0,a.push(t)}else a.push.apply(a,y(e.allOf)),void 0===e.unevaluatedProperties&&(r=void 0);var n})),a.length?q({allOf:a},r):void 0}(e,n);case Ft.ZodTuple:return function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((function(e,n){return Dh(e._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["items","".concat(n)])}))})).reduce((function(e,t){return void 0===t?e:[].concat(y(e),[t])}),[]),additionalItems:Dh(e.rest._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["additionalItems"])}))}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((function(e,n){return Dh(e._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["items","".concat(n)])}))})).reduce((function(e,t){return void 0===t?e:[].concat(y(e),[t])}),[])}}(e,n);case Ft.ZodRecord:return kh(e,n);case Ft.ZodLiteral:return function(e,t){var n=typeof e.value;return"bigint"!==n&&"number"!==n&&"boolean"!==n&&"string"!==n?{type:Array.isArray(e.value)?"array":"object"}:"openApi3"===t.target?{type:"bigint"===n?"integer":n,enum:[e.value]}:{type:"bigint"===n?"integer":n,const:e.value}}(e,n);case Ft.ZodEnum:return function(e){return{type:"string",enum:y(e.values)}}(e);case Ft.ZodNativeEnum:return function(e){var t=e.values,n=Object.keys(e.values).filter((function(e){return"number"!==typeof t[t[e]]})),r=n.map((function(e){return t[e]})),a=Array.from(new Set(r.map((function(e){return typeof e}))));return{type:1===a.length?"string"===a[0]?"string":"number":["string","number"],enum:r}}(e);case Ft.ZodNullable:return function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return"openApi3"===t.target||"property"===t.nullableStrategy?{type:wh[e.innerType._def.typeName],nullable:!0}:{type:[wh[e.innerType._def.typeName],"null"]};if("openApi3"===t.target){var n=Dh(e.innerType._def,q(q({},t),{},{currentPath:y(t.currentPath)}));return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&q(q({},n),{},{nullable:!0})}var r=Dh(e.innerType._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["anyOf","0"])}));return r&&{anyOf:[r,{type:"null"}]}}(e,n);case Ft.ZodOptional:return function(e,t){var n;if(t.currentPath.toString()===(null===(n=t.propertyPath)||void 0===n?void 0:n.toString()))return Dh(e.innerType._def,t);var r=Dh(e.innerType._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["anyOf","1"])}));return r?{anyOf:[{not:{}},r]}:{}}(e,n);case Ft.ZodMap:return function(e,t){return"record"===t.mapStrategy?kh(e,t):{type:"array",maxItems:125,items:{type:"array",items:[Dh(e.keyType._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["items","items","0"])}))||{},Dh(e.valueType._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["items","items","1"])}))||{}],minItems:2,maxItems:2}}}(e,n);case Ft.ZodSet:return function(e,t){var n={type:"array",uniqueItems:!0,items:Dh(e.valueType._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["items"])}))};return e.minSize&&lh(n,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&lh(n,"maxItems",e.maxSize.value,e.maxSize.message,t),n}(e,n);case Ft.ZodLazy:return Dh(e.getter()._def,n);case Ft.ZodPromise:return function(e,t){return Dh(e.type._def,t)}(e,n);case Ft.ZodNaN:case Ft.ZodNever:return{not:{}};case Ft.ZodEffects:return function(e,t,n){return"input"===t.effectStrategy?Dh(e.schema._def,t,n):{}}(e,n,r);case Ft.ZodAny:case Ft.ZodUnknown:return{};case Ft.ZodDefault:return function(e,t){return q(q({},Dh(e.innerType._def,t)),{},{default:e.defaultValue()})}(e,n);case Ft.ZodBranded:return function(e,t){return Dh(e.type._def,t)}(e,n);case Ft.ZodReadonly:case Ft.ZodCatch:return function(e,t){return Dh(e.innerType._def,t)}(e,n);case Ft.ZodPipeline:return function(e,t){if("input"===t.pipeStrategy)return Dh(e.in._def,t);if("output"===t.pipeStrategy)return Dh(e.out._def,t);var n=Dh(e.in._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["allOf","0"])}));return{allOf:[n,Dh(e.out._def,q(q({},t),{},{currentPath:[].concat(y(t.currentPath),["allOf",n?"1":"0"])}))].filter((function(e){return void 0!==e}))}}(e,n);case Ft.ZodFunction:case Ft.ZodVoid:case Ft.ZodSymbol:default:return}},Ph=function(e,t,n){return e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n},Th=function(e){return"_def"in e?e._def:e};var jh=function(e){var t=function(e){return"string"===typeof e?q(q({},Ch),{},{basePath:["#"],definitions:{},name:e}):q(q({},Ch),{},{basePath:["#"],definitions:{}},e)}(e),n=void 0!==t.name?[].concat(y(t.basePath),[t.definitionPath,t.name]):t.basePath;return q(q({},t),{},{currentPath:n,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(t.definitions).map((function(e){var n=w(e,2),r=n[0],a=n[1];return[Th(a),{def:Th(a),path:[].concat(y(t.basePath),[t.definitionPath,r]),jsonSchema:void 0}]})))})},Ih=function(e,t){var n,r=jh(t),a="string"===typeof t?t:"title"===(null===t||void 0===t?void 0:t.nameStrategy)||null===t||void 0===t?void 0:t.name,i=null!==(n=Dh(e._def,void 0===a?r:q(q({},r),{},{currentPath:[].concat(y(r.basePath),[r.definitionPath,a])}),!1))&&void 0!==n?n:{},u="object"===typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==u&&(i.title=u);var o=function(){if(!function(e){if(!e)return!0;for(var t in e)return!1;return!0}(r.definitions)){for(var e={},t=new Set,n=0;n<500;n++){var a=Object.entries(r.definitions).filter((function(e){var n=w(e,1)[0];return!t.has(n)}));if(0===a.length)break;var i,u=G(a);try{for(u.s();!(i=u.n()).done;){var o,s=w(i.value,2),c=s[0],l=s[1];e[c]=null!==(o=Dh(Th(l),q(q({},r),{},{currentPath:[].concat(y(r.basePath),[r.definitionPath,c])}),!0))&&void 0!==o?o:{},t.add(c)}}catch(d){u.e(d)}finally{u.f()}}return e}}(),s=void 0===a?o?q(q({},i),{},P({},r.definitionPath,o)):i:"duplicate-ref"===r.nameStrategy?q(q({},i),o||r.seenRefs.size?P({},r.definitionPath,q(q({},o),r.seenRefs.size?P({},a,i):void 0)):void 0):P({$ref:[].concat(y("relative"===r.$refStrategy?[]:r.basePath),[r.definitionPath,a]).join("/")},r.definitionPath,q(q({},o),{},P({},a,i)));return"jsonSchema7"===r.target?s.$schema="http://json-schema.org/draft-07/schema#":"jsonSchema2019-09"===r.target&&(s.$schema="https://json-schema.org/draft/2019-09/schema#"),s};function Nh(e,t){return Ih(e,{openaiStrictMode:!0,name:t.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function Rh(e,t,n){return function(e,t){var n=q({},e);return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),n}({type:"json_schema",json_schema:q(q({},n),{},{name:t,strict:!0,schema:Nh(e,{name:t})})},(function(t){return e.parse(JSON.parse(t))}))}function Bh(e){return function(e,t){var n=t.parser,r=t.callback,a=q({},e);return Object.defineProperties(a,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:n,enumerable:!1},$callback:{value:r,enumerable:!1}}),a}({type:"function",function:q({name:e.name,parameters:Nh(e.parameters,{name:e.name}),strict:!0},e.description?{description:e.description}:void 0)},{callback:e.function,parser:function(t){return e.parameters.parse(JSON.parse(t))}})}function Lh(e,t){var n="number"===typeof t?void 0:t;return q({name:e.name,description:e.description,parameters:Df(e.schema)},void 0!==(null===n||void 0===n?void 0:n.strict)?{strict:n.strict}:{})}function Mh(e){return function(e){return!!e&&"object"===typeof e&&"name"in e&&"schema"in e&&Zp(e.schema)}(e)||function(e){return void 0!==e&&Jf.isRunnable(e)&&"lc_name"in e.constructor&&"function"===typeof e.constructor.lc_name&&"RunnableToolLike"===e.constructor.lc_name()}(e)||function(e){return void 0!==e&&Array.isArray(e.lc_namespace)}(e)}function Uh(e,t){return e.lc_error_code=t,e.message="".concat(e.message,"\n\nTroubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/").concat(t,"/\n"),e}function zh(e){var t;return e.constructor.name===cr.name?(t=new Error(e.message)).name="TimeoutError":e.constructor.name===or.name?(t=new Error(e.message)).name="AbortError":t=400===e.status&&e.message.includes("tool_calls")?Uh(e,"INVALID_TOOL_RESULTS"):401===e.status?Uh(e,"MODEL_AUTHENTICATION"):429===e.status?Uh(e,"MODEL_RATE_LIMIT"):404===e.status?Uh(e,"MODEL_NOT_FOUND"):e,t}function Hh(e){return e?"any"===e||"required"===e?"required":"auto"===e?"auto":"none"===e?"none":"string"===typeof e?{type:"function",function:{name:e}}:e:void 0}function Zh(e){var t,n=["namespace functions {",""],r=G(e);try{for(r.s();!(t=r.n()).done;){var a,i=t.value;i.description&&n.push("// ".concat(i.description)),Object.keys(null!==(a=i.parameters.properties)&&void 0!==a?a:{}).length>0?(n.push("type ".concat(i.name," = (_: {")),n.push(Wh(i.parameters,0)),n.push("}) => any;")):n.push("type ".concat(i.name," = () => any;")),n.push("")}}catch(u){r.e(u)}finally{r.f()}return n.push("} // namespace functions"),n.join("\n")}function Wh(e,t){for(var n=[],r=0,a=Object.entries(null!==(i=e.properties)&&void 0!==i?i:{});r<a.length;r++){var i,u,o=w(a[r],2),s=o[0],c=o[1];c.description&&t<2&&n.push("// ".concat(c.description)),null!==(u=e.required)&&void 0!==u&&u.includes(s)?n.push("".concat(s,": ").concat(qh(c,t),",")):n.push("".concat(s,"?: ").concat(qh(c,t),","))}return n.map((function(e){return" ".repeat(t)+e})).join("\n")}function qh(e,t){if(void 0!==(n=e).anyOf&&Array.isArray(n.anyOf))return e.anyOf.map((function(e){return qh(e,t)})).join(" | ");var n;switch(e.type){case"string":return e.enum?e.enum.map((function(e){return'"'.concat(e,'"')})).join(" | "):"string";case"number":case"integer":return e.enum?e.enum.map((function(e){return"".concat(e)})).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",Wh(e,t+2),"}"].join("\n");case"array":return e.items?"".concat(qh(e.items,t),"[]"):"any[]";default:return""}}function Gh(e){var t=e._getType();switch(t){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":if(!ds.isInstance(e))throw new Error("Invalid generic chat message");return function(e){return"system"!==e.role&&"developer"!==e.role&&"assistant"!==e.role&&"user"!==e.role&&"function"!==e.role&&"tool"!==e.role&&console.warn("Unknown message role: ".concat(e.role)),e.role}(e);default:throw new Error("Unknown message type: ".concat(t))}}function Vh(e,t){return e.flatMap((function(e){var n,r=Gh(e);"system"===r&&ev(t)&&(r="developer");var a={role:r,content:e.content};return null!=e.name&&(a.name=e.name),null!=e.additional_kwargs.function_call&&(a.function_call=e.additional_kwargs.function_call,a.content=""),ss(e)&&null!==(n=e.tool_calls)&&void 0!==n&&n.length?(a.tool_calls=e.tool_calls.map(ih),a.content=""):(null!=e.additional_kwargs.tool_calls&&(a.tool_calls=e.additional_kwargs.tool_calls),null!=e.tool_call_id&&(a.tool_call_id=e.tool_call_id)),e.additional_kwargs.audio&&"object"===typeof e.additional_kwargs.audio&&"id"in e.additional_kwargs.audio?[a,{role:"assistant",audio:{id:e.additional_kwargs.audio.id}}]:a}))}var $h="__openai_function_call_ids__";function Jh(e,t){return e.flatMap((function(e){var n,r=Gh(e);if("system"===r&&ev(t)&&(r="developer"),"function"===r)throw new Error("Function messages are not supported in Responses API");if("tool"===r){var a,i=e;if("computer_call_output"===(null===(a=i.additional_kwargs)||void 0===a?void 0:a.type)){var u=function(){if("string"===typeof i.content)return{type:"computer_screenshot",image_url:i.content};if(Array.isArray(i.content)){var e=i.content.find((function(e){return"computer_screenshot"===e.type}));if(e)return e;var t=i.content.find((function(e){return"image_url"===e.type}));if(t)return{type:"computer_screenshot",image_url:"string"===typeof t.image_url?t.image_url:t.image_url.url}}throw new Error("Invalid computer call output")}();return{type:"computer_call_output",output:u,call_id:i.tool_call_id}}return{type:"function_call_output",call_id:i.tool_call_id,id:i.id,output:"string"!==typeof i.content?JSON.stringify(i.content):i.content}}if("assistant"===r){var o,s,c=[];if(null!=e.additional_kwargs.reasoning){"object"===typeof(n=e.additional_kwargs.reasoning)&&null!=n&&"type"in n&&"reasoning"===n.type&&c.push(e.additional_kwargs.reasoning)}var l=e.content;null!=e.additional_kwargs.refusal&&("string"===typeof l&&(l=[{type:"output_text",text:l,annotations:[]}]),l=[].concat(y(l),[{type:"refusal",refusal:e.additional_kwargs.refusal}])),c.push({type:"message",role:"assistant",content:"string"===typeof l?l:l.flatMap((function(e){var t;return"text"===e.type?{type:"output_text",text:e.text,annotations:null!==(t=e.annotations)&&void 0!==t?t:[]}:"output_text"===e.type||"refusal"===e.type?e:[]}))});var d=e.additional_kwargs[$h];ss(e)&&null!==(o=e.tool_calls)&&void 0!==o&&o.length?c.push.apply(c,y(e.tool_calls.map((function(e){return{type:"function_call",name:e.name,arguments:JSON.stringify(e.args),call_id:e.id,id:null===d||void 0===d?void 0:d[e.id]}})))):null!=e.additional_kwargs.tool_calls&&c.push.apply(c,y(e.additional_kwargs.tool_calls.map((function(e){return{type:"function_call",name:e.function.name,call_id:e.id,id:null===d||void 0===d?void 0:d[e.id],arguments:e.function.arguments}}))));var f=null!==(s=e.response_metadata.output)&&void 0!==s&&s.length?e.response_metadata.output:e.additional_kwargs.tool_outputs;if(null!=f){var p=f,h=null===p||void 0===p?void 0:p.filter((function(e){return"reasoning"===e.type})),v=null===p||void 0===p?void 0:p.filter((function(e){return"computer_call"===e.type}));h.length>0&&v.length>0&&c.push.apply(c,y(h)),v.length>0&&c.push.apply(c,y(v))}return c}return"user"===r?{type:"message",role:"user",content:"string"===typeof e.content?e.content:e.content.flatMap((function(e){return"text"===e.type?{type:"input_text",text:e.text}:"image_url"===e.type?{type:"input_image",image_url:"string"===typeof e.image_url?e.image_url:e.image_url.url,detail:"string"===typeof e.image_url?"auto":e.image_url.detail}:"input_text"===e.type||"input_image"===e.type||"input_file"===e.type?e:[]}))}:[]}))}function Kh(e){if(e.error){var t=new Error(e.error.message);throw t.name=e.error.code,t}var n,r=[],a=[],i=[],u={model:e.model,created_at:e.created_at,id:e.id,incomplete_details:e.incomplete_details,metadata:e.metadata,object:e.object,status:e.status,user:e.user,model_name:e.model},o={},s=G(e.output);try{for(s.s();!(n=s.n()).done;){var c=n.value;if("message"===c.type)r.push.apply(r,y(c.content.flatMap((function(e){return"output_text"===e.type?("parsed"in e&&null!=e.parsed&&(o.parsed=e.parsed),{type:"text",text:e.text,annotations:e.annotations}):"refusal"===e.type?(o.refusal=e.refusal,[]):e}))));else if("function_call"===c.type){var l,d={function:{name:c.name,arguments:c.arguments},id:c.call_id};try{a.push(ah(d,{returnId:!0}))}catch(h){var f=void 0;"object"===typeof h&&null!=h&&"message"in h&&"string"===typeof h.message&&(f=h.message),i.push(uh(d,f))}null!==(l=o[$h])&&void 0!==l||(o[$h]={}),o[$h][c.call_id]=c.id}else if("reasoning"===c.type)o.reasoning=c;else{var p;null!==(p=o.tool_outputs)&&void 0!==p||(o.tool_outputs=[]),o.tool_outputs.push(c)}}}catch(v){s.e(v)}finally{s.f()}return new os({id:e.id,content:r,tool_calls:a,invalid_tool_calls:i,usage_metadata:e.usage,additional_kwargs:o,response_metadata:u})}function Qh(e){var t,n,r=[],a={},i=[],u={},o={};if("response.output_text.delta"===e.type)r.push({type:"text",text:e.delta,index:e.content_index});else if("response.output_text.annotation.added"===e.type)r.push({type:"text",text:"",annotations:[e.annotation],index:e.content_index});else if("response.output_item.added"===e.type&&"message"===e.item.type)n=e.item.id;else if("response.output_item.added"===e.type&&"function_call"===e.item.type)i.push({type:"tool_call_chunk",name:e.item.name,args:e.item.arguments,id:e.item.id,index:e.output_index}),o[$h]=P({},e.item.call_id,e.item.id);else if("response.output_item.done"!==e.type||"web_search_call"!==e.item.type&&"file_search_call"!==e.item.type&&"computer_call"!==e.item.type)if("response.created"===e.type)u.id=e.response.id,u.model_name=e.response.model,u.model=e.response.model;else if("response.completed"===e.type){var s,c,l,d=Kh(e.response);if(t=e.response.usage,"json_schema"===(null===(s=e.response.text)||void 0===s||null===(c=s.format)||void 0===c?void 0:c.type))null!==(l=o.parsed)&&void 0!==l||(o.parsed=JSON.parse(d.text));for(var f=0,p=Object.entries(e.response);f<p.length;f++){var h=w(p[f],2),v=h[0],m=h[1];"id"!==v&&(u[v]=m)}}else if("response.function_call_arguments.delta"===e.type)i.push({type:"tool_call_chunk",args:e.delta,index:e.output_index});else if("response.web_search_call.completed"===e.type||"response.file_search_call.completed"===e.type)a={tool_outputs:{id:e.item_id,type:e.type.replace("response.","").replace(".completed",""),status:"completed"}};else{if("response.refusal.done"!==e.type)return null;o.refusal=e.refusal}else o.tool_outputs=[e.item];return new zd({text:r.map((function(e){return e.text})).join(""),message:new ls({id:n,content:r,tool_call_chunks:i,usage_metadata:t,additional_kwargs:o,response_metadata:u}),generationInfo:a})}function Xh(e){return"type"in e&&"function"!==e.type}function Yh(e,t){return Mp(e)?void 0!==(null===t||void 0===t?void 0:t.strict)?q(q({},e),{},{function:q(q({},e.function),{},{strict:t.strict})}):e:function(e,t){var n;if(Mh(e)){var r=Bh({name:e.name,parameters:e.schema,description:e.description});n=r.function.parameters?{type:r.type,function:q({name:r.function.name,description:r.function.description,parameters:r.function.parameters},void 0!==(null===t||void 0===t?void 0:t.strict)?{strict:t.strict}:{})}:{type:"function",function:Lh(e,t)}}else n=e;return void 0!==(null===t||void 0===t?void 0:t.strict)&&(n.function.strict=t.strict),n}(e,t)}function ev(e){return(null===e||void 0===e?void 0:e.startsWith("o1"))||(null===e||void 0===e?void 0:e.startsWith("o3"))}var tv=function(e){B(n,e);var t=z(n);function n(e){var r,a,i,u,o,s,c,l,d,f,p,h,v,m,y,g,b,_,k,w;return T(this,n),w=t.call(this,null!==e&&void 0!==e?e:{}),Object.defineProperty(N(w),"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(N(w),"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"n",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"modelName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(N(w),"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(N(w),"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(N(w),"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"modalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"reasoningEffort",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(w),"useResponsesApi",{enumerable:!0,configurable:!0,writable:!0,value:!1}),w.openAIApiKey=null!==(r=null!==(a=null!==(i=null===e||void 0===e?void 0:e.apiKey)&&void 0!==i?i:null===e||void 0===e?void 0:e.openAIApiKey)&&void 0!==a?a:null===e||void 0===e||null===(u=e.configuration)||void 0===u?void 0:u.apiKey)&&void 0!==r?r:Fl("OPENAI_API_KEY"),w.apiKey=w.openAIApiKey,w.organization=null!==(o=null===e||void 0===e||null===(s=e.configuration)||void 0===s?void 0:s.organization)&&void 0!==o?o:Fl("OPENAI_ORGANIZATION"),w.model=null!==(c=null!==(l=null===e||void 0===e?void 0:e.model)&&void 0!==l?l:null===e||void 0===e?void 0:e.modelName)&&void 0!==c?c:w.model,w.modelName=w.model,w.modelKwargs=null!==(d=null===e||void 0===e?void 0:e.modelKwargs)&&void 0!==d?d:{},w.timeout=null===e||void 0===e?void 0:e.timeout,w.temperature=null!==(f=null===e||void 0===e?void 0:e.temperature)&&void 0!==f?f:w.temperature,w.topP=null!==(p=null===e||void 0===e?void 0:e.topP)&&void 0!==p?p:w.topP,w.frequencyPenalty=null!==(h=null===e||void 0===e?void 0:e.frequencyPenalty)&&void 0!==h?h:w.frequencyPenalty,w.presencePenalty=null!==(v=null===e||void 0===e?void 0:e.presencePenalty)&&void 0!==v?v:w.presencePenalty,w.logprobs=null===e||void 0===e?void 0:e.logprobs,w.topLogprobs=null===e||void 0===e?void 0:e.topLogprobs,w.n=null!==(m=null===e||void 0===e?void 0:e.n)&&void 0!==m?m:w.n,w.logitBias=null===e||void 0===e?void 0:e.logitBias,w.stop=null!==(y=null===e||void 0===e?void 0:e.stopSequences)&&void 0!==y?y:null===e||void 0===e?void 0:e.stop,w.stopSequences=w.stop,w.user=null===e||void 0===e?void 0:e.user,w.__includeRawResponse=null===e||void 0===e?void 0:e.__includeRawResponse,w.audio=null===e||void 0===e?void 0:e.audio,w.modalities=null===e||void 0===e?void 0:e.modalities,w.reasoningEffort=null===e||void 0===e?void 0:e.reasoningEffort,w.maxTokens=null!==(g=null===e||void 0===e?void 0:e.maxCompletionTokens)&&void 0!==g?g:null===e||void 0===e?void 0:e.maxTokens,w.useResponsesApi=null!==(b=null===e||void 0===e?void 0:e.useResponsesApi)&&void 0!==b?b:w.useResponsesApi,"o1"===w.model&&(w.disableStreaming=!0),w.streaming=null!==(_=null===e||void 0===e?void 0:e.streaming)&&void 0!==_&&_,w.streamUsage=null!==(k=null===e||void 0===e?void 0:e.streamUsage)&&void 0!==k?k:w.streamUsage,w.clientConfig=q({apiKey:w.apiKey,organization:w.organization,dangerouslyAllowBrowser:!0},null===e||void 0===e?void 0:e.configuration),void 0!==(null===e||void 0===e?void 0:e.supportsStrictToolCalling)&&(w.supportsStrictToolCalling=e.supportsStrictToolCalling),w}return I(n,[{key:"callKeys",get:function(){return[].concat(y(kn(L(n.prototype),"callKeys",this)),["options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed","reasoning_effort"])}},{key:"lc_secrets",get:function(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}},{key:"lc_aliases",get:function(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key"}}},{key:"lc_serializable_keys",get:function(){return["configuration","logprobs","topLogprobs","prefixMessages","supportsStrictToolCalling","modalities","audio","reasoningEffort","temperature","maxTokens","topP","frequencyPenalty","presencePenalty","n","logitBias","user","streaming","streamUsage","modelName","model","modelKwargs","stop","stopSequences","timeout","openAIApiKey","apiKey","cache","maxConcurrency","maxRetries","verbose","callbacks","tags","metadata","disableStreaming"]}},{key:"getLsParams",value:function(e){var t,n,r=this.invocationParams(e);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:null!==(t=r.temperature)&&void 0!==t?t:void 0,ls_max_tokens:null!==(n=r.max_tokens)&&void 0!==n?n:void 0,ls_stop:e.stop}}},{key:"bindTools",value:function(e,t){var n;return void 0!==(null===t||void 0===t?void 0:t.strict)?n=t.strict:void 0!==this.supportsStrictToolCalling&&(n=this.supportsStrictToolCalling),this.bind(q({tools:e.map((function(e){return Xh(e)?e:Yh(e,{strict:n})}))},t))}},{key:"createResponseFormat",value:function(e){return e&&"json_schema"===e.type&&e.json_schema.schema&&nv(e.json_schema.schema)?Rh(e.json_schema.schema,e.json_schema.name,{description:e.json_schema.description}):e}},{key:"invocationParams",value:function(e,t){var n,r,a,i,u,o=this;if(void 0!==(null===e||void 0===e?void 0:e.strict)?i=e.strict:void 0!==this.supportsStrictToolCalling&&(i=this.supportsStrictToolCalling),this._useResponseApi(e)){var s,c,l=q({model:this.model,temperature:this.temperature,top_p:this.topP,user:this.user,stream:this.streaming,previous_response_id:null===e||void 0===e?void 0:e.previous_response_id,truncation:null===e||void 0===e?void 0:e.truncation,include:null===e||void 0===e?void 0:e.include,tools:null!==e&&void 0!==e&&null!==(s=e.tools)&&void 0!==s&&s.length?e.tools.map((function(e){return Xh(e)?e:Mp(e)?{type:"function",name:e.function.name,parameters:e.function.parameters,description:e.function.description,strict:i}:null})).filter((function(e){return null!==e})):void 0,tool_choice:(u=null===e||void 0===e?void 0:e.tool_choice,null!=u&&"object"===typeof u&&"type"in u&&"function"!==u.type?null===e||void 0===e?void 0:e.tool_choice:function(){var t=Hh(null===e||void 0===e?void 0:e.tool_choice);return"object"===typeof t&&"type"in t?{type:"function",name:t.function.name}:void 0}()),text:function(){if(null!==e&&void 0!==e&&e.text)return e.text;var t=o.createResponseFormat(null===e||void 0===e?void 0:e.response_format);return"json_schema"===(null===t||void 0===t?void 0:t.type)?null!=t.json_schema.schema?{format:{type:"json_schema",schema:t.json_schema.schema,description:t.json_schema.description,name:t.json_schema.name,strict:t.json_schema.strict}}:void 0:{format:t}}(),parallel_tool_calls:null===e||void 0===e?void 0:e.parallel_tool_calls,max_output_tokens:-1===this.maxTokens?void 0:this.maxTokens},this.modelKwargs),d=null!==(c=null===e||void 0===e?void 0:e.reasoning_effort)&&void 0!==c?c:this.reasoningEffort;return void 0!==d&&(l.reasoning={effort:d}),l}var f={};void 0!==(null===e||void 0===e?void 0:e.stream_options)?f={stream_options:e.stream_options}:this.streamUsage&&(this.streaming||null!==t&&void 0!==t&&t.streaming)&&(f={stream_options:{include_usage:!0}});var p=q(q(q(q({model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:null!==(n=null===e||void 0===e?void 0:e.stop)&&void 0!==n?n:this.stopSequences,user:this.user,stream:this.streaming,functions:null===e||void 0===e?void 0:e.functions,function_call:null===e||void 0===e?void 0:e.function_call,tools:null!==e&&void 0!==e&&null!==(r=e.tools)&&void 0!==r&&r.length?e.tools.map((function(e){return Yh(e,{strict:i})})):void 0,tool_choice:Hh(null===e||void 0===e?void 0:e.tool_choice),response_format:this.createResponseFormat(null===e||void 0===e?void 0:e.response_format),seed:null===e||void 0===e?void 0:e.seed},f),{},{parallel_tool_calls:null===e||void 0===e?void 0:e.parallel_tool_calls},this.audio||null!==e&&void 0!==e&&e.audio?{audio:this.audio||(null===e||void 0===e?void 0:e.audio)}:{}),this.modalities||null!==e&&void 0!==e&&e.modalities?{modalities:this.modalities||(null===e||void 0===e?void 0:e.modalities)}:{}),this.modelKwargs);void 0!==(null===e||void 0===e?void 0:e.prediction)&&(p.prediction=e.prediction);var h=null!==(a=null===e||void 0===e?void 0:e.reasoning_effort)&&void 0!==a?a:this.reasoningEffort;return void 0!==h&&(p.reasoning_effort=h),ev(p.model)?p.max_completion_tokens=-1===this.maxTokens?void 0:this.maxTokens:p.max_tokens=-1===this.maxTokens?void 0:this.maxTokens,p}},{key:"_convertOpenAIChatCompletionMessageToBaseMessage",value:function(e,t){var n,r=e.tool_calls;if("assistant"===e.role){var a,i=[],u=[],o=G(null!==r&&void 0!==r?r:[]);try{for(o.s();!(a=o.n()).done;){var s=a.value;try{i.push(ah(s,{returnId:!0}))}catch(d){u.push(uh(s,d.message))}}}catch(f){o.e(f)}finally{o.f()}var c={function_call:e.function_call,tool_calls:r};void 0!==this.__includeRawResponse&&(c.__raw_response=t);var l=q({model_name:t.model},t.system_fingerprint?{usage:q({},t.usage),system_fingerprint:t.system_fingerprint}:{});return e.audio&&(c.audio=e.audio),new os({content:e.content||"",tool_calls:i,invalid_tool_calls:u,additional_kwargs:c,response_metadata:l,id:t.id})}return new ds(e.content||"",null!==(n=e.role)&&void 0!==n?n:"unknown")}},{key:"_convertOpenAIDeltaToBaseMessageChunk",value:function(e,t,n){var r,a,i,u=null!==(r=e.role)&&void 0!==r?r:n,o=null!==(a=e.content)&&void 0!==a?a:"";i=e.function_call?{function_call:e.function_call}:e.tool_calls?{tool_calls:e.tool_calls}:{},this.__includeRawResponse&&(i.__raw_response=t),e.audio&&(i.audio=q(q({},e.audio),{},{index:t.choices[0].index}));var s={usage:q({},t.usage)};if("user"===u)return new vs({content:o,response_metadata:s});if("assistant"===u){var c=[];if(Array.isArray(e.tool_calls)){var l,d=G(e.tool_calls);try{for(d.s();!(l=d.n()).done;){var f,p,h=l.value;c.push({name:null===(f=h.function)||void 0===f?void 0:f.name,args:null===(p=h.function)||void 0===p?void 0:p.arguments,id:h.id,index:h.index,type:"tool_call_chunk"})}}catch(v){d.e(v)}finally{d.f()}}return new ls({content:o,tool_call_chunks:c,additional_kwargs:i,id:t.id,response_metadata:s})}return"system"===u?new ys({content:o,response_metadata:s}):"developer"===u?new ys({content:o,response_metadata:s,additional_kwargs:{__openai_role__:"developer"}}):"function"===u?new ps({content:o,additional_kwargs:i,name:e.name,response_metadata:s}):"tool"===u?new us({content:o,additional_kwargs:i,tool_call_id:e.tool_call_id,response_metadata:s}):new fs({content:o,role:u,response_metadata:s})}},{key:"_identifyingParams",value:function(){return q(q({model_name:this.model},this.invocationParams()),this.clientConfig)}},{key:"_streamResponseChunks",value:function(e,t,n){var r=this;return An(p().mark((function a(){var i,u,o,s,c,l,d,f,h,v,m,y,g,b,_,k,w,x,E,A,C,D,S,O,F,P,T,j,I,N,R,B,L,M,U,z,H,Z,W,G,V,$;return p().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!r._useResponseApi(t)){a.next=37;break}return a.next=3,xn(r.responseApiWithRetry(q(q({},r.invocationParams(t,{streaming:!0})),{},{input:Jh(e,r.model),stream:!0}),t));case 3:u=a.sent,o=!1,s=!1,a.prev=6,l=Cn(u);case 8:return a.next=10,xn(l.next());case 10:if(!(o=!(d=a.sent).done)){a.next=20;break}if(f=d.value,null!=(h=Qh(f))){a.next=15;break}return a.abrupt("continue",17);case 15:return a.next=17,h;case 17:o=!1,a.next=8;break;case 20:a.next=26;break;case 22:a.prev=22,a.t0=a.catch(6),s=!0,c=a.t0;case 26:if(a.prev=26,a.prev=27,!o||null==l.return){a.next=31;break}return a.next=31,xn(l.return());case 31:if(a.prev=31,!s){a.next=34;break}throw c;case 34:return a.finish(31);case 35:return a.finish(26);case 36:return a.abrupt("return");case 37:return v=Vh(e,r.model),m=q(q({},r.invocationParams(t,{streaming:!0})),{},{messages:v,stream:!0}),a.next=41,xn(r.completionWithRetry(m,t));case 41:g=a.sent,_=!1,k=!1,a.prev=44,x=Cn(g);case 46:return a.next=48,xn(x.next());case 48:if(!(_=!(E=a.sent).done)){a.next=74;break}if(A=E.value,P=null===A||void 0===A||null===(C=A.choices)||void 0===C?void 0:C[0],A.usage&&(b=A.usage),P){a.next=54;break}return a.abrupt("continue",71);case 54:if(T=P.delta){a.next=57;break}return a.abrupt("continue",71);case 57:if(j=r._convertOpenAIDeltaToBaseMessageChunk(T,A,y),y=null!==(D=T.role)&&void 0!==D?D:y,I={prompt:null!==(S=t.promptIndex)&&void 0!==S?S:0,completion:null!==(O=P.index)&&void 0!==O?O:0},"string"===typeof j.content){a.next=63;break}return console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported."),a.abrupt("continue",71);case 63:return N=q({},I),null!=P.finish_reason&&(N.finish_reason=P.finish_reason,N.system_fingerprint=A.system_fingerprint,N.model_name=A.model),r.logprobs&&(N.logprobs=P.logprobs),R=new zd({message:j,text:j.content,generationInfo:N}),a.next=69,R;case 69:return a.next=71,xn(null===n||void 0===n?void 0:n.handleLLMNewToken(null!==(F=R.text)&&void 0!==F?F:"",I,void 0,void 0,void 0,{chunk:R}));case 71:_=!1,a.next=46;break;case 74:a.next=80;break;case 76:a.prev=76,a.t1=a.catch(44),k=!0,w=a.t1;case 80:if(a.prev=80,a.prev=81,!_||null==x.return){a.next=85;break}return a.next=85,xn(x.return());case 85:if(a.prev=85,!k){a.next=88;break}throw w;case 88:return a.finish(85);case 89:return a.finish(80);case 90:if(!b){a.next=96;break}return G=q(q({},null!==(null===(B=b.prompt_tokens_details)||void 0===B?void 0:B.audio_tokens)&&{audio:null===(L=b.prompt_tokens_details)||void 0===L?void 0:L.audio_tokens}),null!==(null===(M=b.prompt_tokens_details)||void 0===M?void 0:M.cached_tokens)&&{cache_read:null===(U=b.prompt_tokens_details)||void 0===U?void 0:U.cached_tokens}),V=q(q({},null!==(null===(z=b.completion_tokens_details)||void 0===z?void 0:z.audio_tokens)&&{audio:null===(H=b.completion_tokens_details)||void 0===H?void 0:H.audio_tokens}),null!==(null===(Z=b.completion_tokens_details)||void 0===Z?void 0:Z.reasoning_tokens)&&{reasoning:null===(W=b.completion_tokens_details)||void 0===W?void 0:W.reasoning_tokens}),$=new zd({message:new ls({content:"",response_metadata:{usage:q({},b)},usage_metadata:q(q({input_tokens:b.prompt_tokens,output_tokens:b.completion_tokens,total_tokens:b.total_tokens},Object.keys(G).length>0&&{input_token_details:G}),Object.keys(V).length>0&&{output_token_details:V})}),text:""}),a.next=96,$;case 96:if(null===(i=t.signal)||void 0===i||!i.aborted){a.next=98;break}throw new Error("AbortError");case 98:case"end":return a.stop()}}),a,null,[[6,22,26,36],[27,,31,35],[44,76,80,90],[81,,85,89]])})))()}},{key:"identifyingParams",value:function(){return this._identifyingParams()}},{key:"_responseApiGenerate",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c,l,d,f,h,v,m,y,g,b;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=this.invocationParams(n)).stream){e.next=33;break}o=this._streamResponseChunks(t,n,r),c=!1,l=!1,e.prev=5,f=Cn(o);case 7:return e.next=9,f.next();case 9:if(!(c=!(h=e.sent).done)){e.next=16;break}(v=h.value).message.response_metadata=q(q({},v.generationInfo),v.message.response_metadata),s=null!==(m=null===(y=s)||void 0===y?void 0:y.concat(v))&&void 0!==m?m:v;case 13:c=!1,e.next=7;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(5),l=!0,d=e.t0;case 22:if(e.prev=22,e.prev=23,!c||null==f.return){e.next=27;break}return e.next=27,f.return();case 27:if(e.prev=27,!l){e.next=30;break}throw d;case 30:return e.finish(27);case 31:return e.finish(22);case 32:return e.abrupt("return",{generations:s?[s]:[],llmOutput:{estimatedTokenUsage:null===(i=s)||void 0===i||null===(u=i.message)||void 0===u?void 0:u.usage_metadata}});case 33:return g=Jh(t,this.model),e.next=36,this.responseApiWithRetry(q({input:g},a),q({signal:null===n||void 0===n?void 0:n.signal},null===n||void 0===n?void 0:n.options));case 36:return b=e.sent,e.abrupt("return",{generations:[{text:b.output_text,message:Kh(b)}],llmOutput:{id:b.id,estimatedTokenUsage:b.usage?{promptTokens:b.usage.input_tokens,completionTokens:b.usage.output_tokens,totalTokens:b.usage.total_tokens}:void 0}});case 38:case"end":return e.stop()}}),e,this,[[5,18,22,32],[23,,27,31]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_useResponseApi",value:function(e){var t,n=null===e||void 0===e||null===(t=e.tools)||void 0===t?void 0:t.some(Xh),r=null!=(null===e||void 0===e?void 0:e.previous_response_id)||null!=(null===e||void 0===e?void 0:e.text)||null!=(null===e||void 0===e?void 0:e.truncation)||null!=(null===e||void 0===e?void 0:e.include);return this.useResponsesApi||n||r}},{key:"_generate",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c,l,d,f,h,v,m,y,g,b,_,k,x,E,A,C,D,S,O,F,P,T,j,I,N,R,B,L,M,U,z,H,Z,W,V,$,J,K;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._useResponseApi(n)){e.next=2;break}return e.abrupt("return",this._responseApiGenerate(t,n,r));case 2:if(a={},i=this.invocationParams(n),u=Vh(t,this.model),!i.stream){e.next=52;break}o=this._streamResponseChunks(t,n,r),s={},c=!1,l=!1,e.prev=10,f=Cn(o);case 12:return e.next=14,f.next();case 14:if(!(c=!(h=e.sent).done)){e.next=22;break}(v=h.value).message.response_metadata=q(q({},v.generationInfo),v.message.response_metadata),g=null!==(m=null===(y=v.generationInfo)||void 0===y?void 0:y.completion)&&void 0!==m?m:0,void 0===s[g]?s[g]=v:s[g]=s[g].concat(v);case 19:c=!1,e.next=12;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(10),l=!0,d=e.t0;case 28:if(e.prev=28,e.prev=29,!c||null==f.return){e.next=33;break}return e.next=33,f.return();case 33:if(e.prev=33,!l){e.next=36;break}throw d;case 36:return e.finish(33);case 37:return e.finish(28);case 38:return b=Object.entries(s).sort((function(e,t){var n=w(e,1)[0],r=w(t,1)[0];return parseInt(n,10)-parseInt(r,10)})).map((function(e){var t=w(e,2);t[0];return t[1]})),_=this.invocationParams(n),k=_.functions,x=_.function_call,e.next=42,this.getEstimatedTokenCountFromPrompt(t,k,x);case 42:return E=e.sent,e.next=45,this.getNumTokensFromGenerations(b);case 45:return A=e.sent,a.input_tokens=E,a.output_tokens=A,a.total_tokens=E+A,e.abrupt("return",{generations:b,llmOutput:{estimatedTokenUsage:{promptTokens:a.input_tokens,completionTokens:a.output_tokens,totalTokens:a.total_tokens}}});case 52:if(!n.response_format||"json_schema"!==n.response_format.type){e.next=58;break}return e.next=55,this.betaParsedCompletionWithRetry(q(q({},i),{},{stream:!1,messages:u}),q({signal:null===n||void 0===n?void 0:n.signal},null===n||void 0===n?void 0:n.options));case 55:F=e.sent,e.next=61;break;case 58:return e.next=60,this.completionWithRetry(q(q({},i),{},{stream:!1,messages:u}),q({signal:null===n||void 0===n?void 0:n.signal},null===n||void 0===n?void 0:n.options));case 60:F=e.sent;case 61:P=null!==(C=null===(D=F)||void 0===D?void 0:D.usage)&&void 0!==C?C:{},T=P.completion_tokens,j=P.prompt_tokens,I=P.total_tokens,N=P.prompt_tokens_details,R=P.completion_tokens_details,T&&(a.output_tokens=(null!==(B=a.output_tokens)&&void 0!==B?B:0)+T),j&&(a.input_tokens=(null!==(L=a.input_tokens)&&void 0!==L?L:0)+j),I&&(a.total_tokens=(null!==(M=a.total_tokens)&&void 0!==M?M:0)+I),null===(null===N||void 0===N?void 0:N.audio_tokens)&&null===(null===N||void 0===N?void 0:N.cached_tokens)||(a.input_token_details=q(q({},null!==(null===N||void 0===N?void 0:N.audio_tokens)&&{audio:null===N||void 0===N?void 0:N.audio_tokens}),null!==(null===N||void 0===N?void 0:N.cached_tokens)&&{cache_read:null===N||void 0===N?void 0:N.cached_tokens})),null===(null===R||void 0===R?void 0:R.audio_tokens)&&null===(null===R||void 0===R?void 0:R.reasoning_tokens)||(a.output_token_details=q(q({},null!==(null===R||void 0===R?void 0:R.audio_tokens)&&{audio:null===R||void 0===R?void 0:R.audio_tokens}),null!==(null===R||void 0===R?void 0:R.reasoning_tokens)&&{reasoning:null===R||void 0===R?void 0:R.reasoning_tokens})),U=[],z=G(null!==(S=null===(O=F)||void 0===O?void 0:O.choices)&&void 0!==S?S:[]);try{for(z.s();!(H=z.n()).done;)$=H.value,J=null!==(Z=null===(W=$.message)||void 0===W?void 0:W.content)&&void 0!==Z?Z:"",(K={text:J,message:this._convertOpenAIChatCompletionMessageToBaseMessage(null!==(V=$.message)&&void 0!==V?V:{role:"assistant"},F)}).generationInfo=q(q({},$.finish_reason?{finish_reason:$.finish_reason}:{}),$.logprobs?{logprobs:$.logprobs}:{}),ss(K.message)&&(K.message.usage_metadata=a),K.message=new os(Object.fromEntries(Object.entries(K.message).filter((function(e){return!w(e,1)[0].startsWith("lc_")})))),U.push(K)}catch(p){z.e(p)}finally{z.f()}return e.abrupt("return",{generations:U,llmOutput:{tokenUsage:{promptTokens:a.input_tokens,completionTokens:a.output_tokens,totalTokens:a.total_tokens}}});case 71:case"end":return e.stop()}}),e,this,[[10,24,28,38],[29,,33,37]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getEstimatedTokenCountFromPrompt",value:function(){var e=b(p().mark((function e(t,n,r){var a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getNumTokensFromMessages(t);case 2:if(a=e.sent.totalCount,!n||"auto"===r){e.next=10;break}return i=Zh(n),e.t0=a,e.next=8,this.getNumTokens(i);case 8:a=e.t0+=e.sent,a+=9;case 10:if(n&&t.find((function(e){return"system"===e._getType()}))&&(a-=4),"none"!==r){e.next=15;break}a+=1,e.next=21;break;case 15:if("object"!==typeof r){e.next=21;break}return e.t1=a,e.next=19,this.getNumTokens(r.name);case 19:e.t2=e.sent,a=e.t1+=e.t2+4;case 21:return e.abrupt("return",a);case 22:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getNumTokensFromGenerations",value:function(){var e=b(p().mark((function e(t){var n,r=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(function(){var e=b(p().mark((function e(t){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=t.message.additional_kwargs)||void 0===n||!n.function_call){e.next=6;break}return e.next=3,r.getNumTokensFromMessages([t.message]);case 3:return e.abrupt("return",e.sent.countPerMessage[0]);case 6:return e.next=8,r.getNumTokens(t.message.content);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return n=e.sent,e.abrupt("return",n.reduce((function(e,t){return e+t}),0));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getNumTokensFromMessages",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=0,r=0,a=0,"gpt-3.5-turbo-0301"===this.model?(r=4,a=-1):(r=3,a=1),e.next=6,Promise.all(t.map(function(){var e=b(p().mark((function e(t){var i,o,s,c,l,d,f,h,v,m,y;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.getNumTokens(t.content);case 2:return c=e.sent,e.next=5,u.getNumTokens(Gh(t));case 5:if(l=e.sent,void 0===t.name){e.next=14;break}return e.t1=a,e.next=10,u.getNumTokens(t.name);case 10:e.t2=e.sent,e.t0=e.t1+e.t2,e.next=15;break;case 14:e.t0=0;case 15:if(d=e.t0,f=c+r+l+d,"function"===(h=t)._getType()&&(f-=2),null!==(i=h.additional_kwargs)&&void 0!==i&&i.function_call&&(f+=3),null===h||void 0===h||null===(o=h.additional_kwargs.function_call)||void 0===o||!o.name){e.next=25;break}return e.t3=f,e.next=24,u.getNumTokens(null===(v=h.additional_kwargs.function_call)||void 0===v?void 0:v.name);case 24:f=e.t3+=e.sent;case 25:if(null===(s=h.additional_kwargs.function_call)||void 0===s||!s.arguments){e.next=40;break}return e.prev=26,e.t4=f,e.next=30,u.getNumTokens(JSON.stringify(JSON.parse(null===(m=h.additional_kwargs.function_call)||void 0===m?void 0:m.arguments)));case 30:f=e.t4+=e.sent,e.next=40;break;case 33:return e.prev=33,e.t5=e.catch(26),console.error("Error parsing function arguments",e.t5,JSON.stringify(h.additional_kwargs.function_call)),e.t6=f,e.next=39,u.getNumTokens(null===(y=h.additional_kwargs.function_call)||void 0===y?void 0:y.arguments);case 39:f=e.t6+=e.sent;case 40:return n+=f,e.abrupt("return",f);case 42:case"end":return e.stop()}}),e,null,[[26,33]])})));return function(t){return e.apply(this,arguments)}}()));case 6:return i=e.sent,n+=3,e.abrupt("return",{totalCount:n,countPerMessage:i});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"completionWithRetry",value:function(){var e=b(p().mark((function e(t,n){var r,a=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._getClientOptions(n),e.abrupt("return",this.caller.call(b(p().mark((function e(){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.client.chat.completions.create(t,r);case 3:return n=e.sent,e.abrupt("return",n);case 7:throw e.prev=7,e.t0=e.catch(0),zh(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"responseApiWithRetry",value:function(){var e=b(p().mark((function e(t,n){var r=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.caller.call(b(p().mark((function e(){var a,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r._getClientOptions(n),e.prev=1,"json_schema"!==(null===(i=t.text)||void 0===i||null===(u=i.format)||void 0===u?void 0:u.type)||t.stream){e.next=6;break}return e.next=5,r.client.responses.parse(t,a);case 5:case 8:return e.abrupt("return",e.sent);case 6:return e.next=8,r.client.responses.create(t,a);case 11:throw e.prev=11,e.t0=e.catch(1),zh(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"betaParsedCompletionWithRetry",value:function(){var e=b(p().mark((function e(t,n){var r,a=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._getClientOptions(n),e.abrupt("return",this.caller.call(b(p().mark((function e(){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.client.beta.chat.completions.parse(t,r);case 3:return n=e.sent,e.abrupt("return",n);case 7:throw e.prev=7,e.t0=e.catch(0),zh(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getClientOptions",value:function(e){if(!this.client){var t=function(e){var t=e.azureOpenAIApiDeploymentName,n=e.azureOpenAIApiInstanceName,r=e.azureOpenAIApiKey,a=e.azureOpenAIBasePath,i=e.baseURL,u=e.azureADTokenProvider,o=e.azureOpenAIEndpoint;if((r||u)&&a&&t)return"".concat(a,"/").concat(t);if((r||u)&&o&&t)return"".concat(o,"/openai/deployments/").concat(t);if(r||u){if(!n)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!t)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return"https://".concat(n,".openai.azure.com/openai/deployments/").concat(t)}return i}({baseURL:this.clientConfig.baseURL}),n=q(q({},this.clientConfig),{},{baseURL:t,timeout:this.timeout,maxRetries:0});n.baseURL||delete n.baseURL,this.client=new zo(n)}return q(q({},this.clientConfig),e)}},{key:"_llmType",value:function(){return"openai"}},{key:"_combineLLMOutput",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){var n,r,a;t&&t.tokenUsage&&(e.tokenUsage.completionTokens+=null!==(n=t.tokenUsage.completionTokens)&&void 0!==n?n:0,e.tokenUsage.promptTokens+=null!==(r=t.tokenUsage.promptTokens)&&void 0!==r?r:0,e.tokenUsage.totalTokens+=null!==(a=t.tokenUsage.totalTokens)&&void 0!==a?a:0);return e}),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}},{key:"withStructuredOutput",value:function(e,t){var n,r,a,i,u,o,s;if(void 0!==(u=e)&&"object"===typeof u.schema?(n=e.schema,r=e.name,a=e.method,i=e.includeRaw):(n=e,r=null===t||void 0===t?void 0:t.name,a=null===t||void 0===t?void 0:t.method,i=null===t||void 0===t?void 0:t.includeRaw),void 0!==(null===t||void 0===t?void 0:t.strict)&&"jsonMode"===a)throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if(this.model.startsWith("gpt-3")||this.model.startsWith("gpt-4-")||"gpt-4"===this.model?"jsonSchema"===a&&console.warn('[WARNING]: JSON Schema is not supported for model "'.concat(this.model,'". Falling back to tool calling.')):void 0===a&&(a="jsonSchema"),"jsonMode"===a)o=this.bind({response_format:{type:"json_object"}}),s=nv(n)?th.fromZodSchema(n):new nh;else if("jsonSchema"===a){var c;if(o=this.bind({response_format:{type:"json_schema",json_schema:{name:null!==(c=r)&&void 0!==c?c:"extract",description:n.description,schema:n,strict:null===t||void 0===t?void 0:t.strict}}}),nv(n)){var l=th.fromZodSchema(n);s=np.from((function(e){return"parsed"in e.additional_kwargs?e.additional_kwargs.parsed:l}))}else s=new nh}else{var d,f=null!==(d=r)&&void 0!==d?d:"extract";if(nv(n)){var p=Df(n);o=this.bind(q({tools:[{type:"function",function:{name:f,description:p.description,parameters:p}}],tool_choice:{type:"function",function:{name:f}}},void 0!==(null===t||void 0===t?void 0:t.strict)?{strict:t.strict}:{})),s=new sh({returnSingle:!0,keyName:f,zodSchema:n})}else{var h,v,m;if("string"===typeof n.name&&"object"===typeof n.parameters&&null!=n.parameters)h=n,f=n.name;else h={name:f=null!==(v=n.title)&&void 0!==v?v:f,description:null!==(m=n.description)&&void 0!==m?m:"",parameters:n};o=this.bind(q({tools:[{type:"function",function:h}],tool_choice:{type:"function",function:{name:f}}},void 0!==(null===t||void 0===t?void 0:t.strict)?{strict:t.strict}:{})),s=new sh({returnSingle:!0,keyName:f})}}if(!i)return o.pipe(s);var y=Hp.assign({parsed:function(e,t){return s.invoke(e.raw,t)}}),g=Hp.assign({parsed:function(){return null}}),b=y.withFallbacks({fallbacks:[g]});return Yf.from([{raw:o},b])}}],[{key:"lc_name",value:function(){return"ChatOpenAI"}}]),n}(Wp);function nv(e){return"function"===typeof(null===e||void 0===e?void 0:e.parse)}var rv=function(e){B(n,e);var t=z(n);function n(e){var r,a,i;return T(this,n),i=t.call(this,null!==e&&void 0!==e?e:{}),Object.defineProperty(N(i),"returnDirect",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(N(i),"verboseParsingErrors",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(N(i),"responseFormat",{enumerable:!0,configurable:!0,writable:!0,value:"content"}),i.verboseParsingErrors=null!==(r=null===e||void 0===e?void 0:e.verboseParsingErrors)&&void 0!==r?r:i.verboseParsingErrors,i.responseFormat=null!==(a=null===e||void 0===e?void 0:e.responseFormat)&&void 0!==a?a:i.responseFormat,i}return I(n,[{key:"lc_namespace",get:function(){return["langchain","tools"]}},{key:"invoke",value:function(){var e=b(p().mark((function e(t,n){var r,a,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=_d(n),bs(t)?(r=t.id,a=t.args,i=q(q({},i),{},{toolCall:t,configurable:q(q({},i.configurable),{},{tool_call_id:r})})):a=t,e.abrupt("return",this.call(a,i));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"call",value:function(){var e=b(p().mark((function e(t,n,r){var a,i,u,o,s,c,l,d,f,h,v;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.schema.parseAsync(t);case 3:a=e.sent,e.next=11;break;case 6:throw e.prev=6,e.t0=e.catch(0),i="Received tool input did not match expected schema",this.verboseParsingErrors&&(i="".concat(i,"\nDetails: ").concat(e.t0.message)),new _s(i,JSON.stringify(t));case 11:return u=td(n),o=sd.configure(u.callbacks,this.callbacks,u.tags||r,this.tags,u.metadata,this.metadata,{verbose:this.verbose}),e.next=15,null===o||void 0===o?void 0:o.handleToolStart(this.toJSON(),"string"===typeof a?a:JSON.stringify(a),u.runId,void 0,void 0,void 0,u.runName);case 15:return s=e.sent,delete u.runId,e.prev=17,e.next=20,this._call(a,s,u);case 20:c=e.sent,e.next=28;break;case 23:return e.prev=23,e.t1=e.catch(17),e.next=27,null===s||void 0===s?void 0:s.handleToolError(e.t1);case 27:throw e.t1;case 28:if("content_and_artifact"!==this.responseFormat){e.next=39;break}if(!Array.isArray(c)||2!==c.length){e.next=36;break}f=w(c,2),l=f[0],d=f[1],e.next=37;break;case 36:throw new Error('Tool response format is "content_and_artifact" but the output was not a two-tuple.\nResult: '.concat(JSON.stringify(c)));case 37:e.next=40;break;case 39:l=c;case 40:return u&&"configurable"in u&&(h=u.configurable.tool_call_id),v=iv({content:l,artifact:d,toolCallId:h,name:this.name}),e.next=44,null===s||void 0===s?void 0:s.handleToolEnd(v);case 44:return e.abrupt("return",v);case 45:case"end":return e.stop()}}),e,this,[[0,6],[17,23]])})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(Up),av=function(e){B(n,e);var t=z(n);function n(e){var r;return T(this,n),r=t.call(this,e),Object.defineProperty(N(r),"schema",{enumerable:!0,configurable:!0,writable:!0,value:vn.object({input:vn.string().optional()}).transform((function(e){return e.input}))}),r}return I(n,[{key:"call",value:function(e,t){return kn(L(n.prototype),"call",this).call(this,"string"!==typeof e&&e?e:{input:e},t)}}]),n}(rv);function iv(e){var t,n=e.content,r=e.artifact,a=e.toolCallId;return a&&(null==(t=n)||"object"!==typeof t||!("lc_direct_tool_output"in t)||!0!==t.lc_direct_tool_output)?"string"===typeof n||Array.isArray(n)&&n.every((function(e){return"object"===typeof e}))?new is({content:n,artifact:r,tool_call_id:a,name:e.name}):new is({content:uv(n),artifact:r,tool_call_id:a,name:e.name}):n}function uv(e){try{return JSON.stringify(e,null,2)}catch(t){return"".concat(e)}}var ov=function(e){B(n,e);var t=z(n);function n(e){var r,a,i,u,o,s,c,l,d,f,p;T(this,n),void 0!==(null===e||void 0===e?void 0:e.responseFormat)&&["url","b64_json"].includes(e.responseFormat)&&(e.dallEResponseFormat=e.responseFormat,e.responseFormat="content"),p=t.call(this,e),Object.defineProperty(N(p),"name",{enumerable:!0,configurable:!0,writable:!0,value:"dalle_api_wrapper"}),Object.defineProperty(N(p),"description",{enumerable:!0,configurable:!0,writable:!0,value:"A wrapper around OpenAI DALL-E API. Useful for when you need to generate images from a text description. Input should be an image description."}),Object.defineProperty(N(p),"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(N(p),"model",{enumerable:!0,configurable:!0,writable:!0,value:"dall-e-3"}),Object.defineProperty(N(p),"style",{enumerable:!0,configurable:!0,writable:!0,value:"vivid"}),Object.defineProperty(N(p),"quality",{enumerable:!0,configurable:!0,writable:!0,value:"standard"}),Object.defineProperty(N(p),"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(N(p),"size",{enumerable:!0,configurable:!0,writable:!0,value:"1024x1024"}),Object.defineProperty(N(p),"dallEResponseFormat",{enumerable:!0,configurable:!0,writable:!0,value:"url"}),Object.defineProperty(N(p),"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0});var h={apiKey:null!==(r=null!==(a=null===e||void 0===e?void 0:e.apiKey)&&void 0!==a?a:null===e||void 0===e?void 0:e.openAIApiKey)&&void 0!==r?r:Fl("OPENAI_API_KEY"),organization:null!==(i=null===e||void 0===e?void 0:e.organization)&&void 0!==i?i:Fl("OPENAI_ORGANIZATION"),dangerouslyAllowBrowser:!0,baseURL:null===e||void 0===e?void 0:e.baseUrl};return p.client=new zo(h),p.model=null!==(u=null!==(o=null===e||void 0===e?void 0:e.model)&&void 0!==o?o:null===e||void 0===e?void 0:e.modelName)&&void 0!==u?u:p.model,p.style=null!==(s=null===e||void 0===e?void 0:e.style)&&void 0!==s?s:p.style,p.quality=null!==(c=null===e||void 0===e?void 0:e.quality)&&void 0!==c?c:p.quality,p.n=null!==(l=null===e||void 0===e?void 0:e.n)&&void 0!==l?l:p.n,p.size=null!==(d=null===e||void 0===e?void 0:e.size)&&void 0!==d?d:p.size,p.dallEResponseFormat=null!==(f=null===e||void 0===e?void 0:e.dallEResponseFormat)&&void 0!==f?f:p.dallEResponseFormat,p.user=null===e||void 0===e?void 0:e.user,p}return I(n,[{key:"processMultipleGeneratedUrls",value:function(e){return"url"===this.dallEResponseFormat?e.flatMap((function(e){return e.data.flatMap((function(e){return e.url?{type:"image_url",image_url:e.url}:[]})).filter((function(e){return void 0!==e&&"image_url"===e.type&&"string"===typeof e.image_url&&void 0!==e.image_url}))})):e.flatMap((function(e){return e.data.flatMap((function(e){return e.b64_json?{type:"image_url",image_url:{url:e.b64_json}}:[]})).filter((function(e){return void 0!==e&&"image_url"===e.type&&"object"===typeof e.image_url&&"url"in e.image_url&&"string"===typeof e.image_url.url&&void 0!==e.image_url.url}))}))}},{key:"_call",value:function(){var e=b(p().mark((function e(t){var n,r,a,i,u,o,s,c,l=this;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={model:this.model,prompt:t,n:1,size:this.size,response_format:this.dallEResponseFormat,style:this.style,quality:this.quality,user:this.user},!(this.n>1)){e.next=6;break}return e.next=4,Promise.all(Array.from({length:this.n}).map((function(){return l.client.images.generate(n)})));case 4:return r=e.sent,e.abrupt("return",this.processMultipleGeneratedUrls(r));case 6:return e.next=8,this.client.images.generate(n);case 8:return a=e.sent,i="","url"===this.dallEResponseFormat?(u=a.data.map((function(e){return e.url})).filter((function(e){return"undefined"!==e})),o=w(u,1),i=o[0]):(s=a.data.map((function(e){return e.b64_json})).filter((function(e){return"undefined"!==e})),c=w(s,1),i=c[0]),e.abrupt("return",i);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"lc_name",value:function(){return"DallEAPIWrapper"}}]),n}(av);Object.defineProperty(ov,"toolName",{enumerable:!0,configurable:!0,writable:!0,value:"dalle_api_wrapper"});var sv=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8,a=(0,t.useRef)(null);(0,t.useEffect)((function(){""!==e&&(a.current=new tv({temperature:r,openAIApiKey:e,model:"gpt-4o-mini-2024-07-18"}))}),[e,r]);var i=function(){var e=b(p().mark((function e(t){var r,i,u,o,s,c=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.length>1&&void 0!==c[1]?c[1]:[],i=c.length>2&&void 0!==c[2]?c[2]:null,e.prev=2,u=[new ms(n)].concat(y(r.map((function(e){return"user"===e.type?new hs(e.message):new os(e.message)}))),[new hs(t)]),console.log("chat start"),console.log(u),a.current){e.next=8;break}throw new Error("Chat model not initialized");case 8:return o=null!==i?a.current.withStructuredOutput(i):a.current,e.next=11,o.invoke(u);case 11:return s=e.sent,console.log("chat ok"),console.log(s),e.abrupt("return",null!==i?s:s.content);case 17:return e.prev=17,e.t0=e.catch(2),console.error(e.t0),e.abrupt("return",null);case 21:return e.prev=21,u&&a.current&&(a.current.getNumTokensFromMessages(u).then((function(e){console.log(e.totalCount)})),console.log("log size: ".concat(u.length))),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[2,17,21,24]])})));return function(t){return e.apply(this,arguments)}}();return{chat:i}},cv=S((function(e){return{gameStatus:a,progress:0,apiKey:"",suspectChatHistory:{},watsonChatHistory:[],guessingHistory:[],chatCounts:{watson:0,suspects:{},guessing:0},setGameStatus:function(t){return e({gameStatus:t})},setProgress:function(t){return e({progress:t})},finishGame:function(){return e({gameStatus:o})},updateApiKey:function(t){return e({apiKey:t})},resetGameState:function(){return e({suspectChatHistory:{},watsonChatHistory:[],guessingHistory:[],chatCounts:{watson:0,suspects:{},guessing:0}})},updateSuspectChatHistory:function(t,n){return e((function(e){return{suspectChatHistory:q(q({},e.suspectChatHistory),{},P({},t,n))}}))},updateWatsonChatHistory:function(t){return e({watsonChatHistory:t})},updateGuessingHistory:function(t){return e({guessingHistory:t})},incrementChatCount:function(t,n){return e((function(e){return t===c?{chatCounts:q(q({},e.chatCounts),{},{watson:e.chatCounts.watson+1})}:t===l&&n?{chatCounts:q(q({},e.chatCounts),{},{suspects:q(q({},e.chatCounts.suspects),{},P({},n,(e.chatCounts.suspects[n]||0)+1))})}:t===d?{chatCounts:q(q({},e.chatCounts),{},{guessing:e.chatCounts.guessing+1})}:e}))},resetChatCounts:function(){return e({chatCounts:{watson:0,suspects:{},guessing:0}})}}})),lv="Main_mainContainer__nEEux",dv="Main_titleImage__TllMe",fv="Main_inputContainer__Ilr-W",pv="Main_titleBar__j4Anp",hv="Main_title__bwARM",vv="Main_separator__KsZz6",mv="Main_startBtn__6iGVH",yv=n(184),gv=function(){var e=cv(),n=e.apiKey,r=e.updateApiKey,o=O((function(e){return e.updateScenario})),s=w((0,t.useState)(""),2),c=s[0],l=s[1],d=w((0,t.useState)("English"),2),f=d[0],h=d[1],v=sv(n,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"English";return"You are a game screenwriter. You must write all content in ".concat(e,'.\n\nThe scenario you are going to produce has the form \'Closed Circle of Suspects\'. "Closed circle of suspects" refers to "a set number of suspects have a set motive and opportunity," in other words, when the murderer is close to the scene and is not a crime by an outsider. Usually, this format is carried out by introducing many suspects in the beginning, putting most of them in a situation where they can be identified as the murderer, and then the player guesses who the murderer is.\n\nIn particular, a good scenario has the following characteristics and you should keep these characteristics.\n1. The criminal must be able to judge through logical reasoning. There must be a way to logically solve the case, that is, a path to understand the overall situation of the case by interpreting various contexts. If the case is solved only by hiding one so-called "decisive evidence" in several clues and finding the evidence, it is not a good mystery game.\n2. There may be an aid or accomplice, but there must be a clear one real murderer.\n3. Every action must have a reason. Nothing happens "just" and no clue is found "just". There\'s no strange behavior that the character in the story "just" does.\n4. You shouldn\'t create problems that can be interpreted in any way, but you should prove that you can definitely reach a single real criminal through the clues and information given to the player.\n5. Each suspects has his or her own story, but the stories must come together to create a story.\n6. Every suspects must have motive and opportunity to murder.\n7. You don\'t have to be obsessed with the reality of the story, but the murder method and trick should be realistic.\n\nRemember to write all content in ').concat(e,", including names, locations, and any cultural references that should be appropriate for that language and culture.\n")}(f)),m=v.chat,g=sv(n,"You are OutputParser.",0).chat,_=cv(),k=_.setGameStatus,x=_.setProgress,E=_.resetGameState,A=function(){var e=b(p().mark((function e(){var t,r,s,l,d,h;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==n){e.next=3;break}return window.alert("enter api key"),e.abrupt("return");case 3:if(k(i),E(),"skip generate"!==c){e.next=9;break}return o(_n),k(u),e.abrupt("return");case 9:return e.prev=9,console.log("start generate"),t=[],e.next=14,m("From now on, let's make a story in order according to my request step by step considering the following keywords.\n        keywords : ".concat(c,"\n        First, Define the victim. The victim's name, age, personality, occupation, appearance etc"),t);case 14:if(null!==(r=e.sent)){e.next=17;break}throw new Error("Failed to generate victim information");case 17:return t=[].concat(y(t),[{type:"user",message:"From now on, let's make a story in order according to my request step by step considering the following keywords.\n        keywords : ".concat(c,"\n        First, Define the victim. The victim's name, age, personality, occupation, appearance etc")},{type:"assistant",message:r}]),x(20),e.next=21,m("Define the suspect. There are a total of four suspects. Name, personality, age, occupation, appearance etc. of the suspect. Every suspect must have an motive for murder the victim.",t);case 21:if(null!==(s=e.sent)){e.next=24;break}throw new Error("Failed to generate suspects information");case 24:return t=[].concat(y(t),[{type:"user",message:"Define the suspect. There are a total of four suspects. Name, personality, age, occupation, appearance etc. of the suspect. Every suspect must have an motive for murder the victim."},{type:"assistant",message:s}]),x(35),e.next=28,m("Define one killer who actually committed a murder among the suspects defined above. Describe the method of murder, the trick to escape the suspect, and the loophole in the trick. The loophole in deception should not be due to evidence such as cctv, dna, but rather the logical error of the alibi claimed by the killer or traces left at the crime scene.",t);case 28:if(null!==(l=e.sent)){e.next=31;break}throw new Error("Failed to generate murderer information");case 31:return t=[].concat(y(t),[{type:"user",message:"Define one killer who actually committed a murder among the suspects defined above. Describe the method of murder, the trick to escape the suspect, and the loophole in the trick. The loophole in deception should not be due to evidence such as cctv, dna, but rather the logical error of the alibi claimed by the killer or traces left at the crime scene."},{type:"assistant",message:l}]),x(50),e.next=35,m("Describe the story, alibi, of the other three suspects, excluding the murderer, among the four suspects defined above. The suspects had a chance to commit the crime and a motive for the murder, but they did not actually kill.",t);case 35:if(null!==(d=e.sent)){e.next=38;break}throw new Error("Failed to generate suspects' stories");case 38:return t=[].concat(y(t),[{type:"user",message:"Describe the story, alibi, of the other three suspects, excluding the murderer, among the four suspects defined above. The suspects had a chance to commit the crime and a motive for the murder, but they did not actually kill."},{type:"assistant",message:d}]),x(75),e.next=42,g("\n                Based on the following story elements, generate a structured scenario in ".concat(f,":\n                \n                Victim: ").concat(r,"\n                ----\n                Suspects: ").concat(s,"\n                ----\n                Murderer: ").concat(l,"\n                ----\n                Suspects' Stories: ").concat(d,"\n            "),[],bn);case 42:h=e.sent,x(100),o(h),k(u),e.next=54;break;case 48:e.prev=48,e.t0=e.catch(9),console.error(e.t0),window.alert("game boot failed. please retry."),k(a),x(0);case 54:case"end":return e.stop()}}),e,null,[[9,48]])})));return function(){return e.apply(this,arguments)}}();return(0,yv.jsxs)("div",{className:lv,children:[(0,yv.jsx)("img",{className:dv,src:"".concat("/detective-infinity","/assets/detective-infinity-title-black.png"),alt:"Detective Infinity"}),(0,yv.jsx)("h2",{children:"Unleash your inner Sherlock Holmes in an Al-powered mystery adventure!"}),(0,yv.jsx)("p",{children:"You become a detective and investigate a murder case."}),(0,yv.jsx)("p",{children:"Nobody knows the truth of the case. Every time you face a new incident that no one has ever seen."}),(0,yv.jsxs)("div",{className:fv,children:[(0,yv.jsx)("div",{className:pv,children:(0,yv.jsx)("h1",{className:hv,children:"API KEY"})}),(0,yv.jsx)("div",{className:vv}),(0,yv.jsxs)("p",{children:["You need OpenAi API Key. You can create API Key ",(0,yv.jsx)("a",{href:"https://platform.openai.com/account/api-keys",children:"HERE"})]}),(0,yv.jsx)("input",{type:"text",placeholder:"sk-xxxx..",value:n,onChange:function(e){return r(e.target.value)}})]}),(0,yv.jsxs)("div",{className:fv,children:[(0,yv.jsx)("div",{className:pv,children:(0,yv.jsx)("h1",{className:hv,children:"CUSTOM SCENE ( optional )"})}),(0,yv.jsx)("div",{className:vv}),(0,yv.jsx)("p",{children:"You can set the background for the case you're investigating if you want"}),(0,yv.jsx)("input",{type:"text",placeholder:"ex> school, office, airplane, chosun dynasty..?",value:c,onChange:function(e){return l(e.target.value)}})]}),(0,yv.jsxs)("div",{className:fv,children:[(0,yv.jsx)("div",{className:pv,children:(0,yv.jsx)("h1",{className:hv,children:"LANGUAGE ( optional )"})}),(0,yv.jsx)("div",{className:vv}),(0,yv.jsx)("p",{children:"Select the language for the game (e.g., English, Korean, Japanese)"}),(0,yv.jsx)("input",{type:"text",placeholder:"ex> English, Korean, Japanese",value:f,onChange:function(e){return h(e.target.value)}})]}),(0,yv.jsx)("button",{className:mv,type:"button",onClick:A,children:"START"})]})},bv="Loading_window__j-6IL",_v="Loading_titleBar__rw+C4",kv="Loading_title__PaTPZ",wv="Loading_separator__sgCK2",xv="Loading_windowPane__UBKvM",Ev="Loading_watsonImage__CIpb5",Av="Loading_progressContainer__cJQis",Cv="Loading_progressBar__gTt4y",Dv="Loading_progressText__XSiFA",Sv=function(){var e=w((0,t.useState)("Please wait.."),2),n=e[0],r=e[1],a=cv().progress,i=["Deciphering clues...","Sleuthing mysteries...","Setting up the crime scene...","Gathering suspects...","Polishing magnifying glass...","Sharpening detective instincts...","Brewing coffee for late-night investigations...","Prepping noir atmosphere...","Calibrating plot twists...","Ready your deductions...","Bribing informants...","Shuffling case files..."];return(0,t.useEffect)((function(){var e=setInterval((function(){r(function(){var e=Math.floor(Math.random()*i.length);return i[e]}())}),3e3);return function(){return clearInterval(e)}}),[]),(0,yv.jsxs)("div",{className:bv,children:[(0,yv.jsx)("div",{className:_v,children:(0,yv.jsx)("h1",{className:kv,children:"Loading"})}),(0,yv.jsx)("div",{className:wv}),(0,yv.jsxs)("div",{className:xv,children:[(0,yv.jsx)("img",{src:"".concat("/detective-infinity","/assets/detective-infinity-watson.png"),alt:"Watson",className:Ev}),(0,yv.jsx)("h3",{children:n}),(0,yv.jsxs)("div",{className:Av,children:[(0,yv.jsx)("div",{className:Cv,style:{width:"".concat(a,"%")}}),(0,yv.jsxs)("span",{className:Dv,children:[a,"%"]})]})]})]})},Ov="WatsonSurvey_form__n6rA4",Fv="WatsonSurvey_input__xIg+q",Pv="WatsonSurvey_chatContainer__vzn2U",Tv="WatsonSurvey_chatHeader__0+L8+",jv="WatsonSurvey_chatMessages__fz9s7",Iv="WatsonSurvey_chatMessage__Sw1dn",Nv="WatsonSurvey_messageType__QifMi",Rv="WatsonSurvey_messageTypeUser__VMbmi",Bv="WatsonSurvey_messageTypeWatson__7Fon4",Lv="WatsonSurvey_messageContent__sHqjo",Mv="WatsonSurvey_fieldRow__J66Ol",Uv="WatsonSurvey_button__BDCpL",zv="WatsonSurvey_questionCount__c2h6k",Hv=function(e){var n=e.messages,r=e.setMessages,a=e.chat,i=w((0,t.useState)(""),2),u=i[0],o=i[1],s=w((0,t.useState)(!1),2),l=s[0],d=s[1],f=(0,t.useRef)(null),h=cv(),v=h.chatCounts,m=h.incrementChatCount;(0,t.useEffect)((function(){var e;null===(e=f.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})}),[n]);var y=function(){var e=b(p().mark((function e(t){var i,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==u){e.next=3;break}return e.abrupt("return");case 3:return i=n.concat({type:"user",message:u}),r(i),d(!0),e.next=8,a(u,i);case 8:null==(s=e.sent)?r(i.concat({type:"error",message:"AI Error"})):(r(i.concat({type:"watson",message:s})),m(c)),d(!1),o("");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,yv.jsxs)("div",{className:Pv,children:[(0,yv.jsx)("div",{className:Tv,children:(0,yv.jsx)("h3",{children:"Watson Survey"})}),(0,yv.jsxs)("div",{className:jv,children:[n.map((function(e,t){return(0,yv.jsxs)("div",{className:Iv,children:[(0,yv.jsx)("strong",{className:"".concat(Nv," ").concat("user"===e.type?Rv:Bv),children:e.type}),(0,yv.jsx)("span",{className:Lv,children:e.message})]},t)})),(0,yv.jsx)("div",{ref:f})]}),(0,yv.jsx)("form",{className:Ov,onSubmit:y,children:(0,yv.jsxs)("div",{className:Mv,children:[(0,yv.jsx)("input",{className:Fv,value:u,onChange:function(e){return o(e.target.value)},placeholder:(v.watson||0)>=20?"No more questions":"Type a question for Watson",disabled:l}),(0,yv.jsx)("button",{className:Uv,type:"submit",disabled:l||(v.watson||0)>=20,children:"Send"})]})}),(0,yv.jsx)("div",{className:Mv,children:(0,yv.jsxs)("span",{className:zv,children:["Questions: ",v.watson||0,"/20"]})})]})},Zv="Watson_container__B4lcg",Wv="Watson_watsonInfo__CZStq",qv="Watson_character__nm2Y4",Gv="Watson_title__2GV0H",Vv="Watson_description__Hgl2G",$v="Watson_chatArea__fKAxu",Jv=function(){var e=cv(),t=e.apiKey,n=e.watsonChatHistory,r=e.updateWatsonChatHistory,a=O((function(e){return e.scenario})),i=sv(t,function(e){return e?"You are Watson. Watson is an assistant investigating a case with a detective(==me). Follow my instructions and help with the case investigation(e.g., on-site investigation, surrounding investigation, etc.). Respond 'Unanswered' to questions that are not relevant to the case investigation.\n----\nInformation about the case is provided. The case contains only the core content, so you add and enrich the additional content.\ncase : ".concat(JSON.stringify(e)):""}(a)),u=i.chat,o=n,s=r;return(0,yv.jsxs)("div",{className:Zv,children:[(0,yv.jsxs)("div",{className:Wv,children:[(0,yv.jsx)("img",{src:"".concat("/detective-infinity","/assets/detective-infinity-watson.png"),alt:"watson",className:qv}),(0,yv.jsx)("h3",{className:Gv,children:"What shall we investigate, detective?"}),(0,yv.jsx)("p",{className:Vv,children:"Watson at your service! Just give me a shout if you need a hand solving this mystery!"})]}),(0,yv.jsx)("div",{className:$v,children:(0,yv.jsx)(Hv,{messages:o,setMessages:s,chat:u})})]})},Kv=vn.object({grade:vn.string().describe("grade"),hint:vn.string().describe("hint")}),Qv="Guessing_container__W1TPh",Xv="Guessing_history__EEEmM",Yv="Guessing_historyTitle__9ifAQ",em="Guessing_historyContent__uATJL",tm="Guessing_historyLabel__Xe-23",nm="Guessing_form__nhNtm",rm="Guessing_inputContainer__ZsR4g",am="Guessing_label__sxulQ",im="Guessing_select__U5Qc9",um="Guessing_textarea__lBCpW",om="Guessing_buttonContainer__Uz5jo",sm="Guessing_button__7LX7j",cm="Guessing_instruction__aUnNe",lm="Guessing_tryContainer__Jycy7",dm="Guessing_tryTitle__7q815",fm="Guessing_tryProgress__nKbhs",pm="Guessing_tryCount__rv4mm",hm="Guessing_tryBar__Zk8rp",vm="Guessing_tryBarFill__4pMAV",mm=function(e){var n=e.suspects,r=cv(),a=r.apiKey,i=r.guessingHistory,u=r.updateGuessingHistory,o=r.chatCounts,s=r.incrementChatCount,c=r.finishGame,l=O((function(e){return e.scenario})),f=sv(a,function(e){return e?"You are grader machine. I will provide you with the criminal I think, and the reasoning. You should compare my reasoning with the truth and give a grade on how accurate my reasoning is.\n----\nInformation about the truth is provided.\ntruth : ".concat(JSON.stringify(e.truth)):""}(l),.4),h=f.chat,v=w((0,t.useState)(n[0].name),2),m=v[0],g=v[1],_=w((0,t.useState)(""),2),k=_[0],x=_[1],E=w((0,t.useState)(""),2),A=E[0],C=E[1],D=w((0,t.useState)(""),2),S=D[0],F=D[1],P=w((0,t.useState)(!1),2),T=P[0],j=P[1],I=function(){var e=b(p().mark((function e(t){var r,a,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==m&&""!==k&&""!==A&&""!==S){e.next=3;break}return e.abrupt("return");case 3:return j(!0),r="This is my reasoning.\n        - murderer: ".concat(m,"\n        - method: ").concat(k,"\n        - motive: ").concat(A,"\n        - evidence: ").concat(S,"\n        "),e.next=7,h(r,[],Kv);case 7:if(null!==(a=e.sent)){e.next=12;break}return window.alert("Ai Error. retry."),j(!1),e.abrupt("return");case 12:if(e.prev=12,"S"!==a.grade){e.next=17;break}return window.alert("Congratulation!!"),c(),e.abrupt("return");case 17:o=i.concat({name:m,method:k,motive:A,evidence:S,grade:a.grade,hint:a.hint}),u(o),s(d),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(12),window.alert("Ai Error. retry.");case 25:return e.prev=25,j(!1),g(n[0].name),x(""),C(""),F(""),e.finish(25);case 32:case"end":return e.stop()}}),e,null,[[12,22,25,32]])})));return function(t){return e.apply(this,arguments)}}();return(0,t.useEffect)((function(){(o.guessing||0)>=5&&(window.alert("No more try.."),c())}),[o.guessing,c]),(0,yv.jsxs)("div",{className:Qv,children:[(0,yv.jsxs)("div",{className:lm,children:[(0,yv.jsx)("div",{className:dm,children:"Max Try"}),(0,yv.jsxs)("div",{className:fm,children:[(0,yv.jsxs)("div",{className:pm,children:[o.guessing||0,"/5"]}),(0,yv.jsx)("div",{className:hm,children:(0,yv.jsx)("div",{className:vm,style:{width:"".concat((o.guessing||0)/5*100,"%")}})})]})]}),(0,yv.jsx)("p",{className:cm,children:"So, who's the murderer? Reveal the killer, the method of the crime, their motive\u2014and the evidence to back it all up!"}),(0,yv.jsxs)("form",{className:nm,onSubmit:I,children:[(0,yv.jsxs)("div",{className:rm,children:[(0,yv.jsx)("label",{className:am,children:"murderer"}),(0,yv.jsx)("select",{className:im,value:m,onChange:function(e){return g(e.target.value)},children:n.map((function(e,t){return(0,yv.jsx)("option",{value:e.name,children:e.name},t)}))})]}),(0,yv.jsxs)("div",{className:rm,children:[(0,yv.jsx)("label",{className:am,children:"method"}),(0,yv.jsx)("textarea",{className:um,value:k,onChange:function(e){return x(e.target.value)},placeholder:"How was the crime committed?"})]}),(0,yv.jsxs)("div",{className:rm,children:[(0,yv.jsx)("label",{className:am,children:"motive"}),(0,yv.jsx)("textarea",{className:um,value:A,onChange:function(e){return C(e.target.value)},placeholder:"Why did they commit the crime?"})]}),(0,yv.jsxs)("div",{className:rm,children:[(0,yv.jsx)("label",{className:am,children:"evidence"}),(0,yv.jsx)("textarea",{className:um,value:S,onChange:function(e){return F(e.target.value)},placeholder:"What evidence supports your theory?"})]}),(0,yv.jsxs)("div",{className:om,children:[(0,yv.jsx)("button",{className:sm,type:"button",onClick:c,children:"give up.."}),(0,yv.jsx)("button",{className:sm,type:"submit",disabled:T||(o.guessing||0)>=5,children:"Busted!"})]})]}),y(i).reverse().map((function(e,t){return(0,yv.jsxs)("div",{className:Xv,children:[(0,yv.jsxs)("h3",{className:Yv,children:["# ",i.length-t]}),(0,yv.jsxs)("p",{className:em,children:[(0,yv.jsx)("span",{className:tm,children:"name:"})," ",e.name]}),(0,yv.jsxs)("p",{className:em,children:[(0,yv.jsx)("span",{className:tm,children:"method:"})," ",e.method]}),(0,yv.jsxs)("p",{className:em,children:[(0,yv.jsx)("span",{className:tm,children:"motive:"})," ",e.motive]}),(0,yv.jsxs)("p",{className:em,children:[(0,yv.jsx)("span",{className:tm,children:"evidence:"})," ",e.evidence]}),(0,yv.jsxs)("p",{className:em,children:[(0,yv.jsx)("span",{className:tm,children:"grade:"})," ",e.grade]}),(0,yv.jsxs)("p",{className:em,children:[(0,yv.jsx)("span",{className:tm,children:"hint:"})," ",e.hint]})]},t)}))]})},ym="Playing_container__2OPmY",gm="Playing_tabHeader__ZuWyq",bm="Playing_tab__mr8wo",_m="Playing_tabActive__a0RqU Playing_tab__mr8wo",km="Playing_contentArea__2uu5i",wm="Playing_victimInfo__3Rad9",xm=function(e){var t=e.scenario;return(0,yv.jsxs)(yv.Fragment,{children:[(0,yv.jsx)("h1",{children:t.title}),(0,yv.jsx)("p",{children:t.prologue}),(0,yv.jsx)("h2",{children:"VICTIM"}),(0,yv.jsxs)("h3",{children:[t.victim.name," / ",t.victim.age," / ",t.victim.gender]}),(0,yv.jsxs)("div",{className:wm,children:[(0,yv.jsx)("span",{children:"occupation"}),(0,yv.jsx)("p",{children:t.victim.occupation}),(0,yv.jsx)("span",{children:"appearance"}),(0,yv.jsx)("p",{children:t.victim.appearance}),(0,yv.jsx)("span",{children:"description"}),(0,yv.jsx)("p",{children:t.victim.description}),(0,yv.jsx)("span",{children:"cause of death"}),(0,yv.jsx)("p",{children:t.victim.causeOfDeath})]}),(0,yv.jsx)("h2",{children:"CRIME SCENE"}),(0,yv.jsx)("p",{children:t.crimeScene})]})},Em="Suspect_suspectCard__mnic7",Am="Suspect_selected__ICqaH",Cm="Suspect_suspectInfo__vTCR-",Dm="Suspect_label__Bm0Ep",Sm=function(e){var t=e.info,n=e.isSelected,r=e.onSelect;return(0,yv.jsxs)("div",{className:"".concat(Em," ").concat(n?Am:""),onClick:r,children:[(0,yv.jsxs)("p",{className:Cm,children:[(0,yv.jsx)("span",{className:Dm,children:"Name:"})," ",t.name]}),(0,yv.jsxs)("p",{className:Cm,children:[(0,yv.jsx)("span",{className:Dm,children:"Gender:"})," ",t.gender]}),(0,yv.jsxs)("p",{className:Cm,children:[(0,yv.jsx)("span",{className:Dm,children:"Age:"})," ",t.age]}),(0,yv.jsxs)("p",{className:Cm,children:[(0,yv.jsx)("span",{className:Dm,children:"Occupation:"})," ",t.occupation]}),(0,yv.jsxs)("p",{className:Cm,children:[(0,yv.jsx)("span",{className:Dm,children:"Appearance:"})," ",t.appearance]})]})},Om="SuspectInterview_form__Hz6ed",Fm="SuspectInterview_input__FEe9D",Pm="SuspectInterview_chatContainer__KyPFX",Tm="SuspectInterview_chatHeader__WNpQm",jm="SuspectInterview_closeButton__ioRG4",Im="SuspectInterview_chatMessages__GZVx4",Nm="SuspectInterview_chatMessage__KLiXj",Rm="SuspectInterview_messageType__hs+0J",Bm="SuspectInterview_messageTypeUser__AgVXu",Lm="SuspectInterview_messageTypeSuspect__nqPt4",Mm="SuspectInterview_messageContent__uqdUR",Um="SuspectInterview_fieldRow__Ml9A-",zm="SuspectInterview_button__cED9+",Hm="SuspectInterview_questionCount__tp7up",Zm=function(e){var n=e.name,r=e.messages,a=e.setMessages,i=e.offInterview,u=e.chat,o=w((0,t.useState)(""),2),s=o[0],c=o[1],d=w((0,t.useState)(!1),2),f=d[0],h=d[1],v=(0,t.useRef)(null),m=cv(),y=m.chatCounts,g=m.incrementChatCount;(0,t.useEffect)((function(){var e;null===(e=v.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})}),[r]);var _=function(){var e=b(p().mark((function e(t){var i,o,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==s){e.next=3;break}return e.abrupt("return");case 3:return i=r.concat({type:"user",message:s}),a(i),h(!0),o="\n        Interviewee: ".concat(n," \n        Question: ").concat(s),e.next=9,u(o,r);case 9:null==(d=e.sent)?a(i.concat({type:"error",message:"AI Error"})):(a(i.concat({type:n,message:d})),g(l,n)),h(!1),c("");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,yv.jsxs)("div",{className:Pm,children:[(0,yv.jsxs)("div",{className:Tm,children:[(0,yv.jsxs)("h3",{children:["Interview with ",n]}),(0,yv.jsx)("button",{className:jm,onClick:i,children:"\xd7"})]}),(0,yv.jsxs)("div",{className:Im,children:[r.map((function(e,t){return(0,yv.jsxs)("div",{className:Nm,children:[(0,yv.jsx)("strong",{className:"".concat(Rm," ").concat("user"===e.type?Bm:Lm),children:e.type}),(0,yv.jsx)("span",{className:Mm,children:e.message})]},t)})),(0,yv.jsx)("div",{ref:v})]}),(0,yv.jsx)("form",{className:Om,onSubmit:_,children:(0,yv.jsxs)("div",{className:Um,children:[(0,yv.jsx)("input",{className:Fm,value:s,onChange:function(e){return c(e.target.value)},placeholder:(y.suspects[n]||0)>=15?"No more questions":"Type an interview question",disabled:f}),(0,yv.jsx)("button",{className:zm,type:"submit",disabled:f||(y.suspects[n]||0)>=15,children:"Send"})]})}),(0,yv.jsx)("div",{className:Um,children:(0,yv.jsxs)("span",{className:Hm,children:["Questions: ",y.suspects[n]||0,"/15"]})})]})},Wm="Suspects_container__Vjwql",qm="Suspects_suspectsList__4JAx5",Gm="Suspects_chatArea__7unI7",Vm="Suspects_noSelection__S6BEn",$m=function(e){var n=e.suspects,r=w((0,t.useState)(null),2),a=r[0],i=r[1],u=cv(),o=u.apiKey,s=u.suspectChatHistory,c=u.updateSuspectChatHistory,l=O((function(e){return e.scenario})),d=sv(o,a?function(e,t){if(!e||!t)return"";var n="You are ".concat(e.name,". You're a suspect in a murder case and I interview you. Answer only what I asked briefly(not give a suspect answer for nothing). \nInformation about you and the victim is provided. Answer based on this, but feel free to make up if you lack information.\n----\nThe following is information about you.\nyou : ").concat(JSON.stringify(e),"\n---- \nThe following is information about the victim.\nvictim : ").concat(JSON.stringify(t.victim),"\n----\n\n"),r="You are ".concat(e.name,". You're the real culprit in a murder case and I interview you as a suspect. I don't know whether you are murderer or not.\nYou must never confesses, obediently admits to the crime himself, or explains the method of the crime himself until I provide sufficient evidence. Do your best not to be caught as the culprit. Not give a suspect answer for nothing.\nIf I am questioned without sufficient evidence, refuse to answer or deny. Trick me to believe you're not a murderer.\nInformation about you and the victim is provided. Answer based on this, but feel free to make up if you lack information.\n----\nThe following is information about you.\nyou : ").concat(JSON.stringify(e),"\ncrime : ").concat(JSON.stringify(t.truth),"\n---- \nThe following is information about the victim.\nvictim : ").concat(JSON.stringify(t.victim),"\n----\n");return e.isMurderer?r:n}(a,l):""),f=d.chat;return(0,yv.jsxs)("div",{className:Wm,children:[(0,yv.jsxs)("div",{className:qm,children:[(0,yv.jsx)("h3",{children:"Suspects"}),n.map((function(e,t){return(0,yv.jsx)(Sm,{info:e,isSelected:(null===a||void 0===a?void 0:a.name)===e.name,onSelect:function(){return function(e){i(e)}(e)}},t)}))]}),(0,yv.jsx)("div",{className:Gm,children:a?(0,yv.jsx)(Zm,{name:a.name,messages:s[a.name]||[],setMessages:function(e){return c(a.name,e)},offInterview:function(){i(null)},chat:f}):(0,yv.jsx)("div",{className:Vm,children:(0,yv.jsx)("p",{children:"Select a suspect to start the interview"})})})]})},Jm=function(){var e=O((function(e){return e.scenario})),n=w((0,t.useState)(s.PROLOGUE),2),r=n[0],a=n[1],i=function(e){var t,n=null!==(t=Object.values(s).find((function(t){return t===e})))&&void 0!==t?t:s.PROLOGUE;a(n)};return e&&(0,yv.jsxs)("div",{className:ym,children:[(0,yv.jsxs)("div",{className:gm,children:[(0,yv.jsx)("div",{className:r===s.PROLOGUE?_m:bm,onClick:function(){return i(s.PROLOGUE)},children:"The Crime Scene"}),(0,yv.jsx)("div",{className:r===s.SUSPECTS?_m:bm,onClick:function(){return i(s.SUSPECTS)},children:"Suspects"}),(0,yv.jsx)("div",{className:r===s.WATSON?_m:bm,onClick:function(){return i(s.WATSON)},children:"Watson"}),(0,yv.jsx)("div",{className:r===s.GUESSING?_m:bm,onClick:function(){return i(s.GUESSING)},children:"Solve the Case"})]}),(0,yv.jsx)("div",{className:km,children:function(){switch(r){case s.PROLOGUE:return(0,yv.jsx)(xm,{scenario:e});case s.SUSPECTS:return(0,yv.jsx)($m,{suspects:e.suspects});case s.WATSON:return(0,yv.jsx)(Jv,{});case s.GUESSING:return(0,yv.jsx)(mm,{suspects:e.suspects});default:return null}}()})]})},Km="Ending_window__Vdcoq",Qm="Ending_titleBar__MO0ye",Xm="Ending_title__aZXrs",Ym="Ending_separator__bbdo0",ey="Ending_dialog__uXb07",ty="Ending_standardDialog__KwZyO",ny="Ending_buttonContainer__snKQa",ry="Ending_button__T08L4",ay=function(){var e,t=O((function(e){return e.scenario})),n=cv().setGameStatus;return(0,yv.jsxs)("div",{className:Km,children:[(0,yv.jsx)("div",{className:Qm,children:(0,yv.jsx)("h1",{className:Xm,children:"Ending.."})}),(0,yv.jsx)("div",{className:Ym}),(0,yv.jsxs)("div",{className:ey,children:[(0,yv.jsx)("h3",{children:"Murderer"}),(0,yv.jsxs)("div",{children:[(0,yv.jsxs)("p",{children:["name : ",t.truth.murderer]}),(0,yv.jsxs)("p",{children:["how : ",t.truth.how]}),(0,yv.jsxs)("p",{children:["why : ",t.truth.why]}),(0,yv.jsxs)("p",{children:["trick : ",t.truth.trick]}),(0,yv.jsxs)("p",{children:["loophole : ",t.truth.loophole]}),(0,yv.jsxs)("p",{children:["story : ",null===(e=t.suspects.find((function(e){return e.isMurderer})))||void 0===e?void 0:e.story]})]}),(0,yv.jsx)("div",{className:Ym}),(0,yv.jsx)("h3",{children:"Suspects"}),t.suspects.filter((function(e){return!e.isMurderer})).map((function(e,t){return(0,yv.jsxs)("div",{className:ty,children:[(0,yv.jsxs)("p",{children:["name : ",e.name]}),(0,yv.jsxs)("p",{children:["alibi : ",e.alibi]}),(0,yv.jsxs)("p",{children:["story : ",e.story]})]},t)})),(0,yv.jsx)("div",{className:ny,children:(0,yv.jsx)("button",{className:ry,type:"button",onClick:function(){return n(a)},children:"HOME"})})]})]})},iy=function(){var e=cv().gameStatus;return(0,t.useEffect)((function(){console.log=function(){},console.warn=function(){}}),[]),(0,yv.jsxs)("div",{className:"App",children:[e===a&&(0,yv.jsx)(gv,{}),e===i&&(0,yv.jsx)(Sv,{}),e===u&&(0,yv.jsx)(Jm,{}),e===o&&(0,yv.jsx)(ay,{})]})},uy=function(e){e&&e instanceof Function&&n.e(787).then(n.bind(n,787)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,u=t.getTTFB;n(e),r(e),a(e),i(e),u(e)}))},oy=document.getElementById("root");if(!oy)throw new Error("Failed to find the root element");r.createRoot(oy).render((0,yv.jsx)(t.StrictMode,{children:(0,yv.jsx)(iy,{})})),uy()}()}();
//# sourceMappingURL=main.6ad2c5ba.js.map