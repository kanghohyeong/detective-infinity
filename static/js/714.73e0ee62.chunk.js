"use strict";(self.webpackChunkai_detective=self.webpackChunkai_detective||[]).push([[714],{1714:function(e,t,n){n.r(t),n.d(t,{SequentialChain:function(){return y},SimpleSequentialChain:function(){return d}});var a=n(4942),r=n(4165),i=n(5861),u=n(7762),s=n(5671),l=n(3144),o=n(7326),c=n(136),h=n(9388),p=n(4897);function v(e,t){var n,a=new Set,r=(0,u.Z)(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.has(i)&&a.add(i)}}catch(s){r.e(s)}finally{r.f()}return a}function f(e,t){var n,a=new Set(e),r=(0,u.Z)(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;a.delete(i)}}catch(s){r.e(s)}finally{r.f()}return a}function b(e){return Array.from(e).map((function(e){return'"'.concat(e,'"')})).join(", ")}var y=function(e){(0,c.Z)(n,e);var t=(0,h.Z)(n);function n(e){var a,r,i;if((0,s.Z)(this,n),i=t.call(this,e),Object.defineProperty((0,o.Z)(i),"chains",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,o.Z)(i),"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,o.Z)(i),"outputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,o.Z)(i),"returnAll",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),i.chains=e.chains,i.inputVariables=e.inputVariables,i.outputVariables=null!==(a=e.outputVariables)&&void 0!==a?a:[],i.outputVariables.length>0&&e.returnAll)throw new Error("Either specify variables to return using `outputVariables` or use `returnAll` param. Cannot apply both conditions at the same time.");return i.returnAll=null!==(r=e.returnAll)&&void 0!==r&&r,i._validateChains(),i}return(0,l.Z)(n,[{key:"inputKeys",get:function(){return this.inputVariables}},{key:"outputKeys",get:function(){return this.outputVariables}},{key:"_validateChains",value:function(){var e,t;if(0===this.chains.length)throw new Error("Sequential chain must have at least one chain.");var n=null!==(e=null===(t=this.memory)||void 0===t?void 0:t.memoryKeys)&&void 0!==e?e:[],a=new Set(this.inputKeys),r=new Set(n),i=v(a,r);if(i.size>0)throw new Error("The following keys: ".concat(b(i)," are overlapping between memory and input keys of the chain variables. This can lead to unexpected behaviour. Please use input and memory keys that don't overlap."));var s,l=function(e,t){var n,a=new Set(e),r=(0,u.Z)(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;a.add(i)}}catch(s){r.e(s)}finally{r.f()}return a}(a,r),o=(0,u.Z)(this.chains);try{for(o.s();!(s=o.n()).done;){var c=s.value,h=f(new Set(c.inputKeys),l);if(h.size>0)throw new Error('Missing variables for chain "'.concat(c._chainType(),'": ').concat(b(h),". Only got the following variables: ").concat(b(l),"."));var p=new Set(c.outputKeys),y=v(l,p);if(y.size>0)throw new Error('The following output variables for chain "'.concat(c._chainType(),'" are overlapping: ').concat(b(y),". This can lead to unexpected behaviour."));var d,w=(0,u.Z)(p);try{for(w.s();!(d=w.n()).done;){var Z=d.value;l.add(Z)}}catch(g){w.e(g)}finally{w.f()}}}catch(g){o.e(g)}finally{o.f()}if(0===this.outputVariables.length)if(this.returnAll){var k=f(l,a);this.outputVariables=Array.from(k)}else this.outputVariables=this.chains[this.chains.length-1].outputKeys;else{var m=f(new Set(this.outputVariables),new Set(l));if(m.size>0)throw new Error("The following output variables were expected to be in the final chain output but were not found: ".concat(b(m),"."))}}},{key:"_call",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var a,i,s,l,o,c,h,p,v,f,b,y;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t,i={},s=(0,u.Z)(this.chains),e.prev=3,s.s();case 5:if((l=s.n()).done){e.next=13;break}return o=l.value,e.next=9,o.call(a,null===n||void 0===n?void 0:n.getChild());case 9:for(a=e.sent,c=0,h=Object.keys(a);c<h.length;c++)p=h[c],i[p]=a[p];case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),s.e(e.t0);case 18:return e.prev=18,s.f(),e.finish(18);case 21:v={},f=(0,u.Z)(this.outputVariables);try{for(f.s();!(b=f.n()).done;)y=b.value,v[y]=i[y]}catch(r){f.e(r)}finally{f.f()}return e.abrupt("return",v);case 25:case"end":return e.stop()}}),e,this,[[3,15,18,21]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_chainType",value:function(){return"sequential_chain"}},{key:"serialize",value:function(){var e,t=[],n=(0,u.Z)(this.chains);try{for(n.s();!(e=n.n()).done;){var a=e.value;t.push(a.serialize())}}catch(r){n.e(r)}finally{n.f()}return{_type:this._chainType(),input_variables:this.inputVariables,output_variables:this.outputVariables,chains:t}}}],[{key:"deserialize",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){var a,i,s,l,o,c,h,v;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],i=t.input_variables,s=t.output_variables,l=t.chains,o=(0,u.Z)(l),e.prev=5,o.s();case 7:if((c=o.n()).done){e.next=15;break}return h=c.value,e.next=11,p.l.deserialize(h);case 11:v=e.sent,a.push(v);case 13:e.next=7;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),o.e(e.t0);case 20:return e.prev=20,o.f(),e.finish(20);case 23:return e.abrupt("return",new n({chains:a,inputVariables:i,outputVariables:s}));case 24:case"end":return e.stop()}}),e,null,[[5,17,20,23]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(p.l),d=function(e){(0,c.Z)(n,e);var t=(0,h.Z)(n);function n(e){var a,r,i;return(0,s.Z)(this,n),i=t.call(this,e.memory,e.verbose,null!==(a=e.callbacks)&&void 0!==a?a:e.callbackManager),Object.defineProperty((0,o.Z)(i),"chains",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,o.Z)(i),"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input"}),Object.defineProperty((0,o.Z)(i),"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output"}),Object.defineProperty((0,o.Z)(i),"trimOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),i.chains=e.chains,i.trimOutputs=null!==(r=e.trimOutputs)&&void 0!==r&&r,i._validateChains(),i}return(0,l.Z)(n,[{key:"inputKeys",get:function(){return[this.inputKey]}},{key:"outputKeys",get:function(){return[this.outputKey]}},{key:"_validateChains",value:function(){var e,t=(0,u.Z)(this.chains);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(1!==n.inputKeys.length)throw new Error("Chains used in SimpleSequentialChain should all have one input, got ".concat(n.inputKeys.length," for ").concat(n._chainType(),"."));if(1!==n.outputKeys.length)throw new Error("Chains used in SimpleSequentialChain should all have one output, got ".concat(n.outputKeys.length," for ").concat(n._chainType(),"."))}}catch(a){t.e(a)}finally{t.f()}}},{key:"_call",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var i,s,l,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=t[this.inputKey],s=(0,u.Z)(this.chains),e.prev=2,s.s();case 4:if((l=s.n()).done){e.next=14;break}return o=l.value,e.next=8,o.run(i,null===n||void 0===n?void 0:n.getChild());case 8:return i=e.sent,this.trimOutputs&&(i=i.trim()),e.next=12,null===n||void 0===n?void 0:n.handleText(i);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),s.e(e.t0);case 19:return e.prev=19,s.f(),e.finish(19);case 22:return e.abrupt("return",(0,a.Z)({},this.outputKey,i));case 23:case"end":return e.stop()}}),e,this,[[2,16,19,22]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_chainType",value:function(){return"simple_sequential_chain"}},{key:"serialize",value:function(){var e,t=[],n=(0,u.Z)(this.chains);try{for(n.s();!(e=n.n()).done;){var a=e.value;t.push(a.serialize())}}catch(r){n.e(r)}finally{n.f()}return{_type:this._chainType(),chains:t}}}],[{key:"deserialize",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){var a,i,s,l,o,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],i=t.chains,s=(0,u.Z)(i),e.prev=3,s.s();case 5:if((l=s.n()).done){e.next=13;break}return o=l.value,e.next=9,p.l.deserialize(o);case 9:c=e.sent,a.push(c);case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),s.e(e.t0);case 18:return e.prev=18,s.f(),e.finish(18);case 21:return e.abrupt("return",new n({chains:a}));case 22:case"end":return e.stop()}}),e,null,[[3,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(p.l)}}]);
//# sourceMappingURL=714.73e0ee62.chunk.js.map