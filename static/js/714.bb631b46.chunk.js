"use strict";(self.webpackChunkai_detective=self.webpackChunkai_detective||[]).push([[714],{1714:function(e,t,n){n.r(t),n.d(t,{SequentialChain:function(){return b},SimpleSequentialChain:function(){return d}});var a=n(4942),r=n(4165),i=n(5861),u=n(7762),s=n(5671),l=n(3144),o=n(7326),c=n(136),h=n(9388),p=n(3025);function v(e,t){var n,a=new Set,r=(0,u.Z)(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.has(i)&&a.add(i)}}catch(s){r.e(s)}finally{r.f()}return a}function f(e,t){var n,a=new Set(e),r=(0,u.Z)(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;a.delete(i)}}catch(s){r.e(s)}finally{r.f()}return a}function y(e){return Array.from(e).map((function(e){return'"'.concat(e,'"')})).join(", ")}var b=function(e){(0,c.Z)(n,e);var t=(0,h.Z)(n);function n(e){var a,r,i;if((0,s.Z)(this,n),i=t.call(this,e),Object.defineProperty((0,o.Z)(i),"chains",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,o.Z)(i),"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,o.Z)(i),"outputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,o.Z)(i),"returnAll",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),i.chains=e.chains,i.inputVariables=e.inputVariables,i.outputVariables=null!==(a=e.outputVariables)&&void 0!==a?a:[],i.outputVariables.length>0&&e.returnAll)throw new Error("Either specify variables to return using `outputVariables` or use `returnAll` param. Cannot apply both conditions at the same time.");return i.returnAll=null!==(r=e.returnAll)&&void 0!==r&&r,i._validateChains(),i}return(0,l.Z)(n,[{key:"inputKeys",get:function(){return this.inputVariables}},{key:"outputKeys",get:function(){return this.outputVariables}},{key:"_validateChains",value:function(){var e,t;if(0===this.chains.length)throw new Error("Sequential chain must have at least one chain.");var n=null!==(e=null===(t=this.memory)||void 0===t?void 0:t.memoryKeys)&&void 0!==e?e:[],a=new Set(this.inputKeys),r=new Set(n),i=v(a,r);if(i.size>0)throw new Error("The following keys: ".concat(y(i)," are overlapping between memory and input keys of the chain variables. This can lead to unexpected behaviour. Please use input and memory keys that don't overlap."));var s,l=function(e,t){var n,a=new Set(e),r=(0,u.Z)(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;a.add(i)}}catch(s){r.e(s)}finally{r.f()}return a}(a,r),o=(0,u.Z)(this.chains);try{for(o.s();!(s=o.n()).done;){var c=s.value,h=f(new Set(c.inputKeys),l);if(c.memory&&(h=f(h,new Set(c.memory.memoryKeys))),h.size>0)throw new Error('Missing variables for chain "'.concat(c._chainType(),'": ').concat(y(h),". Only got the following variables: ").concat(y(l),"."));var p=new Set(c.outputKeys),b=v(l,p);if(b.size>0)throw new Error('The following output variables for chain "'.concat(c._chainType(),'" are overlapping: ').concat(y(b),". This can lead to unexpected behaviour."));var d,w=(0,u.Z)(p);try{for(w.s();!(d=w.n()).done;){var m=d.value;l.add(m)}}catch(g){w.e(g)}finally{w.f()}}}catch(g){o.e(g)}finally{o.f()}if(0===this.outputVariables.length)if(this.returnAll){var Z=f(l,a);this.outputVariables=Array.from(Z)}else this.outputVariables=this.chains[this.chains.length-1].outputKeys;else{var k=f(new Set(this.outputVariables),new Set(l));if(k.size>0)throw new Error("The following output variables were expected to be in the final chain output but were not found: ".concat(y(k),"."))}}},{key:"_call",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var a,i,s,l,o,c,h,p,v,f,y,b,d;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={},i=t,s=0,l=(0,u.Z)(this.chains),e.prev=4,l.s();case 6:if((o=l.n()).done){e.next=15;break}return c=o.value,s+=1,e.next=11,c.call(i,null===n||void 0===n?void 0:n.getChild("step_".concat(s)));case 11:for(a=e.sent,h=0,p=Object.keys(a);h<p.length;h++)v=p[h],i[v]=a[v];case 13:e.next=6;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),l.e(e.t0);case 20:return e.prev=20,l.f(),e.finish(20);case 23:f={},y=(0,u.Z)(this.outputVariables);try{for(y.s();!(b=y.n()).done;)d=b.value,f[d]=i[d]}catch(r){y.e(r)}finally{y.f()}return e.abrupt("return",f);case 27:case"end":return e.stop()}}),e,this,[[4,17,20,23]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_chainType",value:function(){return"sequential_chain"}},{key:"serialize",value:function(){var e,t=[],n=(0,u.Z)(this.chains);try{for(n.s();!(e=n.n()).done;){var a=e.value;t.push(a.serialize())}}catch(r){n.e(r)}finally{n.f()}return{_type:this._chainType(),input_variables:this.inputVariables,output_variables:this.outputVariables,chains:t}}}],[{key:"lc_name",value:function(){return"SequentialChain"}},{key:"deserialize",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){var a,i,s,l,o,c,h,v;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],i=t.input_variables,s=t.output_variables,l=t.chains,o=(0,u.Z)(l),e.prev=5,o.s();case 7:if((c=o.n()).done){e.next=15;break}return h=c.value,e.next=11,p.l.deserialize(h);case 11:v=e.sent,a.push(v);case 13:e.next=7;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),o.e(e.t0);case 20:return e.prev=20,o.f(),e.finish(20);case 23:return e.abrupt("return",new n({chains:a,inputVariables:i,outputVariables:s}));case 24:case"end":return e.stop()}}),e,null,[[5,17,20,23]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(p.l),d=function(e){(0,c.Z)(n,e);var t=(0,h.Z)(n);function n(e){var a,r;return(0,s.Z)(this,n),r=t.call(this,e),Object.defineProperty((0,o.Z)(r),"chains",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty((0,o.Z)(r),"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input"}),Object.defineProperty((0,o.Z)(r),"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output"}),Object.defineProperty((0,o.Z)(r),"trimOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.chains=e.chains,r.trimOutputs=null!==(a=e.trimOutputs)&&void 0!==a&&a,r._validateChains(),r}return(0,l.Z)(n,[{key:"inputKeys",get:function(){return[this.inputKey]}},{key:"outputKeys",get:function(){return[this.outputKey]}},{key:"_validateChains",value:function(){var e,t=(0,u.Z)(this.chains);try{var n=function(){var t=e.value;if(1!==t.inputKeys.filter((function(e){var n,a;return null===(n=!(null!==(a=t.memory)&&void 0!==a&&a.memoryKeys.includes(e)))||void 0===n||n})).length)throw new Error("Chains used in SimpleSequentialChain should all have one input, got ".concat(t.inputKeys.length," for ").concat(t._chainType(),"."));if(1!==t.outputKeys.length)throw new Error("Chains used in SimpleSequentialChain should all have one output, got ".concat(t.outputKeys.length," for ").concat(t._chainType(),"."))};for(t.s();!(e=t.n()).done;)n()}catch(a){t.e(a)}finally{t.f()}}},{key:"_call",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t,n){var i,s,l,o,c,h;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=t[this.inputKey],s=0,l=(0,u.Z)(this.chains),e.prev=3,l.s();case 5:if((o=l.n()).done){e.next=17;break}return h=o.value,s+=1,e.next=10,h.call((c={},(0,a.Z)(c,h.inputKeys[0],i),(0,a.Z)(c,"signal",t.signal),c),null===n||void 0===n?void 0:n.getChild("step_".concat(s)));case 10:return e.t0=h.outputKeys[0],i=e.sent[e.t0],this.trimOutputs&&(i=i.trim()),e.next=15,null===n||void 0===n?void 0:n.handleText(i);case 15:e.next=5;break;case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(3),l.e(e.t1);case 22:return e.prev=22,l.f(),e.finish(22);case 25:return e.abrupt("return",(0,a.Z)({},this.outputKey,i));case 26:case"end":return e.stop()}}),e,this,[[3,19,22,25]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_chainType",value:function(){return"simple_sequential_chain"}},{key:"serialize",value:function(){var e,t=[],n=(0,u.Z)(this.chains);try{for(n.s();!(e=n.n()).done;){var a=e.value;t.push(a.serialize())}}catch(r){n.e(r)}finally{n.f()}return{_type:this._chainType(),chains:t}}}],[{key:"lc_name",value:function(){return"SimpleSequentialChain"}},{key:"deserialize",value:function(){var e=(0,i.Z)((0,r.Z)().mark((function e(t){var a,i,s,l,o,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],i=t.chains,s=(0,u.Z)(i),e.prev=3,s.s();case 5:if((l=s.n()).done){e.next=13;break}return o=l.value,e.next=9,p.l.deserialize(o);case 9:c=e.sent,a.push(c);case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),s.e(e.t0);case 18:return e.prev=18,s.f(),e.finish(18);case 21:return e.abrupt("return",new n({chains:a}));case 22:case"end":return e.stop()}}),e,null,[[3,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(p.l)}}]);
//# sourceMappingURL=714.bb631b46.chunk.js.map